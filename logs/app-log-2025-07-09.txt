2025-07-09 18:25:10,426 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:25:10,427 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 18:25:10,782 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:25:10,782 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:25:10,782 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:25:10,782 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:25:10,796 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:25:11,129 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:25:11,131 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:25:11,132 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:25:11,133 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:25:11,156 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:25:11,336 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:25:11,339 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:25:11,977 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:12,510 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:12,512 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:25:12,813 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:25:12,815 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:25:12,821 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:25:12,821 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:25:12,821 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:25:12,821 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:25:12,824 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:25:13,224 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:25:13,226 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:25:13,226 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:25:13,227 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:25:13,250 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:25:13,412 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:25:13,413 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:25:13,736 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:13,938 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:13,940 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:25:14,437 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:25:14,438 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:25:14,440 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:25:14,440 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:25:14,443 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:25:14,445 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:25:14,446 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:25:14,446 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:25:14,447 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:25:14,449 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:25:14,725 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:25:14,726 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:25:14,727 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:25:14,728 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:25:14,751 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:25:14,896 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:25:14,899 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:25:15,322 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:15,577 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:15,580 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:25:15,809 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:25:15,817 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:25:15,821 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:25:15,822 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:25:15,825 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 18:25:15,826 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 18:25:15,827 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 18:25:15,830 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:25:15,832 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:25:15,834 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 18:25:15,835 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:25:15,836 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 18:25:15,837 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:25:15,837 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:25:15,837 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:25:15,838 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:25:15,841 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:25:16,128 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:25:16,129 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:25:16,130 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:25:16,130 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:25:16,153 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:25:16,296 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:25:16,299 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:25:16,810 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:17,132 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:17,132 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:25:17,523 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:25:17,526 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:25:17,531 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 18:25:17,531 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 18:25:17,532 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:25:17,532 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:25:17,534 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:25:17,831 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:25:17,833 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:25:17,833 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:25:17,834 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:25:17,856 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:25:17,998 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:25:18,000 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:25:18,515 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:18,956 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:18,958 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 18:25:19,672 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 18:25:19,674 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 18:25:19,682 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 18:25:19,682 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 18:25:19,682 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:25:19,683 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:25:19,685 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:25:19,998 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:25:19,999 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:25:20,001 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:25:20,001 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:25:20,024 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:25:20,179 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:25:20,180 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:25:20,385 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:20,501 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:20,502 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 18:25:20,659 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 18:25:20,660 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 18:25:20,661 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 18:25:20,662 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 18:25:20,662 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 18:25:20,666 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 18:25:20,668 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 18:25:20,668 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 18:25:20,669 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 18:25:20,670 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 18:25:20,671 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 18:25:20,675 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 18:25:20,684 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 18:25:20,685 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 18:25:20,687 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 18:25:20,687 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 18:25:20,689 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 18:25:20,692 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17612': 955, '17904': 178, '17914': 326, '18675': 769}
2025-07-09 18:25:20,692 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 18:25:20,692 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17612': 955, '17904': 178, '17914': 326, '18675': 769}
2025-07-09 18:25:20,697 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 18:25:20,700 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 18:25:20,703 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 18:25:20,706 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 18:25:20,707 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17612': np.int64(955), '17904': np.int64(178), '17914': np.int64(326), '18675': np.int64(769)}
2025-07-09 18:25:20,708 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 18:25:20,708 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17612': np.int64(955), '17904': np.int64(178), '17914': np.int64(326), '18675': np.int64(769)}
2025-07-09 18:25:20,711 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 18:25:20,717 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 18:25:20,722 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 18:25:20,724 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 18:25:20,726 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 18:25:20,727 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17612': np.int64(884), '17904': np.int64(176), '17914': np.int64(323), '18675': np.int64(768)}
2025-07-09 18:25:20,728 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 18:25:20,729 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17612': np.int64(884), '17904': np.int64(176), '17914': np.int64(323), '18675': np.int64(768)}
2025-07-09 18:25:20,730 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 18:25:20,735 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 18:25:20,742 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 18:25:20,745 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 18:25:20,749 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:25:20,749 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17612': np.int64(790), '17904': np.int64(163), '17914': np.int64(317), '18675': np.int64(768)}
2025-07-09 18:25:20,749 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 18:25:20,749 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17612': np.int64(790), '17904': np.int64(163), '17914': np.int64(317), '18675': np.int64(768)}
2025-07-09 18:25:20,750 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 18:25:20,752 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 18:25:20,754 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 18:25:20,756 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 18:25:20,757 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:25:20,757 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17612': np.int64(1149), '17904': np.int64(156), '17914': np.int64(310), '18675': np.int64(768)}
2025-07-09 18:25:20,757 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 18:25:20,758 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17612': np.int64(1149), '17904': np.int64(156), '17914': np.int64(310), '18675': np.int64(768)}
2025-07-09 18:25:20,759 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 18:25:20,762 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 18:25:20,766 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 18:25:20,769 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 18:25:20,770 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:25:20,770 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17612': np.int64(853), '17904': np.int64(155), '17914': np.int64(303), '18675': np.int64(768)}
2025-07-09 18:25:20,771 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 18:25:20,771 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17612': np.int64(853), '17904': np.int64(155), '17914': np.int64(303), '18675': np.int64(768)}
2025-07-09 18:25:20,772 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 18:25:20,773 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 18:25:20,775 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 18:25:20,777 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 18:25:20,779 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 18:25:20,780 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 18:25:20,780 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 18:25:20,781 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 18:25:20,783 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:25:20,785 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:25:20,786 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:25:20,788 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:25:20,788 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 18:25:20,788 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 18:25:20,789 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 18:25:20,791 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:25:20,792 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:25:20,794 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:25:20,796 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:25:20,797 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 18:25:20,798 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 18:25:20,798 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 18:25:20,799 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 18:25:20,801 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 18:25:20,803 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 18:25:20,804 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 18:25:20,806 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 18:25:20,806 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17612': np.int64(689), '17904': np.int64(151), '17914': np.int64(299), '18675': np.int64(766)}
2025-07-09 18:25:20,807 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 18:25:20,807 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17612': np.int64(689), '17904': np.int64(151), '17914': np.int64(299), '18675': np.int64(766)}
2025-07-09 18:25:20,808 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 18:25:20,810 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 18:25:20,815 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 18:25:20,817 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 18:25:20,818 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 18:25:20,819 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17612': np.int64(602), '17904': np.int64(151), '17914': np.int64(296), '18675': np.int64(766)}
2025-07-09 18:25:20,819 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 18:25:20,819 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17612': np.int64(602), '17904': np.int64(151), '17914': np.int64(296), '18675': np.int64(766)}
2025-07-09 18:25:20,820 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 18:25:20,822 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 18:25:20,823 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 18:25:20,825 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 18:25:20,826 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 18:25:20,827 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17612': np.int64(535), '17904': np.int64(150), '17914': np.int64(293), '18675': np.int64(765)}
2025-07-09 18:25:20,828 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 18:25:20,828 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17612': np.int64(535), '17904': np.int64(150), '17914': np.int64(293), '18675': np.int64(765)}
2025-07-09 18:25:20,830 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 18:25:20,833 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 18:25:20,834 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 18:25:20,836 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 18:25:20,837 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:25:20,837 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17612': np.int64(301), '17904': np.int64(136), '17914': np.int64(282), '18675': np.int64(765)}
2025-07-09 18:25:20,838 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 18:25:20,838 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17612': np.int64(301), '17904': np.int64(136), '17914': np.int64(282), '18675': np.int64(765)}
2025-07-09 18:25:20,839 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 18:25:20,841 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 18:25:20,842 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 18:25:20,844 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 18:25:20,848 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:25:20,849 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 18:25:20,849 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 18:25:20,849 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 18:25:20,851 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:25:20,853 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:25:20,855 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:25:20,856 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:25:20,857 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 18:25:20,857 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 18:25:20,857 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 18:25:20,860 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:25:20,864 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:25:20,866 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:25:20,868 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:25:20,868 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 18:25:20,868 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 18:25:20,869 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 18:25:20,871 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 18:25:20,873 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 18:25:20,874 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 18:25:20,876 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 18:25:20,879 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 18:25:20,879 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17612': np.int64(54), '17904': np.int64(133), '17914': np.int64(267), '18675': np.int64(762)}
2025-07-09 18:25:20,880 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 18:25:20,881 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17612': np.int64(54), '17904': np.int64(133), '17914': np.int64(267), '18675': np.int64(762)}
2025-07-09 18:25:20,882 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 18:25:20,883 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 18:25:20,885 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 18:25:20,887 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 18:25:20,888 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 18:25:20,888 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17612': np.int64(-2), '17904': np.int64(132), '17914': np.int64(256), '18675': np.int64(750)}
2025-07-09 18:25:20,889 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 18:25:20,889 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17612': np.int64(-2), '17904': np.int64(132), '17914': np.int64(256), '18675': np.int64(750)}
2025-07-09 18:25:20,890 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 18:25:20,892 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 18:25:20,896 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 18:25:20,898 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 18:25:20,900 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:25:20,900 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17612': np.int64(517), '17904': np.int64(131), '17914': np.int64(255), '18675': np.int64(750)}
2025-07-09 18:25:20,901 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 18:25:20,901 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17612': np.int64(517), '17904': np.int64(131), '17914': np.int64(255), '18675': np.int64(750)}
2025-07-09 18:25:20,903 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 18:25:20,904 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 18:25:20,906 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 18:25:20,909 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 18:25:20,910 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:25:20,911 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17612': np.int64(470), '17904': np.int64(129), '17914': np.int64(248), '18675': np.int64(750)}
2025-07-09 18:25:20,911 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 18:25:20,912 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17612': np.int64(470), '17904': np.int64(129), '17914': np.int64(248), '18675': np.int64(750)}
2025-07-09 18:25:20,914 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 18:25:20,916 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 18:25:20,918 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 18:25:20,920 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 18:25:20,921 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 18:25:20,922 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:25:20,922 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 18:25:20,923 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:25:20,925 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:25:20,926 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:25:20,928 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:25:20,931 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:25:20,932 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:25:20,932 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 18:25:20,932 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:25:20,935 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:25:20,936 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:25:20,938 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:25:20,940 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:25:20,940 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:25:20,941 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 18:25:20,941 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:25:20,942 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 18:25:20,944 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 18:25:20,947 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 18:25:20,949 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:25:20,951 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:25:20,951 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17612': np.int64(749), '17904': np.int64(122), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:25:20,951 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 18:25:20,951 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17612': np.int64(749), '17904': np.int64(122), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:25:20,952 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 18:25:20,956 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 18:25:20,957 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 18:25:20,959 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 18:25:20,961 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:25:20,961 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17612': np.int64(707), '17904': np.int64(121), '17914': np.int64(242), '18675': np.int64(749)}
2025-07-09 18:25:20,963 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 18:25:20,963 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17612': np.int64(707), '17904': np.int64(121), '17914': np.int64(242), '18675': np.int64(749)}
2025-07-09 18:25:20,965 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 18:25:20,967 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 18:25:20,969 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 18:25:20,970 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 18:25:20,972 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:25:20,972 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17612': np.int64(534), '17904': np.int64(120), '17914': np.int64(238), '18675': np.int64(749)}
2025-07-09 18:25:20,972 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 18:25:20,973 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17612': np.int64(534), '17904': np.int64(120), '17914': np.int64(238), '18675': np.int64(749)}
2025-07-09 18:25:20,974 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 18:25:20,975 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 18:25:20,977 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 18:25:20,980 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 18:25:20,983 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:25:20,983 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17612': np.int64(474), '17904': np.int64(118), '17914': np.int64(229), '18675': np.int64(749)}
2025-07-09 18:25:20,984 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 18:25:20,984 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17612': np.int64(474), '17904': np.int64(118), '17914': np.int64(229), '18675': np.int64(749)}
2025-07-09 18:25:20,985 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 18:25:20,986 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 18:25:20,988 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 18:25:20,990 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 18:25:20,991 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:25:20,992 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 18:25:20,992 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 18:25:20,992 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 18:25:20,996 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:25:20,999 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:25:21,001 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:25:21,002 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:25:21,002 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 18:25:21,003 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 18:25:21,003 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 18:25:21,005 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:25:21,007 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:25:21,008 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:25:21,010 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:25:21,010 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 18:25:21,011 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 18:25:21,011 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 18:25:21,013 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 18:25:21,016 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 18:25:21,017 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 18:25:21,019 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 18:25:21,020 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:25:21,021 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17612': np.int64(339), '17904': np.int64(112), '17914': np.int64(222), '18675': np.int64(749)}
2025-07-09 18:25:21,023 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
4  2025-06-02  17612            955            884
2025-07-09 18:25:21,024 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
116  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-09 18:25:21,025 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 18:25:21,025 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 18:25:21,026 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
4  2025-06-02  17612            955            884
2025-07-09 18:25:21,028 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
116  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-09 18:25:21,029 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 18:25:21,032 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 18:25:21,034 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
0    2025-06-01            955
4    2025-06-02            884
8    2025-06-03            790
12   2025-06-04           1149
16   2025-06-05            853
20   2025-06-06            736
24   2025-06-07            736
28   2025-06-08            736
32   2025-06-09            689
36   2025-06-10            602
40   2025-06-11            535
44   2025-06-12            301
48   2025-06-13            218
52   2025-06-14            218
56   2025-06-15            218
60   2025-06-16             54
64   2025-06-17             -2
68   2025-06-18            517
72   2025-06-19            470
76   2025-06-20            394
80   2025-06-21            394
84   2025-06-22            394
88   2025-06-23            749
92   2025-06-24            707
96   2025-06-25            534
100  2025-06-26            474
104  2025-06-27            423
108  2025-06-28            423
112  2025-06-29            423
116  2025-06-30            339
2025-07-09 18:25:21,035 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            178
5    2025-06-02            176
9    2025-06-03            163
13   2025-06-04            156
17   2025-06-05            155
21   2025-06-06            153
25   2025-06-07            153
29   2025-06-08            153
33   2025-06-09            151
37   2025-06-10            151
41   2025-06-11            150
45   2025-06-12            136
49   2025-06-13            135
53   2025-06-14            135
57   2025-06-15            135
61   2025-06-16            133
65   2025-06-17            132
69   2025-06-18            131
73   2025-06-19            129
77   2025-06-20            128
81   2025-06-21            128
85   2025-06-22            128
89   2025-06-23            122
93   2025-06-24            121
97   2025-06-25            120
101  2025-06-26            118
105  2025-06-27            115
109  2025-06-28            115
113  2025-06-29            115
117  2025-06-30            112
2025-07-09 18:25:21,041 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 18:25:21,048 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 18:25:21,050 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 18:25:21,052 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
0    2025-06-01           20
4    2025-06-02           19
8    2025-06-03           17
12   2025-06-04           24
16   2025-06-05           18
20   2025-06-06           16
24   2025-06-07           16
28   2025-06-08           16
32   2025-06-09           15
36   2025-06-10           13
40   2025-06-11           12
44   2025-06-12            7
48   2025-06-13            5
52   2025-06-14            5
56   2025-06-15            5
60   2025-06-16            2
64   2025-06-17            0
68   2025-06-18           11
72   2025-06-19           10
76   2025-06-20            9
80   2025-06-21            9
84   2025-06-22            9
88   2025-06-23           16
92   2025-06-24           15
96   2025-06-25           12
100  2025-06-26           10
104  2025-06-27            9
108  2025-06-28            9
112  2025-06-29            9
116  2025-06-30            8
2025-07-09 18:25:21,053 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 18:25:21,054 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 18:25:21,054 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 18:25:21,054 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 18:25:21,056 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 18:25:21,057 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 18:25:21,058 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 18:25:21,063 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 18:25:21,063 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 18:25:21,064 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 18:25:21,066 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 18:25:21,069 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 18:25:21,071 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 18:25:21,072 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 18:25:21,072 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:25:21,072 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:25:21,074 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:25:21,346 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:25:21,347 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:25:21,348 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:25:21,348 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 18:25:21,371 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:25:21,525 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:25:21,527 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:25:21,824 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:21,938 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:22,108 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:25:22,263 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:25:22,267 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 18:25:23,135 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:25:23,137 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 18:25:23,138 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 18:25:23,140 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 18:25:23,142 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 18:25:23,142 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 18:25:23,143 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 18:25:23,149 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 18:25:23,152 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 18:25:23,163 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 18:25:23,167 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 18:25:23,168 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 18:25:23,179 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 18:25:23,182 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 18:25:23,188 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 18:25:23,192 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 18:25:23,199 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 18:25:23,200 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:25:23,201 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:25:23,202 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 18:25:23,210 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:25:23,211 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:25:23,218 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:25:23,488 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:25:23,494 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:25:23,496 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:25:23,498 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 18:25:23,542 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:25:23,704 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:25:23,706 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:25:23,920 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:24,319 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:25:24,707 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:25:25,155 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:25:25,157 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 18:25:25,606 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:25:25,609 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 18:25:25,609 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 18:25:25,613 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 18:25:25,613 - __main__ - INFO - Script finished successfully.
2025-07-09 18:31:37,382 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:31:37,383 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 18:31:37,756 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:31:37,756 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:31:37,756 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:31:37,757 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:31:37,770 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:31:38,062 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:31:38,064 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:31:38,064 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:31:38,064 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:31:38,088 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:31:38,261 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:31:38,263 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:31:38,677 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:38,954 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:38,955 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:31:39,090 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:31:39,093 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:31:39,099 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:31:39,099 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:31:39,099 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:31:39,100 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:31:39,102 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:31:39,341 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:31:39,342 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:31:39,344 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:31:39,344 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:31:39,368 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:31:39,527 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:31:39,531 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:31:39,728 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:39,845 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:39,848 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:31:40,033 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:31:40,034 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:31:40,036 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:31:40,037 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:31:40,039 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:31:40,039 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:31:40,040 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:31:40,040 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:31:40,040 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:31:40,042 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:31:40,373 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:31:40,375 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:31:40,377 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:31:40,378 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:31:40,400 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:31:40,561 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:31:40,562 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:31:40,807 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:40,922 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:40,923 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:31:41,071 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:31:41,079 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:31:41,083 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:31:41,084 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:31:41,087 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 18:31:41,088 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 18:31:41,089 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 18:31:41,090 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:31:41,091 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:31:41,093 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 18:31:41,094 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:31:41,095 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 18:31:41,095 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:31:41,096 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:31:41,096 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:31:41,096 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:31:41,099 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:31:41,336 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:31:41,337 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:31:41,338 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:31:41,339 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:31:41,361 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:31:41,510 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:31:41,512 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:31:41,722 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:41,839 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:41,840 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:31:42,001 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:31:42,005 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:31:42,008 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 18:31:42,009 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 18:31:42,011 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:31:42,012 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:31:42,017 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:31:42,253 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:31:42,255 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:31:42,256 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:31:42,257 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:31:42,280 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:31:42,446 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:31:42,447 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:31:42,753 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:42,866 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:42,867 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 18:31:43,061 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 18:31:43,064 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 18:31:43,075 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 18:31:43,077 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 18:31:43,077 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:31:43,078 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:31:43,083 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:31:43,368 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:31:43,369 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:31:43,369 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:31:43,370 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:31:43,392 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:31:43,544 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:31:43,547 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:31:43,982 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:44,102 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:44,104 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 18:31:44,248 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 18:31:44,250 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 18:31:44,251 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 18:31:44,252 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 18:31:44,252 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 18:31:44,256 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 18:31:44,258 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 18:31:44,258 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 18:31:44,259 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 18:31:44,261 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 18:31:44,262 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 18:31:44,266 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 18:31:44,267 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 18:31:44,267 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 18:31:44,268 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 18:31:44,268 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 18:31:44,270 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 18:31:44,270 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'18675': 769, '17914': 326, '17904': 178, '17612': 955}
2025-07-09 18:31:44,271 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 18:31:44,271 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'18675': 769, '17914': 326, '17904': 178, '17612': 955}
2025-07-09 18:31:44,273 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 18:31:44,274 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 18:31:44,276 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 18:31:44,278 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 18:31:44,279 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'18675': np.int64(769), '17914': np.int64(326), '17904': np.int64(178), '17612': np.int64(955)}
2025-07-09 18:31:44,279 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 18:31:44,279 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'18675': np.int64(769), '17914': np.int64(326), '17904': np.int64(178), '17612': np.int64(955)}
2025-07-09 18:31:44,280 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 18:31:44,282 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 18:31:44,284 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 18:31:44,286 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 18:31:44,287 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 18:31:44,288 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'18675': np.int64(768), '17914': np.int64(323), '17904': np.int64(176), '17612': np.int64(884)}
2025-07-09 18:31:44,288 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 18:31:44,288 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'18675': np.int64(768), '17914': np.int64(323), '17904': np.int64(176), '17612': np.int64(884)}
2025-07-09 18:31:44,289 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 18:31:44,290 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:31:44,293 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 18:31:44,296 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 18:31:44,298 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 18:31:44,298 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'18675': np.int64(768), '17914': np.int64(317), '17904': np.int64(163), '17612': np.int64(790)}
2025-07-09 18:31:44,298 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 18:31:44,299 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'18675': np.int64(768), '17914': np.int64(317), '17904': np.int64(163), '17612': np.int64(790)}
2025-07-09 18:31:44,300 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 18:31:44,302 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:31:44,303 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 18:31:44,305 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 18:31:44,306 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 18:31:44,306 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'18675': np.int64(768), '17914': np.int64(310), '17904': np.int64(156), '17612': np.int64(1149)}
2025-07-09 18:31:44,307 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 18:31:44,307 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'18675': np.int64(768), '17914': np.int64(310), '17904': np.int64(156), '17612': np.int64(1149)}
2025-07-09 18:31:44,307 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 18:31:44,309 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:31:44,313 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 18:31:44,315 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 18:31:44,316 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 18:31:44,317 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'18675': np.int64(768), '17914': np.int64(303), '17904': np.int64(155), '17612': np.int64(853)}
2025-07-09 18:31:44,317 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 18:31:44,317 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'18675': np.int64(768), '17914': np.int64(303), '17904': np.int64(155), '17612': np.int64(853)}
2025-07-09 18:31:44,318 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 18:31:44,320 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 18:31:44,321 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 18:31:44,323 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 18:31:44,324 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 18:31:44,324 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'18675': np.int64(767), '17914': np.int64(302), '17904': np.int64(153), '17612': np.int64(736)}
2025-07-09 18:31:44,325 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 18:31:44,325 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'18675': np.int64(767), '17914': np.int64(302), '17904': np.int64(153), '17612': np.int64(736)}
2025-07-09 18:31:44,328 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:31:44,330 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:31:44,331 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:31:44,332 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:31:44,333 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'18675': np.int64(767), '17914': np.int64(302), '17904': np.int64(153), '17612': np.int64(736)}
2025-07-09 18:31:44,333 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 18:31:44,333 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'18675': np.int64(767), '17914': np.int64(302), '17904': np.int64(153), '17612': np.int64(736)}
2025-07-09 18:31:44,335 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:31:44,336 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:31:44,337 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:31:44,339 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:31:44,339 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'18675': np.int64(767), '17914': np.int64(302), '17904': np.int64(153), '17612': np.int64(736)}
2025-07-09 18:31:44,339 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 18:31:44,339 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'18675': np.int64(767), '17914': np.int64(302), '17904': np.int64(153), '17612': np.int64(736)}
2025-07-09 18:31:44,340 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 18:31:44,342 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 18:31:44,344 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 18:31:44,347 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 18:31:44,349 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 18:31:44,350 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'18675': np.int64(766), '17914': np.int64(299), '17904': np.int64(151), '17612': np.int64(689)}
2025-07-09 18:31:44,350 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 18:31:44,350 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'18675': np.int64(766), '17914': np.int64(299), '17904': np.int64(151), '17612': np.int64(689)}
2025-07-09 18:31:44,352 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 18:31:44,353 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 18:31:44,355 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 18:31:44,357 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 18:31:44,359 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 18:31:44,359 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'18675': np.int64(766), '17914': np.int64(296), '17904': np.int64(151), '17612': np.int64(602)}
2025-07-09 18:31:44,360 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 18:31:44,360 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'18675': np.int64(766), '17914': np.int64(296), '17904': np.int64(151), '17612': np.int64(602)}
2025-07-09 18:31:44,363 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 18:31:44,364 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 18:31:44,366 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 18:31:44,368 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 18:31:44,370 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 18:31:44,370 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'18675': np.int64(765), '17914': np.int64(293), '17904': np.int64(150), '17612': np.int64(535)}
2025-07-09 18:31:44,370 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 18:31:44,371 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'18675': np.int64(765), '17914': np.int64(293), '17904': np.int64(150), '17612': np.int64(535)}
2025-07-09 18:31:44,372 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 18:31:44,374 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:31:44,375 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 18:31:44,379 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 18:31:44,380 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 18:31:44,381 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'18675': np.int64(765), '17914': np.int64(282), '17904': np.int64(136), '17612': np.int64(301)}
2025-07-09 18:31:44,381 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 18:31:44,381 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'18675': np.int64(765), '17914': np.int64(282), '17904': np.int64(136), '17612': np.int64(301)}
2025-07-09 18:31:44,382 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 18:31:44,383 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:31:44,385 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 18:31:44,386 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 18:31:44,388 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 18:31:44,389 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'18675': np.int64(765), '17914': np.int64(270), '17904': np.int64(135), '17612': np.int64(218)}
2025-07-09 18:31:44,389 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 18:31:44,390 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'18675': np.int64(765), '17914': np.int64(270), '17904': np.int64(135), '17612': np.int64(218)}
2025-07-09 18:31:44,391 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:31:44,393 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:31:44,396 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:31:44,397 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:31:44,398 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'18675': np.int64(765), '17914': np.int64(270), '17904': np.int64(135), '17612': np.int64(218)}
2025-07-09 18:31:44,398 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 18:31:44,398 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'18675': np.int64(765), '17914': np.int64(270), '17904': np.int64(135), '17612': np.int64(218)}
2025-07-09 18:31:44,400 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:31:44,401 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:31:44,402 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:31:44,404 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:31:44,404 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'18675': np.int64(765), '17914': np.int64(270), '17904': np.int64(135), '17612': np.int64(218)}
2025-07-09 18:31:44,404 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 18:31:44,404 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'18675': np.int64(765), '17914': np.int64(270), '17904': np.int64(135), '17612': np.int64(218)}
2025-07-09 18:31:44,405 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 18:31:44,407 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 18:31:44,408 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 18:31:44,410 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 18:31:44,412 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 18:31:44,413 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'18675': np.int64(762), '17914': np.int64(267), '17904': np.int64(133), '17612': np.int64(54)}
2025-07-09 18:31:44,413 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 18:31:44,414 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'18675': np.int64(762), '17914': np.int64(267), '17904': np.int64(133), '17612': np.int64(54)}
2025-07-09 18:31:44,415 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 18:31:44,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 18:31:44,418 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 18:31:44,420 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 18:31:44,422 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 18:31:44,422 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'18675': np.int64(750), '17914': np.int64(256), '17904': np.int64(132), '17612': np.int64(-2)}
2025-07-09 18:31:44,422 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 18:31:44,422 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'18675': np.int64(750), '17914': np.int64(256), '17904': np.int64(132), '17612': np.int64(-2)}
2025-07-09 18:31:44,423 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 18:31:44,425 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:31:44,429 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 18:31:44,431 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 18:31:44,432 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 18:31:44,432 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'18675': np.int64(750), '17914': np.int64(255), '17904': np.int64(131), '17612': np.int64(517)}
2025-07-09 18:31:44,433 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 18:31:44,433 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'18675': np.int64(750), '17914': np.int64(255), '17904': np.int64(131), '17612': np.int64(517)}
2025-07-09 18:31:44,434 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 18:31:44,436 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:31:44,438 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 18:31:44,439 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 18:31:44,441 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 18:31:44,441 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'18675': np.int64(750), '17914': np.int64(248), '17904': np.int64(129), '17612': np.int64(470)}
2025-07-09 18:31:44,442 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 18:31:44,442 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'18675': np.int64(750), '17914': np.int64(248), '17904': np.int64(129), '17612': np.int64(470)}
2025-07-09 18:31:44,444 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 18:31:44,447 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 18:31:44,449 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 18:31:44,451 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 18:31:44,454 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 18:31:44,455 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(128), '17612': np.int64(394)}
2025-07-09 18:31:44,455 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 18:31:44,456 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(128), '17612': np.int64(394)}
2025-07-09 18:31:44,458 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:31:44,462 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:31:44,466 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:31:44,470 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:31:44,470 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(128), '17612': np.int64(394)}
2025-07-09 18:31:44,471 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 18:31:44,472 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(128), '17612': np.int64(394)}
2025-07-09 18:31:44,476 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:31:44,481 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:31:44,484 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:31:44,487 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:31:44,487 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(128), '17612': np.int64(394)}
2025-07-09 18:31:44,488 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 18:31:44,488 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(128), '17612': np.int64(394)}
2025-07-09 18:31:44,490 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 18:31:44,494 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:31:44,498 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:31:44,501 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 18:31:44,503 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 18:31:44,503 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(122), '17612': np.int64(749)}
2025-07-09 18:31:44,504 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 18:31:44,504 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(122), '17612': np.int64(749)}
2025-07-09 18:31:44,505 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 18:31:44,507 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:31:44,508 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 18:31:44,514 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 18:31:44,516 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 18:31:44,516 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'18675': np.int64(749), '17914': np.int64(242), '17904': np.int64(121), '17612': np.int64(707)}
2025-07-09 18:31:44,516 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 18:31:44,517 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'18675': np.int64(749), '17914': np.int64(242), '17904': np.int64(121), '17612': np.int64(707)}
2025-07-09 18:31:44,517 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 18:31:44,519 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:31:44,521 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 18:31:44,522 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 18:31:44,523 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 18:31:44,524 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'18675': np.int64(749), '17914': np.int64(238), '17904': np.int64(120), '17612': np.int64(534)}
2025-07-09 18:31:44,524 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 18:31:44,524 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'18675': np.int64(749), '17914': np.int64(238), '17904': np.int64(120), '17612': np.int64(534)}
2025-07-09 18:31:44,526 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 18:31:44,530 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:31:44,532 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 18:31:44,534 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 18:31:44,536 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 18:31:44,536 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'18675': np.int64(749), '17914': np.int64(229), '17904': np.int64(118), '17612': np.int64(474)}
2025-07-09 18:31:44,536 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 18:31:44,537 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'18675': np.int64(749), '17914': np.int64(229), '17904': np.int64(118), '17612': np.int64(474)}
2025-07-09 18:31:44,538 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 18:31:44,540 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:31:44,542 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 18:31:44,543 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 18:31:44,547 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 18:31:44,548 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'18675': np.int64(749), '17914': np.int64(223), '17904': np.int64(115), '17612': np.int64(423)}
2025-07-09 18:31:44,548 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 18:31:44,549 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'18675': np.int64(749), '17914': np.int64(223), '17904': np.int64(115), '17612': np.int64(423)}
2025-07-09 18:31:44,551 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:31:44,552 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:31:44,553 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:31:44,555 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:31:44,555 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'18675': np.int64(749), '17914': np.int64(223), '17904': np.int64(115), '17612': np.int64(423)}
2025-07-09 18:31:44,555 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 18:31:44,556 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'18675': np.int64(749), '17914': np.int64(223), '17904': np.int64(115), '17612': np.int64(423)}
2025-07-09 18:31:44,558 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:31:44,559 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:31:44,563 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:31:44,564 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:31:44,565 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'18675': np.int64(749), '17914': np.int64(223), '17904': np.int64(115), '17612': np.int64(423)}
2025-07-09 18:31:44,565 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 18:31:44,565 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'18675': np.int64(749), '17914': np.int64(223), '17904': np.int64(115), '17612': np.int64(423)}
2025-07-09 18:31:44,566 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 18:31:44,568 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:31:44,569 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 18:31:44,571 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 18:31:44,572 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 18:31:44,573 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'18675': np.int64(749), '17914': np.int64(222), '17904': np.int64(112), '17612': np.int64(339)}
2025-07-09 18:31:44,575 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
1  2025-06-01  17914            326            326
0  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 18:31:44,577 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
117  2025-06-30  17914            223            222
116  2025-06-30  18675            749            749
2025-07-09 18:31:44,577 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 18:31:44,578 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 18:31:44,580 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
1  2025-06-01  17914            326            326
0  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 18:31:44,581 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
117  2025-06-30  17914            223            222
116  2025-06-30  18675            749            749
2025-07-09 18:31:44,582 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 18:31:44,583 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 18:31:44,585 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01            955
7    2025-06-02            884
11   2025-06-03            790
15   2025-06-04           1149
19   2025-06-05            853
23   2025-06-06            736
27   2025-06-07            736
31   2025-06-08            736
35   2025-06-09            689
39   2025-06-10            602
43   2025-06-11            535
47   2025-06-12            301
51   2025-06-13            218
55   2025-06-14            218
59   2025-06-15            218
63   2025-06-16             54
67   2025-06-17             -2
71   2025-06-18            517
75   2025-06-19            470
79   2025-06-20            394
83   2025-06-21            394
87   2025-06-22            394
91   2025-06-23            749
95   2025-06-24            707
99   2025-06-25            534
103  2025-06-26            474
107  2025-06-27            423
111  2025-06-28            423
115  2025-06-29            423
119  2025-06-30            339
2025-07-09 18:31:44,586 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            178
6    2025-06-02            176
10   2025-06-03            163
14   2025-06-04            156
18   2025-06-05            155
22   2025-06-06            153
26   2025-06-07            153
30   2025-06-08            153
34   2025-06-09            151
38   2025-06-10            151
42   2025-06-11            150
46   2025-06-12            136
50   2025-06-13            135
54   2025-06-14            135
58   2025-06-15            135
62   2025-06-16            133
66   2025-06-17            132
70   2025-06-18            131
74   2025-06-19            129
78   2025-06-20            128
82   2025-06-21            128
86   2025-06-22            128
90   2025-06-23            122
94   2025-06-24            121
98   2025-06-25            120
102  2025-06-26            118
106  2025-06-27            115
110  2025-06-28            115
114  2025-06-29            115
118  2025-06-30            112
2025-07-09 18:31:44,593 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 18:31:44,598 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 18:31:44,600 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 18:31:44,601 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           20
7    2025-06-02           19
11   2025-06-03           17
15   2025-06-04           24
19   2025-06-05           18
23   2025-06-06           16
27   2025-06-07           16
31   2025-06-08           16
35   2025-06-09           15
39   2025-06-10           13
43   2025-06-11           12
47   2025-06-12            7
51   2025-06-13            5
55   2025-06-14            5
59   2025-06-15            5
63   2025-06-16            2
67   2025-06-17            0
71   2025-06-18           11
75   2025-06-19           10
79   2025-06-20            9
83   2025-06-21            9
87   2025-06-22            9
91   2025-06-23           16
95   2025-06-24           15
99   2025-06-25           12
103  2025-06-26           10
107  2025-06-27            9
111  2025-06-28            9
115  2025-06-29            9
119  2025-06-30            8
2025-07-09 18:31:44,602 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 18:31:44,603 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 18:31:44,603 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 18:31:44,604 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 18:31:44,605 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 18:31:44,606 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 18:31:44,607 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 18:31:44,612 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 18:31:44,613 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 18:31:44,613 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 18:31:44,615 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 18:31:44,618 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 18:31:44,618 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 18:31:44,620 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 18:31:44,621 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 18:31:44,622 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 18:31:44,623 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 18:31:44,624 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 18:31:44,624 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 18:31:44,625 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 18:31:44,626 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 18:31:44,627 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 18:31:44,629 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 18:31:44,630 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 18:31:44,633 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            NaN            NaN            NaN            NaN              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 18:31:44,633 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 18:31:44,637 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:31:44,637 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 18:31:44,640 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            NaN            NaN            NaN            NaN              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            NaN            NaN            NaN            NaN              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 18:31:44,642 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame BEFORE return (head):
2025-07-09 18:31:44,647 - src.services.reporting_logic.monthly_report_generator - DEBUG -                   Date  Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
0  2025-06-01 00:00:00         0.0           0.0           0.00             0.00                20.25         20.25            NaN            NaN            NaN            NaN            0.0
1  2025-06-02 00:00:00        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0            0.0
2  2025-06-03 00:00:00        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0            0.0
3  2025-06-04 00:00:00        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0            0.0
4  2025-06-05 00:00:00        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0            0.0
2025-07-09 18:31:44,647 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame BEFORE return (tail):
2025-07-09 18:31:44,650 - src.services.reporting_logic.monthly_report_generator - DEBUG -                    Date  Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
26  2025-06-27 00:00:00        17.0          60.0          72.25             45.0                13.50        130.75           51.0            3.0            6.0            0.0            0.0
27  2025-06-28 00:00:00         0.0           0.0           0.00              0.0                13.50         13.50            NaN            NaN            NaN            NaN            0.0
28  2025-06-29 00:00:00         0.0           0.0           0.00              0.0                13.50         13.50            NaN            NaN            NaN            NaN            0.0
29  2025-06-30 00:00:00        10.0          88.0          42.50             66.0                13.05        121.55           84.0            3.0            1.0            0.0            0.0
30                TOTAL       552.0        2236.0        2346.00           1677.0               459.90       4482.90         2046.0           66.0          104.0           20.0            0.0
2025-07-09 18:31:44,650 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame BEFORE return (info):
2025-07-09 18:31:44,653 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:31:44,653 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 18:31:44,654 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 18:31:44,654 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:31:44,654 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:31:44,656 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:31:44,884 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:31:44,887 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:31:44,887 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:31:44,888 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 18:31:44,910 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:31:45,077 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:31:45,081 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:31:45,283 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:45,400 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:45,628 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:31:45,783 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:31:45,786 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 18:31:46,746 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:31:46,748 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 18:31:46,748 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 18:31:46,749 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 18:31:46,749 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 18:31:46,749 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 18:31:46,750 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 18:31:46,751 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 18:31:46,751 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 18:31:46,754 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 18:31:46,755 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 18:31:46,755 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 18:31:46,758 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 18:31:46,759 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 18:31:46,762 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 18:31:46,763 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 18:31:46,764 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 18:31:46,765 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:31:46,765 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:31:46,765 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 18:31:46,767 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:31:46,768 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:31:46,770 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:31:47,050 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:31:47,051 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:31:47,052 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:31:47,052 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 18:31:47,074 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:31:47,239 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:31:47,241 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:31:47,434 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:47,589 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:31:47,739 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:31:47,948 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:31:47,949 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 18:31:48,181 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:31:48,183 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 18:31:48,184 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 18:31:48,185 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 18:31:48,186 - __main__ - INFO - Script finished successfully.
2025-07-09 18:34:44,489 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:34:44,490 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 18:34:45,179 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:34:45,179 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:34:45,180 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:34:45,180 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:34:45,196 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:34:45,538 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:34:45,540 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:34:45,541 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:34:45,541 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:34:45,568 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:34:45,746 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:34:45,749 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:34:46,106 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:46,226 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:46,228 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:34:46,462 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:34:46,464 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:34:46,470 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:34:46,470 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:34:46,471 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:34:46,471 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:34:46,475 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:34:46,729 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:34:46,731 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:34:46,732 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:34:46,732 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:34:46,755 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:34:46,917 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:34:46,921 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:34:47,177 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:47,293 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:47,293 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:34:47,476 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:34:47,477 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:34:47,479 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:34:47,480 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:34:47,482 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:34:47,483 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:34:47,484 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:34:47,484 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:34:47,485 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:34:47,487 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:34:47,734 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:34:47,735 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:34:47,736 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:34:47,736 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:34:47,761 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:34:47,925 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:34:47,929 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:34:48,112 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:48,261 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:48,263 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:34:48,403 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:34:48,412 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:34:48,417 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:34:48,418 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:34:48,421 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 18:34:48,422 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 18:34:48,423 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 18:34:48,424 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:34:48,425 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:34:48,427 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 18:34:48,428 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:34:48,428 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 18:34:48,429 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:34:48,429 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:34:48,429 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:34:48,430 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:34:48,433 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:34:48,684 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:34:48,685 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:34:48,686 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:34:48,686 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:34:48,708 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:34:48,856 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:34:48,859 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:34:49,108 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:49,228 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:49,230 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:34:49,545 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:34:49,549 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:34:49,552 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 18:34:49,553 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 18:34:49,554 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:34:49,554 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:34:49,559 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:34:49,841 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:34:49,842 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:34:49,843 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:34:49,843 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:34:49,865 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:34:50,013 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:34:50,015 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:34:50,226 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:50,345 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:50,347 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 18:34:50,486 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 18:34:50,490 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 18:34:50,496 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 18:34:50,496 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 18:34:50,496 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:34:50,496 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:34:50,499 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:34:50,724 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:34:50,726 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:34:50,727 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:34:50,728 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:34:50,750 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:34:50,909 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:34:50,912 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:34:51,108 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:51,239 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:51,241 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 18:34:51,369 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 18:34:51,371 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 18:34:51,372 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 18:34:51,373 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 18:34:51,374 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 18:34:51,378 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 18:34:51,380 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 18:34:51,381 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 18:34:51,382 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 18:34:51,384 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 18:34:51,384 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 18:34:51,387 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 18:34:51,387 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 18:34:51,388 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 18:34:51,388 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 18:34:51,388 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 18:34:51,389 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 18:34:51,390 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17904': 178, '18675': 769, '17914': 326, '17612': 955}
2025-07-09 18:34:51,390 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 18:34:51,390 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17904': 178, '18675': 769, '17914': 326, '17612': 955}
2025-07-09 18:34:51,392 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 18:34:51,395 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 18:34:51,397 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 18:34:51,400 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 18:34:51,400 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17904': np.int64(178), '18675': np.int64(769), '17914': np.int64(326), '17612': np.int64(955)}
2025-07-09 18:34:51,400 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 18:34:51,400 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17904': np.int64(178), '18675': np.int64(769), '17914': np.int64(326), '17612': np.int64(955)}
2025-07-09 18:34:51,401 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 18:34:51,404 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 18:34:51,406 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 18:34:51,406 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 18:34:51,409 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 18:34:51,409 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17904': np.int64(176), '18675': np.int64(768), '17914': np.int64(323), '17612': np.int64(884)}
2025-07-09 18:34:51,409 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 18:34:51,409 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17904': np.int64(176), '18675': np.int64(768), '17914': np.int64(323), '17612': np.int64(884)}
2025-07-09 18:34:51,410 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 18:34:51,413 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 18:34:51,414 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:34:51,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 18:34:51,417 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 18:34:51,418 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17904': np.int64(163), '18675': np.int64(768), '17914': np.int64(317), '17612': np.int64(790)}
2025-07-09 18:34:51,418 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 18:34:51,418 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17904': np.int64(163), '18675': np.int64(768), '17914': np.int64(317), '17612': np.int64(790)}
2025-07-09 18:34:51,419 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 18:34:51,421 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 18:34:51,422 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:34:51,424 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 18:34:51,426 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 18:34:51,426 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17904': np.int64(156), '18675': np.int64(768), '17914': np.int64(310), '17612': np.int64(1149)}
2025-07-09 18:34:51,427 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 18:34:51,427 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17904': np.int64(156), '18675': np.int64(768), '17914': np.int64(310), '17612': np.int64(1149)}
2025-07-09 18:34:51,429 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 18:34:51,430 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 18:34:51,432 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:34:51,434 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 18:34:51,435 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 18:34:51,436 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17904': np.int64(155), '18675': np.int64(768), '17914': np.int64(303), '17612': np.int64(853)}
2025-07-09 18:34:51,436 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 18:34:51,436 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17904': np.int64(155), '18675': np.int64(768), '17914': np.int64(303), '17612': np.int64(853)}
2025-07-09 18:34:51,438 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 18:34:51,439 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 18:34:51,440 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 18:34:51,442 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 18:34:51,445 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 18:34:51,446 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17904': np.int64(153), '18675': np.int64(767), '17914': np.int64(302), '17612': np.int64(736)}
2025-07-09 18:34:51,447 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 18:34:51,447 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17904': np.int64(153), '18675': np.int64(767), '17914': np.int64(302), '17612': np.int64(736)}
2025-07-09 18:34:51,449 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:34:51,451 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:34:51,454 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:34:51,455 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:34:51,456 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17904': np.int64(153), '18675': np.int64(767), '17914': np.int64(302), '17612': np.int64(736)}
2025-07-09 18:34:51,456 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 18:34:51,457 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17904': np.int64(153), '18675': np.int64(767), '17914': np.int64(302), '17612': np.int64(736)}
2025-07-09 18:34:51,459 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:34:51,461 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:34:51,463 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:34:51,464 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:34:51,464 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17904': np.int64(153), '18675': np.int64(767), '17914': np.int64(302), '17612': np.int64(736)}
2025-07-09 18:34:51,465 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 18:34:51,465 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17904': np.int64(153), '18675': np.int64(767), '17914': np.int64(302), '17612': np.int64(736)}
2025-07-09 18:34:51,466 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 18:34:51,468 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 18:34:51,469 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 18:34:51,471 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 18:34:51,472 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 18:34:51,473 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17904': np.int64(151), '18675': np.int64(766), '17914': np.int64(299), '17612': np.int64(689)}
2025-07-09 18:34:51,473 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 18:34:51,473 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17904': np.int64(151), '18675': np.int64(766), '17914': np.int64(299), '17612': np.int64(689)}
2025-07-09 18:34:51,474 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 18:34:51,476 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 18:34:51,478 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 18:34:51,480 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 18:34:51,482 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 18:34:51,483 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17904': np.int64(151), '18675': np.int64(766), '17914': np.int64(296), '17612': np.int64(602)}
2025-07-09 18:34:51,483 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 18:34:51,483 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17904': np.int64(151), '18675': np.int64(766), '17914': np.int64(296), '17612': np.int64(602)}
2025-07-09 18:34:51,484 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 18:34:51,486 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 18:34:51,489 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 18:34:51,490 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 18:34:51,492 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 18:34:51,493 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17904': np.int64(150), '18675': np.int64(765), '17914': np.int64(293), '17612': np.int64(535)}
2025-07-09 18:34:51,493 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 18:34:51,494 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17904': np.int64(150), '18675': np.int64(765), '17914': np.int64(293), '17612': np.int64(535)}
2025-07-09 18:34:51,495 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 18:34:51,497 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 18:34:51,499 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:34:51,501 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 18:34:51,503 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 18:34:51,503 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17904': np.int64(136), '18675': np.int64(765), '17914': np.int64(282), '17612': np.int64(301)}
2025-07-09 18:34:51,503 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 18:34:51,504 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17904': np.int64(136), '18675': np.int64(765), '17914': np.int64(282), '17612': np.int64(301)}
2025-07-09 18:34:51,505 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 18:34:51,507 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 18:34:51,508 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:34:51,510 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 18:34:51,513 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 18:34:51,514 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17904': np.int64(135), '18675': np.int64(765), '17914': np.int64(270), '17612': np.int64(218)}
2025-07-09 18:34:51,514 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 18:34:51,515 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17904': np.int64(135), '18675': np.int64(765), '17914': np.int64(270), '17612': np.int64(218)}
2025-07-09 18:34:51,516 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:34:51,518 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:34:51,520 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:34:51,521 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:34:51,521 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17904': np.int64(135), '18675': np.int64(765), '17914': np.int64(270), '17612': np.int64(218)}
2025-07-09 18:34:51,522 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 18:34:51,522 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17904': np.int64(135), '18675': np.int64(765), '17914': np.int64(270), '17612': np.int64(218)}
2025-07-09 18:34:51,524 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:34:51,526 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:34:51,528 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:34:51,530 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:34:51,531 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17904': np.int64(135), '18675': np.int64(765), '17914': np.int64(270), '17612': np.int64(218)}
2025-07-09 18:34:51,531 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 18:34:51,531 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17904': np.int64(135), '18675': np.int64(765), '17914': np.int64(270), '17612': np.int64(218)}
2025-07-09 18:34:51,533 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 18:34:51,535 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 18:34:51,536 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 18:34:51,539 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 18:34:51,540 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 18:34:51,541 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17904': np.int64(133), '18675': np.int64(762), '17914': np.int64(267), '17612': np.int64(54)}
2025-07-09 18:34:51,541 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 18:34:51,541 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17904': np.int64(133), '18675': np.int64(762), '17914': np.int64(267), '17612': np.int64(54)}
2025-07-09 18:34:51,542 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 18:34:51,545 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 18:34:51,548 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 18:34:51,549 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 18:34:51,551 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 18:34:51,552 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17904': np.int64(132), '18675': np.int64(750), '17914': np.int64(256), '17612': np.int64(-2)}
2025-07-09 18:34:51,552 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 18:34:51,552 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17904': np.int64(132), '18675': np.int64(750), '17914': np.int64(256), '17612': np.int64(-2)}
2025-07-09 18:34:51,553 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 18:34:51,555 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 18:34:51,557 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:34:51,558 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 18:34:51,559 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 18:34:51,560 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17904': np.int64(131), '18675': np.int64(750), '17914': np.int64(255), '17612': np.int64(517)}
2025-07-09 18:34:51,561 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 18:34:51,562 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17904': np.int64(131), '18675': np.int64(750), '17914': np.int64(255), '17612': np.int64(517)}
2025-07-09 18:34:51,563 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 18:34:51,566 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 18:34:51,567 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:34:51,569 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 18:34:51,571 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 18:34:51,571 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17904': np.int64(129), '18675': np.int64(750), '17914': np.int64(248), '17612': np.int64(470)}
2025-07-09 18:34:51,571 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 18:34:51,571 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17904': np.int64(129), '18675': np.int64(750), '17914': np.int64(248), '17612': np.int64(470)}
2025-07-09 18:34:51,572 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 18:34:51,574 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 18:34:51,576 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 18:34:51,578 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 18:34:51,582 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 18:34:51,583 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17904': np.int64(128), '18675': np.int64(749), '17914': np.int64(243), '17612': np.int64(394)}
2025-07-09 18:34:51,583 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 18:34:51,584 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17904': np.int64(128), '18675': np.int64(749), '17914': np.int64(243), '17612': np.int64(394)}
2025-07-09 18:34:51,587 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:34:51,589 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:34:51,590 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:34:51,592 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:34:51,593 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17904': np.int64(128), '18675': np.int64(749), '17914': np.int64(243), '17612': np.int64(394)}
2025-07-09 18:34:51,593 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 18:34:51,594 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17904': np.int64(128), '18675': np.int64(749), '17914': np.int64(243), '17612': np.int64(394)}
2025-07-09 18:34:51,598 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:34:51,601 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:34:51,603 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:34:51,605 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:34:51,605 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17904': np.int64(128), '18675': np.int64(749), '17914': np.int64(243), '17612': np.int64(394)}
2025-07-09 18:34:51,606 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 18:34:51,606 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17904': np.int64(128), '18675': np.int64(749), '17914': np.int64(243), '17612': np.int64(394)}
2025-07-09 18:34:51,607 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 18:34:51,610 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 18:34:51,614 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:34:51,616 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:34:51,617 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 18:34:51,617 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17904': np.int64(122), '18675': np.int64(749), '17914': np.int64(243), '17612': np.int64(749)}
2025-07-09 18:34:51,618 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 18:34:51,618 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17904': np.int64(122), '18675': np.int64(749), '17914': np.int64(243), '17612': np.int64(749)}
2025-07-09 18:34:51,619 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 18:34:51,620 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 18:34:51,621 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:34:51,623 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 18:34:51,624 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 18:34:51,625 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17904': np.int64(121), '18675': np.int64(749), '17914': np.int64(242), '17612': np.int64(707)}
2025-07-09 18:34:51,626 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 18:34:51,626 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17904': np.int64(121), '18675': np.int64(749), '17914': np.int64(242), '17612': np.int64(707)}
2025-07-09 18:34:51,627 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 18:34:51,630 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 18:34:51,632 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:34:51,633 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 18:34:51,635 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 18:34:51,635 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17904': np.int64(120), '18675': np.int64(749), '17914': np.int64(238), '17612': np.int64(534)}
2025-07-09 18:34:51,635 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 18:34:51,636 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17904': np.int64(120), '18675': np.int64(749), '17914': np.int64(238), '17612': np.int64(534)}
2025-07-09 18:34:51,636 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 18:34:51,638 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 18:34:51,639 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:34:51,641 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 18:34:51,643 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 18:34:51,644 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17904': np.int64(118), '18675': np.int64(749), '17914': np.int64(229), '17612': np.int64(474)}
2025-07-09 18:34:51,644 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 18:34:51,645 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17904': np.int64(118), '18675': np.int64(749), '17914': np.int64(229), '17612': np.int64(474)}
2025-07-09 18:34:51,646 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 18:34:51,648 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 18:34:51,649 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:34:51,651 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 18:34:51,652 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 18:34:51,653 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17904': np.int64(115), '18675': np.int64(749), '17914': np.int64(223), '17612': np.int64(423)}
2025-07-09 18:34:51,653 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 18:34:51,653 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17904': np.int64(115), '18675': np.int64(749), '17914': np.int64(223), '17612': np.int64(423)}
2025-07-09 18:34:51,655 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:34:51,656 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:34:51,658 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:34:51,660 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:34:51,661 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17904': np.int64(115), '18675': np.int64(749), '17914': np.int64(223), '17612': np.int64(423)}
2025-07-09 18:34:51,661 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 18:34:51,662 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17904': np.int64(115), '18675': np.int64(749), '17914': np.int64(223), '17612': np.int64(423)}
2025-07-09 18:34:51,664 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:34:51,665 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:34:51,666 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:34:51,667 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:34:51,668 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17904': np.int64(115), '18675': np.int64(749), '17914': np.int64(223), '17612': np.int64(423)}
2025-07-09 18:34:51,668 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 18:34:51,668 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17904': np.int64(115), '18675': np.int64(749), '17914': np.int64(223), '17612': np.int64(423)}
2025-07-09 18:34:51,669 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 18:34:51,671 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 18:34:51,672 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:34:51,674 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 18:34:51,676 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 18:34:51,677 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17904': np.int64(112), '18675': np.int64(749), '17914': np.int64(222), '17612': np.int64(339)}
2025-07-09 18:34:51,680 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
0  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
1  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 18:34:51,682 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
113  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
116  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
117  2025-06-30  18675            749            749
2025-07-09 18:34:51,682 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 18:34:51,682 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 18:34:51,683 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
0  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
1  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 18:34:51,684 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
113  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
116  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
117  2025-06-30  18675            749            749
2025-07-09 18:34:51,685 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 18:34:51,686 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 18:34:51,688 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01            955
7    2025-06-02            884
11   2025-06-03            790
15   2025-06-04           1149
19   2025-06-05            853
23   2025-06-06            736
27   2025-06-07            736
31   2025-06-08            736
35   2025-06-09            689
39   2025-06-10            602
43   2025-06-11            535
47   2025-06-12            301
51   2025-06-13            218
55   2025-06-14            218
59   2025-06-15            218
63   2025-06-16             54
67   2025-06-17             -2
71   2025-06-18            517
75   2025-06-19            470
79   2025-06-20            394
83   2025-06-21            394
87   2025-06-22            394
91   2025-06-23            749
95   2025-06-24            707
99   2025-06-25            534
103  2025-06-26            474
107  2025-06-27            423
111  2025-06-28            423
115  2025-06-29            423
119  2025-06-30            339
2025-07-09 18:34:51,690 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
0    2025-06-01            178
4    2025-06-02            176
8    2025-06-03            163
12   2025-06-04            156
16   2025-06-05            155
20   2025-06-06            153
24   2025-06-07            153
28   2025-06-08            153
32   2025-06-09            151
36   2025-06-10            151
40   2025-06-11            150
44   2025-06-12            136
48   2025-06-13            135
52   2025-06-14            135
56   2025-06-15            135
60   2025-06-16            133
64   2025-06-17            132
68   2025-06-18            131
72   2025-06-19            129
76   2025-06-20            128
80   2025-06-21            128
84   2025-06-22            128
88   2025-06-23            122
92   2025-06-24            121
96   2025-06-25            120
100  2025-06-26            118
104  2025-06-27            115
108  2025-06-28            115
112  2025-06-29            115
116  2025-06-30            112
2025-07-09 18:34:51,697 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 18:34:51,701 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 18:34:51,707 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 18:34:51,713 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           20
7    2025-06-02           19
11   2025-06-03           17
15   2025-06-04           24
19   2025-06-05           18
23   2025-06-06           16
27   2025-06-07           16
31   2025-06-08           16
35   2025-06-09           15
39   2025-06-10           13
43   2025-06-11           12
47   2025-06-12            7
51   2025-06-13            5
55   2025-06-14            5
59   2025-06-15            5
63   2025-06-16            2
67   2025-06-17            0
71   2025-06-18           11
75   2025-06-19           10
79   2025-06-20            9
83   2025-06-21            9
87   2025-06-22            9
91   2025-06-23           16
95   2025-06-24           15
99   2025-06-25           12
103  2025-06-26           10
107  2025-06-27            9
111  2025-06-28            9
115  2025-06-29            9
119  2025-06-30            8
2025-07-09 18:34:51,714 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 18:34:51,716 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 18:34:51,716 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 18:34:51,717 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 18:34:51,719 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 18:34:51,722 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 18:34:51,724 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 18:34:51,731 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 18:34:51,732 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 18:34:51,733 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 18:34:51,736 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 18:34:51,743 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 18:34:51,745 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 18:34:51,748 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 18:34:51,749 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 18:34:51,750 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 18:34:51,751 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 18:34:51,752 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 18:34:51,753 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 18:34:51,755 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 18:34:51,756 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 18:34:51,758 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 18:34:51,759 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 18:34:51,761 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 18:34:51,764 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 18:34:51,765 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 18:34:51,766 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 18:34:51,767 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 18:34:51,768 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 18:34:51,770 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 18:34:51,771 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 18:34:51,774 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:34:51,774 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 18:34:51,776 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 18:34:51,779 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame BEFORE return (head):
2025-07-09 18:34:51,782 - src.services.reporting_logic.monthly_report_generator - DEBUG -                   Date  Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
0  2025-06-01 00:00:00         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0            0.0
1  2025-06-02 00:00:00        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0            0.0
2  2025-06-03 00:00:00        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0            0.0
3  2025-06-04 00:00:00        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0            0.0
4  2025-06-05 00:00:00        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0            0.0
2025-07-09 18:34:51,783 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame BEFORE return (tail):
2025-07-09 18:34:51,785 - src.services.reporting_logic.monthly_report_generator - DEBUG -                    Date  Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
26  2025-06-27 00:00:00        17.0          60.0          72.25             45.0                13.50        130.75           51.0            3.0            6.0            0.0            0.0
27  2025-06-28 00:00:00         0.0           0.0           0.00              0.0                13.50         13.50            0.0            0.0            0.0            0.0            0.0
28  2025-06-29 00:00:00         0.0           0.0           0.00              0.0                13.50         13.50            0.0            0.0            0.0            0.0            0.0
29  2025-06-30 00:00:00        10.0          88.0          42.50             66.0                13.05        121.55           84.0            3.0            1.0            0.0            0.0
30                TOTAL       552.0        2236.0        2346.00           1677.0               459.90       4482.90         2046.0           66.0          104.0           20.0            0.0
2025-07-09 18:34:51,785 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame BEFORE return (info):
2025-07-09 18:34:51,788 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:34:51,788 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 18:34:51,789 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 18:34:51,789 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:34:51,789 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:34:51,791 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:34:52,093 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:34:52,094 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:34:52,095 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:34:52,095 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 18:34:52,116 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:34:52,265 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:34:52,268 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:34:52,468 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:52,582 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:52,748 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:34:52,900 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:34:52,902 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 18:34:53,063 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:34:53,065 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 18:34:53,067 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 18:34:53,068 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 18:34:53,069 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 18:34:53,069 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 18:34:53,070 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 18:34:53,073 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 18:34:53,073 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 18:34:53,076 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 18:34:53,079 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 18:34:53,080 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 18:34:53,082 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 18:34:53,083 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 18:34:53,084 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 18:34:53,085 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 18:34:53,086 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 18:34:53,087 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:34:53,087 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:34:53,087 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 18:34:53,089 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:34:53,090 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:34:53,092 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:34:53,348 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:34:53,349 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:34:53,350 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:34:53,350 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 18:34:53,372 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:34:53,553 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:34:53,558 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:34:53,755 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:53,878 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:34:54,040 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:34:54,203 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:34:54,205 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 18:34:54,361 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:34:54,363 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 18:34:54,365 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 18:34:54,369 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 18:34:54,370 - __main__ - INFO - Script finished successfully.
2025-07-09 18:39:38,080 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:39:38,081 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 18:39:38,561 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:39:38,561 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:39:38,561 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:39:38,562 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:39:38,573 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:39:38,869 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:39:38,870 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:39:38,871 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:39:38,871 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:39:38,896 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:39:39,054 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:39:39,056 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:39:39,428 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:39,550 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:39,551 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:39:39,692 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:39:39,694 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:39:39,699 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:39:39,699 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:39:39,700 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:39:39,700 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:39:39,702 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:39:39,942 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:39:39,946 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:39:39,947 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:39:39,947 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:39:39,969 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:39:40,125 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:39:40,130 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:39:40,334 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:40,454 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:40,455 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:39:40,600 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:39:40,603 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:39:40,605 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:39:40,607 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:39:40,615 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:39:40,617 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:39:40,618 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:39:40,618 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:39:40,618 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:39:40,621 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:39:40,845 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:39:40,847 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:39:40,848 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:39:40,848 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:39:40,875 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:39:41,019 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:39:41,021 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:39:41,212 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:41,333 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:41,335 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:39:41,578 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:39:41,583 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:39:41,588 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:39:41,588 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:39:41,590 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 18:39:41,592 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 18:39:41,593 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 18:39:41,594 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:39:41,595 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:39:41,596 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 18:39:41,599 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:39:41,599 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 18:39:41,600 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:39:41,600 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:39:41,601 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:39:41,601 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:39:41,604 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:39:41,845 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:39:41,848 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:39:41,849 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:39:41,850 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:39:41,878 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:39:42,035 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:39:42,037 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:39:42,295 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:42,425 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:42,427 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:39:42,574 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:39:42,580 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:39:42,583 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 18:39:42,583 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 18:39:42,584 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:39:42,584 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:39:42,586 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:39:42,821 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:39:42,824 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:39:42,826 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:39:42,828 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:39:42,853 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:39:43,009 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:39:43,013 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:39:43,320 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:43,442 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:43,443 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 18:39:43,627 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 18:39:43,630 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 18:39:43,636 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 18:39:43,637 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 18:39:43,638 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:39:43,638 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:39:43,640 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:39:43,871 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:39:43,875 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:39:43,876 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:39:43,877 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:39:43,901 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:39:44,060 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:39:44,064 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:39:44,344 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:44,458 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:44,460 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 18:39:44,594 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 18:39:44,597 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 18:39:44,598 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 18:39:44,599 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 18:39:44,600 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 18:39:44,604 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 18:39:44,605 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 18:39:44,605 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 18:39:44,609 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 18:39:44,610 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 18:39:44,611 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 18:39:44,612 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 18:39:44,613 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 18:39:44,613 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 18:39:44,614 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 18:39:44,614 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 18:39:44,615 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 18:39:44,615 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17612': 955, '17904': 178, '17914': 326, '18675': 769}
2025-07-09 18:39:44,616 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 18:39:44,616 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17612': 955, '17904': 178, '17914': 326, '18675': 769}
2025-07-09 18:39:44,618 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 18:39:44,620 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 18:39:44,622 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 18:39:44,623 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 18:39:44,624 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17612': np.int64(955), '17904': np.int64(178), '17914': np.int64(326), '18675': np.int64(769)}
2025-07-09 18:39:44,624 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 18:39:44,625 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17612': np.int64(955), '17904': np.int64(178), '17914': np.int64(326), '18675': np.int64(769)}
2025-07-09 18:39:44,626 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 18:39:44,628 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 18:39:44,630 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 18:39:44,632 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 18:39:44,633 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 18:39:44,634 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17612': np.int64(884), '17904': np.int64(176), '17914': np.int64(323), '18675': np.int64(768)}
2025-07-09 18:39:44,634 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 18:39:44,634 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17612': np.int64(884), '17904': np.int64(176), '17914': np.int64(323), '18675': np.int64(768)}
2025-07-09 18:39:44,635 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 18:39:44,637 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 18:39:44,638 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 18:39:44,640 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 18:39:44,642 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:39:44,642 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17612': np.int64(790), '17904': np.int64(163), '17914': np.int64(317), '18675': np.int64(768)}
2025-07-09 18:39:44,643 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 18:39:44,643 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17612': np.int64(790), '17904': np.int64(163), '17914': np.int64(317), '18675': np.int64(768)}
2025-07-09 18:39:44,645 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 18:39:44,647 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 18:39:44,649 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 18:39:44,650 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 18:39:44,652 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:39:44,652 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17612': np.int64(1149), '17904': np.int64(156), '17914': np.int64(310), '18675': np.int64(768)}
2025-07-09 18:39:44,652 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 18:39:44,653 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17612': np.int64(1149), '17904': np.int64(156), '17914': np.int64(310), '18675': np.int64(768)}
2025-07-09 18:39:44,654 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 18:39:44,656 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 18:39:44,658 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 18:39:44,662 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 18:39:44,664 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:39:44,665 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17612': np.int64(853), '17904': np.int64(155), '17914': np.int64(303), '18675': np.int64(768)}
2025-07-09 18:39:44,665 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 18:39:44,666 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17612': np.int64(853), '17904': np.int64(155), '17914': np.int64(303), '18675': np.int64(768)}
2025-07-09 18:39:44,667 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 18:39:44,669 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 18:39:44,671 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 18:39:44,672 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 18:39:44,674 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 18:39:44,674 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 18:39:44,675 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 18:39:44,675 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 18:39:44,678 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:39:44,680 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:39:44,681 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:39:44,683 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:39:44,683 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 18:39:44,683 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 18:39:44,684 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 18:39:44,685 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:39:44,686 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:39:44,688 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:39:44,689 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:39:44,690 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 18:39:44,690 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 18:39:44,690 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 18:39:44,692 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 18:39:44,694 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 18:39:44,696 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 18:39:44,698 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 18:39:44,699 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 18:39:44,700 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17612': np.int64(689), '17904': np.int64(151), '17914': np.int64(299), '18675': np.int64(766)}
2025-07-09 18:39:44,700 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 18:39:44,701 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17612': np.int64(689), '17904': np.int64(151), '17914': np.int64(299), '18675': np.int64(766)}
2025-07-09 18:39:44,702 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 18:39:44,704 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 18:39:44,706 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 18:39:44,707 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 18:39:44,709 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 18:39:44,709 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17612': np.int64(602), '17904': np.int64(151), '17914': np.int64(296), '18675': np.int64(766)}
2025-07-09 18:39:44,709 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 18:39:44,710 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17612': np.int64(602), '17904': np.int64(151), '17914': np.int64(296), '18675': np.int64(766)}
2025-07-09 18:39:44,712 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 18:39:44,714 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 18:39:44,715 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 18:39:44,717 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 18:39:44,718 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 18:39:44,718 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17612': np.int64(535), '17904': np.int64(150), '17914': np.int64(293), '18675': np.int64(765)}
2025-07-09 18:39:44,718 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 18:39:44,719 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17612': np.int64(535), '17904': np.int64(150), '17914': np.int64(293), '18675': np.int64(765)}
2025-07-09 18:39:44,720 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 18:39:44,721 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 18:39:44,723 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 18:39:44,724 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 18:39:44,727 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:39:44,727 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17612': np.int64(301), '17904': np.int64(136), '17914': np.int64(282), '18675': np.int64(765)}
2025-07-09 18:39:44,727 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 18:39:44,728 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17612': np.int64(301), '17904': np.int64(136), '17914': np.int64(282), '18675': np.int64(765)}
2025-07-09 18:39:44,729 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 18:39:44,731 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 18:39:44,732 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 18:39:44,734 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 18:39:44,735 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:39:44,736 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 18:39:44,736 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 18:39:44,736 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 18:39:44,738 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:39:44,740 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:39:44,741 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:39:44,743 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:39:44,743 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 18:39:44,743 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 18:39:44,744 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 18:39:44,747 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:39:44,748 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:39:44,750 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:39:44,751 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:39:44,752 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 18:39:44,752 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 18:39:44,752 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 18:39:44,754 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 18:39:44,755 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 18:39:44,757 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 18:39:44,759 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 18:39:44,761 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 18:39:44,762 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17612': np.int64(54), '17904': np.int64(133), '17914': np.int64(267), '18675': np.int64(762)}
2025-07-09 18:39:44,762 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 18:39:44,763 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17612': np.int64(54), '17904': np.int64(133), '17914': np.int64(267), '18675': np.int64(762)}
2025-07-09 18:39:44,764 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 18:39:44,765 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 18:39:44,767 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 18:39:44,768 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 18:39:44,770 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 18:39:44,770 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17612': np.int64(-2), '17904': np.int64(132), '17914': np.int64(256), '18675': np.int64(750)}
2025-07-09 18:39:44,770 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 18:39:44,771 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17612': np.int64(-2), '17904': np.int64(132), '17914': np.int64(256), '18675': np.int64(750)}
2025-07-09 18:39:44,772 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 18:39:44,773 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 18:39:44,776 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 18:39:44,779 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 18:39:44,780 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:39:44,781 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17612': np.int64(517), '17904': np.int64(131), '17914': np.int64(255), '18675': np.int64(750)}
2025-07-09 18:39:44,781 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 18:39:44,781 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17612': np.int64(517), '17904': np.int64(131), '17914': np.int64(255), '18675': np.int64(750)}
2025-07-09 18:39:44,783 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 18:39:44,785 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 18:39:44,786 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 18:39:44,788 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 18:39:44,789 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:39:44,790 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17612': np.int64(470), '17904': np.int64(129), '17914': np.int64(248), '18675': np.int64(750)}
2025-07-09 18:39:44,790 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 18:39:44,791 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17612': np.int64(470), '17904': np.int64(129), '17914': np.int64(248), '18675': np.int64(750)}
2025-07-09 18:39:44,792 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 18:39:44,795 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 18:39:44,797 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 18:39:44,798 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 18:39:44,800 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 18:39:44,801 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:39:44,801 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 18:39:44,801 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:39:44,803 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:39:44,804 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:39:44,805 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:39:44,807 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:39:44,808 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:39:44,808 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 18:39:44,808 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:39:44,811 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:39:44,813 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:39:44,816 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:39:44,818 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:39:44,818 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:39:44,818 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 18:39:44,819 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:39:44,819 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 18:39:44,821 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 18:39:44,823 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 18:39:44,824 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:39:44,826 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:39:44,827 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17612': np.int64(749), '17904': np.int64(122), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:39:44,828 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 18:39:44,829 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17612': np.int64(749), '17904': np.int64(122), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 18:39:44,830 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 18:39:44,832 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 18:39:44,834 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 18:39:44,835 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 18:39:44,836 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:39:44,837 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17612': np.int64(707), '17904': np.int64(121), '17914': np.int64(242), '18675': np.int64(749)}
2025-07-09 18:39:44,837 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 18:39:44,837 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17612': np.int64(707), '17904': np.int64(121), '17914': np.int64(242), '18675': np.int64(749)}
2025-07-09 18:39:44,838 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 18:39:44,839 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 18:39:44,841 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 18:39:44,843 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 18:39:44,846 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:39:44,846 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17612': np.int64(534), '17904': np.int64(120), '17914': np.int64(238), '18675': np.int64(749)}
2025-07-09 18:39:44,847 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 18:39:44,847 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17612': np.int64(534), '17904': np.int64(120), '17914': np.int64(238), '18675': np.int64(749)}
2025-07-09 18:39:44,848 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 18:39:44,849 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 18:39:44,851 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 18:39:44,853 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 18:39:44,854 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:39:44,855 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17612': np.int64(474), '17904': np.int64(118), '17914': np.int64(229), '18675': np.int64(749)}
2025-07-09 18:39:44,855 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 18:39:44,855 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17612': np.int64(474), '17904': np.int64(118), '17914': np.int64(229), '18675': np.int64(749)}
2025-07-09 18:39:44,856 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 18:39:44,857 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 18:39:44,859 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 18:39:44,862 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 18:39:44,864 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:39:44,864 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 18:39:44,865 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 18:39:44,865 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 18:39:44,867 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:39:44,869 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:39:44,870 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:39:44,871 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:39:44,872 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 18:39:44,872 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 18:39:44,872 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 18:39:44,874 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:39:44,877 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:39:44,879 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:39:44,880 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:39:44,881 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 18:39:44,881 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 18:39:44,881 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 18:39:44,882 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 18:39:44,884 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 18:39:44,885 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 18:39:44,887 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 18:39:44,888 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:39:44,888 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17612': np.int64(339), '17904': np.int64(112), '17914': np.int64(222), '18675': np.int64(749)}
2025-07-09 18:39:44,891 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
4  2025-06-02  17612            955            884
2025-07-09 18:39:44,892 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
116  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-09 18:39:44,893 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 18:39:44,893 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 18:39:44,894 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
4  2025-06-02  17612            955            884
2025-07-09 18:39:44,896 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
116  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-09 18:39:44,896 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 18:39:44,898 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 18:39:44,899 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
0    2025-06-01            955
4    2025-06-02            884
8    2025-06-03            790
12   2025-06-04           1149
16   2025-06-05            853
20   2025-06-06            736
24   2025-06-07            736
28   2025-06-08            736
32   2025-06-09            689
36   2025-06-10            602
40   2025-06-11            535
44   2025-06-12            301
48   2025-06-13            218
52   2025-06-14            218
56   2025-06-15            218
60   2025-06-16             54
64   2025-06-17             -2
68   2025-06-18            517
72   2025-06-19            470
76   2025-06-20            394
80   2025-06-21            394
84   2025-06-22            394
88   2025-06-23            749
92   2025-06-24            707
96   2025-06-25            534
100  2025-06-26            474
104  2025-06-27            423
108  2025-06-28            423
112  2025-06-29            423
116  2025-06-30            339
2025-07-09 18:39:44,901 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            178
5    2025-06-02            176
9    2025-06-03            163
13   2025-06-04            156
17   2025-06-05            155
21   2025-06-06            153
25   2025-06-07            153
29   2025-06-08            153
33   2025-06-09            151
37   2025-06-10            151
41   2025-06-11            150
45   2025-06-12            136
49   2025-06-13            135
53   2025-06-14            135
57   2025-06-15            135
61   2025-06-16            133
65   2025-06-17            132
69   2025-06-18            131
73   2025-06-19            129
77   2025-06-20            128
81   2025-06-21            128
85   2025-06-22            128
89   2025-06-23            122
93   2025-06-24            121
97   2025-06-25            120
101  2025-06-26            118
105  2025-06-27            115
109  2025-06-28            115
113  2025-06-29            115
117  2025-06-30            112
2025-07-09 18:39:44,907 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 18:39:44,911 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 18:39:44,912 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 18:39:44,914 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
0    2025-06-01           20
4    2025-06-02           19
8    2025-06-03           17
12   2025-06-04           24
16   2025-06-05           18
20   2025-06-06           16
24   2025-06-07           16
28   2025-06-08           16
32   2025-06-09           15
36   2025-06-10           13
40   2025-06-11           12
44   2025-06-12            7
48   2025-06-13            5
52   2025-06-14            5
56   2025-06-15            5
60   2025-06-16            2
64   2025-06-17            0
68   2025-06-18           11
72   2025-06-19           10
76   2025-06-20            9
80   2025-06-21            9
84   2025-06-22            9
88   2025-06-23           16
92   2025-06-24           15
96   2025-06-25           12
100  2025-06-26           10
104  2025-06-27            9
108  2025-06-28            9
112  2025-06-29            9
116  2025-06-30            8
2025-07-09 18:39:44,915 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 18:39:44,915 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 18:39:44,915 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 18:39:44,917 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 18:39:44,918 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 18:39:44,919 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 18:39:44,919 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 18:39:44,922 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 18:39:44,923 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 18:39:44,923 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 18:39:44,925 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 18:39:44,928 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 18:39:44,929 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 18:39:44,930 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 18:39:44,931 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 18:39:44,932 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 18:39:44,933 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 18:39:44,934 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 18:39:44,934 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 18:39:44,935 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 18:39:44,936 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 18:39:44,936 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 18:39:44,937 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 18:39:44,938 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 18:39:44,939 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 18:39:44,939 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 18:39:44,940 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 18:39:44,941 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 18:39:44,941 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 18:39:44,945 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 18:39:44,945 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 18:39:44,948 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:39:44,949 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 18:39:44,951 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 18:39:44,953 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame BEFORE return (head):
2025-07-09 18:39:44,955 - src.services.reporting_logic.monthly_report_generator - DEBUG -                   Date  Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
0  2025-06-01 00:00:00         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0            0.0
1  2025-06-02 00:00:00        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0            0.0
2  2025-06-03 00:00:00        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0            0.0
3  2025-06-04 00:00:00        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0            0.0
4  2025-06-05 00:00:00        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0            0.0
2025-07-09 18:39:44,956 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame BEFORE return (tail):
2025-07-09 18:39:44,958 - src.services.reporting_logic.monthly_report_generator - DEBUG -                    Date  Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
26  2025-06-27 00:00:00        17.0          60.0          72.25             45.0                13.50        130.75           51.0            3.0            6.0            0.0            0.0
27  2025-06-28 00:00:00         0.0           0.0           0.00              0.0                13.50         13.50            0.0            0.0            0.0            0.0            0.0
28  2025-06-29 00:00:00         0.0           0.0           0.00              0.0                13.50         13.50            0.0            0.0            0.0            0.0            0.0
29  2025-06-30 00:00:00        10.0          88.0          42.50             66.0                13.05        121.55           84.0            3.0            1.0            0.0            0.0
30                TOTAL       552.0        2236.0        2346.00           1677.0               459.90       4482.90         2046.0           66.0          104.0           20.0            0.0
2025-07-09 18:39:44,959 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame BEFORE return (info):
2025-07-09 18:39:44,963 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:39:44,963 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 18:39:44,964 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 18:39:44,964 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:39:44,964 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:39:44,967 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:39:45,208 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:39:45,211 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:39:45,212 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:39:45,213 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 18:39:45,236 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:39:45,381 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:39:45,383 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:39:45,675 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:45,792 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:45,982 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:39:46,187 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:39:46,188 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 18:39:46,388 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:39:46,390 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 18:39:46,391 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 18:39:46,393 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 18:39:46,394 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 18:39:46,394 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 18:39:46,395 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 18:39:46,398 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 18:39:46,399 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 18:39:46,404 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 18:39:46,405 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 18:39:46,407 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 18:39:46,411 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 18:39:46,412 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 18:39:46,415 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 18:39:46,415 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 18:39:46,420 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 18:39:46,422 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:39:46,423 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:39:46,424 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 18:39:46,429 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:39:46,430 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:39:46,432 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:39:46,664 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:39:46,666 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:39:46,667 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:39:46,668 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 18:39:46,689 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:39:46,846 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:39:46,849 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:39:47,054 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:47,171 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:39:47,415 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:39:47,559 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:39:47,561 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 18:39:47,723 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:39:47,724 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 18:39:47,725 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 18:39:47,725 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 18:39:47,726 - __main__ - INFO - Script finished successfully.
2025-07-09 18:40:28,644 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:40:28,645 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 18:40:28,999 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:40:29,000 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:40:29,000 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:40:29,000 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:40:29,012 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:40:29,261 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:40:29,262 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:40:29,263 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:40:29,263 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:40:29,286 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:40:29,437 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:40:29,439 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:40:29,722 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:29,844 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:29,845 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:40:30,014 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:40:30,016 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:40:30,022 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:40:30,023 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:40:30,024 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:40:30,024 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:40:30,027 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:40:30,276 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:40:30,277 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:40:30,278 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:40:30,278 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:40:30,300 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:40:30,449 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:40:30,453 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:40:30,645 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:30,854 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:30,856 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:40:31,004 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:40:31,007 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:40:31,010 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:40:31,011 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:40:31,015 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:40:31,015 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:40:31,016 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:40:31,016 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:40:31,016 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:40:31,019 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:40:31,233 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:40:31,235 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:40:31,236 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:40:31,236 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:40:31,261 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:40:31,400 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:40:31,402 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:40:31,606 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:31,731 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:31,733 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:40:31,959 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:40:31,965 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:40:31,969 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:40:31,970 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:40:31,973 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 18:40:31,975 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 18:40:31,976 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 18:40:31,977 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:40:31,978 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:40:31,979 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 18:40:31,981 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:40:31,981 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 18:40:31,982 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:40:31,982 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:40:31,983 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:40:31,983 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:40:31,985 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:40:32,220 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:40:32,222 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:40:32,223 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:40:32,224 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:40:32,247 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:40:32,405 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:40:32,410 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:40:32,618 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:32,754 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:32,755 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:40:32,901 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:40:32,905 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:40:32,908 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 18:40:32,909 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 18:40:32,910 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:40:32,910 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:40:32,912 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:40:33,160 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:40:33,162 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:40:33,164 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:40:33,166 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:40:33,187 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:40:33,353 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:40:33,355 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:40:33,599 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:33,805 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:33,808 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 18:40:34,008 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 18:40:34,010 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 18:40:34,016 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 18:40:34,016 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 18:40:34,017 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:40:34,017 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:40:34,021 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:40:34,244 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:40:34,246 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:40:34,246 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:40:34,247 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:40:34,269 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:40:34,429 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:40:34,430 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:40:34,641 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:34,765 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:34,766 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 18:40:34,913 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 18:40:34,915 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 18:40:34,917 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 18:40:34,919 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 18:40:34,920 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 18:40:34,929 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 18:40:34,932 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 18:40:34,933 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 18:40:34,936 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 18:40:34,938 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 18:40:34,939 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 18:40:34,942 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 18:40:34,943 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 18:40:34,944 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 18:40:34,944 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 18:40:34,945 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 18:40:34,946 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 18:40:34,947 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'18675': 769, '17612': 955, '17904': 178, '17914': 326}
2025-07-09 18:40:34,948 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 18:40:34,949 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'18675': 769, '17612': 955, '17904': 178, '17914': 326}
2025-07-09 18:40:34,951 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 18:40:34,953 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 18:40:34,955 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 18:40:34,956 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 18:40:34,957 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'18675': np.int64(769), '17612': np.int64(955), '17904': np.int64(178), '17914': np.int64(326)}
2025-07-09 18:40:34,957 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 18:40:34,958 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'18675': np.int64(769), '17612': np.int64(955), '17904': np.int64(178), '17914': np.int64(326)}
2025-07-09 18:40:34,959 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 18:40:34,962 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 18:40:34,965 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 18:40:34,967 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 18:40:34,968 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 18:40:34,969 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'18675': np.int64(768), '17612': np.int64(884), '17904': np.int64(176), '17914': np.int64(323)}
2025-07-09 18:40:34,970 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 18:40:34,970 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'18675': np.int64(768), '17612': np.int64(884), '17904': np.int64(176), '17914': np.int64(323)}
2025-07-09 18:40:34,972 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 18:40:34,974 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:40:34,977 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 18:40:34,980 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 18:40:34,982 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 18:40:34,982 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'18675': np.int64(768), '17612': np.int64(790), '17904': np.int64(163), '17914': np.int64(317)}
2025-07-09 18:40:34,983 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 18:40:34,984 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'18675': np.int64(768), '17612': np.int64(790), '17904': np.int64(163), '17914': np.int64(317)}
2025-07-09 18:40:34,985 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 18:40:34,987 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:40:34,989 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 18:40:34,992 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 18:40:34,995 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 18:40:34,995 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'18675': np.int64(768), '17612': np.int64(1149), '17904': np.int64(156), '17914': np.int64(310)}
2025-07-09 18:40:34,996 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 18:40:34,996 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'18675': np.int64(768), '17612': np.int64(1149), '17904': np.int64(156), '17914': np.int64(310)}
2025-07-09 18:40:34,997 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 18:40:34,999 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:40:35,001 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 18:40:35,002 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 18:40:35,004 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 18:40:35,005 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'18675': np.int64(768), '17612': np.int64(853), '17904': np.int64(155), '17914': np.int64(303)}
2025-07-09 18:40:35,005 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 18:40:35,006 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'18675': np.int64(768), '17612': np.int64(853), '17904': np.int64(155), '17914': np.int64(303)}
2025-07-09 18:40:35,007 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 18:40:35,009 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 18:40:35,012 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 18:40:35,014 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 18:40:35,016 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 18:40:35,016 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'18675': np.int64(767), '17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 18:40:35,017 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 18:40:35,017 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'18675': np.int64(767), '17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 18:40:35,019 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:40:35,021 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:40:35,023 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:40:35,024 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:40:35,025 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'18675': np.int64(767), '17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 18:40:35,025 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 18:40:35,026 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'18675': np.int64(767), '17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 18:40:35,028 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:40:35,030 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:40:35,032 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:40:35,033 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:40:35,034 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'18675': np.int64(767), '17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 18:40:35,034 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 18:40:35,034 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'18675': np.int64(767), '17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 18:40:35,035 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 18:40:35,037 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 18:40:35,038 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 18:40:35,039 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 18:40:35,040 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 18:40:35,041 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'18675': np.int64(766), '17612': np.int64(689), '17904': np.int64(151), '17914': np.int64(299)}
2025-07-09 18:40:35,041 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 18:40:35,041 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'18675': np.int64(766), '17612': np.int64(689), '17904': np.int64(151), '17914': np.int64(299)}
2025-07-09 18:40:35,044 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 18:40:35,045 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 18:40:35,046 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 18:40:35,048 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 18:40:35,050 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 18:40:35,050 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'18675': np.int64(766), '17612': np.int64(602), '17904': np.int64(151), '17914': np.int64(296)}
2025-07-09 18:40:35,051 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 18:40:35,051 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'18675': np.int64(766), '17612': np.int64(602), '17904': np.int64(151), '17914': np.int64(296)}
2025-07-09 18:40:35,052 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 18:40:35,053 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 18:40:35,054 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 18:40:35,055 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 18:40:35,057 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 18:40:35,058 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'18675': np.int64(765), '17612': np.int64(535), '17904': np.int64(150), '17914': np.int64(293)}
2025-07-09 18:40:35,059 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 18:40:35,059 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'18675': np.int64(765), '17612': np.int64(535), '17904': np.int64(150), '17914': np.int64(293)}
2025-07-09 18:40:35,061 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 18:40:35,063 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:40:35,064 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 18:40:35,065 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 18:40:35,067 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 18:40:35,067 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'18675': np.int64(765), '17612': np.int64(301), '17904': np.int64(136), '17914': np.int64(282)}
2025-07-09 18:40:35,067 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 18:40:35,068 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'18675': np.int64(765), '17612': np.int64(301), '17904': np.int64(136), '17914': np.int64(282)}
2025-07-09 18:40:35,068 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 18:40:35,070 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:40:35,071 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 18:40:35,073 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 18:40:35,074 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 18:40:35,075 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'18675': np.int64(765), '17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 18:40:35,075 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 18:40:35,075 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'18675': np.int64(765), '17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 18:40:35,078 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:40:35,080 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:40:35,081 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:40:35,082 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:40:35,083 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'18675': np.int64(765), '17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 18:40:35,083 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 18:40:35,083 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'18675': np.int64(765), '17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 18:40:35,085 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:40:35,085 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:40:35,087 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:40:35,088 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:40:35,088 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'18675': np.int64(765), '17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 18:40:35,088 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 18:40:35,089 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'18675': np.int64(765), '17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 18:40:35,090 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 18:40:35,092 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 18:40:35,094 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 18:40:35,096 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 18:40:35,097 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 18:40:35,097 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'18675': np.int64(762), '17612': np.int64(54), '17904': np.int64(133), '17914': np.int64(267)}
2025-07-09 18:40:35,098 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 18:40:35,098 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'18675': np.int64(762), '17612': np.int64(54), '17904': np.int64(133), '17914': np.int64(267)}
2025-07-09 18:40:35,099 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 18:40:35,100 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 18:40:35,101 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 18:40:35,103 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 18:40:35,104 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 18:40:35,104 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'18675': np.int64(750), '17612': np.int64(-2), '17904': np.int64(132), '17914': np.int64(256)}
2025-07-09 18:40:35,105 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 18:40:35,106 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'18675': np.int64(750), '17612': np.int64(-2), '17904': np.int64(132), '17914': np.int64(256)}
2025-07-09 18:40:35,107 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 18:40:35,109 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:40:35,111 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 18:40:35,113 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 18:40:35,114 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 18:40:35,114 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'18675': np.int64(750), '17612': np.int64(517), '17904': np.int64(131), '17914': np.int64(255)}
2025-07-09 18:40:35,115 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 18:40:35,115 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'18675': np.int64(750), '17612': np.int64(517), '17904': np.int64(131), '17914': np.int64(255)}
2025-07-09 18:40:35,117 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 18:40:35,118 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:40:35,119 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 18:40:35,120 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 18:40:35,121 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 18:40:35,122 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'18675': np.int64(750), '17612': np.int64(470), '17904': np.int64(129), '17914': np.int64(248)}
2025-07-09 18:40:35,122 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 18:40:35,122 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'18675': np.int64(750), '17612': np.int64(470), '17904': np.int64(129), '17914': np.int64(248)}
2025-07-09 18:40:35,123 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 18:40:35,124 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 18:40:35,128 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 18:40:35,129 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 18:40:35,131 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 18:40:35,131 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'18675': np.int64(749), '17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 18:40:35,131 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 18:40:35,132 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'18675': np.int64(749), '17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 18:40:35,134 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:40:35,135 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:40:35,135 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:40:35,137 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:40:35,137 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'18675': np.int64(749), '17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 18:40:35,137 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 18:40:35,137 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'18675': np.int64(749), '17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 18:40:35,140 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:40:35,142 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:40:35,143 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:40:35,145 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:40:35,145 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'18675': np.int64(749), '17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 18:40:35,146 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 18:40:35,146 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'18675': np.int64(749), '17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 18:40:35,147 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 18:40:35,148 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:40:35,149 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 18:40:35,151 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 18:40:35,152 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:40:35,153 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'18675': np.int64(749), '17612': np.int64(749), '17904': np.int64(122), '17914': np.int64(243)}
2025-07-09 18:40:35,153 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 18:40:35,154 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'18675': np.int64(749), '17612': np.int64(749), '17904': np.int64(122), '17914': np.int64(243)}
2025-07-09 18:40:35,155 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 18:40:35,156 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:40:35,158 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 18:40:35,159 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 18:40:35,162 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 18:40:35,163 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'18675': np.int64(749), '17612': np.int64(707), '17904': np.int64(121), '17914': np.int64(242)}
2025-07-09 18:40:35,163 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 18:40:35,164 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'18675': np.int64(749), '17612': np.int64(707), '17904': np.int64(121), '17914': np.int64(242)}
2025-07-09 18:40:35,164 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 18:40:35,165 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:40:35,167 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 18:40:35,168 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 18:40:35,170 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 18:40:35,170 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'18675': np.int64(749), '17612': np.int64(534), '17904': np.int64(120), '17914': np.int64(238)}
2025-07-09 18:40:35,170 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 18:40:35,171 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'18675': np.int64(749), '17612': np.int64(534), '17904': np.int64(120), '17914': np.int64(238)}
2025-07-09 18:40:35,172 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 18:40:35,173 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:40:35,174 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 18:40:35,176 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 18:40:35,178 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 18:40:35,179 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'18675': np.int64(749), '17612': np.int64(474), '17904': np.int64(118), '17914': np.int64(229)}
2025-07-09 18:40:35,179 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 18:40:35,179 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'18675': np.int64(749), '17612': np.int64(474), '17904': np.int64(118), '17914': np.int64(229)}
2025-07-09 18:40:35,180 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 18:40:35,182 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:40:35,183 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 18:40:35,185 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 18:40:35,186 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 18:40:35,187 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'18675': np.int64(749), '17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 18:40:35,187 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 18:40:35,187 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'18675': np.int64(749), '17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 18:40:35,189 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:40:35,190 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:40:35,192 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:40:35,194 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:40:35,195 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'18675': np.int64(749), '17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 18:40:35,195 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 18:40:35,195 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'18675': np.int64(749), '17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 18:40:35,198 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:40:35,198 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:40:35,200 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:40:35,201 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:40:35,201 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'18675': np.int64(749), '17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 18:40:35,202 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 18:40:35,202 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'18675': np.int64(749), '17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 18:40:35,203 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 18:40:35,205 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:40:35,207 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 18:40:35,208 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 18:40:35,210 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 18:40:35,211 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'18675': np.int64(749), '17612': np.int64(339), '17904': np.int64(112), '17914': np.int64(222)}
2025-07-09 18:40:35,213 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
3  2025-06-01  17914            326            326
0  2025-06-01  18675            769            769
5  2025-06-02  17612            955            884
2025-07-09 18:40:35,215 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            749            749
117  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
119  2025-06-30  17914            223            222
116  2025-06-30  18675            749            749
2025-07-09 18:40:35,215 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 18:40:35,215 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 18:40:35,216 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
3  2025-06-01  17914            326            326
0  2025-06-01  18675            769            769
5  2025-06-02  17612            955            884
2025-07-09 18:40:35,217 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            749            749
117  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
119  2025-06-30  17914            223            222
116  2025-06-30  18675            749            749
2025-07-09 18:40:35,217 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 18:40:35,219 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 18:40:35,220 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01            955
5    2025-06-02            884
9    2025-06-03            790
13   2025-06-04           1149
17   2025-06-05            853
21   2025-06-06            736
25   2025-06-07            736
29   2025-06-08            736
33   2025-06-09            689
37   2025-06-10            602
41   2025-06-11            535
45   2025-06-12            301
49   2025-06-13            218
53   2025-06-14            218
57   2025-06-15            218
61   2025-06-16             54
65   2025-06-17             -2
69   2025-06-18            517
73   2025-06-19            470
77   2025-06-20            394
81   2025-06-21            394
85   2025-06-22            394
89   2025-06-23            749
93   2025-06-24            707
97   2025-06-25            534
101  2025-06-26            474
105  2025-06-27            423
109  2025-06-28            423
113  2025-06-29            423
117  2025-06-30            339
2025-07-09 18:40:35,221 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            178
6    2025-06-02            176
10   2025-06-03            163
14   2025-06-04            156
18   2025-06-05            155
22   2025-06-06            153
26   2025-06-07            153
30   2025-06-08            153
34   2025-06-09            151
38   2025-06-10            151
42   2025-06-11            150
46   2025-06-12            136
50   2025-06-13            135
54   2025-06-14            135
58   2025-06-15            135
62   2025-06-16            133
66   2025-06-17            132
70   2025-06-18            131
74   2025-06-19            129
78   2025-06-20            128
82   2025-06-21            128
86   2025-06-22            128
90   2025-06-23            122
94   2025-06-24            121
98   2025-06-25            120
102  2025-06-26            118
106  2025-06-27            115
110  2025-06-28            115
114  2025-06-29            115
118  2025-06-30            112
2025-07-09 18:40:35,229 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 18:40:35,232 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 18:40:35,234 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 18:40:35,236 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           20
5    2025-06-02           19
9    2025-06-03           17
13   2025-06-04           24
17   2025-06-05           18
21   2025-06-06           16
25   2025-06-07           16
29   2025-06-08           16
33   2025-06-09           15
37   2025-06-10           13
41   2025-06-11           12
45   2025-06-12            7
49   2025-06-13            5
53   2025-06-14            5
57   2025-06-15            5
61   2025-06-16            2
65   2025-06-17            0
69   2025-06-18           11
73   2025-06-19           10
77   2025-06-20            9
81   2025-06-21            9
85   2025-06-22            9
89   2025-06-23           16
93   2025-06-24           15
97   2025-06-25           12
101  2025-06-26           10
105  2025-06-27            9
109  2025-06-28            9
113  2025-06-29            9
117  2025-06-30            8
2025-07-09 18:40:35,238 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 18:40:35,238 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 18:40:35,239 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 18:40:35,239 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 18:40:35,241 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 18:40:35,242 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 18:40:35,244 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 18:40:35,248 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 18:40:35,249 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 18:40:35,249 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 18:40:35,251 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 18:40:35,254 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 18:40:35,255 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 18:40:35,256 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 18:40:35,257 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 18:40:35,259 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 18:40:35,260 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 18:40:35,262 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 18:40:35,263 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 18:40:35,264 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 18:40:35,264 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 18:40:35,265 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 18:40:35,266 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 18:40:35,267 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 18:40:35,268 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 18:40:35,269 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 18:40:35,270 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 18:40:35,271 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 18:40:35,272 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 18:40:35,275 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 18:40:35,276 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 18:40:35,280 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:40:35,280 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 18:40:35,283 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 18:40:35,285 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame BEFORE return (head):
2025-07-09 18:40:35,288 - src.services.reporting_logic.monthly_report_generator - DEBUG -                   Date  Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
0  2025-06-01 00:00:00         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0            0.0
1  2025-06-02 00:00:00        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0            0.0
2  2025-06-03 00:00:00        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0            0.0
3  2025-06-04 00:00:00        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0            0.0
4  2025-06-05 00:00:00        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0            0.0
2025-07-09 18:40:35,289 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame BEFORE return (tail):
2025-07-09 18:40:35,292 - src.services.reporting_logic.monthly_report_generator - DEBUG -                    Date  Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
26  2025-06-27 00:00:00        17.0          60.0          72.25             45.0                13.50        130.75           51.0            3.0            6.0            0.0            0.0
27  2025-06-28 00:00:00         0.0           0.0           0.00              0.0                13.50         13.50            0.0            0.0            0.0            0.0            0.0
28  2025-06-29 00:00:00         0.0           0.0           0.00              0.0                13.50         13.50            0.0            0.0            0.0            0.0            0.0
29  2025-06-30 00:00:00        10.0          88.0          42.50             66.0                13.05        121.55           84.0            3.0            1.0            0.0            0.0
30                TOTAL       552.0        2236.0        2346.00           1677.0               459.90       4482.90         2046.0           66.0          104.0           20.0            0.0
2025-07-09 18:40:35,293 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame BEFORE return (info):
2025-07-09 18:40:35,296 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:40:35,297 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 18:40:35,297 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 18:40:35,297 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:40:35,297 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:40:35,301 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:40:35,540 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:40:35,542 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:40:35,543 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:40:35,543 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 18:40:35,566 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:40:35,730 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:40:35,734 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:40:36,005 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:36,131 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:36,363 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:40:36,518 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:40:36,521 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 18:40:36,774 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:40:36,776 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 18:40:36,777 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 18:40:36,779 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 18:40:36,780 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 18:40:36,781 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 18:40:36,783 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 18:40:36,788 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 18:40:36,789 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 18:40:36,796 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 18:40:36,800 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 18:40:36,800 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 18:40:36,809 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 18:40:36,810 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 18:40:36,815 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 18:40:36,816 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 18:40:36,818 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 18:40:36,819 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:40:36,822 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:40:36,822 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 18:40:36,828 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:40:36,831 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:40:36,838 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:40:37,123 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:40:37,136 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:40:37,143 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:40:37,147 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 18:40:37,232 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:40:37,421 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:40:37,425 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:40:37,695 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:37,810 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:40:37,965 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:40:38,206 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:40:38,209 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 18:40:38,374 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:40:38,375 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 18:40:38,375 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 18:40:38,377 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 18:40:38,378 - __main__ - INFO - Script finished successfully.
2025-07-09 18:42:36,342 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:42:36,343 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 18:42:36,964 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:42:36,964 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:42:36,965 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:42:36,965 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:42:36,986 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:42:37,260 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:42:37,263 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:42:37,264 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:42:37,265 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:42:37,298 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:42:37,471 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:42:37,473 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:42:37,769 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:37,904 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:37,906 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:42:38,081 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:42:38,084 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:42:38,095 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:42:38,095 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:42:38,096 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:42:38,097 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:42:38,102 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:42:38,340 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:42:38,344 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:42:38,346 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:42:38,348 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:42:38,383 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:42:38,526 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:42:38,529 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:42:38,789 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:38,908 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:38,913 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:42:39,055 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:42:39,056 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:42:39,058 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:42:39,060 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:42:39,064 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:42:39,065 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:42:39,066 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:42:39,066 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:42:39,067 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:42:39,071 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:42:39,305 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:42:39,307 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:42:39,308 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:42:39,309 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:42:39,335 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:42:39,482 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:42:39,483 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:42:39,758 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:39,867 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:39,868 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:42:40,065 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:42:40,071 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:42:40,077 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:42:40,078 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:42:40,082 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 18:42:40,084 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 18:42:40,085 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 18:42:40,086 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:42:40,087 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:42:40,088 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 18:42:40,089 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:42:40,090 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 18:42:40,092 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:42:40,093 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:42:40,093 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:42:40,094 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:42:40,097 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:42:40,335 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:42:40,337 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:42:40,337 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:42:40,338 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:42:40,363 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:42:40,548 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:42:40,549 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:42:40,740 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:40,857 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:40,859 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:42:41,193 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:42:41,196 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:42:41,200 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 18:42:41,200 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 18:42:41,201 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:42:41,201 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:42:41,204 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:42:41,471 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:42:41,473 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:42:41,473 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:42:41,474 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:42:41,499 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:42:41,692 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:42:41,694 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:42:41,977 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:42,111 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:42,112 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 18:42:42,319 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 18:42:42,321 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 18:42:42,331 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 18:42:42,332 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 18:42:42,333 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:42:42,334 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:42:42,336 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:42:42,659 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:42:42,661 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:42:42,661 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:42:42,662 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:42:42,684 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:42:42,865 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:42:42,867 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:42:43,132 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:43,266 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:43,267 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 18:42:43,411 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 18:42:43,414 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 18:42:43,415 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 18:42:43,416 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 18:42:43,417 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 18:42:43,421 - src.services.reporting_logic.monthly_report_generator - ERROR - Error generating monthly charge report: name 'shpped_orders_df' is not defined
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\monthly_report_generator.py", line 33, in generate_monthly_charge_report
    shipped_orders_df['Date'] = pd.to_datetime(shpped_orders_df['Date']).dt.date
                                              ^^^^^^^^^^^^^^^^
NameError: name 'shpped_orders_df' is not defined
2025-07-09 18:42:43,423 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-09 18:42:43,424 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 18:42:43,425 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 18:42:43,425 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 18:42:43,427 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 18:42:43,428 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 18:42:43,432 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 18:42:43,434 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 18:42:43,434 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 18:42:43,438 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 18:42:43,439 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 18:42:43,441 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 18:42:43,442 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 18:42:43,446 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 18:42:43,447 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:42:43,448 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:42:43,448 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 18:42:43,451 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:42:43,452 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:42:43,455 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:42:43,756 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:42:43,758 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:42:43,759 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:42:43,759 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 18:42:43,826 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:42:44,021 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:42:44,026 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:42:44,304 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:44,497 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:42:44,979 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:42:45,172 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:42:45,174 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 18:42:45,321 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:42:45,323 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 18:42:45,323 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 18:42:45,324 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 18:42:45,326 - __main__ - INFO - Script finished successfully.
2025-07-09 18:43:22,505 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:43:22,505 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 18:43:23,122 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:43:23,123 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:43:23,123 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:43:23,124 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:43:23,138 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:43:23,387 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:43:23,389 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:43:23,390 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:43:23,390 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:43:23,417 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:43:23,570 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:43:23,574 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:43:23,884 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:24,008 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:24,011 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:43:24,171 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:43:24,174 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:43:24,181 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:43:24,181 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:43:24,181 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:43:24,182 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:43:24,184 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:43:24,404 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:43:24,406 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:43:24,407 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:43:24,407 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:43:24,433 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:43:24,578 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:43:24,581 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:43:24,793 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:25,102 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:25,104 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:43:25,258 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:43:25,260 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:43:25,262 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:43:25,264 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:43:25,273 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:43:25,274 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:43:25,274 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:43:25,274 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:43:25,276 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:43:25,279 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:43:25,593 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:43:25,595 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:43:25,595 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:43:25,596 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:43:25,617 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:43:25,760 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:43:25,764 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:43:26,040 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:26,248 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:26,251 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:43:26,428 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:43:26,433 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:43:26,438 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:43:26,440 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:43:26,443 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 18:43:26,446 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 18:43:26,446 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 18:43:26,447 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:43:26,448 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:43:26,449 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 18:43:26,450 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:43:26,451 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 18:43:26,451 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:43:26,451 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:43:26,452 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:43:26,453 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:43:26,456 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:43:26,667 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:43:26,669 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:43:26,669 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:43:26,670 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:43:26,693 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:43:26,839 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:43:26,840 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:43:27,167 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:27,372 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:27,375 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:43:27,577 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:43:27,582 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:43:27,586 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 18:43:27,586 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 18:43:27,587 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:43:27,587 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:43:27,589 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:43:27,884 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:43:27,886 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:43:27,886 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:43:27,887 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:43:27,909 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:43:28,076 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:43:28,079 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:43:28,342 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:28,490 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:28,491 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 18:43:28,806 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 18:43:28,808 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 18:43:28,814 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 18:43:28,815 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 18:43:28,815 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:43:28,815 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:43:28,818 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:43:29,113 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:43:29,115 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:43:29,115 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:43:29,116 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:43:29,137 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:43:29,280 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:43:29,283 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:43:29,555 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:29,711 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:29,713 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 18:43:29,890 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 18:43:29,893 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 18:43:29,895 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 18:43:29,897 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 18:43:29,897 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 18:43:29,902 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 18:43:29,904 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 18:43:29,905 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 18:43:29,906 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 18:43:29,907 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 18:43:29,908 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 18:43:29,910 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 18:43:29,911 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 18:43:29,912 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 18:43:29,912 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 18:43:29,913 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 18:43:29,914 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 18:43:29,914 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 326, '17904': 178, '17612': 955, '18675': 769}
2025-07-09 18:43:29,915 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 18:43:29,915 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 326, '17904': 178, '17612': 955, '18675': 769}
2025-07-09 18:43:29,918 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 18:43:29,919 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 18:43:29,920 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 18:43:29,922 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 18:43:29,922 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(326), '17904': np.int64(178), '17612': np.int64(955), '18675': np.int64(769)}
2025-07-09 18:43:29,922 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 18:43:29,923 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(326), '17904': np.int64(178), '17612': np.int64(955), '18675': np.int64(769)}
2025-07-09 18:43:29,924 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 18:43:29,926 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 18:43:29,928 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 18:43:29,930 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 18:43:29,932 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 18:43:29,932 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(323), '17904': np.int64(176), '17612': np.int64(884), '18675': np.int64(768)}
2025-07-09 18:43:29,933 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 18:43:29,933 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(323), '17904': np.int64(176), '17612': np.int64(884), '18675': np.int64(768)}
2025-07-09 18:43:29,934 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 18:43:29,936 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 18:43:29,937 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 18:43:29,938 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 18:43:29,940 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:43:29,941 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(317), '17904': np.int64(163), '17612': np.int64(790), '18675': np.int64(768)}
2025-07-09 18:43:29,941 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 18:43:29,941 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(317), '17904': np.int64(163), '17612': np.int64(790), '18675': np.int64(768)}
2025-07-09 18:43:29,943 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 18:43:29,944 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 18:43:29,947 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 18:43:29,949 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 18:43:29,951 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:43:29,951 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(310), '17904': np.int64(156), '17612': np.int64(1149), '18675': np.int64(768)}
2025-07-09 18:43:29,952 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 18:43:29,952 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(310), '17904': np.int64(156), '17612': np.int64(1149), '18675': np.int64(768)}
2025-07-09 18:43:29,953 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 18:43:29,955 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 18:43:29,957 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 18:43:29,959 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 18:43:29,961 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:43:29,961 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(303), '17904': np.int64(155), '17612': np.int64(853), '18675': np.int64(768)}
2025-07-09 18:43:29,961 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 18:43:29,962 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(303), '17904': np.int64(155), '17612': np.int64(853), '18675': np.int64(768)}
2025-07-09 18:43:29,963 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 18:43:29,965 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 18:43:29,966 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 18:43:29,969 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 18:43:29,969 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 18:43:29,969 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(302), '17904': np.int64(153), '17612': np.int64(736), '18675': np.int64(767)}
2025-07-09 18:43:29,970 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 18:43:29,970 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(302), '17904': np.int64(153), '17612': np.int64(736), '18675': np.int64(767)}
2025-07-09 18:43:29,973 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:43:29,973 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:43:29,976 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:43:29,978 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:43:29,978 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(302), '17904': np.int64(153), '17612': np.int64(736), '18675': np.int64(767)}
2025-07-09 18:43:29,978 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 18:43:29,978 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(302), '17904': np.int64(153), '17612': np.int64(736), '18675': np.int64(767)}
2025-07-09 18:43:29,981 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:43:29,981 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:43:29,982 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:43:29,985 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:43:29,985 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(302), '17904': np.int64(153), '17612': np.int64(736), '18675': np.int64(767)}
2025-07-09 18:43:29,985 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 18:43:29,985 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(302), '17904': np.int64(153), '17612': np.int64(736), '18675': np.int64(767)}
2025-07-09 18:43:29,985 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 18:43:29,988 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 18:43:29,989 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 18:43:29,990 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 18:43:29,993 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 18:43:29,993 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(299), '17904': np.int64(151), '17612': np.int64(689), '18675': np.int64(766)}
2025-07-09 18:43:29,993 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 18:43:29,993 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(299), '17904': np.int64(151), '17612': np.int64(689), '18675': np.int64(766)}
2025-07-09 18:43:29,995 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 18:43:29,997 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 18:43:29,998 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 18:43:29,999 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 18:43:30,002 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 18:43:30,002 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(296), '17904': np.int64(151), '17612': np.int64(602), '18675': np.int64(766)}
2025-07-09 18:43:30,002 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 18:43:30,002 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(296), '17904': np.int64(151), '17612': np.int64(602), '18675': np.int64(766)}
2025-07-09 18:43:30,003 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 18:43:30,004 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 18:43:30,006 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 18:43:30,008 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 18:43:30,010 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 18:43:30,012 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(293), '17904': np.int64(150), '17612': np.int64(535), '18675': np.int64(765)}
2025-07-09 18:43:30,012 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 18:43:30,012 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(293), '17904': np.int64(150), '17612': np.int64(535), '18675': np.int64(765)}
2025-07-09 18:43:30,013 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 18:43:30,015 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 18:43:30,017 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 18:43:30,018 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 18:43:30,020 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:43:30,020 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(282), '17904': np.int64(136), '17612': np.int64(301), '18675': np.int64(765)}
2025-07-09 18:43:30,020 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 18:43:30,020 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(282), '17904': np.int64(136), '17612': np.int64(301), '18675': np.int64(765)}
2025-07-09 18:43:30,021 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 18:43:30,023 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 18:43:30,024 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 18:43:30,026 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 18:43:30,028 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:43:30,029 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(270), '17904': np.int64(135), '17612': np.int64(218), '18675': np.int64(765)}
2025-07-09 18:43:30,029 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 18:43:30,030 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(270), '17904': np.int64(135), '17612': np.int64(218), '18675': np.int64(765)}
2025-07-09 18:43:30,032 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:43:30,033 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:43:30,035 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:43:30,036 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:43:30,037 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(270), '17904': np.int64(135), '17612': np.int64(218), '18675': np.int64(765)}
2025-07-09 18:43:30,037 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 18:43:30,037 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(270), '17904': np.int64(135), '17612': np.int64(218), '18675': np.int64(765)}
2025-07-09 18:43:30,039 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:43:30,041 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:43:30,042 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:43:30,045 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:43:30,045 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(270), '17904': np.int64(135), '17612': np.int64(218), '18675': np.int64(765)}
2025-07-09 18:43:30,046 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 18:43:30,046 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(270), '17904': np.int64(135), '17612': np.int64(218), '18675': np.int64(765)}
2025-07-09 18:43:30,047 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 18:43:30,049 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 18:43:30,052 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 18:43:30,052 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 18:43:30,054 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 18:43:30,054 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(267), '17904': np.int64(133), '17612': np.int64(54), '18675': np.int64(762)}
2025-07-09 18:43:30,055 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 18:43:30,055 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(267), '17904': np.int64(133), '17612': np.int64(54), '18675': np.int64(762)}
2025-07-09 18:43:30,057 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 18:43:30,060 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 18:43:30,062 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 18:43:30,064 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 18:43:30,066 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 18:43:30,067 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(256), '17904': np.int64(132), '17612': np.int64(-2), '18675': np.int64(750)}
2025-07-09 18:43:30,067 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 18:43:30,067 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(256), '17904': np.int64(132), '17612': np.int64(-2), '18675': np.int64(750)}
2025-07-09 18:43:30,069 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 18:43:30,071 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 18:43:30,072 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 18:43:30,074 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 18:43:30,076 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:43:30,076 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(255), '17904': np.int64(131), '17612': np.int64(517), '18675': np.int64(750)}
2025-07-09 18:43:30,077 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 18:43:30,077 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(255), '17904': np.int64(131), '17612': np.int64(517), '18675': np.int64(750)}
2025-07-09 18:43:30,079 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 18:43:30,080 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 18:43:30,082 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 18:43:30,083 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 18:43:30,084 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:43:30,085 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(248), '17904': np.int64(129), '17612': np.int64(470), '18675': np.int64(750)}
2025-07-09 18:43:30,085 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 18:43:30,085 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(248), '17904': np.int64(129), '17612': np.int64(470), '18675': np.int64(750)}
2025-07-09 18:43:30,086 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 18:43:30,088 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 18:43:30,089 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 18:43:30,091 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 18:43:30,092 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 18:43:30,093 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(243), '17904': np.int64(128), '17612': np.int64(394), '18675': np.int64(749)}
2025-07-09 18:43:30,094 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 18:43:30,094 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(243), '17904': np.int64(128), '17612': np.int64(394), '18675': np.int64(749)}
2025-07-09 18:43:30,097 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:43:30,098 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:43:30,099 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:43:30,100 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:43:30,101 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(243), '17904': np.int64(128), '17612': np.int64(394), '18675': np.int64(749)}
2025-07-09 18:43:30,101 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 18:43:30,101 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(243), '17904': np.int64(128), '17612': np.int64(394), '18675': np.int64(749)}
2025-07-09 18:43:30,103 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:43:30,104 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:43:30,106 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:43:30,108 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:43:30,109 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(243), '17904': np.int64(128), '17612': np.int64(394), '18675': np.int64(749)}
2025-07-09 18:43:30,109 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 18:43:30,109 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(243), '17904': np.int64(128), '17612': np.int64(394), '18675': np.int64(749)}
2025-07-09 18:43:30,111 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 18:43:30,113 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:43:30,114 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 18:43:30,116 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 18:43:30,117 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:43:30,118 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(243), '17904': np.int64(122), '17612': np.int64(749), '18675': np.int64(749)}
2025-07-09 18:43:30,118 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 18:43:30,118 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(243), '17904': np.int64(122), '17612': np.int64(749), '18675': np.int64(749)}
2025-07-09 18:43:30,120 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 18:43:30,121 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 18:43:30,123 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 18:43:30,124 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 18:43:30,126 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:43:30,127 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(242), '17904': np.int64(121), '17612': np.int64(707), '18675': np.int64(749)}
2025-07-09 18:43:30,127 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 18:43:30,128 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(242), '17904': np.int64(121), '17612': np.int64(707), '18675': np.int64(749)}
2025-07-09 18:43:30,129 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 18:43:30,130 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 18:43:30,132 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 18:43:30,133 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 18:43:30,135 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:43:30,136 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(238), '17904': np.int64(120), '17612': np.int64(534), '18675': np.int64(749)}
2025-07-09 18:43:30,136 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 18:43:30,136 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(238), '17904': np.int64(120), '17612': np.int64(534), '18675': np.int64(749)}
2025-07-09 18:43:30,137 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 18:43:30,139 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 18:43:30,140 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 18:43:30,142 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 18:43:30,144 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:43:30,144 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(229), '17904': np.int64(118), '17612': np.int64(474), '18675': np.int64(749)}
2025-07-09 18:43:30,144 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 18:43:30,146 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(229), '17904': np.int64(118), '17612': np.int64(474), '18675': np.int64(749)}
2025-07-09 18:43:30,147 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 18:43:30,148 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 18:43:30,149 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 18:43:30,151 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 18:43:30,153 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:43:30,153 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(223), '17904': np.int64(115), '17612': np.int64(423), '18675': np.int64(749)}
2025-07-09 18:43:30,154 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 18:43:30,154 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(223), '17904': np.int64(115), '17612': np.int64(423), '18675': np.int64(749)}
2025-07-09 18:43:30,155 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:43:30,157 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:43:30,157 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:43:30,159 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:43:30,160 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(223), '17904': np.int64(115), '17612': np.int64(423), '18675': np.int64(749)}
2025-07-09 18:43:30,160 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 18:43:30,161 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(223), '17904': np.int64(115), '17612': np.int64(423), '18675': np.int64(749)}
2025-07-09 18:43:30,162 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:43:30,164 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:43:30,165 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:43:30,169 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:43:30,171 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(223), '17904': np.int64(115), '17612': np.int64(423), '18675': np.int64(749)}
2025-07-09 18:43:30,171 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 18:43:30,172 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(223), '17904': np.int64(115), '17612': np.int64(423), '18675': np.int64(749)}
2025-07-09 18:43:30,174 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 18:43:30,179 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 18:43:30,182 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 18:43:30,185 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 18:43:30,189 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:43:30,190 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(222), '17904': np.int64(112), '17612': np.int64(339), '18675': np.int64(749)}
2025-07-09 18:43:30,204 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
6  2025-06-02  17612            955            884
2025-07-09 18:43:30,205 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
118  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-09 18:43:30,207 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 18:43:30,207 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 18:43:30,208 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
6  2025-06-02  17612            955            884
2025-07-09 18:43:30,209 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
118  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-09 18:43:30,211 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 18:43:30,218 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 18:43:30,221 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
2    2025-06-01            955
6    2025-06-02            884
10   2025-06-03            790
14   2025-06-04           1149
18   2025-06-05            853
22   2025-06-06            736
26   2025-06-07            736
30   2025-06-08            736
34   2025-06-09            689
38   2025-06-10            602
42   2025-06-11            535
46   2025-06-12            301
50   2025-06-13            218
54   2025-06-14            218
58   2025-06-15            218
62   2025-06-16             54
66   2025-06-17             -2
70   2025-06-18            517
74   2025-06-19            470
78   2025-06-20            394
82   2025-06-21            394
86   2025-06-22            394
90   2025-06-23            749
94   2025-06-24            707
98   2025-06-25            534
102  2025-06-26            474
106  2025-06-27            423
110  2025-06-28            423
114  2025-06-29            423
118  2025-06-30            339
2025-07-09 18:43:30,224 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            178
5    2025-06-02            176
9    2025-06-03            163
13   2025-06-04            156
17   2025-06-05            155
21   2025-06-06            153
25   2025-06-07            153
29   2025-06-08            153
33   2025-06-09            151
37   2025-06-10            151
41   2025-06-11            150
45   2025-06-12            136
49   2025-06-13            135
53   2025-06-14            135
57   2025-06-15            135
61   2025-06-16            133
65   2025-06-17            132
69   2025-06-18            131
73   2025-06-19            129
77   2025-06-20            128
81   2025-06-21            128
85   2025-06-22            128
89   2025-06-23            122
93   2025-06-24            121
97   2025-06-25            120
101  2025-06-26            118
105  2025-06-27            115
109  2025-06-28            115
113  2025-06-29            115
117  2025-06-30            112
2025-07-09 18:43:30,226 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
2025-07-09 18:43:30,235 - src.services.reporting_logic.monthly_report_generator - INFO - Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 18:43:30,241 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 18:43:30,243 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 18:43:30,245 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
2    2025-06-01           20
6    2025-06-02           19
10   2025-06-03           17
14   2025-06-04           24
18   2025-06-05           18
22   2025-06-06           16
26   2025-06-07           16
30   2025-06-08           16
34   2025-06-09           15
38   2025-06-10           13
42   2025-06-11           12
46   2025-06-12            7
50   2025-06-13            5
54   2025-06-14            5
58   2025-06-15            5
62   2025-06-16            2
66   2025-06-17            0
70   2025-06-18           11
74   2025-06-19           10
78   2025-06-20            9
82   2025-06-21            9
86   2025-06-22            9
90   2025-06-23           16
94   2025-06-24           15
98   2025-06-25           12
102  2025-06-26           10
106  2025-06-27            9
110  2025-06-28            9
114  2025-06-29            9
118  2025-06-30            8
2025-07-09 18:43:30,246 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 18:43:30,247 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 18:43:30,248 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 18:43:30,248 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 18:43:30,249 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 18:43:30,250 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 18:43:30,251 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 18:43:30,254 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 18:43:30,254 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 18:43:30,254 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 18:43:30,256 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 18:43:30,260 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 18:43:30,261 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 18:43:30,262 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 18:43:30,263 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 18:43:30,264 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 18:43:30,264 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 18:43:30,266 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 18:43:30,267 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 18:43:30,268 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 18:43:30,268 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 18:43:30,269 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 18:43:30,269 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 18:43:30,270 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 18:43:30,271 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 18:43:30,271 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 18:43:30,272 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 18:43:30,273 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 18:43:30,274 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 18:43:30,277 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 18:43:30,277 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 18:43:30,281 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:43:30,281 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 18:43:30,284 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 18:43:30,286 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER reordering and renaming (head):
2025-07-09 18:43:30,290 - src.services.reporting_logic.monthly_report_generator - DEBUG -                   Date  # Of Orders  17612  17904  17914  18675  Orders  Packages  Space Rental   Total
0  2025-06-01 00:00:00          0.0    0.0    0.0    0.0    0.0    0.00      0.00         20.25   20.25
1  2025-06-02 00:00:00         19.0   71.0    2.0    3.0    1.0   80.75     57.75         19.35  157.85
2  2025-06-03 00:00:00         22.0   94.0   13.0    6.0    0.0   93.50     84.75         18.00  196.25
3  2025-06-04 00:00:00         35.0  119.0    7.0    7.0    0.0  148.75     99.75         21.15  269.65
4  2025-06-05 00:00:00         83.0  296.0    1.0    7.0    0.0  352.75    228.00         18.45  599.20
2025-07-09 18:43:30,291 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER reordering and renaming (columns and dtypes):
2025-07-09 18:43:30,294 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:43:30,295 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER reordering and renaming (tail):
2025-07-09 18:43:30,297 - src.services.reporting_logic.monthly_report_generator - DEBUG -                    Date  # Of Orders   17612  17904  17914  18675   Orders  Packages  Space Rental    Total
26  2025-06-27 00:00:00         17.0    51.0    3.0    6.0    0.0    72.25      45.0         13.50   130.75
27  2025-06-28 00:00:00          0.0     0.0    0.0    0.0    0.0     0.00       0.0         13.50    13.50
28  2025-06-29 00:00:00          0.0     0.0    0.0    0.0    0.0     0.00       0.0         13.50    13.50
29  2025-06-30 00:00:00         10.0    84.0    3.0    1.0    0.0    42.50      66.0         13.05   121.55
30                TOTAL        552.0  2046.0   66.0  104.0   20.0  2346.00    1677.0        459.90  4482.90
2025-07-09 18:43:30,298 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 18:43:30,298 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 18:43:30,299 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:43:30,299 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:43:30,301 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:43:30,515 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:43:30,518 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:43:30,519 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:43:30,520 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 18:43:30,544 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:43:30,703 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:43:30,704 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:43:30,971 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:31,144 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:31,365 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:43:31,574 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:43:31,576 - gspread_dataframe - DEBUG - 320 cell updates to send
2025-07-09 18:43:31,775 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AJ32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:43:31,776 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:J32", 'updatedRows': 32, 'updatedColumns': 10, 'updatedCells': 320}
2025-07-09 18:43:31,777 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 18:43:31,778 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 18:43:31,779 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 18:43:31,779 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 18:43:31,780 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 18:43:31,781 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 18:43:31,782 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 18:43:31,785 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 18:43:31,786 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 18:43:31,787 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 18:43:31,789 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 18:43:31,790 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 18:43:31,792 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 18:43:31,794 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 18:43:31,796 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 18:43:31,796 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:43:31,797 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:43:31,797 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 18:43:31,803 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:43:31,804 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:43:31,806 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:43:32,034 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:43:32,037 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:43:32,037 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:43:32,038 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 18:43:32,062 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:43:32,219 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:43:32,222 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:43:32,493 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:32,629 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:43:32,799 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:43:32,973 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:43:32,974 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 18:43:33,141 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:43:33,143 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 18:43:33,144 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 18:43:33,144 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 18:43:33,144 - __main__ - INFO - Script finished successfully.
2025-07-09 18:47:21,177 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:47:21,178 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 18:47:21,554 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:47:21,554 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:47:21,555 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:47:21,555 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:47:21,567 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:47:21,870 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:47:21,871 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:47:21,872 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:47:21,872 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:47:21,895 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:47:22,068 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:47:22,070 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:47:23,816 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:24,320 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:24,321 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:47:24,946 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:47:24,948 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:47:24,953 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:47:24,953 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:47:24,953 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:47:24,954 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:47:24,958 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:47:25,234 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:47:25,236 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:47:25,236 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:47:25,237 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:47:25,259 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:47:25,406 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:47:25,408 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:47:26,703 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:27,400 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:27,402 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:47:27,931 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:47:27,934 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:47:27,936 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:47:27,937 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:47:27,944 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:47:27,945 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:47:27,945 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:47:27,946 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:47:27,946 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:47:27,949 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:47:28,212 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:47:28,214 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:47:28,214 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:47:28,215 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:47:28,237 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:47:28,389 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:47:28,393 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:47:28,918 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:29,922 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:29,925 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:47:30,576 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:47:30,596 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:47:30,608 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:47:30,612 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:47:30,619 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 18:47:30,621 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 18:47:30,623 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 18:47:30,627 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:47:30,629 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:47:30,634 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 18:47:30,638 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:47:30,640 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 18:47:30,643 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:47:30,643 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:47:30,645 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:47:30,646 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:47:30,651 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:47:30,917 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:47:30,919 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:47:30,920 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:47:30,920 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:47:30,971 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:47:31,121 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:47:31,125 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:47:31,906 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:32,760 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:32,762 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:47:33,827 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:47:33,837 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:47:33,847 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 18:47:33,848 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 18:47:33,850 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:47:33,851 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:47:33,862 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:47:34,150 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:47:34,154 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:47:34,155 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:47:34,157 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:47:34,222 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:47:34,366 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:47:34,370 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:47:35,013 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:35,903 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:35,906 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 18:47:36,825 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 18:47:36,831 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 18:47:36,852 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 18:47:36,854 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 18:47:36,855 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:47:36,857 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:47:36,868 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:47:37,157 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:47:37,160 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:47:37,161 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:47:37,161 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:47:37,209 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:47:37,362 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:47:37,367 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:47:38,110 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:38,727 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:38,730 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 18:47:39,311 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 18:47:39,314 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 18:47:39,317 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 18:47:39,319 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 18:47:39,320 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 18:47:39,338 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 18:47:39,345 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 18:47:39,347 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 18:47:39,349 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 18:47:39,352 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 18:47:39,353 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 18:47:39,362 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 18:47:39,363 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 18:47:39,364 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 18:47:39,365 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 18:47:39,366 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 18:47:39,371 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 18:47:39,374 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17904': 178, '17914': 326, '18675': 769, '17612': 955}
2025-07-09 18:47:39,376 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 18:47:39,376 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17904': 178, '17914': 326, '18675': 769, '17612': 955}
2025-07-09 18:47:39,384 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 18:47:39,389 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 18:47:39,396 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 18:47:39,402 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 18:47:39,403 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17904': np.int64(178), '17914': np.int64(326), '18675': np.int64(769), '17612': np.int64(955)}
2025-07-09 18:47:39,405 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 18:47:39,406 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17904': np.int64(178), '17914': np.int64(326), '18675': np.int64(769), '17612': np.int64(955)}
2025-07-09 18:47:39,410 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 18:47:39,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 18:47:39,420 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 18:47:39,425 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 18:47:39,431 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 18:47:39,432 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17904': np.int64(176), '17914': np.int64(323), '18675': np.int64(768), '17612': np.int64(884)}
2025-07-09 18:47:39,433 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 18:47:39,434 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17904': np.int64(176), '17914': np.int64(323), '18675': np.int64(768), '17612': np.int64(884)}
2025-07-09 18:47:39,436 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 18:47:39,440 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 18:47:39,445 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 18:47:39,449 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:47:39,453 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 18:47:39,454 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17904': np.int64(163), '17914': np.int64(317), '18675': np.int64(768), '17612': np.int64(790)}
2025-07-09 18:47:39,455 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 18:47:39,455 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17904': np.int64(163), '17914': np.int64(317), '18675': np.int64(768), '17612': np.int64(790)}
2025-07-09 18:47:39,459 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 18:47:39,463 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 18:47:39,468 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 18:47:39,472 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:47:39,478 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 18:47:39,479 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17904': np.int64(156), '17914': np.int64(310), '18675': np.int64(768), '17612': np.int64(1149)}
2025-07-09 18:47:39,480 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 18:47:39,481 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17904': np.int64(156), '17914': np.int64(310), '18675': np.int64(768), '17612': np.int64(1149)}
2025-07-09 18:47:39,484 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 18:47:39,490 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 18:47:39,493 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 18:47:39,499 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:47:39,504 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 18:47:39,505 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17904': np.int64(155), '17914': np.int64(303), '18675': np.int64(768), '17612': np.int64(853)}
2025-07-09 18:47:39,507 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 18:47:39,507 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17904': np.int64(155), '17914': np.int64(303), '18675': np.int64(768), '17612': np.int64(853)}
2025-07-09 18:47:39,509 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 18:47:39,514 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 18:47:39,519 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 18:47:39,525 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 18:47:39,533 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 18:47:39,533 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:47:39,535 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 18:47:39,536 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:47:39,544 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:47:39,552 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:47:39,558 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:47:39,563 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:47:39,566 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:47:39,567 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 18:47:39,569 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:47:39,579 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:47:39,585 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:47:39,592 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:47:39,598 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:47:39,600 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:47:39,601 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 18:47:39,603 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17904': np.int64(153), '17914': np.int64(302), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:47:39,607 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 18:47:39,616 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 18:47:39,625 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 18:47:39,634 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 18:47:39,642 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 18:47:39,645 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17904': np.int64(151), '17914': np.int64(299), '18675': np.int64(766), '17612': np.int64(689)}
2025-07-09 18:47:39,647 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 18:47:39,649 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17904': np.int64(151), '17914': np.int64(299), '18675': np.int64(766), '17612': np.int64(689)}
2025-07-09 18:47:39,654 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 18:47:39,661 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 18:47:39,669 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 18:47:39,676 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 18:47:39,683 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 18:47:39,685 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17904': np.int64(151), '17914': np.int64(296), '18675': np.int64(766), '17612': np.int64(602)}
2025-07-09 18:47:39,686 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 18:47:39,687 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17904': np.int64(151), '17914': np.int64(296), '18675': np.int64(766), '17612': np.int64(602)}
2025-07-09 18:47:39,691 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 18:47:39,713 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 18:47:39,734 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 18:47:39,751 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 18:47:39,771 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 18:47:39,774 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17904': np.int64(150), '17914': np.int64(293), '18675': np.int64(765), '17612': np.int64(535)}
2025-07-09 18:47:39,776 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 18:47:39,780 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17904': np.int64(150), '17914': np.int64(293), '18675': np.int64(765), '17612': np.int64(535)}
2025-07-09 18:47:39,786 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 18:47:39,795 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 18:47:39,802 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 18:47:39,808 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:47:39,818 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 18:47:39,819 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17904': np.int64(136), '17914': np.int64(282), '18675': np.int64(765), '17612': np.int64(301)}
2025-07-09 18:47:39,820 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 18:47:39,821 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17904': np.int64(136), '17914': np.int64(282), '18675': np.int64(765), '17612': np.int64(301)}
2025-07-09 18:47:39,824 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 18:47:39,830 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 18:47:39,840 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 18:47:39,851 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:47:39,856 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 18:47:39,857 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:47:39,857 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 18:47:39,858 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:47:39,864 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:47:39,869 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:47:39,872 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:47:39,876 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:47:39,877 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:47:39,878 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 18:47:39,879 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:47:39,884 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:47:39,888 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:47:39,892 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:47:39,895 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:47:39,896 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:47:39,898 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 18:47:39,898 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17904': np.int64(135), '17914': np.int64(270), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:47:39,901 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 18:47:39,904 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 18:47:39,909 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 18:47:39,913 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 18:47:39,919 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 18:47:39,920 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17904': np.int64(133), '17914': np.int64(267), '18675': np.int64(762), '17612': np.int64(54)}
2025-07-09 18:47:39,920 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 18:47:39,921 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17904': np.int64(133), '17914': np.int64(267), '18675': np.int64(762), '17612': np.int64(54)}
2025-07-09 18:47:39,925 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 18:47:39,931 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 18:47:39,936 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 18:47:39,941 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 18:47:39,947 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 18:47:39,948 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17904': np.int64(132), '17914': np.int64(256), '18675': np.int64(750), '17612': np.int64(-2)}
2025-07-09 18:47:39,949 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 18:47:39,950 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17904': np.int64(132), '17914': np.int64(256), '18675': np.int64(750), '17612': np.int64(-2)}
2025-07-09 18:47:39,953 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 18:47:39,959 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 18:47:39,966 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 18:47:39,972 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:47:39,977 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 18:47:39,979 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17904': np.int64(131), '17914': np.int64(255), '18675': np.int64(750), '17612': np.int64(517)}
2025-07-09 18:47:39,981 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 18:47:39,982 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17904': np.int64(131), '17914': np.int64(255), '18675': np.int64(750), '17612': np.int64(517)}
2025-07-09 18:47:39,985 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 18:47:39,993 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 18:47:40,003 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 18:47:40,011 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:47:40,018 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 18:47:40,019 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17904': np.int64(129), '17914': np.int64(248), '18675': np.int64(750), '17612': np.int64(470)}
2025-07-09 18:47:40,020 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 18:47:40,021 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17904': np.int64(129), '17914': np.int64(248), '18675': np.int64(750), '17612': np.int64(470)}
2025-07-09 18:47:40,025 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 18:47:40,030 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 18:47:40,035 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 18:47:40,039 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 18:47:40,047 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 18:47:40,048 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:47:40,049 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 18:47:40,049 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:47:40,055 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:47:40,060 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:47:40,067 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:47:40,073 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:47:40,075 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:47:40,076 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 18:47:40,077 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:47:40,087 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:47:40,093 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:47:40,099 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:47:40,105 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:47:40,107 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:47:40,108 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 18:47:40,108 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17904': np.int64(128), '17914': np.int64(243), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:47:40,111 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 18:47:40,119 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 18:47:40,126 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:47:40,133 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:47:40,140 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 18:47:40,142 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17904': np.int64(122), '17914': np.int64(243), '18675': np.int64(749), '17612': np.int64(749)}
2025-07-09 18:47:40,143 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 18:47:40,145 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17904': np.int64(122), '17914': np.int64(243), '18675': np.int64(749), '17612': np.int64(749)}
2025-07-09 18:47:40,150 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 18:47:40,159 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 18:47:40,167 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 18:47:40,175 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:47:40,183 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 18:47:40,185 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17904': np.int64(121), '17914': np.int64(242), '18675': np.int64(749), '17612': np.int64(707)}
2025-07-09 18:47:40,186 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 18:47:40,188 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17904': np.int64(121), '17914': np.int64(242), '18675': np.int64(749), '17612': np.int64(707)}
2025-07-09 18:47:40,191 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 18:47:40,201 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 18:47:40,209 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 18:47:40,217 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:47:40,225 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 18:47:40,226 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17904': np.int64(120), '17914': np.int64(238), '18675': np.int64(749), '17612': np.int64(534)}
2025-07-09 18:47:40,228 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 18:47:40,229 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17904': np.int64(120), '17914': np.int64(238), '18675': np.int64(749), '17612': np.int64(534)}
2025-07-09 18:47:40,235 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 18:47:40,245 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 18:47:40,252 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 18:47:40,260 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:47:40,269 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 18:47:40,271 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17904': np.int64(118), '17914': np.int64(229), '18675': np.int64(749), '17612': np.int64(474)}
2025-07-09 18:47:40,272 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 18:47:40,273 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17904': np.int64(118), '17914': np.int64(229), '18675': np.int64(749), '17612': np.int64(474)}
2025-07-09 18:47:40,277 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 18:47:40,287 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 18:47:40,293 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 18:47:40,303 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:47:40,310 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 18:47:40,312 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:47:40,315 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 18:47:40,316 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:47:40,323 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:47:40,330 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:47:40,339 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:47:40,345 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:47:40,347 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:47:40,349 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 18:47:40,350 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:47:40,360 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:47:40,371 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:47:40,382 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:47:40,392 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:47:40,395 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:47:40,397 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 18:47:40,399 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17904': np.int64(115), '17914': np.int64(223), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:47:40,405 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 18:47:40,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 18:47:40,422 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 18:47:40,431 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:47:40,438 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 18:47:40,439 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17904': np.int64(112), '17914': np.int64(222), '18675': np.int64(749), '17612': np.int64(339)}
2025-07-09 18:47:40,447 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
0  2025-06-01  17904            178            178
1  2025-06-01  17914            326            326
2  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 18:47:40,450 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
116  2025-06-30  17904            115            112
117  2025-06-30  17914            223            222
118  2025-06-30  18675            749            749
2025-07-09 18:47:40,451 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 18:47:40,452 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 18:47:40,456 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
0  2025-06-01  17904            178            178
1  2025-06-01  17914            326            326
2  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 18:47:40,459 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
116  2025-06-30  17904            115            112
117  2025-06-30  17914            223            222
118  2025-06-30  18675            749            749
2025-07-09 18:47:40,462 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 18:47:40,471 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 18:47:40,477 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01            955
7    2025-06-02            884
11   2025-06-03            790
15   2025-06-04           1149
19   2025-06-05            853
23   2025-06-06            736
27   2025-06-07            736
31   2025-06-08            736
35   2025-06-09            689
39   2025-06-10            602
43   2025-06-11            535
47   2025-06-12            301
51   2025-06-13            218
55   2025-06-14            218
59   2025-06-15            218
63   2025-06-16             54
67   2025-06-17             -2
71   2025-06-18            517
75   2025-06-19            470
79   2025-06-20            394
83   2025-06-21            394
87   2025-06-22            394
91   2025-06-23            749
95   2025-06-24            707
99   2025-06-25            534
103  2025-06-26            474
107  2025-06-27            423
111  2025-06-28            423
115  2025-06-29            423
119  2025-06-30            339
2025-07-09 18:47:40,485 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
0    2025-06-01            178
4    2025-06-02            176
8    2025-06-03            163
12   2025-06-04            156
16   2025-06-05            155
20   2025-06-06            153
24   2025-06-07            153
28   2025-06-08            153
32   2025-06-09            151
36   2025-06-10            151
40   2025-06-11            150
44   2025-06-12            136
48   2025-06-13            135
52   2025-06-14            135
56   2025-06-15            135
60   2025-06-16            133
64   2025-06-17            132
68   2025-06-18            131
72   2025-06-19            129
76   2025-06-20            128
80   2025-06-21            128
84   2025-06-22            128
88   2025-06-23            122
92   2025-06-24            121
96   2025-06-25            120
100  2025-06-26            118
104  2025-06-27            115
108  2025-06-28            115
112  2025-06-29            115
116  2025-06-30            112
2025-07-09 18:47:40,490 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
2025-07-09 18:47:40,522 - src.services.reporting_logic.monthly_report_generator - INFO - Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 18:47:40,546 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 18:47:40,553 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 18:47:40,559 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           20
7    2025-06-02           19
11   2025-06-03           17
15   2025-06-04           24
19   2025-06-05           18
23   2025-06-06           16
27   2025-06-07           16
31   2025-06-08           16
35   2025-06-09           15
39   2025-06-10           13
43   2025-06-11           12
47   2025-06-12            7
51   2025-06-13            5
55   2025-06-14            5
59   2025-06-15            5
63   2025-06-16            2
67   2025-06-17            0
71   2025-06-18           11
75   2025-06-19           10
79   2025-06-20            9
83   2025-06-21            9
87   2025-06-22            9
91   2025-06-23           16
95   2025-06-24           15
99   2025-06-25           12
103  2025-06-26           10
107  2025-06-27            9
111  2025-06-28            9
115  2025-06-29            9
119  2025-06-30            8
2025-07-09 18:47:40,563 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 18:47:40,637 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 18:47:40,639 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 18:47:40,641 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 18:47:40,647 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 18:47:40,649 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 18:47:40,652 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 18:47:40,666 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 18:47:40,667 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 18:47:40,668 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 18:47:40,674 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 18:47:40,684 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 18:47:40,686 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 18:47:40,690 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 18:47:40,692 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 18:47:40,696 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 18:47:40,698 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 18:47:40,703 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 18:47:40,706 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 18:47:40,711 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 18:47:40,714 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 18:47:40,717 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 18:47:40,721 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 18:47:40,725 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 18:47:40,728 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 18:47:40,732 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 18:47:40,736 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 18:47:40,739 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 18:47:40,741 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 18:47:40,755 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 18:47:40,757 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 18:47:40,769 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:47:40,770 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 18:47:40,783 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 18:47:40,804 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (head):
2025-07-09 18:47:40,810 - src.services.reporting_logic.monthly_report_generator - DEBUG -        Date  # Of Orders  17612 17904 17914 18675   Orders Packages Space Rental    Total
0  6/1/2025          0.0      -     -     -     -    $0.00    $0.00       $20.25   $20.25
1  6/2/2025         19.0   71.0   2.0   3.0   1.0   $80.75   $57.75       $19.35  $157.85
2  6/3/2025         22.0   94.0  13.0   6.0     -   $93.50   $84.75       $18.00  $196.25
3  6/4/2025         35.0  119.0   7.0   7.0     -  $148.75   $99.75       $21.15  $269.65
4  6/5/2025         83.0  296.0   1.0   7.0     -  $352.75  $228.00       $18.45  $599.20
2025-07-09 18:47:40,813 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (columns and dtypes):
2025-07-09 18:47:40,823 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:47:40,824 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (tail):
2025-07-09 18:47:40,831 - src.services.reporting_logic.monthly_report_generator - DEBUG -          Date  # Of Orders   17612 17904  17914 18675    Orders  Packages Space Rental     Total
26  6/27/2025         17.0    51.0   3.0    6.0     -    $72.25    $45.00       $13.50   $130.75
27  6/28/2025          0.0       -     -      -     -     $0.00     $0.00       $13.50    $13.50
28  6/29/2025          0.0       -     -      -     -     $0.00     $0.00       $13.50    $13.50
29  6/30/2025         10.0    84.0   3.0    1.0     -    $42.50    $66.00       $13.05   $121.55
30      TOTAL        552.0  2046.0  66.0  104.0  20.0  $2346.00  $1677.00      $459.90  $4482.90
2025-07-09 18:47:40,833 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 18:47:40,835 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 18:47:40,835 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:47:40,836 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:47:40,846 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:47:41,121 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:47:41,125 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:47:41,127 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:47:41,127 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 18:47:41,172 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:47:41,337 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:47:41,344 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:47:41,598 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:41,730 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:41,910 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:47:42,118 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:47:42,124 - gspread_dataframe - DEBUG - 320 cell updates to send
2025-07-09 18:47:42,930 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AJ32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:47:42,931 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:J32", 'updatedRows': 32, 'updatedColumns': 10, 'updatedCells': 320}
2025-07-09 18:47:42,932 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 18:47:42,933 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 18:47:42,935 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 18:47:42,936 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 18:47:42,936 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 18:47:42,939 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 18:47:42,940 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 18:47:42,948 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 18:47:42,951 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 18:47:42,952 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 18:47:42,960 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 18:47:42,962 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 18:47:42,966 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 18:47:42,971 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 18:47:42,977 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 18:47:42,978 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:47:42,979 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:47:42,980 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 18:47:42,987 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:47:42,988 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:47:42,993 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:47:43,238 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:47:43,241 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:47:43,243 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:47:43,243 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 18:47:43,306 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:47:43,458 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:47:43,463 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:47:43,676 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:43,836 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:47:44,005 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:47:44,177 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:47:44,178 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 18:47:44,351 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:47:44,352 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 18:47:44,353 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 18:47:44,355 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 18:47:44,355 - __main__ - INFO - Script finished successfully.
2025-07-09 18:49:42,469 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:49:42,470 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 18:49:42,869 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:49:42,870 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:49:42,870 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:49:42,871 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:49:42,884 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:49:43,182 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:49:43,186 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:49:43,186 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:49:43,187 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:49:43,216 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:49:43,380 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:49:43,384 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:49:43,796 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:44,148 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:44,149 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:49:44,308 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:49:44,310 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:49:44,316 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:49:44,317 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:49:44,317 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:49:44,318 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:49:44,324 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:49:44,580 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:49:44,582 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:49:44,583 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:49:44,583 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:49:44,607 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:49:44,777 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:49:44,779 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:49:44,975 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:45,094 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:45,097 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:49:45,334 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:49:45,337 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:49:45,340 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:49:45,341 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:49:45,344 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:49:45,346 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:49:45,346 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:49:45,346 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:49:45,347 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:49:45,351 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:49:45,588 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:49:45,591 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:49:45,591 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:49:45,593 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:49:45,614 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:49:45,778 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:49:45,782 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:49:46,049 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:46,169 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:46,171 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:49:46,356 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:49:46,364 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:49:46,369 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:49:46,370 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:49:46,373 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 18:49:46,375 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 18:49:46,375 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 18:49:46,376 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:49:46,377 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:49:46,379 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 18:49:46,380 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:49:46,381 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 18:49:46,382 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:49:46,382 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:49:46,382 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:49:46,383 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:49:46,385 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:49:46,674 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:49:46,677 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:49:46,678 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:49:46,679 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:49:46,700 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:49:46,853 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:49:46,855 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:49:47,053 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:47,173 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:47,177 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:49:47,380 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:49:47,386 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:49:47,393 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 18:49:47,393 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 18:49:47,394 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:49:47,395 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:49:47,398 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:49:47,644 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:49:47,645 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:49:47,646 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:49:47,646 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:49:47,668 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:49:47,820 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:49:47,822 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:49:48,030 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:48,140 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:48,141 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 18:49:48,283 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 18:49:48,285 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 18:49:48,293 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 18:49:48,294 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 18:49:48,295 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:49:48,295 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:49:48,299 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:49:48,535 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:49:48,537 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:49:48,538 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:49:48,538 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:49:48,560 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:49:48,703 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:49:48,705 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:49:48,896 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:49,121 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:49,123 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 18:49:49,328 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 18:49:49,331 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 18:49:49,333 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 18:49:49,335 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 18:49:49,335 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 18:49:49,341 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 18:49:49,342 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 18:49:49,343 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 18:49:49,344 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 18:49:49,345 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 18:49:49,347 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 18:49:49,348 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 18:49:49,348 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 18:49:49,349 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 18:49:49,349 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 18:49:49,350 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 18:49:49,352 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 18:49:49,353 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 326, '17904': 178, '18675': 769, '17612': 955}
2025-07-09 18:49:49,354 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 18:49:49,355 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 326, '17904': 178, '18675': 769, '17612': 955}
2025-07-09 18:49:49,358 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 18:49:49,360 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 18:49:49,362 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 18:49:49,363 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 18:49:49,363 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(326), '17904': np.int64(178), '18675': np.int64(769), '17612': np.int64(955)}
2025-07-09 18:49:49,364 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 18:49:49,365 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(326), '17904': np.int64(178), '18675': np.int64(769), '17612': np.int64(955)}
2025-07-09 18:49:49,366 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 18:49:49,369 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 18:49:49,370 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 18:49:49,373 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 18:49:49,374 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 18:49:49,375 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(323), '17904': np.int64(176), '18675': np.int64(768), '17612': np.int64(884)}
2025-07-09 18:49:49,375 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 18:49:49,376 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(323), '17904': np.int64(176), '18675': np.int64(768), '17612': np.int64(884)}
2025-07-09 18:49:49,377 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 18:49:49,379 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 18:49:49,381 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 18:49:49,382 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:49:49,384 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 18:49:49,384 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(317), '17904': np.int64(163), '18675': np.int64(768), '17612': np.int64(790)}
2025-07-09 18:49:49,385 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 18:49:49,385 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(317), '17904': np.int64(163), '18675': np.int64(768), '17612': np.int64(790)}
2025-07-09 18:49:49,386 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 18:49:49,389 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 18:49:49,391 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 18:49:49,393 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:49:49,395 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 18:49:49,396 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(310), '17904': np.int64(156), '18675': np.int64(768), '17612': np.int64(1149)}
2025-07-09 18:49:49,396 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 18:49:49,397 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(310), '17904': np.int64(156), '18675': np.int64(768), '17612': np.int64(1149)}
2025-07-09 18:49:49,399 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 18:49:49,401 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 18:49:49,403 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 18:49:49,404 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:49:49,407 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 18:49:49,407 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(303), '17904': np.int64(155), '18675': np.int64(768), '17612': np.int64(853)}
2025-07-09 18:49:49,408 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 18:49:49,408 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(303), '17904': np.int64(155), '18675': np.int64(768), '17612': np.int64(853)}
2025-07-09 18:49:49,409 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 18:49:49,411 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 18:49:49,413 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 18:49:49,415 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 18:49:49,417 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 18:49:49,418 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:49:49,419 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 18:49:49,419 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:49:49,421 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:49:49,423 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:49:49,424 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:49:49,425 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:49:49,426 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:49:49,427 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 18:49:49,428 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:49:49,430 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:49:49,432 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:49:49,433 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:49:49,434 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:49:49,435 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:49:49,435 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 18:49:49,435 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:49:49,436 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 18:49:49,437 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 18:49:49,439 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 18:49:49,441 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 18:49:49,443 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 18:49:49,443 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(299), '17904': np.int64(151), '18675': np.int64(766), '17612': np.int64(689)}
2025-07-09 18:49:49,444 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 18:49:49,444 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(299), '17904': np.int64(151), '18675': np.int64(766), '17612': np.int64(689)}
2025-07-09 18:49:49,445 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 18:49:49,447 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 18:49:49,449 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 18:49:49,450 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 18:49:49,451 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 18:49:49,452 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(296), '17904': np.int64(151), '18675': np.int64(766), '17612': np.int64(602)}
2025-07-09 18:49:49,452 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 18:49:49,452 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(296), '17904': np.int64(151), '18675': np.int64(766), '17612': np.int64(602)}
2025-07-09 18:49:49,453 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 18:49:49,454 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 18:49:49,456 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 18:49:49,457 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 18:49:49,459 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 18:49:49,459 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(293), '17904': np.int64(150), '18675': np.int64(765), '17612': np.int64(535)}
2025-07-09 18:49:49,460 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 18:49:49,460 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(293), '17904': np.int64(150), '18675': np.int64(765), '17612': np.int64(535)}
2025-07-09 18:49:49,462 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 18:49:49,464 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 18:49:49,465 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 18:49:49,466 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:49:49,467 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 18:49:49,469 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(282), '17904': np.int64(136), '18675': np.int64(765), '17612': np.int64(301)}
2025-07-09 18:49:49,469 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 18:49:49,469 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(282), '17904': np.int64(136), '18675': np.int64(765), '17612': np.int64(301)}
2025-07-09 18:49:49,470 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 18:49:49,471 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 18:49:49,473 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 18:49:49,475 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:49:49,476 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 18:49:49,476 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:49:49,477 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 18:49:49,477 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:49:49,480 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:49:49,481 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:49:49,482 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:49:49,483 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:49:49,485 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:49:49,485 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 18:49:49,486 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:49:49,488 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:49:49,490 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:49:49,491 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:49:49,492 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:49:49,493 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:49:49,493 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 18:49:49,493 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:49:49,494 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 18:49:49,496 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 18:49:49,497 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 18:49:49,499 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 18:49:49,500 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 18:49:49,501 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(267), '17904': np.int64(133), '18675': np.int64(762), '17612': np.int64(54)}
2025-07-09 18:49:49,501 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 18:49:49,501 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(267), '17904': np.int64(133), '18675': np.int64(762), '17612': np.int64(54)}
2025-07-09 18:49:49,502 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 18:49:49,503 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 18:49:49,505 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 18:49:49,507 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 18:49:49,509 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 18:49:49,509 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(256), '17904': np.int64(132), '18675': np.int64(750), '17612': np.int64(-2)}
2025-07-09 18:49:49,509 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 18:49:49,510 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(256), '17904': np.int64(132), '18675': np.int64(750), '17612': np.int64(-2)}
2025-07-09 18:49:49,511 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 18:49:49,513 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 18:49:49,514 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 18:49:49,516 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:49:49,517 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 18:49:49,517 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(255), '17904': np.int64(131), '18675': np.int64(750), '17612': np.int64(517)}
2025-07-09 18:49:49,517 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 18:49:49,518 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(255), '17904': np.int64(131), '18675': np.int64(750), '17612': np.int64(517)}
2025-07-09 18:49:49,519 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 18:49:49,520 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 18:49:49,521 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 18:49:49,524 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:49:49,525 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 18:49:49,526 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(248), '17904': np.int64(129), '18675': np.int64(750), '17612': np.int64(470)}
2025-07-09 18:49:49,526 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 18:49:49,527 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(248), '17904': np.int64(129), '18675': np.int64(750), '17612': np.int64(470)}
2025-07-09 18:49:49,529 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 18:49:49,530 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 18:49:49,532 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 18:49:49,533 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 18:49:49,535 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 18:49:49,536 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:49:49,536 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 18:49:49,536 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:49:49,538 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:49:49,540 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:49:49,541 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:49:49,542 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:49:49,543 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:49:49,543 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 18:49:49,543 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:49:49,546 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:49:49,547 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:49:49,549 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:49:49,550 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:49:49,550 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:49:49,551 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 18:49:49,551 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:49:49,552 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 18:49:49,553 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:49:49,555 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 18:49:49,556 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:49:49,558 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 18:49:49,558 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(243), '17904': np.int64(122), '18675': np.int64(749), '17612': np.int64(749)}
2025-07-09 18:49:49,558 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 18:49:49,558 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(243), '17904': np.int64(122), '18675': np.int64(749), '17612': np.int64(749)}
2025-07-09 18:49:49,559 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 18:49:49,561 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 18:49:49,563 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 18:49:49,564 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:49:49,567 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 18:49:49,567 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(242), '17904': np.int64(121), '18675': np.int64(749), '17612': np.int64(707)}
2025-07-09 18:49:49,567 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 18:49:49,567 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(242), '17904': np.int64(121), '18675': np.int64(749), '17612': np.int64(707)}
2025-07-09 18:49:49,568 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 18:49:49,570 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 18:49:49,571 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 18:49:49,573 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:49:49,574 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 18:49:49,575 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(238), '17904': np.int64(120), '18675': np.int64(749), '17612': np.int64(534)}
2025-07-09 18:49:49,575 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 18:49:49,576 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(238), '17904': np.int64(120), '18675': np.int64(749), '17612': np.int64(534)}
2025-07-09 18:49:49,577 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 18:49:49,579 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 18:49:49,580 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 18:49:49,582 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:49:49,583 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 18:49:49,583 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(229), '17904': np.int64(118), '18675': np.int64(749), '17612': np.int64(474)}
2025-07-09 18:49:49,583 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 18:49:49,583 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(229), '17904': np.int64(118), '18675': np.int64(749), '17612': np.int64(474)}
2025-07-09 18:49:49,584 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 18:49:49,585 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 18:49:49,587 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 18:49:49,588 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:49:49,590 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 18:49:49,590 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:49:49,590 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 18:49:49,591 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:49:49,593 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:49:49,594 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:49:49,596 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:49:49,597 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:49:49,598 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:49:49,598 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 18:49:49,598 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:49:49,600 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:49:49,602 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:49:49,603 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:49:49,603 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:49:49,604 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:49:49,604 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 18:49:49,604 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:49:49,605 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 18:49:49,608 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 18:49:49,609 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 18:49:49,610 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:49:49,613 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 18:49:49,617 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(222), '17904': np.int64(112), '18675': np.int64(749), '17612': np.int64(339)}
2025-07-09 18:49:49,623 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
2  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 18:49:49,627 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
118  2025-06-30  18675            749            749
2025-07-09 18:49:49,630 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 18:49:49,630 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 18:49:49,632 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
2  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 18:49:49,634 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
118  2025-06-30  18675            749            749
2025-07-09 18:49:49,635 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 18:49:49,639 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 18:49:49,642 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01            955
7    2025-06-02            884
11   2025-06-03            790
15   2025-06-04           1149
19   2025-06-05            853
23   2025-06-06            736
27   2025-06-07            736
31   2025-06-08            736
35   2025-06-09            689
39   2025-06-10            602
43   2025-06-11            535
47   2025-06-12            301
51   2025-06-13            218
55   2025-06-14            218
59   2025-06-15            218
63   2025-06-16             54
67   2025-06-17             -2
71   2025-06-18            517
75   2025-06-19            470
79   2025-06-20            394
83   2025-06-21            394
87   2025-06-22            394
91   2025-06-23            749
95   2025-06-24            707
99   2025-06-25            534
103  2025-06-26            474
107  2025-06-27            423
111  2025-06-28            423
115  2025-06-29            423
119  2025-06-30            339
2025-07-09 18:49:49,647 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            178
5    2025-06-02            176
9    2025-06-03            163
13   2025-06-04            156
17   2025-06-05            155
21   2025-06-06            153
25   2025-06-07            153
29   2025-06-08            153
33   2025-06-09            151
37   2025-06-10            151
41   2025-06-11            150
45   2025-06-12            136
49   2025-06-13            135
53   2025-06-14            135
57   2025-06-15            135
61   2025-06-16            133
65   2025-06-17            132
69   2025-06-18            131
73   2025-06-19            129
77   2025-06-20            128
81   2025-06-21            128
85   2025-06-22            128
89   2025-06-23            122
93   2025-06-24            121
97   2025-06-25            120
101  2025-06-26            118
105  2025-06-27            115
109  2025-06-28            115
113  2025-06-29            115
117  2025-06-30            112
2025-07-09 18:49:49,651 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
2025-07-09 18:49:49,655 - src.services.reporting_logic.monthly_report_generator - INFO - Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 18:49:49,661 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 18:49:49,664 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 18:49:49,666 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           20
7    2025-06-02           19
11   2025-06-03           17
15   2025-06-04           24
19   2025-06-05           18
23   2025-06-06           16
27   2025-06-07           16
31   2025-06-08           16
35   2025-06-09           15
39   2025-06-10           13
43   2025-06-11           12
47   2025-06-12            7
51   2025-06-13            5
55   2025-06-14            5
59   2025-06-15            5
63   2025-06-16            2
67   2025-06-17            0
71   2025-06-18           11
75   2025-06-19           10
79   2025-06-20            9
83   2025-06-21            9
87   2025-06-22            9
91   2025-06-23           16
95   2025-06-24           15
99   2025-06-25           12
103  2025-06-26           10
107  2025-06-27            9
111  2025-06-28            9
115  2025-06-29            9
119  2025-06-30            8
2025-07-09 18:49:49,669 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 18:49:49,670 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 18:49:49,672 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 18:49:49,673 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 18:49:49,678 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 18:49:49,681 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 18:49:49,683 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 18:49:49,687 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 18:49:49,688 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 18:49:49,690 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 18:49:49,693 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 18:49:49,700 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 18:49:49,701 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 18:49:49,703 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 18:49:49,704 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 18:49:49,706 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 18:49:49,710 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 18:49:49,713 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 18:49:49,715 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 18:49:49,718 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 18:49:49,720 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 18:49:49,722 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 18:49:49,724 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 18:49:49,725 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 18:49:49,726 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 18:49:49,727 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 18:49:49,729 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 18:49:49,730 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 18:49:49,730 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 18:49:49,733 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 18:49:49,734 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 18:49:49,737 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:49:49,738 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 18:49:49,741 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 18:49:49,749 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (head):
2025-07-09 18:49:49,751 - src.services.reporting_logic.monthly_report_generator - DEBUG -        Date  # Of Orders  17612 17904 17914 18675 18795   Orders Packages Space Rental    Total
0  6/1/2025          0.0      -     -     -     -     -    $0.00    $0.00       $20.25   $20.25
1  6/2/2025         19.0   71.0   2.0   3.0   1.0     -   $80.75   $57.75       $19.35  $157.85
2  6/3/2025         22.0   94.0  13.0   6.0     -     -   $93.50   $84.75       $18.00  $196.25
3  6/4/2025         35.0  119.0   7.0   7.0     -     -  $148.75   $99.75       $21.15  $269.65
4  6/5/2025         83.0  296.0   1.0   7.0     -     -  $352.75  $228.00       $18.45  $599.20
2025-07-09 18:49:49,752 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (columns and dtypes):
2025-07-09 18:49:49,757 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 18:49:49,758 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (tail):
2025-07-09 18:49:49,762 - src.services.reporting_logic.monthly_report_generator - DEBUG -          Date  # Of Orders   17612 17904  17914 18675 18795    Orders  Packages Space Rental     Total
26  6/27/2025         17.0    51.0   3.0    6.0     -     -    $72.25    $45.00       $13.50   $130.75
27  6/28/2025          0.0       -     -      -     -     -     $0.00     $0.00       $13.50    $13.50
28  6/29/2025          0.0       -     -      -     -     -     $0.00     $0.00       $13.50    $13.50
29  6/30/2025         10.0    84.0   3.0    1.0     -     -    $42.50    $66.00       $13.05   $121.55
30      TOTAL        552.0  2046.0  66.0  104.0  20.0     -  $2346.00  $1677.00      $459.90  $4482.90
2025-07-09 18:49:49,763 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 18:49:49,763 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 18:49:49,763 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:49:49,763 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:49:49,766 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:49:50,044 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:49:50,046 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:49:50,049 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:49:50,050 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 18:49:50,111 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:49:50,259 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:49:50,261 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:49:50,452 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:50,576 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:50,734 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:49:50,921 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:49:50,924 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-09 18:49:51,236 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:49:51,237 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-09 18:49:51,238 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 18:49:51,240 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 18:49:51,241 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 18:49:51,242 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 18:49:51,242 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 18:49:51,247 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 18:49:51,248 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 18:49:51,252 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 18:49:51,254 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 18:49:51,255 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 18:49:51,259 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 18:49:51,260 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 18:49:51,263 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 18:49:51,264 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 18:49:51,266 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 18:49:51,267 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:49:51,267 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:49:51,267 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 18:49:51,271 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:49:51,271 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:49:51,279 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:49:51,525 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:49:51,528 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:49:51,529 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:49:51,529 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 18:49:51,575 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:49:51,718 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:49:51,721 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:49:52,927 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:53,047 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:49:53,279 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:49:53,433 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:49:53,435 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 18:49:53,593 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:49:53,595 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 18:49:53,595 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 18:49:53,597 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 18:49:53,598 - __main__ - INFO - Script finished successfully.
2025-07-09 18:51:53,278 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:51:53,278 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 18:51:53,720 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:51:53,720 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:51:53,721 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:51:53,721 - src.services.google_sheets.api_client - ERROR - Error authenticating with Google Sheets API: name 'os' is not defined
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\google_sheets\api_client.py", line 27, in _get_gspread_client
    if 'K_SERVICE' in os.environ:
                      ^^
NameError: name 'os' is not defined
2025-07-09 18:51:53,722 - src.services.google_sheets.api_client - ERROR - Failed to get gspread client for reading data.
2025-07-09 18:51:53,722 - src.services.reporting_logic.report_data_loader - ERROR - Error loading all configuration data: 'bool' object has no attribute 'columns'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 22, in load_all_configuration_data
    config_df.columns = config_df.columns.str.strip()
                        ^^^^^^^^^^^^^^^^^
AttributeError: 'bool' object has no attribute 'columns'
2025-07-09 18:55:30,776 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:55:30,777 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 18:55:31,150 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:55:31,150 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:55:31,150 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:55:31,151 - src.services.google_sheets.api_client - ERROR - Error authenticating with Google Sheets API: File C:\Users\NathanNeely\Projects\ORA_Automation\config\ora-automation-project-2345f75740f8.json was not found.
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\google_sheets\api_client.py", line 38, in _get_gspread_client
    client = secretmanager.SecretManagerServiceClient()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\cloud\secretmanager_v1\services\secret_manager_service\client.py", line 730, in __init__
    self._transport = transport_init(
                      ^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\cloud\secretmanager_v1\services\secret_manager_service\transports\grpc.py", line 242, in __init__
    super().__init__(
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\cloud\secretmanager_v1\services\secret_manager_service\transports\base.py", line 103, in __init__
    credentials, _ = google.auth.default(
                     ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\auth\_default.py", line 651, in default
    credentials, project_id = checker()
                              ^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\auth\_default.py", line 644, in <lambda>
    lambda: _get_explicit_environ_credentials(quota_project_id=quota_project_id),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\auth\_default.py", line 293, in _get_explicit_environ_credentials
    credentials, project_id = load_credentials_from_file(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\auth\_default.py", line 125, in load_credentials_from_file
    raise exceptions.DefaultCredentialsError(
google.auth.exceptions.DefaultCredentialsError: File C:\Users\NathanNeely\Projects\ORA_Automation\config\ora-automation-project-2345f75740f8.json was not found.
2025-07-09 18:55:31,182 - src.services.google_sheets.api_client - ERROR - Failed to get gspread client for reading data.
2025-07-09 18:55:31,183 - src.services.reporting_logic.report_data_loader - ERROR - Error loading all configuration data: 'bool' object has no attribute 'columns'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 22, in load_all_configuration_data
    config_df.columns = config_df.columns.str.strip()
                        ^^^^^^^^^^^^^^^^^
AttributeError: 'bool' object has no attribute 'columns'
2025-07-09 18:57:43,336 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:57:43,336 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 18:57:43,761 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:57:43,761 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:57:43,761 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:57:43,762 - src.services.google_sheets.api_client - ERROR - Error authenticating with Google Sheets API: File C:\Users\NathanNeely\Projects\ORA_Automation\config\ora-automation-project-2345f75740f8.json was not found.
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\google_sheets\api_client.py", line 38, in _get_gspread_client
    client = secretmanager.SecretManagerServiceClient()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\cloud\secretmanager_v1\services\secret_manager_service\client.py", line 730, in __init__
    self._transport = transport_init(
                      ^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\cloud\secretmanager_v1\services\secret_manager_service\transports\grpc.py", line 242, in __init__
    super().__init__(
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\cloud\secretmanager_v1\services\secret_manager_service\transports\base.py", line 103, in __init__
    credentials, _ = google.auth.default(
                     ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\auth\_default.py", line 651, in default
    credentials, project_id = checker()
                              ^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\auth\_default.py", line 644, in <lambda>
    lambda: _get_explicit_environ_credentials(quota_project_id=quota_project_id),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\auth\_default.py", line 293, in _get_explicit_environ_credentials
    credentials, project_id = load_credentials_from_file(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\google\auth\_default.py", line 125, in load_credentials_from_file
    raise exceptions.DefaultCredentialsError(
google.auth.exceptions.DefaultCredentialsError: File C:\Users\NathanNeely\Projects\ORA_Automation\config\ora-automation-project-2345f75740f8.json was not found.
2025-07-09 18:57:43,764 - src.services.google_sheets.api_client - ERROR - Failed to get gspread client for reading data.
2025-07-09 18:57:43,764 - src.services.reporting_logic.report_data_loader - ERROR - Error loading all configuration data: 'bool' object has no attribute 'columns'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 22, in load_all_configuration_data
    config_df.columns = config_df.columns.str.strip()
                        ^^^^^^^^^^^^^^^^^
AttributeError: 'bool' object has no attribute 'columns'
2025-07-09 19:07:04,866 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 19:07:04,866 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 19:07:05,251 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 19:07:05,251 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 19:07:05,251 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:07:05,251 - src.services.google_sheets.api_client - ERROR - GCP_PROJECT_ID environment variable not set for Secret Manager access, and local key not found.
2025-07-09 19:07:05,252 - src.services.google_sheets.api_client - ERROR - Failed to get gspread client for reading data.
2025-07-09 19:07:05,252 - src.services.reporting_logic.report_data_loader - ERROR - Error loading all configuration data: 'bool' object has no attribute 'columns'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 22, in load_all_configuration_data
    config_df.columns = config_df.columns.str.strip()
                        ^^^^^^^^^^^^^^^^^
AttributeError: 'bool' object has no attribute 'columns'
2025-07-09 19:07:21,110 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 19:07:21,110 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 19:07:21,460 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 19:07:21,460 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 19:07:21,461 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:07:21,461 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:07:21,472 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:07:21,782 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:07:21,785 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:07:21,786 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:07:21,786 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:07:21,810 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:07:21,990 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:07:21,992 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:07:23,951 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:24,082 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:24,084 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 19:07:24,238 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 19:07:24,243 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 19:07:24,249 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 19:07:24,249 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 19:07:24,251 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:07:24,251 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:07:24,256 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:07:24,498 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:07:24,500 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:07:24,501 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:07:24,501 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:07:24,526 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:07:24,695 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:07:24,700 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:07:24,921 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:25,080 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:25,083 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 19:07:25,244 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 19:07:25,246 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 19:07:25,247 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 19:07:25,247 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 19:07:25,250 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 19:07:25,251 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 19:07:25,252 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 19:07:25,252 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:07:25,252 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:07:25,255 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:07:25,511 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:07:25,513 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:07:25,514 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:07:25,515 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:07:25,538 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:07:25,709 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:07:25,712 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:07:25,926 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:26,068 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:26,070 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 19:07:26,227 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 19:07:26,232 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 19:07:26,236 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 19:07:26,237 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:07:26,241 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 19:07:26,242 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 19:07:26,243 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 19:07:26,244 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:07:26,245 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:07:26,246 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 19:07:26,247 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:07:26,247 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 19:07:26,248 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 19:07:26,248 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 19:07:26,249 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:07:26,249 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:07:26,251 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:07:26,489 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:07:26,491 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:07:26,492 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:07:26,492 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:07:26,514 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:07:26,686 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:07:26,691 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:07:26,894 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:27,125 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:27,127 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 19:07:27,280 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 19:07:27,283 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 19:07:27,287 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 19:07:27,288 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 19:07:27,289 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:07:27,290 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:07:27,292 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:07:27,536 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:07:27,539 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:07:27,540 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:07:27,541 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:07:27,562 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:07:27,750 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:07:27,754 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:07:28,044 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:28,230 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:28,234 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 19:07:28,377 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 19:07:28,380 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 19:07:28,386 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 19:07:28,386 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 19:07:28,387 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:07:28,387 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:07:28,389 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:07:28,621 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:07:28,623 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:07:28,624 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:07:28,624 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:07:28,646 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:07:28,809 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:07:28,814 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:07:29,032 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:29,159 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:29,161 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 19:07:29,320 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 19:07:29,324 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 19:07:29,327 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 19:07:29,328 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 19:07:29,328 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 19:07:29,334 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 19:07:29,335 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 19:07:29,336 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 19:07:29,337 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 19:07:29,338 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 19:07:29,339 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 19:07:29,341 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 19:07:29,342 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 19:07:29,343 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 19:07:29,343 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 19:07:29,344 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 19:07:29,345 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 19:07:29,346 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17612': 955, '18675': 769, '17914': 326, '17904': 178}
2025-07-09 19:07:29,347 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 19:07:29,347 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17612': 955, '18675': 769, '17914': 326, '17904': 178}
2025-07-09 19:07:29,349 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 19:07:29,350 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 19:07:29,351 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 19:07:29,353 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 19:07:29,353 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17612': np.int64(955), '18675': np.int64(769), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-09 19:07:29,354 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 19:07:29,354 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17612': np.int64(955), '18675': np.int64(769), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-09 19:07:29,355 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 19:07:29,358 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 19:07:29,360 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 19:07:29,362 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 19:07:29,363 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 19:07:29,364 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17612': np.int64(884), '18675': np.int64(768), '17914': np.int64(323), '17904': np.int64(176)}
2025-07-09 19:07:29,364 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 19:07:29,364 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17612': np.int64(884), '18675': np.int64(768), '17914': np.int64(323), '17904': np.int64(176)}
2025-07-09 19:07:29,365 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 19:07:29,366 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 19:07:29,368 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:07:29,369 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 19:07:29,372 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 19:07:29,372 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17612': np.int64(790), '18675': np.int64(768), '17914': np.int64(317), '17904': np.int64(163)}
2025-07-09 19:07:29,372 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 19:07:29,373 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17612': np.int64(790), '18675': np.int64(768), '17914': np.int64(317), '17904': np.int64(163)}
2025-07-09 19:07:29,374 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 19:07:29,377 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 19:07:29,378 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:07:29,379 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 19:07:29,381 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 19:07:29,381 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17612': np.int64(1149), '18675': np.int64(768), '17914': np.int64(310), '17904': np.int64(156)}
2025-07-09 19:07:29,382 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 19:07:29,382 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17612': np.int64(1149), '18675': np.int64(768), '17914': np.int64(310), '17904': np.int64(156)}
2025-07-09 19:07:29,383 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 19:07:29,385 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 19:07:29,387 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:07:29,389 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 19:07:29,392 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 19:07:29,393 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17612': np.int64(853), '18675': np.int64(768), '17914': np.int64(303), '17904': np.int64(155)}
2025-07-09 19:07:29,393 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 19:07:29,394 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17612': np.int64(853), '18675': np.int64(768), '17914': np.int64(303), '17904': np.int64(155)}
2025-07-09 19:07:29,394 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 19:07:29,396 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 19:07:29,397 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 19:07:29,399 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 19:07:29,399 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 19:07:29,400 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17612': np.int64(736), '18675': np.int64(767), '17914': np.int64(302), '17904': np.int64(153)}
2025-07-09 19:07:29,400 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 19:07:29,400 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17612': np.int64(736), '18675': np.int64(767), '17914': np.int64(302), '17904': np.int64(153)}
2025-07-09 19:07:29,403 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:07:29,407 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:07:29,411 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:07:29,413 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:07:29,414 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17612': np.int64(736), '18675': np.int64(767), '17914': np.int64(302), '17904': np.int64(153)}
2025-07-09 19:07:29,414 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 19:07:29,415 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17612': np.int64(736), '18675': np.int64(767), '17914': np.int64(302), '17904': np.int64(153)}
2025-07-09 19:07:29,420 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:07:29,423 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:07:29,426 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:07:29,429 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:07:29,430 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17612': np.int64(736), '18675': np.int64(767), '17914': np.int64(302), '17904': np.int64(153)}
2025-07-09 19:07:29,431 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 19:07:29,432 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17612': np.int64(736), '18675': np.int64(767), '17914': np.int64(302), '17904': np.int64(153)}
2025-07-09 19:07:29,436 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 19:07:29,443 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 19:07:29,448 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 19:07:29,450 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 19:07:29,454 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 19:07:29,455 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17612': np.int64(689), '18675': np.int64(766), '17914': np.int64(299), '17904': np.int64(151)}
2025-07-09 19:07:29,456 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 19:07:29,457 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17612': np.int64(689), '18675': np.int64(766), '17914': np.int64(299), '17904': np.int64(151)}
2025-07-09 19:07:29,460 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 19:07:29,467 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 19:07:29,471 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 19:07:29,474 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 19:07:29,476 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 19:07:29,476 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17612': np.int64(602), '18675': np.int64(766), '17914': np.int64(296), '17904': np.int64(151)}
2025-07-09 19:07:29,477 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 19:07:29,477 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17612': np.int64(602), '18675': np.int64(766), '17914': np.int64(296), '17904': np.int64(151)}
2025-07-09 19:07:29,478 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 19:07:29,480 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 19:07:29,482 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 19:07:29,484 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 19:07:29,485 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 19:07:29,485 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17612': np.int64(535), '18675': np.int64(765), '17914': np.int64(293), '17904': np.int64(150)}
2025-07-09 19:07:29,486 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 19:07:29,486 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17612': np.int64(535), '18675': np.int64(765), '17914': np.int64(293), '17904': np.int64(150)}
2025-07-09 19:07:29,488 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 19:07:29,492 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 19:07:29,493 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:07:29,495 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 19:07:29,496 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 19:07:29,497 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17612': np.int64(301), '18675': np.int64(765), '17914': np.int64(282), '17904': np.int64(136)}
2025-07-09 19:07:29,497 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 19:07:29,498 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17612': np.int64(301), '18675': np.int64(765), '17914': np.int64(282), '17904': np.int64(136)}
2025-07-09 19:07:29,498 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 19:07:29,501 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 19:07:29,502 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:07:29,504 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 19:07:29,507 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 19:07:29,508 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17612': np.int64(218), '18675': np.int64(765), '17914': np.int64(270), '17904': np.int64(135)}
2025-07-09 19:07:29,508 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 19:07:29,509 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17612': np.int64(218), '18675': np.int64(765), '17914': np.int64(270), '17904': np.int64(135)}
2025-07-09 19:07:29,510 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:07:29,513 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:07:29,514 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:07:29,515 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:07:29,516 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17612': np.int64(218), '18675': np.int64(765), '17914': np.int64(270), '17904': np.int64(135)}
2025-07-09 19:07:29,516 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 19:07:29,516 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17612': np.int64(218), '18675': np.int64(765), '17914': np.int64(270), '17904': np.int64(135)}
2025-07-09 19:07:29,519 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:07:29,521 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:07:29,523 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:07:29,525 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:07:29,525 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17612': np.int64(218), '18675': np.int64(765), '17914': np.int64(270), '17904': np.int64(135)}
2025-07-09 19:07:29,526 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 19:07:29,527 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17612': np.int64(218), '18675': np.int64(765), '17914': np.int64(270), '17904': np.int64(135)}
2025-07-09 19:07:29,528 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 19:07:29,530 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 19:07:29,531 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 19:07:29,532 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 19:07:29,534 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 19:07:29,535 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17612': np.int64(54), '18675': np.int64(762), '17914': np.int64(267), '17904': np.int64(133)}
2025-07-09 19:07:29,535 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 19:07:29,535 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17612': np.int64(54), '18675': np.int64(762), '17914': np.int64(267), '17904': np.int64(133)}
2025-07-09 19:07:29,537 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 19:07:29,539 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 19:07:29,542 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 19:07:29,543 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 19:07:29,545 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 19:07:29,545 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17612': np.int64(-2), '18675': np.int64(750), '17914': np.int64(256), '17904': np.int64(132)}
2025-07-09 19:07:29,546 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 19:07:29,546 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17612': np.int64(-2), '18675': np.int64(750), '17914': np.int64(256), '17904': np.int64(132)}
2025-07-09 19:07:29,547 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 19:07:29,549 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 19:07:29,550 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:07:29,552 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 19:07:29,554 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 19:07:29,555 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17612': np.int64(517), '18675': np.int64(750), '17914': np.int64(255), '17904': np.int64(131)}
2025-07-09 19:07:29,555 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 19:07:29,556 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17612': np.int64(517), '18675': np.int64(750), '17914': np.int64(255), '17904': np.int64(131)}
2025-07-09 19:07:29,558 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 19:07:29,559 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 19:07:29,561 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:07:29,562 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 19:07:29,564 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 19:07:29,564 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17612': np.int64(470), '18675': np.int64(750), '17914': np.int64(248), '17904': np.int64(129)}
2025-07-09 19:07:29,565 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 19:07:29,565 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17612': np.int64(470), '18675': np.int64(750), '17914': np.int64(248), '17904': np.int64(129)}
2025-07-09 19:07:29,566 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 19:07:29,567 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 19:07:29,568 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 19:07:29,571 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 19:07:29,574 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 19:07:29,575 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17612': np.int64(394), '18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(128)}
2025-07-09 19:07:29,576 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 19:07:29,576 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17612': np.int64(394), '18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(128)}
2025-07-09 19:07:29,578 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:07:29,580 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:07:29,582 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:07:29,583 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:07:29,584 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17612': np.int64(394), '18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(128)}
2025-07-09 19:07:29,584 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 19:07:29,584 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17612': np.int64(394), '18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(128)}
2025-07-09 19:07:29,586 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:07:29,587 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:07:29,590 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:07:29,592 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:07:29,592 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17612': np.int64(394), '18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(128)}
2025-07-09 19:07:29,592 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 19:07:29,593 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17612': np.int64(394), '18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(128)}
2025-07-09 19:07:29,594 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 19:07:29,596 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 19:07:29,597 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:07:29,598 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:07:29,600 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 19:07:29,600 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17612': np.int64(749), '18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(122)}
2025-07-09 19:07:29,601 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 19:07:29,601 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17612': np.int64(749), '18675': np.int64(749), '17914': np.int64(243), '17904': np.int64(122)}
2025-07-09 19:07:29,602 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 19:07:29,604 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 19:07:29,606 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:07:29,609 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 19:07:29,610 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 19:07:29,610 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17612': np.int64(707), '18675': np.int64(749), '17914': np.int64(242), '17904': np.int64(121)}
2025-07-09 19:07:29,611 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 19:07:29,611 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17612': np.int64(707), '18675': np.int64(749), '17914': np.int64(242), '17904': np.int64(121)}
2025-07-09 19:07:29,612 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 19:07:29,613 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 19:07:29,615 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:07:29,616 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 19:07:29,618 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 19:07:29,618 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17612': np.int64(534), '18675': np.int64(749), '17914': np.int64(238), '17904': np.int64(120)}
2025-07-09 19:07:29,619 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 19:07:29,620 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17612': np.int64(534), '18675': np.int64(749), '17914': np.int64(238), '17904': np.int64(120)}
2025-07-09 19:07:29,621 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 19:07:29,623 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 19:07:29,625 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:07:29,627 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 19:07:29,628 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 19:07:29,629 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17612': np.int64(474), '18675': np.int64(749), '17914': np.int64(229), '17904': np.int64(118)}
2025-07-09 19:07:29,629 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 19:07:29,629 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17612': np.int64(474), '18675': np.int64(749), '17914': np.int64(229), '17904': np.int64(118)}
2025-07-09 19:07:29,630 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 19:07:29,632 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 19:07:29,633 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:07:29,635 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 19:07:29,637 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 19:07:29,637 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17612': np.int64(423), '18675': np.int64(749), '17914': np.int64(223), '17904': np.int64(115)}
2025-07-09 19:07:29,638 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 19:07:29,638 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17612': np.int64(423), '18675': np.int64(749), '17914': np.int64(223), '17904': np.int64(115)}
2025-07-09 19:07:29,641 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:07:29,643 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:07:29,644 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:07:29,645 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:07:29,646 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17612': np.int64(423), '18675': np.int64(749), '17914': np.int64(223), '17904': np.int64(115)}
2025-07-09 19:07:29,646 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 19:07:29,646 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17612': np.int64(423), '18675': np.int64(749), '17914': np.int64(223), '17904': np.int64(115)}
2025-07-09 19:07:29,648 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:07:29,650 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:07:29,652 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:07:29,653 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:07:29,654 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17612': np.int64(423), '18675': np.int64(749), '17914': np.int64(223), '17904': np.int64(115)}
2025-07-09 19:07:29,654 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 19:07:29,654 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17612': np.int64(423), '18675': np.int64(749), '17914': np.int64(223), '17904': np.int64(115)}
2025-07-09 19:07:29,656 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 19:07:29,658 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 19:07:29,660 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:07:29,661 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 19:07:29,662 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 19:07:29,663 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17612': np.int64(339), '18675': np.int64(749), '17914': np.int64(222), '17904': np.int64(112)}
2025-07-09 19:07:29,666 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
3  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
1  2025-06-01  18675            769            769
4  2025-06-02  17612            955            884
2025-07-09 19:07:29,668 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
113  2025-06-29  18675            749            749
116  2025-06-30  17612            423            339
119  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
117  2025-06-30  18675            749            749
2025-07-09 19:07:29,668 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 19:07:29,669 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 19:07:29,670 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
3  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
1  2025-06-01  18675            769            769
4  2025-06-02  17612            955            884
2025-07-09 19:07:29,671 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
113  2025-06-29  18675            749            749
116  2025-06-30  17612            423            339
119  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
117  2025-06-30  18675            749            749
2025-07-09 19:07:29,673 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 19:07:29,675 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 19:07:29,677 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
0    2025-06-01            955
4    2025-06-02            884
8    2025-06-03            790
12   2025-06-04           1149
16   2025-06-05            853
20   2025-06-06            736
24   2025-06-07            736
28   2025-06-08            736
32   2025-06-09            689
36   2025-06-10            602
40   2025-06-11            535
44   2025-06-12            301
48   2025-06-13            218
52   2025-06-14            218
56   2025-06-15            218
60   2025-06-16             54
64   2025-06-17             -2
68   2025-06-18            517
72   2025-06-19            470
76   2025-06-20            394
80   2025-06-21            394
84   2025-06-22            394
88   2025-06-23            749
92   2025-06-24            707
96   2025-06-25            534
100  2025-06-26            474
104  2025-06-27            423
108  2025-06-28            423
112  2025-06-29            423
116  2025-06-30            339
2025-07-09 19:07:29,679 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
3    2025-06-01            178
7    2025-06-02            176
11   2025-06-03            163
15   2025-06-04            156
19   2025-06-05            155
23   2025-06-06            153
27   2025-06-07            153
31   2025-06-08            153
35   2025-06-09            151
39   2025-06-10            151
43   2025-06-11            150
47   2025-06-12            136
51   2025-06-13            135
55   2025-06-14            135
59   2025-06-15            135
63   2025-06-16            133
67   2025-06-17            132
71   2025-06-18            131
75   2025-06-19            129
79   2025-06-20            128
83   2025-06-21            128
87   2025-06-22            128
91   2025-06-23            122
95   2025-06-24            121
99   2025-06-25            120
103  2025-06-26            118
107  2025-06-27            115
111  2025-06-28            115
115  2025-06-29            115
119  2025-06-30            112
2025-07-09 19:07:29,680 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
2025-07-09 19:07:29,684 - src.services.reporting_logic.monthly_report_generator - INFO - Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 19:07:29,689 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 19:07:29,692 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 19:07:29,692 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
0    2025-06-01           20
4    2025-06-02           19
8    2025-06-03           17
12   2025-06-04           24
16   2025-06-05           18
20   2025-06-06           16
24   2025-06-07           16
28   2025-06-08           16
32   2025-06-09           15
36   2025-06-10           13
40   2025-06-11           12
44   2025-06-12            7
48   2025-06-13            5
52   2025-06-14            5
56   2025-06-15            5
60   2025-06-16            2
64   2025-06-17            0
68   2025-06-18           11
72   2025-06-19           10
76   2025-06-20            9
80   2025-06-21            9
84   2025-06-22            9
88   2025-06-23           16
92   2025-06-24           15
96   2025-06-25           12
100  2025-06-26           10
104  2025-06-27            9
108  2025-06-28            9
112  2025-06-29            9
116  2025-06-30            8
2025-07-09 19:07:29,693 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 19:07:29,694 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 19:07:29,694 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 19:07:29,694 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 19:07:29,696 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 19:07:29,697 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 19:07:29,698 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 19:07:29,701 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 19:07:29,701 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 19:07:29,702 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 19:07:29,704 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 19:07:29,708 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 19:07:29,708 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 19:07:29,710 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:07:29,711 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 19:07:29,712 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:07:29,713 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 19:07:29,714 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:07:29,715 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 19:07:29,716 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:07:29,717 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 19:07:29,717 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 19:07:29,718 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:07:29,718 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:07:29,719 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:07:29,720 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:07:29,722 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:07:29,723 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:07:29,723 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 19:07:29,726 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 19:07:29,726 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 19:07:29,729 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:07:29,729 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 19:07:29,732 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 19:07:29,736 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (head):
2025-07-09 19:07:29,738 - src.services.reporting_logic.monthly_report_generator - DEBUG -        Date  # Of Orders  17612 17904 17914 18675 18795   Orders Packages Space Rental    Total
0  6/1/2025          0.0    0.0   0.0   0.0   0.0   0.0    $0.00    $0.00       $20.25   $20.25
1  6/2/2025         19.0   71.0   2.0   3.0   1.0   0.0   $80.75   $57.75       $19.35  $157.85
2  6/3/2025         22.0   94.0  13.0   6.0   0.0   0.0   $93.50   $84.75       $18.00  $196.25
3  6/4/2025         35.0  119.0   7.0   7.0   0.0   0.0  $148.75   $99.75       $21.15  $269.65
4  6/5/2025         83.0  296.0   1.0   7.0   0.0   0.0  $352.75  $228.00       $18.45  $599.20
2025-07-09 19:07:29,739 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (columns and dtypes):
2025-07-09 19:07:29,742 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:07:29,743 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (tail):
2025-07-09 19:07:29,745 - src.services.reporting_logic.monthly_report_generator - DEBUG -          Date  # Of Orders   17612 17904  17914 18675 18795    Orders  Packages Space Rental     Total
26  6/27/2025         17.0    51.0   3.0    6.0   0.0   0.0    $72.25    $45.00       $13.50   $130.75
27  6/28/2025          0.0     0.0   0.0    0.0   0.0   0.0     $0.00     $0.00       $13.50    $13.50
28  6/29/2025          0.0     0.0   0.0    0.0   0.0   0.0     $0.00     $0.00       $13.50    $13.50
29  6/30/2025         10.0    84.0   3.0    1.0   0.0   0.0    $42.50    $66.00       $13.05   $121.55
30      TOTAL        552.0  2046.0  66.0  104.0  20.0   0.0  $2346.00  $1677.00      $459.90  $4482.90
2025-07-09 19:07:29,745 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 19:07:29,746 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 19:07:29,746 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:07:29,746 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:07:29,748 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:07:29,992 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:07:29,994 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:07:29,996 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:07:29,997 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 19:07:30,019 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:07:30,172 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:07:30,176 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:07:30,367 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:30,498 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:30,687 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:07:30,855 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:07:30,859 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-09 19:07:31,664 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:07:31,664 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-09 19:07:31,665 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 19:07:31,665 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 19:07:31,666 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 19:07:31,666 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 19:07:31,666 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 19:07:31,668 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 19:07:31,669 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 19:07:31,672 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 19:07:31,675 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 19:07:31,675 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 19:07:31,677 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 19:07:31,678 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 19:07:31,680 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 19:07:31,681 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 19:07:31,683 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 19:07:31,683 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:07:31,684 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:07:31,685 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 19:07:31,688 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:07:31,688 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:07:31,693 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:07:31,927 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:07:31,928 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:07:31,929 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:07:31,929 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 19:07:31,951 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:07:32,095 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:07:32,096 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:07:32,321 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:32,480 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:07:32,671 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:07:32,954 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:07:32,955 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 19:07:33,117 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:07:33,117 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 19:07:33,117 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 19:07:33,118 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 19:07:33,119 - __main__ - INFO - Script finished successfully.
2025-07-09 19:08:02,378 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 19:08:02,378 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 19:08:02,907 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 19:08:02,907 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 19:08:02,907 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:08:02,908 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:08:02,925 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:08:03,186 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:08:03,190 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:08:03,191 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:08:03,192 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:08:03,217 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:08:03,407 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:08:03,409 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:08:03,839 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:04,082 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:04,085 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 19:08:04,344 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 19:08:04,347 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 19:08:04,352 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 19:08:04,352 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 19:08:04,354 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:08:04,355 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:08:04,361 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:08:04,611 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:08:04,614 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:08:04,615 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:08:04,617 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:08:04,642 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:08:04,803 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:08:04,805 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:08:05,238 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:05,458 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:05,461 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 19:08:05,726 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 19:08:05,727 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 19:08:05,728 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 19:08:05,729 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 19:08:05,732 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 19:08:05,733 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 19:08:05,733 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 19:08:05,733 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:08:05,733 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:08:05,737 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:08:05,975 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:08:05,977 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:08:05,977 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:08:05,978 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:08:06,000 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:08:06,154 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:08:06,159 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:08:06,448 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:06,856 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:06,857 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 19:08:07,053 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 19:08:07,060 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 19:08:07,065 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 19:08:07,066 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:08:07,070 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 19:08:07,071 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 19:08:07,073 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 19:08:07,075 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:08:07,076 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:08:07,078 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 19:08:07,079 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:08:07,079 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 19:08:07,080 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 19:08:07,081 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 19:08:07,081 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:08:07,081 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:08:07,083 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:08:07,348 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:08:07,349 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:08:07,349 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:08:07,350 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:08:07,376 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:08:07,531 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:08:07,543 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:08:07,871 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:08,051 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:08,052 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 19:08:08,263 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 19:08:08,266 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 19:08:08,269 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 19:08:08,270 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 19:08:08,271 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:08:08,272 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:08:08,277 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:08:08,515 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:08:08,519 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:08:08,521 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:08:08,523 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:08:08,545 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:08:08,697 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:08:08,699 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:08:09,109 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:09,271 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:09,274 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 19:08:09,447 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 19:08:09,450 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 19:08:09,456 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 19:08:09,457 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 19:08:09,457 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:08:09,458 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:08:09,461 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:08:09,753 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:08:09,755 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:08:09,756 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:08:09,757 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:08:09,779 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:08:09,953 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:08:09,958 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:08:10,235 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:10,412 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:10,413 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 19:08:10,760 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 19:08:10,762 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 19:08:10,763 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 19:08:10,764 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 19:08:10,765 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 19:08:10,772 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 19:08:10,773 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 19:08:10,774 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 19:08:10,776 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 19:08:10,778 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 19:08:10,778 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 19:08:10,780 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 19:08:10,780 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 19:08:10,781 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 19:08:10,781 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 19:08:10,781 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 19:08:10,783 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 19:08:10,783 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17904': 178, '17612': 955, '17914': 326, '18675': 769}
2025-07-09 19:08:10,784 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 19:08:10,784 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17904': 178, '17612': 955, '17914': 326, '18675': 769}
2025-07-09 19:08:10,787 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 19:08:10,790 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 19:08:10,792 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 19:08:10,793 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 19:08:10,794 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17904': np.int64(178), '17612': np.int64(955), '17914': np.int64(326), '18675': np.int64(769)}
2025-07-09 19:08:10,794 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 19:08:10,795 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17904': np.int64(178), '17612': np.int64(955), '17914': np.int64(326), '18675': np.int64(769)}
2025-07-09 19:08:10,796 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 19:08:10,798 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 19:08:10,799 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 19:08:10,800 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 19:08:10,802 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 19:08:10,803 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17904': np.int64(176), '17612': np.int64(884), '17914': np.int64(323), '18675': np.int64(768)}
2025-07-09 19:08:10,803 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 19:08:10,804 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17904': np.int64(176), '17612': np.int64(884), '17914': np.int64(323), '18675': np.int64(768)}
2025-07-09 19:08:10,806 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 19:08:10,808 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 19:08:10,809 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 19:08:10,811 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 19:08:10,812 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:08:10,812 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17904': np.int64(163), '17612': np.int64(790), '17914': np.int64(317), '18675': np.int64(768)}
2025-07-09 19:08:10,813 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 19:08:10,813 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17904': np.int64(163), '17612': np.int64(790), '17914': np.int64(317), '18675': np.int64(768)}
2025-07-09 19:08:10,814 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 19:08:10,815 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 19:08:10,817 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 19:08:10,818 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 19:08:10,820 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:08:10,821 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17904': np.int64(156), '17612': np.int64(1149), '17914': np.int64(310), '18675': np.int64(768)}
2025-07-09 19:08:10,821 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 19:08:10,822 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17904': np.int64(156), '17612': np.int64(1149), '17914': np.int64(310), '18675': np.int64(768)}
2025-07-09 19:08:10,823 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 19:08:10,825 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 19:08:10,827 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 19:08:10,828 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 19:08:10,829 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:08:10,830 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17904': np.int64(155), '17612': np.int64(853), '17914': np.int64(303), '18675': np.int64(768)}
2025-07-09 19:08:10,830 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 19:08:10,831 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17904': np.int64(155), '17612': np.int64(853), '17914': np.int64(303), '18675': np.int64(768)}
2025-07-09 19:08:10,832 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 19:08:10,833 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 19:08:10,835 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 19:08:10,838 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 19:08:10,839 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 19:08:10,840 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17904': np.int64(153), '17612': np.int64(736), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 19:08:10,840 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 19:08:10,840 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17904': np.int64(153), '17612': np.int64(736), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 19:08:10,842 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:08:10,844 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:08:10,845 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:08:10,846 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:08:10,847 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17904': np.int64(153), '17612': np.int64(736), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 19:08:10,847 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 19:08:10,847 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17904': np.int64(153), '17612': np.int64(736), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 19:08:10,849 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:08:10,850 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:08:10,852 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:08:10,853 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:08:10,854 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17904': np.int64(153), '17612': np.int64(736), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 19:08:10,855 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 19:08:10,855 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17904': np.int64(153), '17612': np.int64(736), '17914': np.int64(302), '18675': np.int64(767)}
2025-07-09 19:08:10,857 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 19:08:10,858 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 19:08:10,860 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 19:08:10,861 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 19:08:10,862 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 19:08:10,863 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17904': np.int64(151), '17612': np.int64(689), '17914': np.int64(299), '18675': np.int64(766)}
2025-07-09 19:08:10,863 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 19:08:10,863 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17904': np.int64(151), '17612': np.int64(689), '17914': np.int64(299), '18675': np.int64(766)}
2025-07-09 19:08:10,864 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 19:08:10,866 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 19:08:10,868 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 19:08:10,869 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 19:08:10,871 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 19:08:10,871 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17904': np.int64(151), '17612': np.int64(602), '17914': np.int64(296), '18675': np.int64(766)}
2025-07-09 19:08:10,872 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 19:08:10,872 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17904': np.int64(151), '17612': np.int64(602), '17914': np.int64(296), '18675': np.int64(766)}
2025-07-09 19:08:10,874 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 19:08:10,875 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 19:08:10,877 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 19:08:10,878 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 19:08:10,880 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 19:08:10,880 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17904': np.int64(150), '17612': np.int64(535), '17914': np.int64(293), '18675': np.int64(765)}
2025-07-09 19:08:10,880 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 19:08:10,881 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17904': np.int64(150), '17612': np.int64(535), '17914': np.int64(293), '18675': np.int64(765)}
2025-07-09 19:08:10,882 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 19:08:10,883 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 19:08:10,885 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 19:08:10,887 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 19:08:10,889 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:08:10,889 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17904': np.int64(136), '17612': np.int64(301), '17914': np.int64(282), '18675': np.int64(765)}
2025-07-09 19:08:10,890 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 19:08:10,890 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17904': np.int64(136), '17612': np.int64(301), '17914': np.int64(282), '18675': np.int64(765)}
2025-07-09 19:08:10,891 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 19:08:10,893 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 19:08:10,894 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 19:08:10,896 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 19:08:10,897 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:08:10,898 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17904': np.int64(135), '17612': np.int64(218), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 19:08:10,898 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 19:08:10,899 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17904': np.int64(135), '17612': np.int64(218), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 19:08:10,901 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:08:10,903 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:08:10,905 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:08:10,908 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:08:10,908 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17904': np.int64(135), '17612': np.int64(218), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 19:08:10,909 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 19:08:10,909 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17904': np.int64(135), '17612': np.int64(218), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 19:08:10,911 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:08:10,914 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:08:10,916 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:08:10,918 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:08:10,918 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17904': np.int64(135), '17612': np.int64(218), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 19:08:10,919 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 19:08:10,920 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17904': np.int64(135), '17612': np.int64(218), '17914': np.int64(270), '18675': np.int64(765)}
2025-07-09 19:08:10,921 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 19:08:10,925 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 19:08:10,926 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 19:08:10,928 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 19:08:10,930 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 19:08:10,930 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17904': np.int64(133), '17612': np.int64(54), '17914': np.int64(267), '18675': np.int64(762)}
2025-07-09 19:08:10,931 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 19:08:10,931 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17904': np.int64(133), '17612': np.int64(54), '17914': np.int64(267), '18675': np.int64(762)}
2025-07-09 19:08:10,932 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 19:08:10,934 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 19:08:10,935 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 19:08:10,937 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 19:08:10,940 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 19:08:10,941 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17904': np.int64(132), '17612': np.int64(-2), '17914': np.int64(256), '18675': np.int64(750)}
2025-07-09 19:08:10,941 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 19:08:10,941 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17904': np.int64(132), '17612': np.int64(-2), '17914': np.int64(256), '18675': np.int64(750)}
2025-07-09 19:08:10,942 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 19:08:10,944 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 19:08:10,945 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 19:08:10,947 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 19:08:10,948 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:08:10,949 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17904': np.int64(131), '17612': np.int64(517), '17914': np.int64(255), '18675': np.int64(750)}
2025-07-09 19:08:10,949 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 19:08:10,949 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17904': np.int64(131), '17612': np.int64(517), '17914': np.int64(255), '18675': np.int64(750)}
2025-07-09 19:08:10,950 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 19:08:10,952 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 19:08:10,954 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 19:08:10,957 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 19:08:10,959 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:08:10,959 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17904': np.int64(129), '17612': np.int64(470), '17914': np.int64(248), '18675': np.int64(750)}
2025-07-09 19:08:10,960 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 19:08:10,960 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17904': np.int64(129), '17612': np.int64(470), '17914': np.int64(248), '18675': np.int64(750)}
2025-07-09 19:08:10,961 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 19:08:10,962 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 19:08:10,964 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 19:08:10,965 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 19:08:10,967 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 19:08:10,967 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17904': np.int64(128), '17612': np.int64(394), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 19:08:10,967 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 19:08:10,967 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17904': np.int64(128), '17612': np.int64(394), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 19:08:10,970 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:08:10,972 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:08:10,974 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:08:10,975 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:08:10,976 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17904': np.int64(128), '17612': np.int64(394), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 19:08:10,976 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 19:08:10,976 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17904': np.int64(128), '17612': np.int64(394), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 19:08:10,978 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:08:10,980 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:08:10,981 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:08:10,983 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:08:10,983 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17904': np.int64(128), '17612': np.int64(394), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 19:08:10,983 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 19:08:10,984 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17904': np.int64(128), '17612': np.int64(394), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 19:08:10,984 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 19:08:10,986 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 19:08:10,988 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 19:08:10,991 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:08:10,992 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:08:10,993 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17904': np.int64(122), '17612': np.int64(749), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 19:08:10,993 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 19:08:10,993 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17904': np.int64(122), '17612': np.int64(749), '17914': np.int64(243), '18675': np.int64(749)}
2025-07-09 19:08:10,994 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 19:08:10,996 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 19:08:10,997 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 19:08:10,999 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 19:08:11,000 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:08:11,001 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17904': np.int64(121), '17612': np.int64(707), '17914': np.int64(242), '18675': np.int64(749)}
2025-07-09 19:08:11,001 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 19:08:11,001 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17904': np.int64(121), '17612': np.int64(707), '17914': np.int64(242), '18675': np.int64(749)}
2025-07-09 19:08:11,002 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 19:08:11,005 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 19:08:11,008 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 19:08:11,010 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 19:08:11,011 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:08:11,011 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17904': np.int64(120), '17612': np.int64(534), '17914': np.int64(238), '18675': np.int64(749)}
2025-07-09 19:08:11,011 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 19:08:11,012 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17904': np.int64(120), '17612': np.int64(534), '17914': np.int64(238), '18675': np.int64(749)}
2025-07-09 19:08:11,013 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 19:08:11,015 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 19:08:11,016 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 19:08:11,018 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 19:08:11,019 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:08:11,020 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17904': np.int64(118), '17612': np.int64(474), '17914': np.int64(229), '18675': np.int64(749)}
2025-07-09 19:08:11,021 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 19:08:11,021 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17904': np.int64(118), '17612': np.int64(474), '17914': np.int64(229), '18675': np.int64(749)}
2025-07-09 19:08:11,023 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 19:08:11,025 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 19:08:11,027 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 19:08:11,029 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 19:08:11,030 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:08:11,031 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17904': np.int64(115), '17612': np.int64(423), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 19:08:11,031 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 19:08:11,031 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17904': np.int64(115), '17612': np.int64(423), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 19:08:11,033 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:08:11,035 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:08:11,036 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:08:11,039 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:08:11,040 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17904': np.int64(115), '17612': np.int64(423), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 19:08:11,040 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 19:08:11,040 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17904': np.int64(115), '17612': np.int64(423), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 19:08:11,042 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:08:11,044 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:08:11,045 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:08:11,047 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:08:11,047 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17904': np.int64(115), '17612': np.int64(423), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 19:08:11,048 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 19:08:11,048 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17904': np.int64(115), '17612': np.int64(423), '17914': np.int64(223), '18675': np.int64(749)}
2025-07-09 19:08:11,049 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 19:08:11,051 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 19:08:11,055 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 19:08:11,058 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 19:08:11,061 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:08:11,062 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17904': np.int64(112), '17612': np.int64(339), '17914': np.int64(222), '18675': np.int64(749)}
2025-07-09 19:08:11,066 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612            955            955
0  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
5  2025-06-02  17612            955            884
2025-07-09 19:08:11,067 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
117  2025-06-30  17612            423            339
116  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-09 19:08:11,068 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 19:08:11,069 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 19:08:11,071 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612            955            955
0  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
5  2025-06-02  17612            955            884
2025-07-09 19:08:11,074 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
117  2025-06-30  17612            423            339
116  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-09 19:08:11,075 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 19:08:11,078 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 19:08:11,079 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01            955
5    2025-06-02            884
9    2025-06-03            790
13   2025-06-04           1149
17   2025-06-05            853
21   2025-06-06            736
25   2025-06-07            736
29   2025-06-08            736
33   2025-06-09            689
37   2025-06-10            602
41   2025-06-11            535
45   2025-06-12            301
49   2025-06-13            218
53   2025-06-14            218
57   2025-06-15            218
61   2025-06-16             54
65   2025-06-17             -2
69   2025-06-18            517
73   2025-06-19            470
77   2025-06-20            394
81   2025-06-21            394
85   2025-06-22            394
89   2025-06-23            749
93   2025-06-24            707
97   2025-06-25            534
101  2025-06-26            474
105  2025-06-27            423
109  2025-06-28            423
113  2025-06-29            423
117  2025-06-30            339
2025-07-09 19:08:11,082 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
0    2025-06-01            178
4    2025-06-02            176
8    2025-06-03            163
12   2025-06-04            156
16   2025-06-05            155
20   2025-06-06            153
24   2025-06-07            153
28   2025-06-08            153
32   2025-06-09            151
36   2025-06-10            151
40   2025-06-11            150
44   2025-06-12            136
48   2025-06-13            135
52   2025-06-14            135
56   2025-06-15            135
60   2025-06-16            133
64   2025-06-17            132
68   2025-06-18            131
72   2025-06-19            129
76   2025-06-20            128
80   2025-06-21            128
84   2025-06-22            128
88   2025-06-23            122
92   2025-06-24            121
96   2025-06-25            120
100  2025-06-26            118
104  2025-06-27            115
108  2025-06-28            115
112  2025-06-29            115
116  2025-06-30            112
2025-07-09 19:08:11,084 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
2025-07-09 19:08:11,092 - src.services.reporting_logic.monthly_report_generator - INFO - Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 19:08:11,095 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 19:08:11,097 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 19:08:11,098 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           20
5    2025-06-02           19
9    2025-06-03           17
13   2025-06-04           24
17   2025-06-05           18
21   2025-06-06           16
25   2025-06-07           16
29   2025-06-08           16
33   2025-06-09           15
37   2025-06-10           13
41   2025-06-11           12
45   2025-06-12            7
49   2025-06-13            5
53   2025-06-14            5
57   2025-06-15            5
61   2025-06-16            2
65   2025-06-17            0
69   2025-06-18           11
73   2025-06-19           10
77   2025-06-20            9
81   2025-06-21            9
85   2025-06-22            9
89   2025-06-23           16
93   2025-06-24           15
97   2025-06-25           12
101  2025-06-26           10
105  2025-06-27            9
109  2025-06-28            9
113  2025-06-29            9
117  2025-06-30            8
2025-07-09 19:08:11,100 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 19:08:11,101 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 19:08:11,101 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 19:08:11,102 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 19:08:11,104 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 19:08:11,105 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 19:08:11,107 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 19:08:11,110 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 19:08:11,110 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 19:08:11,111 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 19:08:11,112 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 19:08:11,116 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 19:08:11,117 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 19:08:11,118 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:08:11,119 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 19:08:11,121 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:08:11,122 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 19:08:11,124 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:08:11,125 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 19:08:11,126 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:08:11,127 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 19:08:11,128 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 19:08:11,128 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:08:11,129 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:08:11,131 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:08:11,132 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:08:11,132 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:08:11,133 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:08:11,134 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 19:08:11,136 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 19:08:11,137 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 19:08:11,141 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:08:11,142 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 19:08:11,144 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 19:08:11,150 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (head):
2025-07-09 19:08:11,152 - src.services.reporting_logic.monthly_report_generator - DEBUG -        Date  # Of Orders  17612 17904 17914 18675 18795   Orders Packages Space Rental    Total
0  6/1/2025          0.0    0.0   0.0   0.0   0.0   0.0    $0.00    $0.00       $20.25   $20.25
1  6/2/2025         19.0   71.0   2.0   3.0   1.0   0.0   $80.75   $57.75       $19.35  $157.85
2  6/3/2025         22.0   94.0  13.0   6.0   0.0   0.0   $93.50   $84.75       $18.00  $196.25
3  6/4/2025         35.0  119.0   7.0   7.0   0.0   0.0  $148.75   $99.75       $21.15  $269.65
4  6/5/2025         83.0  296.0   1.0   7.0   0.0   0.0  $352.75  $228.00       $18.45  $599.20
2025-07-09 19:08:11,153 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (columns and dtypes):
2025-07-09 19:08:11,157 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:08:11,157 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (tail):
2025-07-09 19:08:11,159 - src.services.reporting_logic.monthly_report_generator - DEBUG -          Date  # Of Orders   17612 17904  17914 18675 18795    Orders  Packages Space Rental     Total
26  6/27/2025         17.0    51.0   3.0    6.0   0.0   0.0    $72.25    $45.00       $13.50   $130.75
27  6/28/2025          0.0     0.0   0.0    0.0   0.0   0.0     $0.00     $0.00       $13.50    $13.50
28  6/29/2025          0.0     0.0   0.0    0.0   0.0   0.0     $0.00     $0.00       $13.50    $13.50
29  6/30/2025         10.0    84.0   3.0    1.0   0.0   0.0    $42.50    $66.00       $13.05   $121.55
30      TOTAL        552.0  2046.0  66.0  104.0  20.0   0.0  $2346.00  $1677.00      $459.90  $4482.90
2025-07-09 19:08:11,160 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 19:08:11,160 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 19:08:11,161 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:08:11,161 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:08:11,163 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:08:11,388 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:08:11,391 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:08:11,392 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:08:11,392 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 19:08:11,413 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:08:11,558 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:08:11,561 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:08:11,804 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:11,968 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:12,125 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:08:12,315 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:08:12,318 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-09 19:08:12,536 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:08:12,538 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-09 19:08:12,540 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 19:08:12,541 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 19:08:12,542 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 19:08:12,542 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 19:08:12,543 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 19:08:12,545 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 19:08:12,545 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 19:08:12,548 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 19:08:12,549 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 19:08:12,550 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 19:08:12,552 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 19:08:12,553 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 19:08:12,555 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 19:08:12,557 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 19:08:12,558 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 19:08:12,559 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:08:12,559 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:08:12,559 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 19:08:12,561 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:08:12,562 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:08:12,564 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:08:12,833 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:08:12,835 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:08:12,835 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:08:12,836 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 19:08:12,857 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:08:13,008 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:08:13,010 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:08:13,288 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:13,419 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:08:13,631 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:08:13,829 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:08:13,832 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 19:08:14,014 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:08:14,015 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 19:08:14,016 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 19:08:14,017 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 19:08:14,018 - __main__ - INFO - Script finished successfully.
2025-07-09 19:12:08,325 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 19:12:08,325 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 19:12:08,663 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 19:12:08,664 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 19:12:08,664 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:12:08,665 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:12:08,677 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:12:08,932 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:12:08,933 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:12:08,934 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:12:08,934 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:12:08,958 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:12:09,129 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:12:09,132 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:12:09,690 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:09,996 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:09,997 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 19:12:10,403 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 19:12:10,407 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 19:12:10,413 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 19:12:10,413 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 19:12:10,413 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:12:10,414 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:12:10,416 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:12:10,638 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:12:10,641 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:12:10,642 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:12:10,642 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:12:10,664 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:12:10,831 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:12:10,836 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:12:11,260 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:11,619 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:11,622 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 19:12:11,799 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 19:12:11,804 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 19:12:11,807 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 19:12:11,808 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 19:12:11,812 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 19:12:11,813 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 19:12:11,814 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 19:12:11,814 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:12:11,815 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:12:11,819 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:12:12,058 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:12:12,060 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:12:12,060 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:12:12,060 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:12:12,082 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:12:12,224 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:12:12,226 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:12:12,921 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:13,057 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:13,059 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 19:12:13,232 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 19:12:13,237 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 19:12:13,245 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 19:12:13,246 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:12:13,249 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 19:12:13,250 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 19:12:13,251 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 19:12:13,252 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:12:13,253 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:12:13,257 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 19:12:13,258 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:12:13,258 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 19:12:13,259 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 19:12:13,259 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 19:12:13,259 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:12:13,260 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:12:13,262 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:12:13,505 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:12:13,508 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:12:13,509 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:12:13,510 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:12:13,531 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:12:13,699 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:12:13,704 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:12:13,906 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:14,036 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:14,037 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 19:12:14,319 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 19:12:14,326 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 19:12:14,329 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 19:12:14,330 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 19:12:14,330 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:12:14,331 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:12:14,334 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:12:14,564 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:12:14,565 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:12:14,567 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:12:14,567 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:12:14,594 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:12:14,755 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:12:14,757 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:12:15,069 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:15,193 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:15,195 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 19:12:15,422 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 19:12:15,425 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 19:12:15,431 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 19:12:15,431 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 19:12:15,432 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:12:15,433 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:12:15,437 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:12:15,710 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:12:15,713 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:12:15,714 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:12:15,715 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:12:15,737 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:12:15,888 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:12:15,890 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:12:16,204 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:16,478 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:16,480 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 19:12:16,632 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 19:12:16,634 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 19:12:16,636 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 19:12:16,637 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 19:12:16,637 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 19:12:16,640 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 19:12:16,642 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 19:12:16,642 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 19:12:16,643 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 19:12:16,644 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 19:12:16,645 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 19:12:16,646 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 19:12:16,647 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 19:12:16,647 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 19:12:16,648 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 19:12:16,648 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 19:12:16,649 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 19:12:16,650 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17612': 955, '18675': 769, '17904': 178, '17914': 326}
2025-07-09 19:12:16,650 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 19:12:16,650 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17612': 955, '18675': 769, '17904': 178, '17914': 326}
2025-07-09 19:12:16,653 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 19:12:16,654 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 19:12:16,657 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 19:12:16,658 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 19:12:16,658 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17612': np.int64(955), '18675': np.int64(769), '17904': np.int64(178), '17914': np.int64(326)}
2025-07-09 19:12:16,658 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 19:12:16,659 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17612': np.int64(955), '18675': np.int64(769), '17904': np.int64(178), '17914': np.int64(326)}
2025-07-09 19:12:16,660 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 19:12:16,662 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 19:12:16,664 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 19:12:16,665 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 19:12:16,666 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 19:12:16,667 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17612': np.int64(884), '18675': np.int64(768), '17904': np.int64(176), '17914': np.int64(323)}
2025-07-09 19:12:16,667 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 19:12:16,667 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17612': np.int64(884), '18675': np.int64(768), '17904': np.int64(176), '17914': np.int64(323)}
2025-07-09 19:12:16,668 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 19:12:16,670 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 19:12:16,672 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:12:16,674 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 19:12:16,676 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 19:12:16,677 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17612': np.int64(790), '18675': np.int64(768), '17904': np.int64(163), '17914': np.int64(317)}
2025-07-09 19:12:16,677 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 19:12:16,677 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17612': np.int64(790), '18675': np.int64(768), '17904': np.int64(163), '17914': np.int64(317)}
2025-07-09 19:12:16,678 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 19:12:16,680 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 19:12:16,682 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:12:16,683 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 19:12:16,685 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 19:12:16,686 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17612': np.int64(1149), '18675': np.int64(768), '17904': np.int64(156), '17914': np.int64(310)}
2025-07-09 19:12:16,686 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 19:12:16,686 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17612': np.int64(1149), '18675': np.int64(768), '17904': np.int64(156), '17914': np.int64(310)}
2025-07-09 19:12:16,688 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 19:12:16,690 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 19:12:16,692 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:12:16,693 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 19:12:16,695 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 19:12:16,695 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17612': np.int64(853), '18675': np.int64(768), '17904': np.int64(155), '17914': np.int64(303)}
2025-07-09 19:12:16,695 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 19:12:16,696 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17612': np.int64(853), '18675': np.int64(768), '17904': np.int64(155), '17914': np.int64(303)}
2025-07-09 19:12:16,697 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 19:12:16,698 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 19:12:16,700 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 19:12:16,701 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 19:12:16,703 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 19:12:16,704 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17612': np.int64(736), '18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 19:12:16,704 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 19:12:16,705 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17612': np.int64(736), '18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 19:12:16,707 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:12:16,708 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:12:16,710 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:12:16,712 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:12:16,712 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17612': np.int64(736), '18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 19:12:16,713 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 19:12:16,713 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17612': np.int64(736), '18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 19:12:16,715 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:12:16,717 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:12:16,718 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:12:16,720 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:12:16,720 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17612': np.int64(736), '18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 19:12:16,721 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 19:12:16,721 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17612': np.int64(736), '18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 19:12:16,723 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 19:12:16,725 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 19:12:16,727 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 19:12:16,728 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 19:12:16,729 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 19:12:16,730 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17612': np.int64(689), '18675': np.int64(766), '17904': np.int64(151), '17914': np.int64(299)}
2025-07-09 19:12:16,730 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 19:12:16,730 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17612': np.int64(689), '18675': np.int64(766), '17904': np.int64(151), '17914': np.int64(299)}
2025-07-09 19:12:16,731 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 19:12:16,733 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 19:12:16,735 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 19:12:16,737 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 19:12:16,740 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 19:12:16,741 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17612': np.int64(602), '18675': np.int64(766), '17904': np.int64(151), '17914': np.int64(296)}
2025-07-09 19:12:16,741 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 19:12:16,741 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17612': np.int64(602), '18675': np.int64(766), '17904': np.int64(151), '17914': np.int64(296)}
2025-07-09 19:12:16,742 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 19:12:16,744 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 19:12:16,745 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 19:12:16,747 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 19:12:16,748 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 19:12:16,748 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17612': np.int64(535), '18675': np.int64(765), '17904': np.int64(150), '17914': np.int64(293)}
2025-07-09 19:12:16,749 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 19:12:16,749 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17612': np.int64(535), '18675': np.int64(765), '17904': np.int64(150), '17914': np.int64(293)}
2025-07-09 19:12:16,750 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 19:12:16,752 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 19:12:16,754 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:12:16,757 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 19:12:16,758 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 19:12:16,759 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17612': np.int64(301), '18675': np.int64(765), '17904': np.int64(136), '17914': np.int64(282)}
2025-07-09 19:12:16,759 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 19:12:16,760 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17612': np.int64(301), '18675': np.int64(765), '17904': np.int64(136), '17914': np.int64(282)}
2025-07-09 19:12:16,760 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 19:12:16,762 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 19:12:16,763 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:12:16,766 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 19:12:16,768 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 19:12:16,768 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17612': np.int64(218), '18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 19:12:16,768 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 19:12:16,768 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17612': np.int64(218), '18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 19:12:16,771 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:12:16,774 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:12:16,775 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:12:16,777 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:12:16,777 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17612': np.int64(218), '18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 19:12:16,777 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 19:12:16,778 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17612': np.int64(218), '18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 19:12:16,779 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:12:16,781 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:12:16,782 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:12:16,784 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:12:16,784 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17612': np.int64(218), '18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 19:12:16,784 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 19:12:16,785 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17612': np.int64(218), '18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 19:12:16,787 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 19:12:16,789 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 19:12:16,791 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 19:12:16,792 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 19:12:16,794 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 19:12:16,794 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17612': np.int64(54), '18675': np.int64(762), '17904': np.int64(133), '17914': np.int64(267)}
2025-07-09 19:12:16,794 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 19:12:16,795 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17612': np.int64(54), '18675': np.int64(762), '17904': np.int64(133), '17914': np.int64(267)}
2025-07-09 19:12:16,796 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 19:12:16,797 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 19:12:16,799 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 19:12:16,800 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 19:12:16,802 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 19:12:16,803 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17612': np.int64(-2), '18675': np.int64(750), '17904': np.int64(132), '17914': np.int64(256)}
2025-07-09 19:12:16,803 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 19:12:16,803 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17612': np.int64(-2), '18675': np.int64(750), '17904': np.int64(132), '17914': np.int64(256)}
2025-07-09 19:12:16,804 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 19:12:16,807 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 19:12:16,808 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:12:16,810 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 19:12:16,811 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 19:12:16,811 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17612': np.int64(517), '18675': np.int64(750), '17904': np.int64(131), '17914': np.int64(255)}
2025-07-09 19:12:16,811 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 19:12:16,812 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17612': np.int64(517), '18675': np.int64(750), '17904': np.int64(131), '17914': np.int64(255)}
2025-07-09 19:12:16,813 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 19:12:16,814 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 19:12:16,815 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:12:16,817 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 19:12:16,819 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 19:12:16,820 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17612': np.int64(470), '18675': np.int64(750), '17904': np.int64(129), '17914': np.int64(248)}
2025-07-09 19:12:16,821 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 19:12:16,821 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17612': np.int64(470), '18675': np.int64(750), '17904': np.int64(129), '17914': np.int64(248)}
2025-07-09 19:12:16,823 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 19:12:16,824 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 19:12:16,826 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 19:12:16,827 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 19:12:16,829 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 19:12:16,829 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17612': np.int64(394), '18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 19:12:16,829 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 19:12:16,830 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17612': np.int64(394), '18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 19:12:16,831 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:12:16,833 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:12:16,835 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:12:16,837 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:12:16,837 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17612': np.int64(394), '18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 19:12:16,838 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 19:12:16,838 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17612': np.int64(394), '18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 19:12:16,840 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:12:16,841 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:12:16,844 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:12:16,845 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:12:16,846 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17612': np.int64(394), '18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 19:12:16,846 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 19:12:16,847 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17612': np.int64(394), '18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 19:12:16,848 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 19:12:16,849 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 19:12:16,850 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:12:16,853 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 19:12:16,855 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:12:16,856 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17612': np.int64(749), '18675': np.int64(749), '17904': np.int64(122), '17914': np.int64(243)}
2025-07-09 19:12:16,856 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 19:12:16,857 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17612': np.int64(749), '18675': np.int64(749), '17904': np.int64(122), '17914': np.int64(243)}
2025-07-09 19:12:16,857 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 19:12:16,859 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 19:12:16,861 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:12:16,862 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 19:12:16,864 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 19:12:16,864 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17612': np.int64(707), '18675': np.int64(749), '17904': np.int64(121), '17914': np.int64(242)}
2025-07-09 19:12:16,865 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 19:12:16,865 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17612': np.int64(707), '18675': np.int64(749), '17904': np.int64(121), '17914': np.int64(242)}
2025-07-09 19:12:16,866 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 19:12:16,868 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 19:12:16,869 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:12:16,871 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 19:12:16,873 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 19:12:16,874 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17612': np.int64(534), '18675': np.int64(749), '17904': np.int64(120), '17914': np.int64(238)}
2025-07-09 19:12:16,874 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 19:12:16,874 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17612': np.int64(534), '18675': np.int64(749), '17904': np.int64(120), '17914': np.int64(238)}
2025-07-09 19:12:16,875 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 19:12:16,876 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 19:12:16,878 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:12:16,879 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 19:12:16,881 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 19:12:16,881 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17612': np.int64(474), '18675': np.int64(749), '17904': np.int64(118), '17914': np.int64(229)}
2025-07-09 19:12:16,881 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 19:12:16,882 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17612': np.int64(474), '18675': np.int64(749), '17904': np.int64(118), '17914': np.int64(229)}
2025-07-09 19:12:16,882 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 19:12:16,884 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 19:12:16,885 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:12:16,888 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 19:12:16,890 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 19:12:16,890 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17612': np.int64(423), '18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 19:12:16,891 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 19:12:16,891 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17612': np.int64(423), '18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 19:12:16,892 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:12:16,895 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:12:16,898 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:12:16,898 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:12:16,899 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17612': np.int64(423), '18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 19:12:16,899 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 19:12:16,899 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17612': np.int64(423), '18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 19:12:16,901 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:12:16,903 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:12:16,904 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:12:16,906 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:12:16,906 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17612': np.int64(423), '18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 19:12:16,907 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 19:12:16,907 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17612': np.int64(423), '18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 19:12:16,908 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 19:12:16,909 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 19:12:16,911 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:12:16,912 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 19:12:16,914 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 19:12:16,914 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17612': np.int64(339), '18675': np.int64(749), '17904': np.int64(112), '17914': np.int64(222)}
2025-07-09 19:12:16,916 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
3  2025-06-01  17914            326            326
1  2025-06-01  18675            769            769
4  2025-06-02  17612            955            884
2025-07-09 19:12:16,917 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
113  2025-06-29  18675            749            749
116  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
119  2025-06-30  17914            223            222
117  2025-06-30  18675            749            749
2025-07-09 19:12:16,918 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 19:12:16,918 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 19:12:16,920 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
3  2025-06-01  17914            326            326
1  2025-06-01  18675            769            769
4  2025-06-02  17612            955            884
2025-07-09 19:12:16,921 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
113  2025-06-29  18675            749            749
116  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
119  2025-06-30  17914            223            222
117  2025-06-30  18675            749            749
2025-07-09 19:12:16,923 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 19:12:16,924 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 19:12:16,926 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
0    2025-06-01            955
4    2025-06-02            884
8    2025-06-03            790
12   2025-06-04           1149
16   2025-06-05            853
20   2025-06-06            736
24   2025-06-07            736
28   2025-06-08            736
32   2025-06-09            689
36   2025-06-10            602
40   2025-06-11            535
44   2025-06-12            301
48   2025-06-13            218
52   2025-06-14            218
56   2025-06-15            218
60   2025-06-16             54
64   2025-06-17             -2
68   2025-06-18            517
72   2025-06-19            470
76   2025-06-20            394
80   2025-06-21            394
84   2025-06-22            394
88   2025-06-23            749
92   2025-06-24            707
96   2025-06-25            534
100  2025-06-26            474
104  2025-06-27            423
108  2025-06-28            423
112  2025-06-29            423
116  2025-06-30            339
2025-07-09 19:12:16,926 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            178
6    2025-06-02            176
10   2025-06-03            163
14   2025-06-04            156
18   2025-06-05            155
22   2025-06-06            153
26   2025-06-07            153
30   2025-06-08            153
34   2025-06-09            151
38   2025-06-10            151
42   2025-06-11            150
46   2025-06-12            136
50   2025-06-13            135
54   2025-06-14            135
58   2025-06-15            135
62   2025-06-16            133
66   2025-06-17            132
70   2025-06-18            131
74   2025-06-19            129
78   2025-06-20            128
82   2025-06-21            128
86   2025-06-22            128
90   2025-06-23            122
94   2025-06-24            121
98   2025-06-25            120
102  2025-06-26            118
106  2025-06-27            115
110  2025-06-28            115
114  2025-06-29            115
118  2025-06-30            112
2025-07-09 19:12:16,929 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
2025-07-09 19:12:16,933 - src.services.reporting_logic.monthly_report_generator - INFO - Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 19:12:16,936 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 19:12:16,939 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 19:12:16,940 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
0    2025-06-01           20
4    2025-06-02           19
8    2025-06-03           17
12   2025-06-04           24
16   2025-06-05           18
20   2025-06-06           16
24   2025-06-07           16
28   2025-06-08           16
32   2025-06-09           15
36   2025-06-10           13
40   2025-06-11           12
44   2025-06-12            7
48   2025-06-13            5
52   2025-06-14            5
56   2025-06-15            5
60   2025-06-16            2
64   2025-06-17            0
68   2025-06-18           11
72   2025-06-19           10
76   2025-06-20            9
80   2025-06-21            9
84   2025-06-22            9
88   2025-06-23           16
92   2025-06-24           15
96   2025-06-25           12
100  2025-06-26           10
104  2025-06-27            9
108  2025-06-28            9
112  2025-06-29            9
116  2025-06-30            8
2025-07-09 19:12:16,942 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 19:12:16,942 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 19:12:16,944 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 19:12:16,944 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 19:12:16,945 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 19:12:16,946 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 19:12:16,947 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 19:12:16,949 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 19:12:16,950 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 19:12:16,950 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 19:12:16,951 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 19:12:16,956 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 19:12:16,956 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 19:12:16,958 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:12:16,958 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 19:12:16,959 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:12:16,960 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 19:12:16,961 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:12:16,961 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 19:12:16,962 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:12:16,963 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 19:12:16,963 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 19:12:16,964 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:12:16,964 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:12:16,965 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:12:16,966 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:12:16,967 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:12:16,968 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:12:16,968 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 19:12:16,971 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 19:12:16,972 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 19:12:16,975 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:12:16,975 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 19:12:16,978 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 19:12:16,982 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (head):
2025-07-09 19:12:16,983 - src.services.reporting_logic.monthly_report_generator - DEBUG -        Date  # Of Orders  17612 17904 17914 18675 18795   Orders Packages Space Rental    Total
0  6/1/2025          0.0    0.0   0.0   0.0   0.0   0.0    $0.00    $0.00       $20.25   $20.25
1  6/2/2025         19.0   71.0   2.0   3.0   1.0   0.0   $80.75   $57.75       $19.35  $157.85
2  6/3/2025         22.0   94.0  13.0   6.0   0.0   0.0   $93.50   $84.75       $18.00  $196.25
3  6/4/2025         35.0  119.0   7.0   7.0   0.0   0.0  $148.75   $99.75       $21.15  $269.65
4  6/5/2025         83.0  296.0   1.0   7.0   0.0   0.0  $352.75  $228.00       $18.45  $599.20
2025-07-09 19:12:16,984 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (columns and dtypes):
2025-07-09 19:12:16,988 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:12:16,989 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (tail):
2025-07-09 19:12:16,991 - src.services.reporting_logic.monthly_report_generator - DEBUG -          Date  # Of Orders   17612 17904  17914 18675 18795    Orders  Packages Space Rental     Total
26  6/27/2025         17.0    51.0   3.0    6.0   0.0   0.0    $72.25    $45.00       $13.50   $130.75
27  6/28/2025          0.0     0.0   0.0    0.0   0.0   0.0     $0.00     $0.00       $13.50    $13.50
28  6/29/2025          0.0     0.0   0.0    0.0   0.0   0.0     $0.00     $0.00       $13.50    $13.50
29  6/30/2025         10.0    84.0   3.0    1.0   0.0   0.0    $42.50    $66.00       $13.05   $121.55
30      TOTAL        552.0  2046.0  66.0  104.0  20.0   0.0  $2346.00  $1677.00      $459.90  $4482.90
2025-07-09 19:12:16,992 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 19:12:16,992 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 19:12:16,992 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:12:16,993 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:12:16,994 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:12:17,208 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:12:17,210 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:12:17,211 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:12:17,211 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 19:12:17,238 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:12:17,396 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:12:17,397 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:12:17,612 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:17,748 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:17,944 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:12:18,089 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:12:18,090 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-09 19:12:18,269 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:12:18,270 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-09 19:12:18,271 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 19:12:18,272 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 19:12:18,272 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 19:12:18,273 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 19:12:18,273 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 19:12:18,274 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 19:12:18,275 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 19:12:18,277 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 19:12:18,278 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 19:12:18,279 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 19:12:18,281 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 19:12:18,281 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 19:12:18,284 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 19:12:18,285 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 19:12:18,288 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 19:12:18,288 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:12:18,289 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:12:18,289 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 19:12:18,293 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:12:18,293 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:12:18,295 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:12:18,538 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:12:18,540 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:12:18,541 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:12:18,542 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 19:12:18,564 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:12:18,717 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:12:18,720 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:12:18,959 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:19,083 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:12:19,241 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:12:19,378 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:12:19,379 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 19:12:19,521 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:12:19,521 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 19:12:19,522 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 19:12:19,522 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 19:12:19,522 - __main__ - INFO - Script finished successfully.
2025-07-09 19:13:21,892 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 19:13:21,892 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 19:13:22,240 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 19:13:22,240 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 19:13:22,241 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:13:22,241 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:13:22,252 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:13:22,564 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:13:22,569 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:13:22,570 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:13:22,571 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:13:22,594 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:13:22,742 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:13:22,746 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:13:23,208 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:23,396 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:23,397 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 19:13:23,531 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 19:13:23,535 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 19:13:23,542 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 19:13:23,543 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 19:13:23,543 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:13:23,544 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:13:23,546 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:13:23,790 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:13:23,793 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:13:23,793 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:13:23,794 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:13:23,817 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:13:23,957 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:13:23,959 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:13:24,143 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:24,262 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:24,264 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 19:13:24,381 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 19:13:24,384 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 19:13:24,386 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 19:13:24,388 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 19:13:24,392 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 19:13:24,393 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 19:13:24,394 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 19:13:24,395 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:13:24,395 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:13:24,397 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:13:24,640 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:13:24,641 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:13:24,642 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:13:24,643 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:13:24,665 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:13:24,810 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:13:24,814 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:13:24,993 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:25,105 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:25,107 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 19:13:25,226 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 19:13:25,232 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 19:13:25,237 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 19:13:25,238 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:13:25,241 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 19:13:25,242 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 19:13:25,243 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 19:13:25,244 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:13:25,245 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:13:25,246 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 19:13:25,247 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:13:25,248 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 19:13:25,249 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 19:13:25,250 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 19:13:25,250 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:13:25,251 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:13:25,254 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:13:25,478 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:13:25,479 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:13:25,480 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:13:25,480 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:13:25,504 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:13:25,677 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:13:25,679 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:13:25,866 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:25,975 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:25,976 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 19:13:26,104 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 19:13:26,107 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 19:13:26,112 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 19:13:26,113 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 19:13:26,114 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:13:26,114 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:13:26,117 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:13:26,393 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:13:26,394 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:13:26,395 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:13:26,395 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:13:26,417 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:13:26,564 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:13:26,567 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:13:26,762 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:26,868 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:26,870 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 19:13:27,004 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 19:13:27,007 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 19:13:27,013 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 19:13:27,013 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 19:13:27,014 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:13:27,014 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:13:27,017 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:13:27,252 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:13:27,255 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:13:27,256 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:13:27,257 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:13:27,286 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:13:27,428 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:13:27,430 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:13:27,625 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:27,756 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:27,758 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 19:13:27,984 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 19:13:27,987 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 19:13:27,989 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 19:13:27,990 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 19:13:27,990 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 19:13:27,996 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 19:13:27,997 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 19:13:27,997 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 19:13:27,999 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 19:13:27,999 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 19:13:28,000 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 19:13:28,002 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 19:13:28,003 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 19:13:28,004 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 19:13:28,004 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 19:13:28,005 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 19:13:28,007 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 19:13:28,007 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 326, '17612': 955, '17904': 178, '18675': 769}
2025-07-09 19:13:28,009 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 19:13:28,009 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 326, '17612': 955, '17904': 178, '18675': 769}
2025-07-09 19:13:28,011 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 19:13:28,012 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 19:13:28,014 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 19:13:28,016 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 19:13:28,016 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(326), '17612': np.int64(955), '17904': np.int64(178), '18675': np.int64(769)}
2025-07-09 19:13:28,017 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 19:13:28,017 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(326), '17612': np.int64(955), '17904': np.int64(178), '18675': np.int64(769)}
2025-07-09 19:13:28,018 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 19:13:28,020 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 19:13:28,024 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 19:13:28,025 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 19:13:28,027 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 19:13:28,027 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(323), '17612': np.int64(884), '17904': np.int64(176), '18675': np.int64(768)}
2025-07-09 19:13:28,028 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 19:13:28,028 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(323), '17612': np.int64(884), '17904': np.int64(176), '18675': np.int64(768)}
2025-07-09 19:13:28,029 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 19:13:28,031 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 19:13:28,033 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 19:13:28,034 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 19:13:28,036 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:13:28,037 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(317), '17612': np.int64(790), '17904': np.int64(163), '18675': np.int64(768)}
2025-07-09 19:13:28,038 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 19:13:28,038 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(317), '17612': np.int64(790), '17904': np.int64(163), '18675': np.int64(768)}
2025-07-09 19:13:28,041 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 19:13:28,043 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 19:13:28,044 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 19:13:28,046 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 19:13:28,047 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:13:28,048 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(310), '17612': np.int64(1149), '17904': np.int64(156), '18675': np.int64(768)}
2025-07-09 19:13:28,048 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 19:13:28,049 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(310), '17612': np.int64(1149), '17904': np.int64(156), '18675': np.int64(768)}
2025-07-09 19:13:28,050 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 19:13:28,052 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 19:13:28,058 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 19:13:28,060 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 19:13:28,062 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:13:28,063 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(303), '17612': np.int64(853), '17904': np.int64(155), '18675': np.int64(768)}
2025-07-09 19:13:28,063 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 19:13:28,064 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(303), '17612': np.int64(853), '17904': np.int64(155), '18675': np.int64(768)}
2025-07-09 19:13:28,066 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 19:13:28,071 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 19:13:28,075 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 19:13:28,078 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 19:13:28,080 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 19:13:28,081 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(302), '17612': np.int64(736), '17904': np.int64(153), '18675': np.int64(767)}
2025-07-09 19:13:28,082 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 19:13:28,082 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(302), '17612': np.int64(736), '17904': np.int64(153), '18675': np.int64(767)}
2025-07-09 19:13:28,087 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:13:28,090 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:13:28,093 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:13:28,097 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:13:28,097 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(302), '17612': np.int64(736), '17904': np.int64(153), '18675': np.int64(767)}
2025-07-09 19:13:28,097 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 19:13:28,097 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(302), '17612': np.int64(736), '17904': np.int64(153), '18675': np.int64(767)}
2025-07-09 19:13:28,100 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:13:28,104 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:13:28,108 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:13:28,109 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:13:28,110 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(302), '17612': np.int64(736), '17904': np.int64(153), '18675': np.int64(767)}
2025-07-09 19:13:28,111 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 19:13:28,111 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(302), '17612': np.int64(736), '17904': np.int64(153), '18675': np.int64(767)}
2025-07-09 19:13:28,112 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 19:13:28,114 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 19:13:28,116 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 19:13:28,118 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 19:13:28,121 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 19:13:28,121 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(299), '17612': np.int64(689), '17904': np.int64(151), '18675': np.int64(766)}
2025-07-09 19:13:28,121 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 19:13:28,122 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(299), '17612': np.int64(689), '17904': np.int64(151), '18675': np.int64(766)}
2025-07-09 19:13:28,123 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 19:13:28,125 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 19:13:28,127 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 19:13:28,129 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 19:13:28,132 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 19:13:28,132 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(296), '17612': np.int64(602), '17904': np.int64(151), '18675': np.int64(766)}
2025-07-09 19:13:28,132 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 19:13:28,133 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(296), '17612': np.int64(602), '17904': np.int64(151), '18675': np.int64(766)}
2025-07-09 19:13:28,134 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 19:13:28,136 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 19:13:28,139 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 19:13:28,142 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 19:13:28,143 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 19:13:28,144 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(293), '17612': np.int64(535), '17904': np.int64(150), '18675': np.int64(765)}
2025-07-09 19:13:28,144 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 19:13:28,145 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(293), '17612': np.int64(535), '17904': np.int64(150), '18675': np.int64(765)}
2025-07-09 19:13:28,146 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 19:13:28,148 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 19:13:28,150 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 19:13:28,152 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 19:13:28,155 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:13:28,156 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(282), '17612': np.int64(301), '17904': np.int64(136), '18675': np.int64(765)}
2025-07-09 19:13:28,157 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 19:13:28,158 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(282), '17612': np.int64(301), '17904': np.int64(136), '18675': np.int64(765)}
2025-07-09 19:13:28,159 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 19:13:28,161 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 19:13:28,163 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 19:13:28,165 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 19:13:28,166 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:13:28,167 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(270), '17612': np.int64(218), '17904': np.int64(135), '18675': np.int64(765)}
2025-07-09 19:13:28,168 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 19:13:28,168 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(270), '17612': np.int64(218), '17904': np.int64(135), '18675': np.int64(765)}
2025-07-09 19:13:28,171 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:13:28,173 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:13:28,175 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:13:28,177 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:13:28,177 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(270), '17612': np.int64(218), '17904': np.int64(135), '18675': np.int64(765)}
2025-07-09 19:13:28,177 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 19:13:28,178 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(270), '17612': np.int64(218), '17904': np.int64(135), '18675': np.int64(765)}
2025-07-09 19:13:28,179 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:13:28,181 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:13:28,182 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:13:28,183 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:13:28,183 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(270), '17612': np.int64(218), '17904': np.int64(135), '18675': np.int64(765)}
2025-07-09 19:13:28,184 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 19:13:28,185 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(270), '17612': np.int64(218), '17904': np.int64(135), '18675': np.int64(765)}
2025-07-09 19:13:28,186 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 19:13:28,189 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 19:13:28,192 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 19:13:28,194 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 19:13:28,196 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 19:13:28,196 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(267), '17612': np.int64(54), '17904': np.int64(133), '18675': np.int64(762)}
2025-07-09 19:13:28,197 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 19:13:28,197 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(267), '17612': np.int64(54), '17904': np.int64(133), '18675': np.int64(762)}
2025-07-09 19:13:28,198 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 19:13:28,199 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 19:13:28,200 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 19:13:28,202 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 19:13:28,204 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 19:13:28,205 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(256), '17612': np.int64(-2), '17904': np.int64(132), '18675': np.int64(750)}
2025-07-09 19:13:28,206 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 19:13:28,206 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(256), '17612': np.int64(-2), '17904': np.int64(132), '18675': np.int64(750)}
2025-07-09 19:13:28,207 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 19:13:28,209 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 19:13:28,210 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 19:13:28,212 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 19:13:28,213 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:13:28,214 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(255), '17612': np.int64(517), '17904': np.int64(131), '18675': np.int64(750)}
2025-07-09 19:13:28,214 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 19:13:28,214 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(255), '17612': np.int64(517), '17904': np.int64(131), '18675': np.int64(750)}
2025-07-09 19:13:28,215 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 19:13:28,216 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 19:13:28,218 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 19:13:28,221 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 19:13:28,223 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:13:28,224 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(248), '17612': np.int64(470), '17904': np.int64(129), '18675': np.int64(750)}
2025-07-09 19:13:28,224 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 19:13:28,225 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(248), '17612': np.int64(470), '17904': np.int64(129), '18675': np.int64(750)}
2025-07-09 19:13:28,225 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 19:13:28,227 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 19:13:28,228 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 19:13:28,230 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 19:13:28,231 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 19:13:28,232 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(243), '17612': np.int64(394), '17904': np.int64(128), '18675': np.int64(749)}
2025-07-09 19:13:28,232 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 19:13:28,232 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(243), '17612': np.int64(394), '17904': np.int64(128), '18675': np.int64(749)}
2025-07-09 19:13:28,235 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:13:28,237 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:13:28,240 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:13:28,241 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:13:28,241 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(243), '17612': np.int64(394), '17904': np.int64(128), '18675': np.int64(749)}
2025-07-09 19:13:28,242 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 19:13:28,242 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(243), '17612': np.int64(394), '17904': np.int64(128), '18675': np.int64(749)}
2025-07-09 19:13:28,244 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:13:28,245 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:13:28,246 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:13:28,248 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:13:28,248 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(243), '17612': np.int64(394), '17904': np.int64(128), '18675': np.int64(749)}
2025-07-09 19:13:28,248 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 19:13:28,249 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(243), '17612': np.int64(394), '17904': np.int64(128), '18675': np.int64(749)}
2025-07-09 19:13:28,249 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 19:13:28,251 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:13:28,254 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 19:13:28,256 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 19:13:28,258 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:13:28,258 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(243), '17612': np.int64(749), '17904': np.int64(122), '18675': np.int64(749)}
2025-07-09 19:13:28,259 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 19:13:28,259 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(243), '17612': np.int64(749), '17904': np.int64(122), '18675': np.int64(749)}
2025-07-09 19:13:28,260 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 19:13:28,262 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 19:13:28,263 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 19:13:28,265 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 19:13:28,266 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:13:28,266 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(242), '17612': np.int64(707), '17904': np.int64(121), '18675': np.int64(749)}
2025-07-09 19:13:28,267 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 19:13:28,267 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(242), '17612': np.int64(707), '17904': np.int64(121), '18675': np.int64(749)}
2025-07-09 19:13:28,267 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 19:13:28,269 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 19:13:28,271 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 19:13:28,274 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 19:13:28,275 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:13:28,276 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(238), '17612': np.int64(534), '17904': np.int64(120), '18675': np.int64(749)}
2025-07-09 19:13:28,276 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 19:13:28,276 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(238), '17612': np.int64(534), '17904': np.int64(120), '18675': np.int64(749)}
2025-07-09 19:13:28,277 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 19:13:28,278 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 19:13:28,280 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 19:13:28,281 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 19:13:28,283 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:13:28,283 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(229), '17612': np.int64(474), '17904': np.int64(118), '18675': np.int64(749)}
2025-07-09 19:13:28,283 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 19:13:28,284 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(229), '17612': np.int64(474), '17904': np.int64(118), '18675': np.int64(749)}
2025-07-09 19:13:28,285 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 19:13:28,287 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 19:13:28,290 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 19:13:28,292 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 19:13:28,294 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:13:28,294 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(223), '17612': np.int64(423), '17904': np.int64(115), '18675': np.int64(749)}
2025-07-09 19:13:28,294 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 19:13:28,295 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(223), '17612': np.int64(423), '17904': np.int64(115), '18675': np.int64(749)}
2025-07-09 19:13:28,296 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:13:28,298 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:13:28,299 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:13:28,300 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:13:28,300 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(223), '17612': np.int64(423), '17904': np.int64(115), '18675': np.int64(749)}
2025-07-09 19:13:28,301 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 19:13:28,301 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(223), '17612': np.int64(423), '17904': np.int64(115), '18675': np.int64(749)}
2025-07-09 19:13:28,303 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:13:28,305 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:13:28,307 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:13:28,308 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:13:28,309 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(223), '17612': np.int64(423), '17904': np.int64(115), '18675': np.int64(749)}
2025-07-09 19:13:28,309 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 19:13:28,309 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(223), '17612': np.int64(423), '17904': np.int64(115), '18675': np.int64(749)}
2025-07-09 19:13:28,310 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 19:13:28,311 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 19:13:28,312 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 19:13:28,314 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 19:13:28,316 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:13:28,316 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(222), '17612': np.int64(339), '17904': np.int64(112), '18675': np.int64(749)}
2025-07-09 19:13:28,319 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
5  2025-06-02  17612            955            884
2025-07-09 19:13:28,320 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
117  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-09 19:13:28,321 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 19:13:28,321 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 19:13:28,323 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
5  2025-06-02  17612            955            884
2025-07-09 19:13:28,324 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
117  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-09 19:13:28,325 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 19:13:28,326 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 19:13:28,328 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01            955
5    2025-06-02            884
9    2025-06-03            790
13   2025-06-04           1149
17   2025-06-05            853
21   2025-06-06            736
25   2025-06-07            736
29   2025-06-08            736
33   2025-06-09            689
37   2025-06-10            602
41   2025-06-11            535
45   2025-06-12            301
49   2025-06-13            218
53   2025-06-14            218
57   2025-06-15            218
61   2025-06-16             54
65   2025-06-17             -2
69   2025-06-18            517
73   2025-06-19            470
77   2025-06-20            394
81   2025-06-21            394
85   2025-06-22            394
89   2025-06-23            749
93   2025-06-24            707
97   2025-06-25            534
101  2025-06-26            474
105  2025-06-27            423
109  2025-06-28            423
113  2025-06-29            423
117  2025-06-30            339
2025-07-09 19:13:28,330 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            178
6    2025-06-02            176
10   2025-06-03            163
14   2025-06-04            156
18   2025-06-05            155
22   2025-06-06            153
26   2025-06-07            153
30   2025-06-08            153
34   2025-06-09            151
38   2025-06-10            151
42   2025-06-11            150
46   2025-06-12            136
50   2025-06-13            135
54   2025-06-14            135
58   2025-06-15            135
62   2025-06-16            133
66   2025-06-17            132
70   2025-06-18            131
74   2025-06-19            129
78   2025-06-20            128
82   2025-06-21            128
86   2025-06-22            128
90   2025-06-23            122
94   2025-06-24            121
98   2025-06-25            120
102  2025-06-26            118
106  2025-06-27            115
110  2025-06-28            115
114  2025-06-29            115
118  2025-06-30            112
2025-07-09 19:13:28,332 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
2025-07-09 19:13:28,337 - src.services.reporting_logic.monthly_report_generator - INFO - Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 19:13:28,343 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 19:13:28,345 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 19:13:28,346 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           20
5    2025-06-02           19
9    2025-06-03           17
13   2025-06-04           24
17   2025-06-05           18
21   2025-06-06           16
25   2025-06-07           16
29   2025-06-08           16
33   2025-06-09           15
37   2025-06-10           13
41   2025-06-11           12
45   2025-06-12            7
49   2025-06-13            5
53   2025-06-14            5
57   2025-06-15            5
61   2025-06-16            2
65   2025-06-17            0
69   2025-06-18           11
73   2025-06-19           10
77   2025-06-20            9
81   2025-06-21            9
85   2025-06-22            9
89   2025-06-23           16
93   2025-06-24           15
97   2025-06-25           12
101  2025-06-26           10
105  2025-06-27            9
109  2025-06-28            9
113  2025-06-29            9
117  2025-06-30            8
2025-07-09 19:13:28,347 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 19:13:28,347 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 19:13:28,349 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 19:13:28,349 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 19:13:28,351 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 19:13:28,352 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 19:13:28,353 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 19:13:28,357 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 19:13:28,358 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 19:13:28,359 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 19:13:28,360 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 19:13:28,363 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 19:13:28,364 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 19:13:28,366 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:13:28,367 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 19:13:28,369 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:13:28,370 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 19:13:28,371 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:13:28,373 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 19:13:28,374 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:13:28,374 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 19:13:28,375 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 19:13:28,376 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:13:28,377 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:13:28,377 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:13:28,379 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:13:28,380 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:13:28,381 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:13:28,381 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 19:13:28,383 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 19:13:28,384 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 19:13:28,388 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:13:28,388 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 19:13:28,393 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 19:13:28,400 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (head):
2025-07-09 19:13:28,405 - src.services.reporting_logic.monthly_report_generator - DEBUG -        Date  # Of Orders  17612 17904 17914 18675 18795   Orders Packages Space Rental    Total
0  6/1/2025          0.0    0.0   0.0   0.0   0.0   0.0    $0.00    $0.00       $20.25   $20.25
1  6/2/2025         19.0   71.0   2.0   3.0   1.0   0.0   $80.75   $57.75       $19.35  $157.85
2  6/3/2025         22.0   94.0  13.0   6.0   0.0   0.0   $93.50   $84.75       $18.00  $196.25
3  6/4/2025         35.0  119.0   7.0   7.0   0.0   0.0  $148.75   $99.75       $21.15  $269.65
4  6/5/2025         83.0  296.0   1.0   7.0   0.0   0.0  $352.75  $228.00       $18.45  $599.20
2025-07-09 19:13:28,405 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (columns and dtypes):
2025-07-09 19:13:28,410 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:13:28,411 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (tail):
2025-07-09 19:13:28,413 - src.services.reporting_logic.monthly_report_generator - DEBUG -          Date  # Of Orders   17612 17904  17914 18675 18795    Orders  Packages Space Rental     Total
26  6/27/2025         17.0    51.0   3.0    6.0   0.0   0.0    $72.25    $45.00       $13.50   $130.75
27  6/28/2025          0.0     0.0   0.0    0.0   0.0   0.0     $0.00     $0.00       $13.50    $13.50
28  6/29/2025          0.0     0.0   0.0    0.0   0.0   0.0     $0.00     $0.00       $13.50    $13.50
29  6/30/2025         10.0    84.0   3.0    1.0   0.0   0.0    $42.50    $66.00       $13.05   $121.55
30      TOTAL        552.0  2046.0  66.0  104.0  20.0   0.0  $2346.00  $1677.00      $459.90  $4482.90
2025-07-09 19:13:28,413 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 19:13:28,414 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 19:13:28,414 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:13:28,415 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:13:28,417 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:13:28,637 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:13:28,638 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:13:28,639 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:13:28,639 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 19:13:28,663 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:13:28,805 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:13:28,807 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:13:29,112 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:29,217 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:29,369 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:13:29,493 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:13:29,494 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-09 19:13:29,639 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:13:29,640 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-09 19:13:29,641 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 19:13:29,642 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 19:13:29,643 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 19:13:29,644 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 19:13:29,645 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 19:13:29,647 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 19:13:29,648 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 19:13:29,656 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 19:13:29,659 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 19:13:29,661 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 19:13:29,669 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 19:13:29,670 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 19:13:29,673 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 19:13:29,677 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 19:13:29,681 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 19:13:29,683 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:13:29,683 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:13:29,684 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 19:13:29,692 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:13:29,694 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:13:29,701 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:13:29,956 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:13:29,959 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:13:29,961 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:13:29,962 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 19:13:30,016 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:13:30,167 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:13:30,171 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:13:30,353 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:30,452 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:13:30,590 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:13:30,720 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:13:30,724 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 19:13:30,852 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:13:30,855 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 19:13:30,857 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 19:13:30,859 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 19:13:30,860 - __main__ - INFO - Script finished successfully.
2025-07-09 19:15:47,434 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 19:15:47,435 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 19:15:47,784 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 19:15:47,784 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 19:15:47,785 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:15:47,786 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:15:47,799 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:15:48,066 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:15:48,069 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:15:48,069 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:15:48,070 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:15:48,093 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:15:48,271 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:15:48,275 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:15:48,683 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:48,797 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:48,799 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 19:15:48,924 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 19:15:48,926 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 19:15:48,931 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 19:15:48,932 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 19:15:48,933 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:15:48,933 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:15:48,936 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:15:49,172 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:15:49,174 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:15:49,175 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:15:49,175 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:15:49,202 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:15:49,369 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:15:49,371 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:15:49,559 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:49,673 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:49,674 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 19:15:49,797 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 19:15:49,799 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 19:15:49,800 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 19:15:49,801 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 19:15:49,806 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 19:15:49,807 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 19:15:49,807 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 19:15:49,807 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:15:49,808 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:15:49,810 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:15:50,033 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:15:50,036 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:15:50,037 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:15:50,037 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:15:50,061 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:15:50,232 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:15:50,235 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:15:50,425 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:50,552 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:50,555 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 19:15:50,681 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 19:15:50,686 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 19:15:50,692 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 19:15:50,693 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:15:50,696 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 19:15:50,697 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 19:15:50,698 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 19:15:50,698 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:15:50,699 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:15:50,701 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 19:15:50,702 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:15:50,704 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 19:15:50,706 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 19:15:50,707 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 19:15:50,708 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:15:50,708 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:15:50,711 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:15:50,937 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:15:50,939 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:15:50,940 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:15:50,941 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:15:50,964 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:15:51,129 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:15:51,130 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:15:51,346 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:51,454 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:51,455 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 19:15:51,577 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 19:15:51,581 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 19:15:51,584 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 19:15:51,585 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 19:15:51,585 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:15:51,586 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:15:51,588 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:15:51,824 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:15:51,826 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:15:51,826 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:15:51,827 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:15:51,849 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:15:52,008 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:15:52,010 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:15:52,222 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:52,347 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:52,348 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 19:15:52,502 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 19:15:52,503 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 19:15:52,508 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 19:15:52,509 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 19:15:52,509 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:15:52,510 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:15:52,512 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:15:52,745 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:15:52,748 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:15:52,748 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:15:52,749 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:15:52,774 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:15:52,920 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:15:52,923 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:15:53,094 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:53,211 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:53,213 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 19:15:53,332 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 19:15:53,335 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 19:15:53,337 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 19:15:53,338 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 19:15:53,339 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 19:15:53,344 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 19:15:53,346 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 19:15:53,346 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 19:15:53,347 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 19:15:53,348 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 19:15:53,349 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 19:15:53,351 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 19:15:53,352 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 19:15:53,353 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 19:15:53,354 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 19:15:53,355 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 19:15:53,357 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 19:15:53,358 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 326, '18675': 769, '17904': 178, '17612': 955}
2025-07-09 19:15:53,358 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 19:15:53,359 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 326, '18675': 769, '17904': 178, '17612': 955}
2025-07-09 19:15:53,361 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 19:15:53,362 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 19:15:53,363 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 19:15:53,365 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 19:15:53,365 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(326), '18675': np.int64(769), '17904': np.int64(178), '17612': np.int64(955)}
2025-07-09 19:15:53,366 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 19:15:53,366 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(326), '18675': np.int64(769), '17904': np.int64(178), '17612': np.int64(955)}
2025-07-09 19:15:53,367 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 19:15:53,369 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 19:15:53,372 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 19:15:53,374 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 19:15:53,375 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 19:15:53,376 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(323), '18675': np.int64(768), '17904': np.int64(176), '17612': np.int64(884)}
2025-07-09 19:15:53,376 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 19:15:53,376 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(323), '18675': np.int64(768), '17904': np.int64(176), '17612': np.int64(884)}
2025-07-09 19:15:53,377 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 19:15:53,379 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 19:15:53,381 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:15:53,382 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 19:15:53,384 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 19:15:53,385 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(317), '18675': np.int64(768), '17904': np.int64(163), '17612': np.int64(790)}
2025-07-09 19:15:53,385 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 19:15:53,386 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(317), '18675': np.int64(768), '17904': np.int64(163), '17612': np.int64(790)}
2025-07-09 19:15:53,387 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 19:15:53,390 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 19:15:53,391 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:15:53,392 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 19:15:53,394 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 19:15:53,394 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(310), '18675': np.int64(768), '17904': np.int64(156), '17612': np.int64(1149)}
2025-07-09 19:15:53,395 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 19:15:53,395 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(310), '18675': np.int64(768), '17904': np.int64(156), '17612': np.int64(1149)}
2025-07-09 19:15:53,396 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 19:15:53,397 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 19:15:53,399 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:15:53,400 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 19:15:53,403 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 19:15:53,403 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(303), '18675': np.int64(768), '17904': np.int64(155), '17612': np.int64(853)}
2025-07-09 19:15:53,404 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 19:15:53,405 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(303), '18675': np.int64(768), '17904': np.int64(155), '17612': np.int64(853)}
2025-07-09 19:15:53,406 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 19:15:53,407 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 19:15:53,409 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 19:15:53,410 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 19:15:53,412 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 19:15:53,412 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(302), '18675': np.int64(767), '17904': np.int64(153), '17612': np.int64(736)}
2025-07-09 19:15:53,412 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 19:15:53,413 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(302), '18675': np.int64(767), '17904': np.int64(153), '17612': np.int64(736)}
2025-07-09 19:15:53,415 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:15:53,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:15:53,417 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:15:53,419 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:15:53,420 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(302), '18675': np.int64(767), '17904': np.int64(153), '17612': np.int64(736)}
2025-07-09 19:15:53,421 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 19:15:53,421 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(302), '18675': np.int64(767), '17904': np.int64(153), '17612': np.int64(736)}
2025-07-09 19:15:53,423 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:15:53,425 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:15:53,427 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:15:53,427 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:15:53,428 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(302), '18675': np.int64(767), '17904': np.int64(153), '17612': np.int64(736)}
2025-07-09 19:15:53,428 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 19:15:53,429 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(302), '18675': np.int64(767), '17904': np.int64(153), '17612': np.int64(736)}
2025-07-09 19:15:53,429 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 19:15:53,431 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 19:15:53,432 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 19:15:53,434 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 19:15:53,436 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 19:15:53,436 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(299), '18675': np.int64(766), '17904': np.int64(151), '17612': np.int64(689)}
2025-07-09 19:15:53,437 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 19:15:53,438 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(299), '18675': np.int64(766), '17904': np.int64(151), '17612': np.int64(689)}
2025-07-09 19:15:53,439 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 19:15:53,440 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 19:15:53,442 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 19:15:53,443 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 19:15:53,445 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 19:15:53,445 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(296), '18675': np.int64(766), '17904': np.int64(151), '17612': np.int64(602)}
2025-07-09 19:15:53,446 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 19:15:53,446 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(296), '18675': np.int64(766), '17904': np.int64(151), '17612': np.int64(602)}
2025-07-09 19:15:53,447 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 19:15:53,449 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 19:15:53,450 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 19:15:53,452 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 19:15:53,454 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 19:15:53,455 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(293), '18675': np.int64(765), '17904': np.int64(150), '17612': np.int64(535)}
2025-07-09 19:15:53,455 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 19:15:53,455 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(293), '18675': np.int64(765), '17904': np.int64(150), '17612': np.int64(535)}
2025-07-09 19:15:53,456 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 19:15:53,458 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 19:15:53,459 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:15:53,462 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 19:15:53,462 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 19:15:53,463 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(282), '18675': np.int64(765), '17904': np.int64(136), '17612': np.int64(301)}
2025-07-09 19:15:53,463 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 19:15:53,463 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(282), '18675': np.int64(765), '17904': np.int64(136), '17612': np.int64(301)}
2025-07-09 19:15:53,464 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 19:15:53,466 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 19:15:53,468 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:15:53,469 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 19:15:53,472 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 19:15:53,473 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(270), '18675': np.int64(765), '17904': np.int64(135), '17612': np.int64(218)}
2025-07-09 19:15:53,473 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 19:15:53,473 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(270), '18675': np.int64(765), '17904': np.int64(135), '17612': np.int64(218)}
2025-07-09 19:15:53,474 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:15:53,476 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:15:53,477 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:15:53,478 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:15:53,479 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(270), '18675': np.int64(765), '17904': np.int64(135), '17612': np.int64(218)}
2025-07-09 19:15:53,479 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 19:15:53,479 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(270), '18675': np.int64(765), '17904': np.int64(135), '17612': np.int64(218)}
2025-07-09 19:15:53,481 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:15:53,482 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:15:53,483 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:15:53,485 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:15:53,486 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(270), '18675': np.int64(765), '17904': np.int64(135), '17612': np.int64(218)}
2025-07-09 19:15:53,486 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 19:15:53,486 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(270), '18675': np.int64(765), '17904': np.int64(135), '17612': np.int64(218)}
2025-07-09 19:15:53,489 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 19:15:53,490 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 19:15:53,492 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 19:15:53,493 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 19:15:53,495 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 19:15:53,495 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(267), '18675': np.int64(762), '17904': np.int64(133), '17612': np.int64(54)}
2025-07-09 19:15:53,495 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 19:15:53,495 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(267), '18675': np.int64(762), '17904': np.int64(133), '17612': np.int64(54)}
2025-07-09 19:15:53,496 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 19:15:53,497 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 19:15:53,500 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 19:15:53,501 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 19:15:53,503 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 19:15:53,504 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(256), '18675': np.int64(750), '17904': np.int64(132), '17612': np.int64(-2)}
2025-07-09 19:15:53,504 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 19:15:53,504 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(256), '18675': np.int64(750), '17904': np.int64(132), '17612': np.int64(-2)}
2025-07-09 19:15:53,506 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 19:15:53,507 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 19:15:53,508 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:15:53,510 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 19:15:53,512 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 19:15:53,512 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(255), '18675': np.int64(750), '17904': np.int64(131), '17612': np.int64(517)}
2025-07-09 19:15:53,512 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 19:15:53,513 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(255), '18675': np.int64(750), '17904': np.int64(131), '17612': np.int64(517)}
2025-07-09 19:15:53,513 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 19:15:53,515 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 19:15:53,516 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:15:53,518 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 19:15:53,519 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 19:15:53,520 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(248), '18675': np.int64(750), '17904': np.int64(129), '17612': np.int64(470)}
2025-07-09 19:15:53,521 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 19:15:53,521 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(248), '18675': np.int64(750), '17904': np.int64(129), '17612': np.int64(470)}
2025-07-09 19:15:53,522 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 19:15:53,524 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 19:15:53,526 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 19:15:53,527 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 19:15:53,529 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 19:15:53,529 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(243), '18675': np.int64(749), '17904': np.int64(128), '17612': np.int64(394)}
2025-07-09 19:15:53,530 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 19:15:53,530 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(243), '18675': np.int64(749), '17904': np.int64(128), '17612': np.int64(394)}
2025-07-09 19:15:53,531 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:15:53,533 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:15:53,535 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:15:53,537 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:15:53,538 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(243), '18675': np.int64(749), '17904': np.int64(128), '17612': np.int64(394)}
2025-07-09 19:15:53,539 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 19:15:53,539 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(243), '18675': np.int64(749), '17904': np.int64(128), '17612': np.int64(394)}
2025-07-09 19:15:53,541 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:15:53,543 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:15:53,544 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:15:53,546 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:15:53,546 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(243), '18675': np.int64(749), '17904': np.int64(128), '17612': np.int64(394)}
2025-07-09 19:15:53,547 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 19:15:53,547 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(243), '18675': np.int64(749), '17904': np.int64(128), '17612': np.int64(394)}
2025-07-09 19:15:53,548 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 19:15:53,550 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:15:53,553 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:15:53,556 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 19:15:53,558 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 19:15:53,558 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(243), '18675': np.int64(749), '17904': np.int64(122), '17612': np.int64(749)}
2025-07-09 19:15:53,559 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 19:15:53,559 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(243), '18675': np.int64(749), '17904': np.int64(122), '17612': np.int64(749)}
2025-07-09 19:15:53,560 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 19:15:53,562 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 19:15:53,564 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:15:53,565 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 19:15:53,568 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 19:15:53,568 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(242), '18675': np.int64(749), '17904': np.int64(121), '17612': np.int64(707)}
2025-07-09 19:15:53,569 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 19:15:53,569 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(242), '18675': np.int64(749), '17904': np.int64(121), '17612': np.int64(707)}
2025-07-09 19:15:53,570 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 19:15:53,573 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 19:15:53,574 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:15:53,576 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 19:15:53,578 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 19:15:53,578 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(238), '18675': np.int64(749), '17904': np.int64(120), '17612': np.int64(534)}
2025-07-09 19:15:53,579 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 19:15:53,579 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(238), '18675': np.int64(749), '17904': np.int64(120), '17612': np.int64(534)}
2025-07-09 19:15:53,580 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 19:15:53,581 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 19:15:53,583 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:15:53,584 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 19:15:53,587 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 19:15:53,587 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(229), '18675': np.int64(749), '17904': np.int64(118), '17612': np.int64(474)}
2025-07-09 19:15:53,587 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 19:15:53,588 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(229), '18675': np.int64(749), '17904': np.int64(118), '17612': np.int64(474)}
2025-07-09 19:15:53,589 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 19:15:53,591 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 19:15:53,592 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:15:53,594 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 19:15:53,595 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 19:15:53,595 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(223), '18675': np.int64(749), '17904': np.int64(115), '17612': np.int64(423)}
2025-07-09 19:15:53,596 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 19:15:53,596 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(223), '18675': np.int64(749), '17904': np.int64(115), '17612': np.int64(423)}
2025-07-09 19:15:53,598 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:15:53,600 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:15:53,601 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:15:53,603 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:15:53,604 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(223), '18675': np.int64(749), '17904': np.int64(115), '17612': np.int64(423)}
2025-07-09 19:15:53,604 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 19:15:53,604 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(223), '18675': np.int64(749), '17904': np.int64(115), '17612': np.int64(423)}
2025-07-09 19:15:53,607 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:15:53,608 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:15:53,609 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:15:53,610 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:15:53,611 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(223), '18675': np.int64(749), '17904': np.int64(115), '17612': np.int64(423)}
2025-07-09 19:15:53,611 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 19:15:53,611 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(223), '18675': np.int64(749), '17904': np.int64(115), '17612': np.int64(423)}
2025-07-09 19:15:53,612 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 19:15:53,614 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 19:15:53,616 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:15:53,618 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 19:15:53,620 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 19:15:53,621 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(222), '18675': np.int64(749), '17904': np.int64(112), '17612': np.int64(339)}
2025-07-09 19:15:53,624 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
1  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 19:15:53,625 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
113  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
117  2025-06-30  18675            749            749
2025-07-09 19:15:53,626 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 19:15:53,626 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 19:15:53,627 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
1  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 19:15:53,627 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
113  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
117  2025-06-30  18675            749            749
2025-07-09 19:15:53,628 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 19:15:53,629 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 19:15:53,631 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01            955
7    2025-06-02            884
11   2025-06-03            790
15   2025-06-04           1149
19   2025-06-05            853
23   2025-06-06            736
27   2025-06-07            736
31   2025-06-08            736
35   2025-06-09            689
39   2025-06-10            602
43   2025-06-11            535
47   2025-06-12            301
51   2025-06-13            218
55   2025-06-14            218
59   2025-06-15            218
63   2025-06-16             54
67   2025-06-17             -2
71   2025-06-18            517
75   2025-06-19            470
79   2025-06-20            394
83   2025-06-21            394
87   2025-06-22            394
91   2025-06-23            749
95   2025-06-24            707
99   2025-06-25            534
103  2025-06-26            474
107  2025-06-27            423
111  2025-06-28            423
115  2025-06-29            423
119  2025-06-30            339
2025-07-09 19:15:53,633 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            178
6    2025-06-02            176
10   2025-06-03            163
14   2025-06-04            156
18   2025-06-05            155
22   2025-06-06            153
26   2025-06-07            153
30   2025-06-08            153
34   2025-06-09            151
38   2025-06-10            151
42   2025-06-11            150
46   2025-06-12            136
50   2025-06-13            135
54   2025-06-14            135
58   2025-06-15            135
62   2025-06-16            133
66   2025-06-17            132
70   2025-06-18            131
74   2025-06-19            129
78   2025-06-20            128
82   2025-06-21            128
86   2025-06-22            128
90   2025-06-23            122
94   2025-06-24            121
98   2025-06-25            120
102  2025-06-26            118
106  2025-06-27            115
110  2025-06-28            115
114  2025-06-29            115
118  2025-06-30            112
2025-07-09 19:15:53,635 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
2025-07-09 19:15:53,641 - src.services.reporting_logic.monthly_report_generator - INFO - Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 19:15:53,645 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 19:15:53,647 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 19:15:53,647 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           20
7    2025-06-02           19
11   2025-06-03           17
15   2025-06-04           24
19   2025-06-05           18
23   2025-06-06           16
27   2025-06-07           16
31   2025-06-08           16
35   2025-06-09           15
39   2025-06-10           13
43   2025-06-11           12
47   2025-06-12            7
51   2025-06-13            5
55   2025-06-14            5
59   2025-06-15            5
63   2025-06-16            2
67   2025-06-17            0
71   2025-06-18           11
75   2025-06-19           10
79   2025-06-20            9
83   2025-06-21            9
87   2025-06-22            9
91   2025-06-23           16
95   2025-06-24           15
99   2025-06-25           12
103  2025-06-26           10
107  2025-06-27            9
111  2025-06-28            9
115  2025-06-29            9
119  2025-06-30            8
2025-07-09 19:15:53,649 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 19:15:53,649 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 19:15:53,650 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 19:15:53,651 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 19:15:53,653 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 19:15:53,655 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 19:15:53,656 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 19:15:53,661 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 19:15:53,661 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 19:15:53,662 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 19:15:53,663 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 19:15:53,666 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 19:15:53,668 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 19:15:53,669 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:15:53,670 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 19:15:53,672 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:15:53,673 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 19:15:53,674 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:15:53,675 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 19:15:53,676 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:15:53,677 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 19:15:53,677 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 19:15:53,678 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:15:53,678 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:15:53,679 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:15:53,680 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:15:53,681 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:15:53,681 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:15:53,682 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 19:15:53,684 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 19:15:53,685 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 19:15:53,689 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:15:53,690 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 19:15:53,692 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 19:15:53,698 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (head):
2025-07-09 19:15:53,700 - src.services.reporting_logic.monthly_report_generator - DEBUG -        Date  # Of Orders  17612 17904 17914 18675 18795   Orders Packages Space Rental    Total
0  6/1/2025          0.0      -     -     -     -     -    $0.00    $0.00       $20.25   $20.25
1  6/2/2025         19.0   71.0   2.0   3.0   1.0     -   $80.75   $57.75       $19.35  $157.85
2  6/3/2025         22.0   94.0  13.0   6.0     -     -   $93.50   $84.75       $18.00  $196.25
3  6/4/2025         35.0  119.0   7.0   7.0     -     -  $148.75   $99.75       $21.15  $269.65
4  6/5/2025         83.0  296.0   1.0   7.0     -     -  $352.75  $228.00       $18.45  $599.20
2025-07-09 19:15:53,700 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (columns and dtypes):
2025-07-09 19:15:53,703 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:15:53,703 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (tail):
2025-07-09 19:15:53,706 - src.services.reporting_logic.monthly_report_generator - DEBUG -          Date  # Of Orders   17612 17904  17914 18675 18795    Orders  Packages Space Rental     Total
26  6/27/2025         17.0    51.0   3.0    6.0     -     -    $72.25    $45.00       $13.50   $130.75
27  6/28/2025          0.0       -     -      -     -     -     $0.00     $0.00       $13.50    $13.50
28  6/29/2025          0.0       -     -      -     -     -     $0.00     $0.00       $13.50    $13.50
29  6/30/2025         10.0    84.0   3.0    1.0     -     -    $42.50    $66.00       $13.05   $121.55
30      TOTAL        552.0  2046.0  66.0  104.0  20.0     -  $2346.00  $1677.00      $459.90  $4482.90
2025-07-09 19:15:53,707 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 19:15:53,707 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 19:15:53,707 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:15:53,707 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:15:53,710 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:15:53,948 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:15:53,951 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:15:53,952 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:15:53,953 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 19:15:53,975 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:15:54,130 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:15:54,132 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:15:54,318 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:54,441 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:54,580 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:15:54,722 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:15:54,724 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-09 19:15:55,248 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:15:55,250 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-09 19:15:55,251 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 19:15:55,253 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 19:15:55,255 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 19:15:55,256 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 19:15:55,257 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 19:15:55,264 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 19:15:55,265 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 19:15:55,273 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 19:15:55,276 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 19:15:55,278 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 19:15:55,288 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 19:15:55,289 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 19:15:55,295 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 19:15:55,299 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 19:15:55,306 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 19:15:55,307 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:15:55,308 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:15:55,310 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 19:15:55,320 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:15:55,321 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:15:55,330 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:15:55,620 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:15:55,624 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:15:55,626 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:15:55,627 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 19:15:55,694 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:15:55,913 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:15:55,918 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:15:56,194 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:56,316 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:15:56,460 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:15:56,603 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:15:56,606 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 19:15:56,727 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:15:56,728 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 19:15:56,730 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 19:15:56,731 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 19:15:56,731 - __main__ - INFO - Script finished successfully.
2025-07-09 19:18:45,551 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 19:18:45,551 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 19:18:45,888 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 19:18:45,888 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 19:18:45,888 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:18:45,889 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:18:45,901 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:18:46,219 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:18:46,221 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:18:46,222 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:18:46,223 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:18:46,246 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:18:46,419 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:18:46,421 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:18:46,655 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:46,758 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:46,760 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 19:18:46,942 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 19:18:46,943 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 19:18:46,949 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 19:18:46,950 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 19:18:46,950 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:18:46,951 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:18:46,955 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:18:47,203 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:18:47,204 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:18:47,205 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:18:47,205 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:18:47,229 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:18:47,397 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:18:47,399 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:18:47,574 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:47,680 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:47,682 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 19:18:47,804 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 19:18:47,805 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 19:18:47,808 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 19:18:47,808 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 19:18:47,812 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 19:18:47,814 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 19:18:47,815 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 19:18:47,815 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:18:47,816 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:18:47,818 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:18:48,046 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:18:48,049 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:18:48,052 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:18:48,053 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:18:48,077 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:18:48,220 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:18:48,221 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:18:48,408 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:48,584 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:48,585 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 19:18:48,711 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 19:18:48,716 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 19:18:48,723 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 19:18:48,724 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:18:48,726 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 19:18:48,727 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 19:18:48,728 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 19:18:48,728 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:18:48,729 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:18:48,732 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 19:18:48,732 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:18:48,733 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 19:18:48,734 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 19:18:48,734 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 19:18:48,735 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:18:48,736 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:18:48,740 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:18:49,044 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:18:49,045 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:18:49,046 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:18:49,047 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:18:49,071 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:18:49,242 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:18:49,244 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:18:49,434 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:49,536 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:49,539 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 19:18:49,656 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 19:18:49,660 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 19:18:49,663 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 19:18:49,664 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 19:18:49,664 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:18:49,665 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:18:49,669 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:18:49,996 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:18:50,000 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:18:50,001 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:18:50,002 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:18:50,025 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:18:50,175 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:18:50,177 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:18:50,366 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:50,473 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:50,475 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 19:18:50,716 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 19:18:50,718 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 19:18:50,725 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 19:18:50,727 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 19:18:50,727 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:18:50,728 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:18:50,731 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:18:50,975 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:18:50,977 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:18:50,977 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:18:50,978 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:18:51,001 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:18:51,160 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:18:51,162 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:18:51,410 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:51,515 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:51,515 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 19:18:51,645 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 19:18:51,647 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 19:18:51,648 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 19:18:51,649 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 19:18:51,650 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 19:18:51,655 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 19:18:51,656 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 19:18:51,658 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 19:18:51,659 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 19:18:51,660 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 19:18:51,661 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 19:18:51,663 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 19:18:51,663 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 19:18:51,664 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 19:18:51,664 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 19:18:51,664 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 19:18:51,665 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 19:18:51,666 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17904': 178, '17914': 326, '17612': 955, '18675': 769}
2025-07-09 19:18:51,667 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 19:18:51,667 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17904': 178, '17914': 326, '17612': 955, '18675': 769}
2025-07-09 19:18:51,671 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 19:18:51,673 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 19:18:51,674 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 19:18:51,675 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 19:18:51,676 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17904': np.int64(178), '17914': np.int64(326), '17612': np.int64(955), '18675': np.int64(769)}
2025-07-09 19:18:51,676 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 19:18:51,677 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17904': np.int64(178), '17914': np.int64(326), '17612': np.int64(955), '18675': np.int64(769)}
2025-07-09 19:18:51,678 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 19:18:51,680 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 19:18:51,681 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 19:18:51,683 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 19:18:51,686 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 19:18:51,687 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17904': np.int64(176), '17914': np.int64(323), '17612': np.int64(884), '18675': np.int64(768)}
2025-07-09 19:18:51,687 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 19:18:51,688 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17904': np.int64(176), '17914': np.int64(323), '17612': np.int64(884), '18675': np.int64(768)}
2025-07-09 19:18:51,689 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 19:18:51,691 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 19:18:51,692 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 19:18:51,694 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 19:18:51,696 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:18:51,696 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17904': np.int64(163), '17914': np.int64(317), '17612': np.int64(790), '18675': np.int64(768)}
2025-07-09 19:18:51,696 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 19:18:51,696 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17904': np.int64(163), '17914': np.int64(317), '17612': np.int64(790), '18675': np.int64(768)}
2025-07-09 19:18:51,697 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 19:18:51,699 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 19:18:51,700 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 19:18:51,703 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 19:18:51,705 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:18:51,706 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17904': np.int64(156), '17914': np.int64(310), '17612': np.int64(1149), '18675': np.int64(768)}
2025-07-09 19:18:51,707 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 19:18:51,707 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17904': np.int64(156), '17914': np.int64(310), '17612': np.int64(1149), '18675': np.int64(768)}
2025-07-09 19:18:51,708 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 19:18:51,710 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 19:18:51,711 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 19:18:51,712 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 19:18:51,714 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:18:51,714 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17904': np.int64(155), '17914': np.int64(303), '17612': np.int64(853), '18675': np.int64(768)}
2025-07-09 19:18:51,714 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 19:18:51,715 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17904': np.int64(155), '17914': np.int64(303), '17612': np.int64(853), '18675': np.int64(768)}
2025-07-09 19:18:51,716 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 19:18:51,718 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 19:18:51,720 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 19:18:51,722 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 19:18:51,724 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 19:18:51,725 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736), '18675': np.int64(767)}
2025-07-09 19:18:51,725 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 19:18:51,726 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736), '18675': np.int64(767)}
2025-07-09 19:18:51,728 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:18:51,729 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:18:51,730 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:18:51,732 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:18:51,733 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736), '18675': np.int64(767)}
2025-07-09 19:18:51,733 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 19:18:51,734 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736), '18675': np.int64(767)}
2025-07-09 19:18:51,740 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:18:51,741 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:18:51,743 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:18:51,745 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:18:51,745 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736), '18675': np.int64(767)}
2025-07-09 19:18:51,746 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 19:18:51,746 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736), '18675': np.int64(767)}
2025-07-09 19:18:51,747 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 19:18:51,749 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 19:18:51,751 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 19:18:51,756 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 19:18:51,758 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 19:18:51,759 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17904': np.int64(151), '17914': np.int64(299), '17612': np.int64(689), '18675': np.int64(766)}
2025-07-09 19:18:51,760 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 19:18:51,760 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17904': np.int64(151), '17914': np.int64(299), '17612': np.int64(689), '18675': np.int64(766)}
2025-07-09 19:18:51,761 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 19:18:51,763 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 19:18:51,764 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 19:18:51,766 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 19:18:51,770 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 19:18:51,771 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17904': np.int64(151), '17914': np.int64(296), '17612': np.int64(602), '18675': np.int64(766)}
2025-07-09 19:18:51,772 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 19:18:51,773 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17904': np.int64(151), '17914': np.int64(296), '17612': np.int64(602), '18675': np.int64(766)}
2025-07-09 19:18:51,775 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 19:18:51,777 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 19:18:51,780 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 19:18:51,782 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 19:18:51,785 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 19:18:51,786 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17904': np.int64(150), '17914': np.int64(293), '17612': np.int64(535), '18675': np.int64(765)}
2025-07-09 19:18:51,786 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 19:18:51,787 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17904': np.int64(150), '17914': np.int64(293), '17612': np.int64(535), '18675': np.int64(765)}
2025-07-09 19:18:51,789 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 19:18:51,791 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 19:18:51,792 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 19:18:51,794 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 19:18:51,795 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:18:51,796 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17904': np.int64(136), '17914': np.int64(282), '17612': np.int64(301), '18675': np.int64(765)}
2025-07-09 19:18:51,796 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 19:18:51,796 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17904': np.int64(136), '17914': np.int64(282), '17612': np.int64(301), '18675': np.int64(765)}
2025-07-09 19:18:51,797 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 19:18:51,799 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 19:18:51,801 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 19:18:51,804 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 19:18:51,806 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:18:51,806 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218), '18675': np.int64(765)}
2025-07-09 19:18:51,807 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 19:18:51,807 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218), '18675': np.int64(765)}
2025-07-09 19:18:51,809 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:18:51,810 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:18:51,812 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:18:51,813 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:18:51,814 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218), '18675': np.int64(765)}
2025-07-09 19:18:51,814 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 19:18:51,814 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218), '18675': np.int64(765)}
2025-07-09 19:18:51,816 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:18:51,819 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:18:51,822 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:18:51,823 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:18:51,824 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218), '18675': np.int64(765)}
2025-07-09 19:18:51,824 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 19:18:51,824 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218), '18675': np.int64(765)}
2025-07-09 19:18:51,825 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 19:18:51,827 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 19:18:51,828 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 19:18:51,830 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 19:18:51,831 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 19:18:51,832 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17904': np.int64(133), '17914': np.int64(267), '17612': np.int64(54), '18675': np.int64(762)}
2025-07-09 19:18:51,832 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 19:18:51,832 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17904': np.int64(133), '17914': np.int64(267), '17612': np.int64(54), '18675': np.int64(762)}
2025-07-09 19:18:51,833 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 19:18:51,836 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 19:18:51,839 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 19:18:51,840 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 19:18:51,842 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 19:18:51,842 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17904': np.int64(132), '17914': np.int64(256), '17612': np.int64(-2), '18675': np.int64(750)}
2025-07-09 19:18:51,842 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 19:18:51,843 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17904': np.int64(132), '17914': np.int64(256), '17612': np.int64(-2), '18675': np.int64(750)}
2025-07-09 19:18:51,844 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 19:18:51,845 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 19:18:51,847 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 19:18:51,849 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 19:18:51,851 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:18:51,851 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17904': np.int64(131), '17914': np.int64(255), '17612': np.int64(517), '18675': np.int64(750)}
2025-07-09 19:18:51,852 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 19:18:51,852 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17904': np.int64(131), '17914': np.int64(255), '17612': np.int64(517), '18675': np.int64(750)}
2025-07-09 19:18:51,854 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 19:18:51,857 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 19:18:51,859 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 19:18:51,860 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 19:18:51,862 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:18:51,862 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17904': np.int64(129), '17914': np.int64(248), '17612': np.int64(470), '18675': np.int64(750)}
2025-07-09 19:18:51,863 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 19:18:51,863 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17904': np.int64(129), '17914': np.int64(248), '17612': np.int64(470), '18675': np.int64(750)}
2025-07-09 19:18:51,864 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 19:18:51,866 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 19:18:51,869 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 19:18:51,872 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 19:18:51,874 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 19:18:51,874 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394), '18675': np.int64(749)}
2025-07-09 19:18:51,875 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 19:18:51,875 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394), '18675': np.int64(749)}
2025-07-09 19:18:51,877 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:18:51,878 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:18:51,880 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:18:51,881 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:18:51,881 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394), '18675': np.int64(749)}
2025-07-09 19:18:51,882 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 19:18:51,882 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394), '18675': np.int64(749)}
2025-07-09 19:18:51,885 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:18:51,887 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:18:51,890 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:18:51,891 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:18:51,892 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394), '18675': np.int64(749)}
2025-07-09 19:18:51,892 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 19:18:51,893 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394), '18675': np.int64(749)}
2025-07-09 19:18:51,894 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 19:18:51,896 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 19:18:51,897 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:18:51,899 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 19:18:51,902 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:18:51,903 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17904': np.int64(122), '17914': np.int64(243), '17612': np.int64(749), '18675': np.int64(749)}
2025-07-09 19:18:51,904 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 19:18:51,904 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17904': np.int64(122), '17914': np.int64(243), '17612': np.int64(749), '18675': np.int64(749)}
2025-07-09 19:18:51,906 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 19:18:51,908 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 19:18:51,909 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 19:18:51,912 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 19:18:51,914 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:18:51,914 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17904': np.int64(121), '17914': np.int64(242), '17612': np.int64(707), '18675': np.int64(749)}
2025-07-09 19:18:51,914 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 19:18:51,914 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17904': np.int64(121), '17914': np.int64(242), '17612': np.int64(707), '18675': np.int64(749)}
2025-07-09 19:18:51,915 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 19:18:51,917 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 19:18:51,920 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 19:18:51,923 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 19:18:51,924 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:18:51,924 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17904': np.int64(120), '17914': np.int64(238), '17612': np.int64(534), '18675': np.int64(749)}
2025-07-09 19:18:51,925 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 19:18:51,925 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17904': np.int64(120), '17914': np.int64(238), '17612': np.int64(534), '18675': np.int64(749)}
2025-07-09 19:18:51,926 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 19:18:51,927 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 19:18:51,929 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 19:18:51,930 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 19:18:51,932 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:18:51,932 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17904': np.int64(118), '17914': np.int64(229), '17612': np.int64(474), '18675': np.int64(749)}
2025-07-09 19:18:51,932 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 19:18:51,933 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17904': np.int64(118), '17914': np.int64(229), '17612': np.int64(474), '18675': np.int64(749)}
2025-07-09 19:18:51,934 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 19:18:51,937 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 19:18:51,940 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 19:18:51,942 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 19:18:51,943 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:18:51,943 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423), '18675': np.int64(749)}
2025-07-09 19:18:51,944 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 19:18:51,944 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423), '18675': np.int64(749)}
2025-07-09 19:18:51,946 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:18:51,948 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:18:51,949 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:18:51,950 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:18:51,951 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423), '18675': np.int64(749)}
2025-07-09 19:18:51,951 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 19:18:51,952 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423), '18675': np.int64(749)}
2025-07-09 19:18:51,958 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:18:51,960 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:18:51,962 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:18:51,963 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:18:51,964 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423), '18675': np.int64(749)}
2025-07-09 19:18:51,964 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 19:18:51,964 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423), '18675': np.int64(749)}
2025-07-09 19:18:51,965 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 19:18:51,967 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 19:18:51,969 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 19:18:51,972 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 19:18:51,973 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:18:51,974 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17904': np.int64(112), '17914': np.int64(222), '17612': np.int64(339), '18675': np.int64(749)}
2025-07-09 19:18:51,976 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612            955            955
0  2025-06-01  17904            178            178
1  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
6  2025-06-02  17612            955            884
2025-07-09 19:18:51,978 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
118  2025-06-30  17612            423            339
116  2025-06-30  17904            115            112
117  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-09 19:18:51,978 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 19:18:51,978 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 19:18:51,980 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612            955            955
0  2025-06-01  17904            178            178
1  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
6  2025-06-02  17612            955            884
2025-07-09 19:18:51,981 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
118  2025-06-30  17612            423            339
116  2025-06-30  17904            115            112
117  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-09 19:18:51,981 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 19:18:51,983 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 19:18:51,985 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
2    2025-06-01            955
6    2025-06-02            884
10   2025-06-03            790
14   2025-06-04           1149
18   2025-06-05            853
22   2025-06-06            736
26   2025-06-07            736
30   2025-06-08            736
34   2025-06-09            689
38   2025-06-10            602
42   2025-06-11            535
46   2025-06-12            301
50   2025-06-13            218
54   2025-06-14            218
58   2025-06-15            218
62   2025-06-16             54
66   2025-06-17             -2
70   2025-06-18            517
74   2025-06-19            470
78   2025-06-20            394
82   2025-06-21            394
86   2025-06-22            394
90   2025-06-23            749
94   2025-06-24            707
98   2025-06-25            534
102  2025-06-26            474
106  2025-06-27            423
110  2025-06-28            423
114  2025-06-29            423
118  2025-06-30            339
2025-07-09 19:18:51,989 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
0    2025-06-01            178
4    2025-06-02            176
8    2025-06-03            163
12   2025-06-04            156
16   2025-06-05            155
20   2025-06-06            153
24   2025-06-07            153
28   2025-06-08            153
32   2025-06-09            151
36   2025-06-10            151
40   2025-06-11            150
44   2025-06-12            136
48   2025-06-13            135
52   2025-06-14            135
56   2025-06-15            135
60   2025-06-16            133
64   2025-06-17            132
68   2025-06-18            131
72   2025-06-19            129
76   2025-06-20            128
80   2025-06-21            128
84   2025-06-22            128
88   2025-06-23            122
92   2025-06-24            121
96   2025-06-25            120
100  2025-06-26            118
104  2025-06-27            115
108  2025-06-28            115
112  2025-06-29            115
116  2025-06-30            112
2025-07-09 19:18:51,991 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
2025-07-09 19:18:51,996 - src.services.reporting_logic.monthly_report_generator - INFO - Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 19:18:52,000 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 19:18:52,003 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 19:18:52,006 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
2    2025-06-01           20
6    2025-06-02           19
10   2025-06-03           17
14   2025-06-04           24
18   2025-06-05           18
22   2025-06-06           16
26   2025-06-07           16
30   2025-06-08           16
34   2025-06-09           15
38   2025-06-10           13
42   2025-06-11           12
46   2025-06-12            7
50   2025-06-13            5
54   2025-06-14            5
58   2025-06-15            5
62   2025-06-16            2
66   2025-06-17            0
70   2025-06-18           11
74   2025-06-19           10
78   2025-06-20            9
82   2025-06-21            9
86   2025-06-22            9
90   2025-06-23           16
94   2025-06-24           15
98   2025-06-25           12
102  2025-06-26           10
106  2025-06-27            9
110  2025-06-28            9
114  2025-06-29            9
118  2025-06-30            8
2025-07-09 19:18:52,007 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 19:18:52,008 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 19:18:52,008 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 19:18:52,008 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 19:18:52,010 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 19:18:52,011 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 19:18:52,011 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 19:18:52,014 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 19:18:52,015 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 19:18:52,015 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 19:18:52,017 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 19:18:52,022 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 19:18:52,023 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 19:18:52,024 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:18:52,025 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 19:18:52,026 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:18:52,027 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 19:18:52,028 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:18:52,029 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 19:18:52,030 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:18:52,030 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 19:18:52,031 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 19:18:52,031 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:18:52,032 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:18:52,033 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:18:52,035 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:18:52,037 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:18:52,038 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:18:52,039 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 19:18:52,042 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 19:18:52,042 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 19:18:52,045 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:18:52,046 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 19:18:52,049 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 19:18:52,058 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (head):
2025-07-09 19:18:52,060 - src.services.reporting_logic.monthly_report_generator - DEBUG -        Date  # Of Orders  17612 17904 17914 18675 18795   Orders Packages Space Rental    Total
0  6/1/2025          0.0      -     -     -     -     -    $0.00    $0.00       $20.25   $20.25
1  6/2/2025         19.0   71.0   2.0   3.0   1.0     -   $80.75   $57.75       $19.35  $157.85
2  6/3/2025         22.0   94.0  13.0   6.0     -     -   $93.50   $84.75       $18.00  $196.25
3  6/4/2025         35.0  119.0   7.0   7.0     -     -  $148.75   $99.75       $21.15  $269.65
4  6/5/2025         83.0  296.0   1.0   7.0     -     -  $352.75  $228.00       $18.45  $599.20
2025-07-09 19:18:52,061 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (columns and dtypes):
2025-07-09 19:18:52,064 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:18:52,065 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (tail):
2025-07-09 19:18:52,067 - src.services.reporting_logic.monthly_report_generator - DEBUG -          Date  # Of Orders   17612 17904  17914 18675 18795    Orders  Packages Space Rental     Total
26  6/27/2025         17.0    51.0   3.0    6.0     -     -    $72.25    $45.00       $13.50   $130.75
27  6/28/2025          0.0       -     -      -     -     -     $0.00     $0.00       $13.50    $13.50
28  6/29/2025          0.0       -     -      -     -     -     $0.00     $0.00       $13.50    $13.50
29  6/30/2025         10.0    84.0   3.0    1.0     -     -    $42.50    $66.00       $13.05   $121.55
30      TOTAL        552.0  2046.0  66.0  104.0  20.0     -  $2346.00  $1677.00      $459.90  $4482.90
2025-07-09 19:18:52,067 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 19:18:52,068 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 19:18:52,069 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:18:52,069 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:18:52,073 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:18:52,330 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:18:52,332 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:18:52,332 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:18:52,332 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 19:18:52,358 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:18:52,515 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:18:52,517 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:18:52,699 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:52,816 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:52,950 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:18:53,083 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:18:53,085 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-09 19:18:53,222 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:18:53,223 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-09 19:18:53,224 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 19:18:53,226 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 19:18:53,227 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 19:18:53,227 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 19:18:53,228 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 19:18:53,233 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 19:18:53,236 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 19:18:53,248 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 19:18:53,250 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 19:18:53,251 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 19:18:53,260 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 19:18:53,261 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 19:18:53,264 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 19:18:53,267 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 19:18:53,272 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 19:18:53,273 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:18:53,274 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:18:53,276 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 19:18:53,284 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:18:53,286 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:18:53,293 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:18:53,556 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:18:53,560 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:18:53,562 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:18:53,563 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 19:18:53,633 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:18:53,782 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:18:53,788 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:18:54,029 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:54,141 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:18:54,283 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:18:54,409 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:18:54,411 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 19:18:54,556 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:18:54,558 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 19:18:54,559 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 19:18:54,561 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 19:18:54,562 - __main__ - INFO - Script finished successfully.
2025-07-09 19:23:30,298 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 19:23:30,298 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 19:23:30,641 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 19:23:30,642 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 19:23:30,642 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:23:30,643 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:23:30,654 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:23:31,023 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:23:31,027 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:23:31,028 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:23:31,029 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:23:31,056 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:23:31,229 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:23:31,232 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:23:31,560 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:31,686 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:31,687 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 19:23:31,841 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 19:23:31,843 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 19:23:31,848 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 19:23:31,848 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 19:23:31,848 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:23:31,849 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:23:31,851 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:23:32,078 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:23:32,081 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:23:32,081 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:23:32,082 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:23:32,105 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:23:32,257 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:23:32,259 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:23:32,445 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:32,554 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:32,555 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 19:23:32,679 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 19:23:32,682 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 19:23:32,685 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 19:23:32,686 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 19:23:32,690 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 19:23:32,691 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 19:23:32,692 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 19:23:32,692 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:23:32,693 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:23:32,695 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:23:32,920 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:23:32,923 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:23:32,924 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:23:32,925 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:23:32,949 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:23:33,104 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:23:33,105 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:23:33,387 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:33,489 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:33,489 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 19:23:33,618 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 19:23:33,624 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 19:23:33,627 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 19:23:33,628 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:23:33,630 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 19:23:33,631 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists, from raw data usually):
Series([], )
2025-07-09 19:23:33,631 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 19:23:33,632 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:23:33,635 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                         object
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:23:33,636 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 19:23:33,638 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:23:33,638 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 19:23:33,640 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 19:23:33,640 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 19:23:33,640 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:23:33,641 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:23:33,643 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:23:33,878 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:23:33,879 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:23:33,879 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:23:33,879 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:23:33,901 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:23:34,048 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:23:34,049 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:23:34,230 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:34,334 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:34,337 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 19:23:34,460 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 19:23:34,465 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 19:23:34,467 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 19:23:34,468 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 19:23:34,468 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:23:34,469 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:23:34,471 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:23:34,737 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:23:34,738 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:23:34,739 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:23:34,739 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:23:34,760 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:23:34,913 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:23:34,917 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:23:35,095 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:35,202 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:35,205 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 19:23:35,323 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 19:23:35,326 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 19:23:35,334 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 19:23:35,336 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 19:23:35,336 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:23:35,337 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:23:35,340 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:23:35,632 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:23:35,636 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:23:35,638 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:23:35,639 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:23:35,662 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:23:35,826 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:23:35,830 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:23:36,022 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:36,126 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:36,128 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 19:23:36,250 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 19:23:36,254 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 19:23:36,255 - src.services.reporting_logic.report_data_loader - DEBUG - Raw data from ORA_Configuration for product names: <class 'pandas.core.frame.DataFrame'>
2025-07-09 19:23:36,256 - src.services.reporting_logic.report_data_loader - DEBUG - DataFrame columns from ORA_Configuration after strip(): ['ParameterCategory', 'ParameterName', 'SKU', 'Value', 'Unit/Description', 'Notes']
2025-07-09 19:23:36,258 - src.services.reporting_logic.report_data_loader - DEBUG - DataFrame head from ORA_Configuration for product names:
  ParameterCategory    ParameterName    SKU Value Unit/Description                                      Notes
0             Rates      OrderCharge         4.25              USD                    Charge per unique order
1             Rates    PackageCharge         0.75              USD     Charge per package (1 SKU = 1 Package)
2             Rates  SpaceRentalRate         0.45   USD/pallet/day  Daily charge per pallet of space occupied
3      PalletConfig      PalletCount  17612    48     Units/pallet                  Units of 17612 per pallet
4      PalletConfig      PalletCount  17904    64     Units/pallet                  Units of 17904 per pallet
2025-07-09 19:23:36,260 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded product names map from ORA_Configuration. Shape: (5, 2)
2025-07-09 19:23:36,260 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 19:23:36,262 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 19:23:36,266 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 19:23:36,267 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 19:23:36,268 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 19:23:36,271 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 19:23:36,271 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 19:23:36,273 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 19:23:36,275 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 19:23:36,275 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 19:23:36,275 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 19:23:36,276 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 19:23:36,276 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 19:23:36,277 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 19:23:36,278 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'18675': 769, '17904': 178, '17914': 326, '17612': 955}
2025-07-09 19:23:36,278 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 19:23:36,278 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'18675': 769, '17904': 178, '17914': 326, '17612': 955}
2025-07-09 19:23:36,280 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 19:23:36,282 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 19:23:36,283 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 19:23:36,285 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 19:23:36,286 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'18675': np.int64(769), '17904': np.int64(178), '17914': np.int64(326), '17612': np.int64(955)}
2025-07-09 19:23:36,286 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 19:23:36,286 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'18675': np.int64(769), '17904': np.int64(178), '17914': np.int64(326), '17612': np.int64(955)}
2025-07-09 19:23:36,287 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 19:23:36,289 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 19:23:36,290 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 19:23:36,292 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 19:23:36,293 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 19:23:36,294 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'18675': np.int64(768), '17904': np.int64(176), '17914': np.int64(323), '17612': np.int64(884)}
2025-07-09 19:23:36,294 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 19:23:36,294 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'18675': np.int64(768), '17904': np.int64(176), '17914': np.int64(323), '17612': np.int64(884)}
2025-07-09 19:23:36,295 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 19:23:36,297 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:23:36,298 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 19:23:36,300 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 19:23:36,302 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 19:23:36,303 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'18675': np.int64(768), '17904': np.int64(163), '17914': np.int64(317), '17612': np.int64(790)}
2025-07-09 19:23:36,304 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 19:23:36,304 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'18675': np.int64(768), '17904': np.int64(163), '17914': np.int64(317), '17612': np.int64(790)}
2025-07-09 19:23:36,305 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 19:23:36,307 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:23:36,309 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 19:23:36,310 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 19:23:36,311 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 19:23:36,311 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'18675': np.int64(768), '17904': np.int64(156), '17914': np.int64(310), '17612': np.int64(1149)}
2025-07-09 19:23:36,312 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 19:23:36,312 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'18675': np.int64(768), '17904': np.int64(156), '17914': np.int64(310), '17612': np.int64(1149)}
2025-07-09 19:23:36,313 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 19:23:36,315 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:23:36,316 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 19:23:36,318 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 19:23:36,321 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 19:23:36,321 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'18675': np.int64(768), '17904': np.int64(155), '17914': np.int64(303), '17612': np.int64(853)}
2025-07-09 19:23:36,321 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 19:23:36,323 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'18675': np.int64(768), '17904': np.int64(155), '17914': np.int64(303), '17612': np.int64(853)}
2025-07-09 19:23:36,323 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 19:23:36,325 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 19:23:36,327 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 19:23:36,328 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 19:23:36,329 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 19:23:36,330 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736)}
2025-07-09 19:23:36,330 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 19:23:36,330 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736)}
2025-07-09 19:23:36,332 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:23:36,334 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:23:36,336 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:23:36,337 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:23:36,338 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736)}
2025-07-09 19:23:36,338 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 19:23:36,338 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736)}
2025-07-09 19:23:36,340 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:23:36,341 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:23:36,343 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:23:36,344 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:23:36,344 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736)}
2025-07-09 19:23:36,344 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 19:23:36,345 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736)}
2025-07-09 19:23:36,345 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 19:23:36,346 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 19:23:36,349 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 19:23:36,352 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 19:23:36,355 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 19:23:36,356 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'18675': np.int64(766), '17904': np.int64(151), '17914': np.int64(299), '17612': np.int64(689)}
2025-07-09 19:23:36,356 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 19:23:36,356 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'18675': np.int64(766), '17904': np.int64(151), '17914': np.int64(299), '17612': np.int64(689)}
2025-07-09 19:23:36,357 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 19:23:36,359 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 19:23:36,360 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 19:23:36,362 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 19:23:36,364 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 19:23:36,365 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'18675': np.int64(766), '17904': np.int64(151), '17914': np.int64(296), '17612': np.int64(602)}
2025-07-09 19:23:36,365 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 19:23:36,366 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'18675': np.int64(766), '17904': np.int64(151), '17914': np.int64(296), '17612': np.int64(602)}
2025-07-09 19:23:36,367 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 19:23:36,370 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 19:23:36,372 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 19:23:36,374 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 19:23:36,376 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 19:23:36,377 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'18675': np.int64(765), '17904': np.int64(150), '17914': np.int64(293), '17612': np.int64(535)}
2025-07-09 19:23:36,377 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 19:23:36,377 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'18675': np.int64(765), '17904': np.int64(150), '17914': np.int64(293), '17612': np.int64(535)}
2025-07-09 19:23:36,378 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 19:23:36,380 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:23:36,383 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 19:23:36,385 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 19:23:36,387 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 19:23:36,388 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'18675': np.int64(765), '17904': np.int64(136), '17914': np.int64(282), '17612': np.int64(301)}
2025-07-09 19:23:36,388 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 19:23:36,389 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'18675': np.int64(765), '17904': np.int64(136), '17914': np.int64(282), '17612': np.int64(301)}
2025-07-09 19:23:36,390 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 19:23:36,391 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:23:36,393 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 19:23:36,396 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 19:23:36,398 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 19:23:36,398 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218)}
2025-07-09 19:23:36,398 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 19:23:36,399 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218)}
2025-07-09 19:23:36,401 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:23:36,403 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:23:36,405 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:23:36,406 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:23:36,406 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218)}
2025-07-09 19:23:36,406 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 19:23:36,406 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218)}
2025-07-09 19:23:36,409 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:23:36,410 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:23:36,411 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:23:36,413 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:23:36,413 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218)}
2025-07-09 19:23:36,413 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 19:23:36,413 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218)}
2025-07-09 19:23:36,414 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 19:23:36,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 19:23:36,418 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 19:23:36,420 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 19:23:36,422 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 19:23:36,423 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'18675': np.int64(762), '17904': np.int64(133), '17914': np.int64(267), '17612': np.int64(54)}
2025-07-09 19:23:36,423 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 19:23:36,423 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'18675': np.int64(762), '17904': np.int64(133), '17914': np.int64(267), '17612': np.int64(54)}
2025-07-09 19:23:36,424 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 19:23:36,426 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 19:23:36,427 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 19:23:36,429 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 19:23:36,430 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 19:23:36,431 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'18675': np.int64(750), '17904': np.int64(132), '17914': np.int64(256), '17612': np.int64(-2)}
2025-07-09 19:23:36,431 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 19:23:36,431 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'18675': np.int64(750), '17904': np.int64(132), '17914': np.int64(256), '17612': np.int64(-2)}
2025-07-09 19:23:36,432 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 19:23:36,434 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:23:36,437 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 19:23:36,438 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 19:23:36,440 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 19:23:36,440 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'18675': np.int64(750), '17904': np.int64(131), '17914': np.int64(255), '17612': np.int64(517)}
2025-07-09 19:23:36,440 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 19:23:36,441 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'18675': np.int64(750), '17904': np.int64(131), '17914': np.int64(255), '17612': np.int64(517)}
2025-07-09 19:23:36,442 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 19:23:36,443 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:23:36,445 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 19:23:36,446 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 19:23:36,448 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 19:23:36,449 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'18675': np.int64(750), '17904': np.int64(129), '17914': np.int64(248), '17612': np.int64(470)}
2025-07-09 19:23:36,449 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 19:23:36,449 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'18675': np.int64(750), '17904': np.int64(129), '17914': np.int64(248), '17612': np.int64(470)}
2025-07-09 19:23:36,450 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 19:23:36,452 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 19:23:36,455 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 19:23:36,456 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 19:23:36,457 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 19:23:36,457 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394)}
2025-07-09 19:23:36,457 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 19:23:36,458 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394)}
2025-07-09 19:23:36,459 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:23:36,461 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:23:36,462 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:23:36,463 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:23:36,463 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394)}
2025-07-09 19:23:36,464 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 19:23:36,464 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394)}
2025-07-09 19:23:36,466 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:23:36,468 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:23:36,470 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:23:36,472 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:23:36,472 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394)}
2025-07-09 19:23:36,472 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 19:23:36,473 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394)}
2025-07-09 19:23:36,474 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 19:23:36,476 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:23:36,477 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 19:23:36,479 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:23:36,480 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 19:23:36,481 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'18675': np.int64(749), '17904': np.int64(122), '17914': np.int64(243), '17612': np.int64(749)}
2025-07-09 19:23:36,481 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 19:23:36,481 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'18675': np.int64(749), '17904': np.int64(122), '17914': np.int64(243), '17612': np.int64(749)}
2025-07-09 19:23:36,483 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 19:23:36,485 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:23:36,487 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 19:23:36,489 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 19:23:36,490 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 19:23:36,491 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'18675': np.int64(749), '17904': np.int64(121), '17914': np.int64(242), '17612': np.int64(707)}
2025-07-09 19:23:36,491 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 19:23:36,491 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'18675': np.int64(749), '17904': np.int64(121), '17914': np.int64(242), '17612': np.int64(707)}
2025-07-09 19:23:36,492 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 19:23:36,494 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:23:36,495 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 19:23:36,497 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 19:23:36,498 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 19:23:36,499 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'18675': np.int64(749), '17904': np.int64(120), '17914': np.int64(238), '17612': np.int64(534)}
2025-07-09 19:23:36,499 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 19:23:36,500 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'18675': np.int64(749), '17904': np.int64(120), '17914': np.int64(238), '17612': np.int64(534)}
2025-07-09 19:23:36,501 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 19:23:36,503 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:23:36,505 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 19:23:36,506 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 19:23:36,508 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 19:23:36,508 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'18675': np.int64(749), '17904': np.int64(118), '17914': np.int64(229), '17612': np.int64(474)}
2025-07-09 19:23:36,509 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 19:23:36,509 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'18675': np.int64(749), '17904': np.int64(118), '17914': np.int64(229), '17612': np.int64(474)}
2025-07-09 19:23:36,510 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 19:23:36,511 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:23:36,512 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 19:23:36,514 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 19:23:36,515 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 19:23:36,516 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423)}
2025-07-09 19:23:36,516 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 19:23:36,516 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423)}
2025-07-09 19:23:36,519 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:23:36,521 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:23:36,522 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:23:36,524 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:23:36,524 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423)}
2025-07-09 19:23:36,524 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 19:23:36,525 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423)}
2025-07-09 19:23:36,526 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:23:36,528 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:23:36,529 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:23:36,530 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:23:36,531 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423)}
2025-07-09 19:23:36,531 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 19:23:36,531 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423)}
2025-07-09 19:23:36,532 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 19:23:36,535 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:23:36,538 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 19:23:36,540 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 19:23:36,541 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 19:23:36,542 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'18675': np.int64(749), '17904': np.int64(112), '17914': np.int64(222), '17612': np.int64(339)}
2025-07-09 19:23:36,544 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
0  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 19:23:36,545 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
116  2025-06-30  18675            749            749
2025-07-09 19:23:36,545 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 19:23:36,546 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 19:23:36,546 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
0  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 19:23:36,547 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
116  2025-06-30  18675            749            749
2025-07-09 19:23:36,548 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 19:23:36,549 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 19:23:36,551 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01            955
7    2025-06-02            884
11   2025-06-03            790
15   2025-06-04           1149
19   2025-06-05            853
23   2025-06-06            736
27   2025-06-07            736
31   2025-06-08            736
35   2025-06-09            689
39   2025-06-10            602
43   2025-06-11            535
47   2025-06-12            301
51   2025-06-13            218
55   2025-06-14            218
59   2025-06-15            218
63   2025-06-16             54
67   2025-06-17             -2
71   2025-06-18            517
75   2025-06-19            470
79   2025-06-20            394
83   2025-06-21            394
87   2025-06-22            394
91   2025-06-23            749
95   2025-06-24            707
99   2025-06-25            534
103  2025-06-26            474
107  2025-06-27            423
111  2025-06-28            423
115  2025-06-29            423
119  2025-06-30            339
2025-07-09 19:23:36,554 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            178
5    2025-06-02            176
9    2025-06-03            163
13   2025-06-04            156
17   2025-06-05            155
21   2025-06-06            153
25   2025-06-07            153
29   2025-06-08            153
33   2025-06-09            151
37   2025-06-10            151
41   2025-06-11            150
45   2025-06-12            136
49   2025-06-13            135
53   2025-06-14            135
57   2025-06-15            135
61   2025-06-16            133
65   2025-06-17            132
69   2025-06-18            131
73   2025-06-19            129
77   2025-06-20            128
81   2025-06-21            128
85   2025-06-22            128
89   2025-06-23            122
93   2025-06-24            121
97   2025-06-25            120
101  2025-06-26            118
105  2025-06-27            115
109  2025-06-28            115
113  2025-06-29            115
117  2025-06-30            112
2025-07-09 19:23:36,556 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
2025-07-09 19:23:36,560 - src.services.reporting_logic.monthly_report_generator - INFO - Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 19:23:36,564 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 19:23:36,565 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 19:23:36,567 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           20
7    2025-06-02           19
11   2025-06-03           17
15   2025-06-04           24
19   2025-06-05           18
23   2025-06-06           16
27   2025-06-07           16
31   2025-06-08           16
35   2025-06-09           15
39   2025-06-10           13
43   2025-06-11           12
47   2025-06-12            7
51   2025-06-13            5
55   2025-06-14            5
59   2025-06-15            5
63   2025-06-16            2
67   2025-06-17            0
71   2025-06-18           11
75   2025-06-19           10
79   2025-06-20            9
83   2025-06-21            9
87   2025-06-22            9
91   2025-06-23           16
95   2025-06-24           15
99   2025-06-25           12
103  2025-06-26           10
107  2025-06-27            9
111  2025-06-28            9
115  2025-06-29            9
119  2025-06-30            8
2025-07-09 19:23:36,569 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 19:23:36,570 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 19:23:36,570 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 19:23:36,571 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 19:23:36,572 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 19:23:36,573 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 19:23:36,574 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 19:23:36,577 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 19:23:36,577 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 19:23:36,578 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: ['17612', '17904', '17914', '18675']
2025-07-09 19:23:36,579 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 19:23:36,582 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 19:23:36,583 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 19:23:36,584 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:23:36,585 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 19:23:36,588 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:23:36,589 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 19:23:36,592 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:23:36,594 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 19:23:36,596 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:23:36,597 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 19:23:36,598 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 19:23:36,600 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:23:36,601 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:23:36,604 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:23:36,606 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:23:36,608 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:23:36,609 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:23:36,610 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 19:23:36,616 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 19:23:36,617 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 19:23:36,623 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:23:36,624 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 19:23:36,627 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 19:23:36,634 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (head):
2025-07-09 19:23:36,637 - src.services.reporting_logic.monthly_report_generator - DEBUG -        Date  # Of Orders  17612 17904 17914 18675 18795   Orders Packages Space Rental    Total
0  6/1/2025          0.0      -     -     -     -     -    $0.00    $0.00       $20.25   $20.25
1  6/2/2025         19.0   71.0   2.0   3.0   1.0     -   $80.75   $57.75       $19.35  $157.85
2  6/3/2025         22.0   94.0  13.0   6.0     -     -   $93.50   $84.75       $18.00  $196.25
3  6/4/2025         35.0  119.0   7.0   7.0     -     -  $148.75   $99.75       $21.15  $269.65
4  6/5/2025         83.0  296.0   1.0   7.0     -     -  $352.75  $228.00       $18.45  $599.20
2025-07-09 19:23:36,638 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (columns and dtypes):
2025-07-09 19:23:36,645 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:23:36,646 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (tail):
2025-07-09 19:23:36,649 - src.services.reporting_logic.monthly_report_generator - DEBUG -          Date  # Of Orders   17612 17904  17914 18675 18795    Orders  Packages Space Rental     Total
26  6/27/2025         17.0    51.0   3.0    6.0     -     -    $72.25    $45.00       $13.50   $130.75
27  6/28/2025          0.0       -     -      -     -     -     $0.00     $0.00       $13.50    $13.50
28  6/29/2025          0.0       -     -      -     -     -     $0.00     $0.00       $13.50    $13.50
29  6/30/2025         10.0    84.0   3.0    1.0     -     -    $42.50    $66.00       $13.05   $121.55
30      TOTAL        552.0  2046.0  66.0  104.0  20.0     -  $2346.00  $1677.00      $459.90  $4482.90
2025-07-09 19:23:36,649 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 19:23:36,649 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 19:23:36,650 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:23:36,650 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:23:36,653 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:23:36,927 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:23:36,931 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:23:36,933 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:23:36,933 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 19:23:36,959 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:23:37,115 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:23:37,119 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:23:37,307 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:37,417 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:37,576 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:23:37,702 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:23:37,704 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-09 19:23:38,462 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:23:38,465 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-09 19:23:38,465 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 19:23:38,467 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 19:23:38,468 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 19:23:38,471 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 19:23:38,473 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 19:23:38,478 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 19:23:38,479 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 19:23:38,481 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 19:23:38,482 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 19:23:38,482 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 19:23:38,486 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 19:23:38,488 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 19:23:38,489 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 19:23:38,490 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 19:23:38,491 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 19:23:38,492 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:23:38,492 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:23:38,492 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 19:23:38,496 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:23:38,497 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:23:38,499 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:23:38,746 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:23:38,749 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:23:38,750 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:23:38,751 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 19:23:38,775 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:23:38,924 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:23:38,927 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:23:39,118 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:39,225 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:23:39,363 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:23:39,580 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:23:39,581 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 19:23:39,706 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:23:39,707 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 19:23:39,707 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 19:23:39,708 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 19:23:39,708 - __main__ - INFO - Script finished successfully.
2025-07-09 19:24:57,382 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 19:24:57,382 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-09 19:24:57,788 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 19:24:57,789 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 19:24:57,789 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:24:57,789 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:24:57,801 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:24:58,095 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:24:58,100 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:24:58,101 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:24:58,102 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:24:58,127 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:24:58,290 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:24:58,292 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:24:58,666 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:24:58,779 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:24:58,780 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 19:24:58,894 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 19:24:58,900 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 19:24:58,906 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 19:24:58,907 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 19:24:58,907 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:24:58,908 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:24:58,910 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:24:59,138 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:24:59,139 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:24:59,139 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:24:59,140 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:24:59,164 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:24:59,303 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:24:59,304 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:24:59,500 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:24:59,609 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:24:59,610 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 19:24:59,723 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 19:24:59,724 - src.services.google_sheets.api_client - INFO - Successfully fetched 13 rows from worksheet 'Inventory_Transactions'.
2025-07-09 19:24:59,726 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 19:24:59,727 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 19:24:59,731 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 19:24:59,731 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 13 inventory transactions.
2025-07-09 19:24:59,732 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 19:24:59,732 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:24:59,732 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:24:59,737 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:25:00,040 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:25:00,042 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:25:00,042 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:25:00,043 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:25:00,069 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:25:00,212 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:25:00,214 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:25:00,438 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:25:00,540 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:25:00,541 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 19:25:00,651 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 19:25:00,657 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 19:25:00,662 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 19:25:00,663 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:25:00,665 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 19:25:00,667 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists, from raw data usually):
Series([], )
2025-07-09 19:25:00,669 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 19:25:00,670 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:25:00,671 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                         object
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 19:25:00,672 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 19:25:00,673 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 19:25:00,674 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 19:25:00,674 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 19:25:00,674 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 19:25:00,675 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:25:00,675 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:25:00,677 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:25:00,908 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:25:00,912 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:25:00,913 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:25:00,914 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:25:00,936 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:25:01,107 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:25:01,109 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:25:01,289 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:25:01,397 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:25:01,398 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 19:25:01,530 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 19:25:01,533 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 19:25:01,537 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 19:25:01,538 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 19:25:01,538 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:25:01,539 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:25:01,541 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:25:01,789 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:25:01,790 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:25:01,791 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:25:01,792 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:25:01,817 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:25:01,969 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:25:01,970 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:25:02,160 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:25:02,257 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:25:02,260 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 19:25:02,397 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 19:25:02,400 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 19:25:02,407 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 19:25:02,407 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 19:25:02,408 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:25:02,408 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:25:02,412 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:25:02,650 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:25:02,652 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:25:02,654 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:25:02,654 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 19:25:02,677 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:25:02,825 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:25:02,828 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:25:02,998 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:25:03,105 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:25:03,108 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 19:25:03,342 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 19:25:03,346 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 19:25:03,348 - src.services.reporting_logic.report_data_loader - DEBUG - Raw data from ORA_Configuration for product names: <class 'pandas.core.frame.DataFrame'>
2025-07-09 19:25:03,349 - src.services.reporting_logic.report_data_loader - DEBUG - DataFrame columns from ORA_Configuration after strip(): ['ParameterCategory', 'ParameterName', 'SKU', 'Value', 'Unit/Description', 'Notes']
2025-07-09 19:25:03,352 - src.services.reporting_logic.report_data_loader - DEBUG - DataFrame head from ORA_Configuration for product names:
  ParameterCategory    ParameterName    SKU Value Unit/Description                                      Notes
0             Rates      OrderCharge         4.25              USD                    Charge per unique order
1             Rates    PackageCharge         0.75              USD     Charge per package (1 SKU = 1 Package)
2             Rates  SpaceRentalRate         0.45   USD/pallet/day  Daily charge per pallet of space occupied
3      PalletConfig      PalletCount  17612    48     Units/pallet                  Units of 17612 per pallet
4      PalletConfig      PalletCount  17904    64     Units/pallet                  Units of 17904 per pallet
2025-07-09 19:25:03,354 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded product names map from ORA_Configuration. Shape: (5, 2)
2025-07-09 19:25:03,354 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 19:25:03,354 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 19:25:03,363 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 19:25:03,365 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 19:25:03,365 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 19:25:03,368 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 19:25:03,369 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 19:25:03,369 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 19:25:03,372 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 19:25:03,373 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 19:25:03,373 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 19:25:03,374 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 19:25:03,375 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (615, 5)
2025-07-09 19:25:03,376 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 19:25:03,376 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'18795': 0, '18675': 769, '17612': 955, '17904': 178, '17914': 326}
2025-07-09 19:25:03,377 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 19:25:03,378 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'18795': 0, '18675': 769, '17612': 955, '17904': 178, '17914': 326}
2025-07-09 19:25:03,380 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 19:25:03,382 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 19:25:03,384 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 19:25:03,386 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 19:25:03,387 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'18795': np.int64(0), '18675': np.int64(769), '17612': np.int64(955), '17904': np.int64(178), '17914': np.int64(326)}
2025-07-09 19:25:03,388 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 19:25:03,388 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'18795': np.int64(0), '18675': np.int64(769), '17612': np.int64(955), '17904': np.int64(178), '17914': np.int64(326)}
2025-07-09 19:25:03,389 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 19:25:03,392 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 19:25:03,393 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 19:25:03,395 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 19:25:03,397 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 19:25:03,397 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'18795': np.int64(0), '18675': np.int64(768), '17612': np.int64(884), '17904': np.int64(176), '17914': np.int64(323)}
2025-07-09 19:25:03,398 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 19:25:03,399 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'18795': np.int64(0), '18675': np.int64(768), '17612': np.int64(884), '17904': np.int64(176), '17914': np.int64(323)}
2025-07-09 19:25:03,400 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 19:25:03,403 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:25:03,406 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 19:25:03,408 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 19:25:03,410 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 19:25:03,410 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'18795': np.int64(0), '18675': np.int64(768), '17612': np.int64(790), '17904': np.int64(163), '17914': np.int64(317)}
2025-07-09 19:25:03,411 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 19:25:03,412 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'18795': np.int64(0), '18675': np.int64(768), '17612': np.int64(790), '17904': np.int64(163), '17914': np.int64(317)}
2025-07-09 19:25:03,413 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 19:25:03,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:25:03,418 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 19:25:03,420 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 19:25:03,423 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 19:25:03,423 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'18795': np.int64(0), '18675': np.int64(768), '17612': np.int64(1149), '17904': np.int64(156), '17914': np.int64(310)}
2025-07-09 19:25:03,424 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 19:25:03,425 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'18795': np.int64(0), '18675': np.int64(768), '17612': np.int64(1149), '17904': np.int64(156), '17914': np.int64(310)}
2025-07-09 19:25:03,427 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 19:25:03,429 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 19:25:03,430 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 19:25:03,432 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 19:25:03,434 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 19:25:03,435 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'18795': np.int64(0), '18675': np.int64(768), '17612': np.int64(853), '17904': np.int64(155), '17914': np.int64(303)}
2025-07-09 19:25:03,435 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 19:25:03,435 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'18795': np.int64(0), '18675': np.int64(768), '17612': np.int64(853), '17904': np.int64(155), '17914': np.int64(303)}
2025-07-09 19:25:03,437 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 19:25:03,440 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 19:25:03,442 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 19:25:03,443 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 19:25:03,444 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 19:25:03,445 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'18795': np.int64(0), '18675': np.int64(767), '17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 19:25:03,445 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 19:25:03,445 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'18795': np.int64(0), '18675': np.int64(767), '17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 19:25:03,447 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:25:03,449 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:25:03,451 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:25:03,453 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:25:03,453 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'18795': np.int64(0), '18675': np.int64(767), '17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 19:25:03,454 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 19:25:03,454 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'18795': np.int64(0), '18675': np.int64(767), '17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 19:25:03,458 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 19:25:03,460 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 19:25:03,462 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 19:25:03,463 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 19:25:03,463 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'18795': np.int64(0), '18675': np.int64(767), '17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 19:25:03,464 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 19:25:03,464 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'18795': np.int64(0), '18675': np.int64(767), '17612': np.int64(736), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 19:25:03,465 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 19:25:03,467 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 19:25:03,469 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 19:25:03,470 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 19:25:03,472 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 19:25:03,473 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'18795': np.int64(0), '18675': np.int64(766), '17612': np.int64(689), '17904': np.int64(151), '17914': np.int64(299)}
2025-07-09 19:25:03,473 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 19:25:03,473 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'18795': np.int64(0), '18675': np.int64(766), '17612': np.int64(689), '17904': np.int64(151), '17914': np.int64(299)}
2025-07-09 19:25:03,474 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 19:25:03,477 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 19:25:03,478 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 19:25:03,480 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 19:25:03,481 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 19:25:03,482 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'18795': np.int64(0), '18675': np.int64(766), '17612': np.int64(602), '17904': np.int64(151), '17914': np.int64(296)}
2025-07-09 19:25:03,482 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 19:25:03,483 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'18795': np.int64(0), '18675': np.int64(766), '17612': np.int64(602), '17904': np.int64(151), '17914': np.int64(296)}
2025-07-09 19:25:03,484 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 19:25:03,487 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 19:25:03,489 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 19:25:03,490 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 19:25:03,492 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 19:25:03,492 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'18795': np.int64(0), '18675': np.int64(765), '17612': np.int64(535), '17904': np.int64(150), '17914': np.int64(293)}
2025-07-09 19:25:03,492 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 19:25:03,493 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'18795': np.int64(0), '18675': np.int64(765), '17612': np.int64(535), '17904': np.int64(150), '17914': np.int64(293)}
2025-07-09 19:25:03,493 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 19:25:03,496 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:25:03,497 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 19:25:03,499 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 19:25:03,501 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 19:25:03,501 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'18795': np.int64(0), '18675': np.int64(765), '17612': np.int64(301), '17904': np.int64(136), '17914': np.int64(282)}
2025-07-09 19:25:03,502 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 19:25:03,502 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'18795': np.int64(0), '18675': np.int64(765), '17612': np.int64(301), '17904': np.int64(136), '17914': np.int64(282)}
2025-07-09 19:25:03,503 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 19:25:03,506 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:25:03,508 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 19:25:03,509 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 19:25:03,511 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 19:25:03,511 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'18795': np.int64(0), '18675': np.int64(765), '17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 19:25:03,511 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 19:25:03,512 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'18795': np.int64(0), '18675': np.int64(765), '17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 19:25:03,515 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:25:03,516 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:25:03,518 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:25:03,519 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:25:03,520 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'18795': np.int64(0), '18675': np.int64(765), '17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 19:25:03,520 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 19:25:03,521 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'18795': np.int64(0), '18675': np.int64(765), '17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 19:25:03,524 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 19:25:03,526 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 19:25:03,527 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 19:25:03,529 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 19:25:03,529 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'18795': np.int64(0), '18675': np.int64(765), '17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 19:25:03,530 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 19:25:03,531 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'18795': np.int64(0), '18675': np.int64(765), '17612': np.int64(218), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 19:25:03,532 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 19:25:03,535 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 19:25:03,538 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 19:25:03,540 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 19:25:03,541 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 19:25:03,542 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'18795': np.int64(0), '18675': np.int64(762), '17612': np.int64(54), '17904': np.int64(133), '17914': np.int64(267)}
2025-07-09 19:25:03,542 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 19:25:03,542 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'18795': np.int64(0), '18675': np.int64(762), '17612': np.int64(54), '17904': np.int64(133), '17914': np.int64(267)}
2025-07-09 19:25:03,543 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 19:25:03,546 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 19:25:03,548 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 19:25:03,549 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 19:25:03,551 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 19:25:03,551 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'18795': np.int64(0), '18675': np.int64(750), '17612': np.int64(-2), '17904': np.int64(132), '17914': np.int64(256)}
2025-07-09 19:25:03,551 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 19:25:03,552 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'18795': np.int64(0), '18675': np.int64(750), '17612': np.int64(-2), '17904': np.int64(132), '17914': np.int64(256)}
2025-07-09 19:25:03,553 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 19:25:03,557 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:25:03,560 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 19:25:03,563 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 19:25:03,568 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 19:25:03,569 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'18795': np.int64(0), '18675': np.int64(750), '17612': np.int64(517), '17904': np.int64(131), '17914': np.int64(255)}
2025-07-09 19:25:03,571 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 19:25:03,574 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'18795': np.int64(0), '18675': np.int64(750), '17612': np.int64(517), '17904': np.int64(131), '17914': np.int64(255)}
2025-07-09 19:25:03,578 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 19:25:03,582 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 19:25:03,584 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 19:25:03,587 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 19:25:03,591 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 19:25:03,592 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'18795': np.int64(0), '18675': np.int64(750), '17612': np.int64(470), '17904': np.int64(129), '17914': np.int64(248)}
2025-07-09 19:25:03,593 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 19:25:03,594 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'18795': np.int64(0), '18675': np.int64(750), '17612': np.int64(470), '17904': np.int64(129), '17914': np.int64(248)}
2025-07-09 19:25:03,597 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 19:25:03,601 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 19:25:03,603 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 19:25:03,607 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 19:25:03,611 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 19:25:03,612 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 19:25:03,614 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 19:25:03,615 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 19:25:03,622 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:25:03,624 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:25:03,626 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:25:03,630 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:25:03,632 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 19:25:03,635 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 19:25:03,636 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 19:25:03,642 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:25:03,646 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 19:25:03,650 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 19:25:03,653 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:25:03,655 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 19:25:03,658 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 19:25:03,659 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(394), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 19:25:03,662 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 19:25:03,669 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:25:03,674 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 19:25:03,676 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 19:25:03,677 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 19:25:03,677 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(749), '17904': np.int64(122), '17914': np.int64(243)}
2025-07-09 19:25:03,678 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 19:25:03,678 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(749), '17904': np.int64(122), '17914': np.int64(243)}
2025-07-09 19:25:03,679 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 19:25:03,683 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:25:03,685 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 19:25:03,686 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 19:25:03,688 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 19:25:03,689 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(707), '17904': np.int64(121), '17914': np.int64(242)}
2025-07-09 19:25:03,690 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 19:25:03,692 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(707), '17904': np.int64(121), '17914': np.int64(242)}
2025-07-09 19:25:03,694 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 19:25:03,701 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:25:03,703 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 19:25:03,706 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 19:25:03,708 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 19:25:03,709 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(534), '17904': np.int64(120), '17914': np.int64(238)}
2025-07-09 19:25:03,709 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 19:25:03,710 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(534), '17904': np.int64(120), '17914': np.int64(238)}
2025-07-09 19:25:03,711 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 19:25:03,713 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:25:03,715 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 19:25:03,716 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 19:25:03,718 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 19:25:03,718 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(474), '17904': np.int64(118), '17914': np.int64(229)}
2025-07-09 19:25:03,719 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 19:25:03,719 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(474), '17904': np.int64(118), '17914': np.int64(229)}
2025-07-09 19:25:03,720 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 19:25:03,723 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:25:03,724 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 19:25:03,726 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 19:25:03,727 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 19:25:03,728 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 19:25:03,728 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 19:25:03,729 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 19:25:03,732 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:25:03,733 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:25:03,735 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:25:03,737 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:25:03,738 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 19:25:03,739 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 19:25:03,739 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 19:25:03,742 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:25:03,744 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 19:25:03,746 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 19:25:03,748 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 19:25:03,748 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 19:25:03,748 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 19:25:03,749 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(423), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 19:25:03,750 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 19:25:03,753 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 19:25:03,756 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 19:25:03,757 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 19:25:03,758 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 19:25:03,759 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'18795': np.int64(0), '18675': np.int64(749), '17612': np.int64(339), '17904': np.int64(112), '17914': np.int64(222)}
2025-07-09 19:25:03,762 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612            955            955
3  2025-06-01  17904            178            178
4  2025-06-01  17914            326            326
1  2025-06-01  18675            769            769
0  2025-06-01  18795              0              0
2025-07-09 19:25:03,763 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
147  2025-06-30  17612            423            339
148  2025-06-30  17904            115            112
149  2025-06-30  17914            223            222
146  2025-06-30  18675            749            749
145  2025-06-30  18795              0              0
2025-07-09 19:25:03,763 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (150, 4)
2025-07-09 19:25:03,764 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 19:25:03,765 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612            955            955
3  2025-06-01  17904            178            178
4  2025-06-01  17914            326            326
1  2025-06-01  18675            769            769
0  2025-06-01  18795              0              0
2025-07-09 19:25:03,766 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
147  2025-06-30  17612            423            339
148  2025-06-30  17904            115            112
149  2025-06-30  17914            223            222
146  2025-06-30  18675            749            749
145  2025-06-30  18795              0              0
2025-07-09 19:25:03,767 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (150, 4)
2025-07-09 19:25:03,768 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     150.000000
mean      339.020000
std       298.957259
min        -2.000000
25%       120.250000
50%       243.000000
75%       736.000000
max      1149.000000
2025-07-09 19:25:03,770 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
2    2025-06-01            955
7    2025-06-02            884
12   2025-06-03            790
17   2025-06-04           1149
22   2025-06-05            853
27   2025-06-06            736
32   2025-06-07            736
37   2025-06-08            736
42   2025-06-09            689
47   2025-06-10            602
52   2025-06-11            535
57   2025-06-12            301
62   2025-06-13            218
67   2025-06-14            218
72   2025-06-15            218
77   2025-06-16             54
82   2025-06-17             -2
87   2025-06-18            517
92   2025-06-19            470
97   2025-06-20            394
102  2025-06-21            394
107  2025-06-22            394
112  2025-06-23            749
117  2025-06-24            707
122  2025-06-25            534
127  2025-06-26            474
132  2025-06-27            423
137  2025-06-28            423
142  2025-06-29            423
147  2025-06-30            339
2025-07-09 19:25:03,773 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
3    2025-06-01            178
8    2025-06-02            176
13   2025-06-03            163
18   2025-06-04            156
23   2025-06-05            155
28   2025-06-06            153
33   2025-06-07            153
38   2025-06-08            153
43   2025-06-09            151
48   2025-06-10            151
53   2025-06-11            150
58   2025-06-12            136
63   2025-06-13            135
68   2025-06-14            135
73   2025-06-15            135
78   2025-06-16            133
83   2025-06-17            132
88   2025-06-18            131
93   2025-06-19            129
98   2025-06-20            128
103  2025-06-21            128
108  2025-06-22            128
113  2025-06-23            122
118  2025-06-24            121
123  2025-06-25            120
128  2025-06-26            118
133  2025-06-27            115
138  2025-06-28            115
143  2025-06-29            115
148  2025-06-30            112
2025-07-09 19:25:03,775 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
2025-07-09 19:25:03,779 - src.services.reporting_logic.monthly_report_generator - INFO - Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 19:25:03,783 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 19:25:03,784 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    150.000000
mean       6.813333
std        6.502851
min        0.000000
25%        2.000000
50%        4.000000
75%       16.000000
max       24.000000
2025-07-09 19:25:03,786 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
2    2025-06-01           20
7    2025-06-02           19
12   2025-06-03           17
17   2025-06-04           24
22   2025-06-05           18
27   2025-06-06           16
32   2025-06-07           16
37   2025-06-08           16
42   2025-06-09           15
47   2025-06-10           13
52   2025-06-11           12
57   2025-06-12            7
62   2025-06-13            5
67   2025-06-14            5
72   2025-06-15            5
77   2025-06-16            2
82   2025-06-17            0
87   2025-06-18           11
92   2025-06-19           10
97   2025-06-20            9
102  2025-06-21            9
107  2025-06-22            9
112  2025-06-23           16
117  2025-06-24           15
122  2025-06-25           12
127  2025-06-26           10
132  2025-06-27            9
137  2025-06-28            9
142  2025-06-29            9
147  2025-06-30            8
2025-07-09 19:25:03,787 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 19:25:03,788 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 19:25:03,789 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 19:25:03,789 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 19:25:03,791 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 19:25:03,791 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 19:25:03,792 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 19:25:03,795 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 19:25:03,796 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 19:25:03,796 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: ['17612', '17904', '17914', '18675']
2025-07-09 19:25:03,797 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 19:25:03,800 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 19:25:03,801 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-09 19:25:03,802 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:25:03,803 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-09 19:25:03,804 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:25:03,805 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-09 19:25:03,807 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:25:03,808 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-09 19:25:03,809 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:25:03,810 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-09 19:25:03,810 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-09 19:25:03,811 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:25:03,812 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-09 19:25:03,812 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-09 19:25:03,813 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-09 19:25:03,814 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-09 19:25:03,814 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-09 19:25:03,815 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-09 19:25:03,817 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-09 19:25:03,818 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-09 19:25:03,822 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:25:03,822 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-09 19:25:03,825 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-09 19:25:03,830 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (head):
2025-07-09 19:25:03,832 - src.services.reporting_logic.monthly_report_generator - DEBUG -        Date  # Of Orders  17612 17904 17914 18675 18795   Orders Packages Space Rental    Total
0  6/1/2025          0.0      -     -     -     -     -    $0.00    $0.00       $20.25   $20.25
1  6/2/2025         19.0   71.0   2.0   3.0   1.0     -   $80.75   $57.75       $19.35  $157.85
2  6/3/2025         22.0   94.0  13.0   6.0     -     -   $93.50   $84.75       $18.00  $196.25
3  6/4/2025         35.0  119.0   7.0   7.0     -     -  $148.75   $99.75       $21.15  $269.65
4  6/5/2025         83.0  296.0   1.0   7.0     -     -  $352.75  $228.00       $18.45  $599.20
2025-07-09 19:25:03,833 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (columns and dtypes):
2025-07-09 19:25:03,836 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-09 19:25:03,837 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (tail):
2025-07-09 19:25:03,839 - src.services.reporting_logic.monthly_report_generator - DEBUG -          Date  # Of Orders   17612 17904  17914 18675 18795    Orders  Packages Space Rental     Total
26  6/27/2025         17.0    51.0   3.0    6.0     -     -    $72.25    $45.00       $13.50   $130.75
27  6/28/2025          0.0       -     -      -     -     -     $0.00     $0.00       $13.50    $13.50
28  6/29/2025          0.0       -     -      -     -     -     $0.00     $0.00       $13.50    $13.50
29  6/30/2025         10.0    84.0   3.0    1.0     -     -    $42.50    $66.00       $13.05   $121.55
30      TOTAL        552.0  2046.0  66.0  104.0  20.0     -  $2346.00  $1677.00      $459.90  $4482.90
2025-07-09 19:25:03,840 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 19:25:03,841 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 19:25:03,841 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:25:03,841 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:25:03,844 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:25:04,075 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:25:04,077 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:25:04,077 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:25:04,078 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 19:25:04,099 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:25:04,257 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:25:04,260 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:25:04,452 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:25:04,553 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:25:04,680 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:25:04,792 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:25:04,793 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-09 19:25:04,915 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:25:04,917 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-09 19:25:04,918 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 19:25:04,919 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 19:25:04,919 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 19:25:04,920 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 19:25:04,921 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 19:25:04,924 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (2, 5)
2025-07-09 19:25:04,925 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 19:25:04,929 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  18795      6279         Receive
2  17612         2            Ship
3  17612         6            Ship
4  17612         1            Ship
2025-07-09 19:25:04,932 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         1            Ship
63  17914         2            Ship
2025-07-09 19:25:04,933 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (64, 3)
2025-07-09 19:25:04,936 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (5, 2)
2025-07-09 19:25:04,937 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 19:25:04,939 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 19:25:04,941 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 19:25:04,944 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 19:25:04,944 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:25:04,945 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 19:25:04,945 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 19:25:04,948 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 19:25:04,949 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 19:25:04,952 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 19:25:05,213 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 19:25:05,218 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 19:25:05,219 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 19:25:05,220 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 19:25:05,292 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 19:25:05,453 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 19:25:05,456 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 19:25:05,631 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:25:05,734 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 19:25:05,875 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 19:25:06,015 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 19:25:06,019 - gspread_dataframe - DEBUG - 24 cell updates to send
2025-07-09 19:25:06,144 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD6?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 19:25:06,145 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D6", 'updatedRows': 6, 'updatedColumns': 4, 'updatedCells': 24}
2025-07-09 19:25:06,145 - src.services.google_sheets.api_client - INFO - Successfully wrote 5 rows to worksheet 'Weekly Report'.
2025-07-09 19:25:06,146 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 19:25:06,147 - __main__ - INFO - Script finished successfully.
2025-07-10 19:53:44,102 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-10 19:53:44,103 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-10 19:55:09,339 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-10 19:55:09,339 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-10 19:55:10,156 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-10 19:55:10,156 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-10 19:55:10,156 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-10 19:55:10,157 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-10 19:55:10,157 - src.services.gcp.secret_manager - DEBUG - No valid credentials_path provided. Attempting to use Application Default Credentials.
2025-07-10 19:55:10,157 - src.services.gcp.secret_manager - CRITICAL - GCP Default Credentials not found. Ensure you are authenticated (e.g., 'gcloud auth application-default login') or provide a valid service account file via 'credentials_path'.
2025-07-10 19:55:10,158 - src.services.google_sheets.api_client - ERROR - Failed to retrieve Google Sheets service account key from Secret Manager.
2025-07-10 19:55:10,158 - src.services.reporting_logic.report_data_loader - WARNING - No data or malformed data found in 'ORA_Configuration' worksheet. Returning None.
2025-07-10 19:57:31,782 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-10 19:57:31,783 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-10 19:57:32,146 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-10 19:57:32,146 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-10 19:57:32,146 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-10 19:57:32,147 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-10 19:57:32,147 - src.services.gcp.secret_manager - DEBUG - No valid credentials_path provided. Attempting to use Application Default Credentials.
2025-07-10 19:57:32,147 - src.services.gcp.secret_manager - CRITICAL - GCP Default Credentials not found. Ensure you are authenticated (e.g., 'gcloud auth application-default login') or provide a valid service account file via 'credentials_path'.
2025-07-10 19:57:32,148 - src.services.google_sheets.api_client - ERROR - Failed to retrieve Google Sheets service account key from Secret Manager.
2025-07-10 19:57:32,166 - src.services.reporting_logic.report_data_loader - WARNING - No data or malformed data found in 'ORA_Configuration' worksheet. Returning None.
2025-07-10 20:07:36,432 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-10 20:07:36,432 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-10 20:07:36,763 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-10 20:07:36,764 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-10 20:07:36,764 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-10 20:07:36,765 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-10 20:07:36,765 - src.services.gcp.secret_manager - DEBUG - No valid credentials_path provided. Attempting to use Application Default Credentials.
2025-07-10 20:07:36,765 - src.services.gcp.secret_manager - CRITICAL - GCP Default Credentials not found. Ensure you are authenticated (e.g., 'gcloud auth application-default login') or provide a valid service account file via 'credentials_path'.
2025-07-10 20:07:36,766 - src.services.google_sheets.api_client - ERROR - Failed to retrieve Google Sheets service account key from Secret Manager.
2025-07-10 20:07:36,766 - src.services.reporting_logic.report_data_loader - WARNING - No data or malformed data found in 'ORA_Configuration' worksheet. Returning None.
2025-07-10 20:20:18,172 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-10 20:20:18,172 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-10 20:20:18,521 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-10 20:20:18,521 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-10 20:20:18,522 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-10 20:20:18,522 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-10 20:20:18,523 - src.services.gcp.secret_manager - DEBUG - No valid credentials_path provided. Attempting to use Application Default Credentials.
2025-07-10 20:20:18,523 - src.services.gcp.secret_manager - CRITICAL - GCP Default Credentials not found. Ensure you are authenticated (e.g., 'gcloud auth application-default login') or provide a valid service account file via 'credentials_path'.
2025-07-10 20:20:18,524 - src.services.google_sheets.api_client - ERROR - Failed to retrieve Google Sheets service account key from Secret Manager.
2025-07-10 20:20:18,524 - src.services.reporting_logic.report_data_loader - WARNING - No data or malformed data found in 'ORA_Configuration' worksheet. Returning None.
2025-07-10 20:24:37,049 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-10 20:24:37,049 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log-2025-07-09.txt
2025-07-10 20:24:37,440 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-10 20:24:37,440 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-10 20:24:37,440 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-10 20:24:37,440 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-10 20:24:37,509 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-10 20:24:38,104 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-10 20:24:38,106 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-10 20:24:38,106 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-10 20:24:38,106 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-10 20:24:38,133 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-10 20:24:38,323 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-10 20:24:38,327 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-10 20:24:40,172 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:40,532 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:40,535 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-10 20:24:40,928 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-10 20:24:40,938 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-10 20:24:40,957 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-10 20:24:40,958 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-10 20:24:40,958 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-10 20:24:40,958 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-10 20:24:40,960 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-10 20:24:41,243 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-10 20:24:41,246 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-10 20:24:41,247 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-10 20:24:41,248 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-10 20:24:41,269 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-10 20:24:41,431 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-10 20:24:41,433 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-10 20:24:41,686 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:41,995 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:41,996 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-10 20:24:42,346 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-10 20:24:42,350 - src.services.google_sheets.api_client - INFO - Successfully fetched 13 rows from worksheet 'Inventory_Transactions'.
2025-07-10 20:24:42,352 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-10 20:24:42,353 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-10 20:24:42,364 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-10 20:24:42,366 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 13 inventory transactions.
2025-07-10 20:24:42,366 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-10 20:24:42,367 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-10 20:24:42,367 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-10 20:24:42,370 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-10 20:24:42,642 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-10 20:24:42,643 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-10 20:24:42,644 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-10 20:24:42,644 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-10 20:24:42,666 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-10 20:24:42,819 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-10 20:24:42,822 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-10 20:24:43,258 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:43,594 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:43,596 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-10 20:24:43,964 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-10 20:24:43,973 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-10 20:24:43,982 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-10 20:24:43,983 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-10 20:24:43,987 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-10 20:24:43,991 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists, from raw data usually):
Series([], )
2025-07-10 20:24:43,992 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-10 20:24:43,994 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-10 20:24:43,995 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                         object
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-10 20:24:43,997 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-10 20:24:43,998 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-10 20:24:43,998 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-10 20:24:43,999 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-10 20:24:43,999 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-10 20:24:44,000 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-10 20:24:44,000 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-10 20:24:44,005 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-10 20:24:44,315 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-10 20:24:44,319 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-10 20:24:44,320 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-10 20:24:44,320 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-10 20:24:44,344 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-10 20:24:44,502 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-10 20:24:44,505 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-10 20:24:44,956 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:45,160 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:45,160 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-10 20:24:45,358 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-10 20:24:45,362 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-10 20:24:45,366 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-10 20:24:45,367 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-10 20:24:45,367 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-10 20:24:45,368 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-10 20:24:45,373 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-10 20:24:45,637 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-10 20:24:45,638 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-10 20:24:45,639 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-10 20:24:45,640 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-10 20:24:45,663 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-10 20:24:45,822 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-10 20:24:45,823 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-10 20:24:46,083 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:46,399 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:46,400 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-10 20:24:46,585 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-10 20:24:46,586 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-10 20:24:46,606 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-10 20:24:46,608 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-10 20:24:46,608 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-10 20:24:46,608 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-10 20:24:46,610 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-10 20:24:46,895 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-10 20:24:46,898 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-10 20:24:46,899 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-10 20:24:46,900 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-10 20:24:46,922 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-10 20:24:47,073 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-10 20:24:47,077 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-10 20:24:47,338 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:47,674 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:47,676 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-10 20:24:48,090 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-10 20:24:48,093 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-10 20:24:48,096 - src.services.reporting_logic.report_data_loader - DEBUG - Raw data from ORA_Configuration for product names: <class 'pandas.core.frame.DataFrame'>
2025-07-10 20:24:48,098 - src.services.reporting_logic.report_data_loader - DEBUG - DataFrame columns from ORA_Configuration after strip(): ['ParameterCategory', 'ParameterName', 'SKU', 'Value', 'Unit/Description', 'Notes']
2025-07-10 20:24:48,105 - src.services.reporting_logic.report_data_loader - DEBUG - DataFrame head from ORA_Configuration for product names:
  ParameterCategory    ParameterName    SKU Value Unit/Description                                      Notes
0             Rates      OrderCharge         4.25              USD                    Charge per unique order
1             Rates    PackageCharge         0.75              USD     Charge per package (1 SKU = 1 Package)
2             Rates  SpaceRentalRate         0.45   USD/pallet/day  Daily charge per pallet of space occupied
3      PalletConfig      PalletCount  17612    48     Units/pallet                  Units of 17612 per pallet
4      PalletConfig      PalletCount  17904    64     Units/pallet                  Units of 17904 per pallet
2025-07-10 20:24:48,110 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded product names map from ORA_Configuration. Shape: (5, 2)
2025-07-10 20:24:48,111 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-10 20:24:48,112 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-10 20:24:48,137 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-10 20:24:48,140 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-10 20:24:48,141 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-10 20:24:48,143 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-10 20:24:48,146 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-10 20:24:48,147 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-10 20:24:48,153 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-10 20:24:48,155 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-10 20:24:48,156 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-10 20:24:48,157 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-10 20:24:48,158 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (615, 5)
2025-07-10 20:24:48,161 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-10 20:24:48,162 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17904': 178, '17914': 326, '17612': 955, '18795': 0, '18675': 769}
2025-07-10 20:24:48,163 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-10 20:24:48,163 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17904': 178, '17914': 326, '17612': 955, '18795': 0, '18675': 769}
2025-07-10 20:24:48,167 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-10 20:24:48,239 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-10 20:24:48,244 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-10 20:24:48,259 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-10 20:24:48,260 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17904': np.int64(178), '17914': np.int64(326), '17612': np.int64(955), '18795': np.int64(0), '18675': np.int64(769)}
2025-07-10 20:24:48,262 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-10 20:24:48,263 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17904': np.int64(178), '17914': np.int64(326), '17612': np.int64(955), '18795': np.int64(0), '18675': np.int64(769)}
2025-07-10 20:24:48,266 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-10 20:24:48,277 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-10 20:24:48,280 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-10 20:24:48,292 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-10 20:24:48,298 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-10 20:24:48,299 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17904': np.int64(176), '17914': np.int64(323), '17612': np.int64(884), '18795': np.int64(0), '18675': np.int64(768)}
2025-07-10 20:24:48,300 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-10 20:24:48,301 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17904': np.int64(176), '17914': np.int64(323), '17612': np.int64(884), '18795': np.int64(0), '18675': np.int64(768)}
2025-07-10 20:24:48,304 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-10 20:24:48,308 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-10 20:24:48,312 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-10 20:24:48,319 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-10 20:24:48,325 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-10 20:24:48,326 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17904': np.int64(163), '17914': np.int64(317), '17612': np.int64(790), '18795': np.int64(0), '18675': np.int64(768)}
2025-07-10 20:24:48,326 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-10 20:24:48,327 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17904': np.int64(163), '17914': np.int64(317), '17612': np.int64(790), '18795': np.int64(0), '18675': np.int64(768)}
2025-07-10 20:24:48,329 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-10 20:24:48,334 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-10 20:24:48,340 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-10 20:24:48,343 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-10 20:24:48,351 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-10 20:24:48,352 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17904': np.int64(156), '17914': np.int64(310), '17612': np.int64(1149), '18795': np.int64(0), '18675': np.int64(768)}
2025-07-10 20:24:48,354 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-10 20:24:48,355 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17904': np.int64(156), '17914': np.int64(310), '17612': np.int64(1149), '18795': np.int64(0), '18675': np.int64(768)}
2025-07-10 20:24:48,357 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-10 20:24:48,360 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-10 20:24:48,364 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-10 20:24:48,370 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-10 20:24:48,376 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-10 20:24:48,377 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17904': np.int64(155), '17914': np.int64(303), '17612': np.int64(853), '18795': np.int64(0), '18675': np.int64(768)}
2025-07-10 20:24:48,378 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-10 20:24:48,378 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17904': np.int64(155), '17914': np.int64(303), '17612': np.int64(853), '18795': np.int64(0), '18675': np.int64(768)}
2025-07-10 20:24:48,380 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-10 20:24:48,383 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-10 20:24:48,389 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-10 20:24:48,393 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-10 20:24:48,400 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-10 20:24:48,402 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736), '18795': np.int64(0), '18675': np.int64(767)}
2025-07-10 20:24:48,403 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-10 20:24:48,405 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736), '18795': np.int64(0), '18675': np.int64(767)}
2025-07-10 20:24:48,409 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-10 20:24:48,412 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-10 20:24:48,414 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-10 20:24:48,426 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-10 20:24:48,430 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736), '18795': np.int64(0), '18675': np.int64(767)}
2025-07-10 20:24:48,434 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-10 20:24:48,439 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736), '18795': np.int64(0), '18675': np.int64(767)}
2025-07-10 20:24:48,446 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-10 20:24:48,456 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-10 20:24:48,461 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-10 20:24:48,474 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-10 20:24:48,476 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736), '18795': np.int64(0), '18675': np.int64(767)}
2025-07-10 20:24:48,480 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-10 20:24:48,481 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17904': np.int64(153), '17914': np.int64(302), '17612': np.int64(736), '18795': np.int64(0), '18675': np.int64(767)}
2025-07-10 20:24:48,488 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-10 20:24:48,494 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-10 20:24:48,499 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-10 20:24:48,504 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-10 20:24:48,512 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-10 20:24:48,513 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17904': np.int64(151), '17914': np.int64(299), '17612': np.int64(689), '18795': np.int64(0), '18675': np.int64(766)}
2025-07-10 20:24:48,514 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-10 20:24:48,516 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17904': np.int64(151), '17914': np.int64(299), '17612': np.int64(689), '18795': np.int64(0), '18675': np.int64(766)}
2025-07-10 20:24:48,523 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-10 20:24:48,528 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-10 20:24:48,532 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-10 20:24:48,537 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-10 20:24:48,542 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-10 20:24:48,543 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17904': np.int64(151), '17914': np.int64(296), '17612': np.int64(602), '18795': np.int64(0), '18675': np.int64(766)}
2025-07-10 20:24:48,543 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-10 20:24:48,544 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17904': np.int64(151), '17914': np.int64(296), '17612': np.int64(602), '18795': np.int64(0), '18675': np.int64(766)}
2025-07-10 20:24:48,545 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-10 20:24:48,548 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-10 20:24:48,554 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-10 20:24:48,558 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-10 20:24:48,562 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-10 20:24:48,564 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17904': np.int64(150), '17914': np.int64(293), '17612': np.int64(535), '18795': np.int64(0), '18675': np.int64(765)}
2025-07-10 20:24:48,564 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-10 20:24:48,565 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17904': np.int64(150), '17914': np.int64(293), '17612': np.int64(535), '18795': np.int64(0), '18675': np.int64(765)}
2025-07-10 20:24:48,566 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-10 20:24:48,572 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-10 20:24:48,575 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-10 20:24:48,578 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-10 20:24:48,585 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-10 20:24:48,586 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17904': np.int64(136), '17914': np.int64(282), '17612': np.int64(301), '18795': np.int64(0), '18675': np.int64(765)}
2025-07-10 20:24:48,587 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-10 20:24:48,588 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17904': np.int64(136), '17914': np.int64(282), '17612': np.int64(301), '18795': np.int64(0), '18675': np.int64(765)}
2025-07-10 20:24:48,591 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-10 20:24:48,594 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-10 20:24:48,598 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-10 20:24:48,604 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-10 20:24:48,610 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-10 20:24:48,610 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218), '18795': np.int64(0), '18675': np.int64(765)}
2025-07-10 20:24:48,611 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-10 20:24:48,612 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218), '18795': np.int64(0), '18675': np.int64(765)}
2025-07-10 20:24:48,615 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-10 20:24:48,619 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-10 20:24:48,624 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-10 20:24:48,631 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-10 20:24:48,631 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218), '18795': np.int64(0), '18675': np.int64(765)}
2025-07-10 20:24:48,632 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-10 20:24:48,633 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218), '18795': np.int64(0), '18675': np.int64(765)}
2025-07-10 20:24:48,640 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-10 20:24:48,644 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-10 20:24:48,647 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-10 20:24:48,655 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-10 20:24:48,656 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218), '18795': np.int64(0), '18675': np.int64(765)}
2025-07-10 20:24:48,657 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-10 20:24:48,657 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17904': np.int64(135), '17914': np.int64(270), '17612': np.int64(218), '18795': np.int64(0), '18675': np.int64(765)}
2025-07-10 20:24:48,661 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-10 20:24:48,668 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-10 20:24:48,674 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-10 20:24:48,680 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-10 20:24:48,695 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-10 20:24:48,696 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17904': np.int64(133), '17914': np.int64(267), '17612': np.int64(54), '18795': np.int64(0), '18675': np.int64(762)}
2025-07-10 20:24:48,696 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-10 20:24:48,696 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17904': np.int64(133), '17914': np.int64(267), '17612': np.int64(54), '18795': np.int64(0), '18675': np.int64(762)}
2025-07-10 20:24:48,699 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-10 20:24:48,703 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-10 20:24:48,708 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-10 20:24:48,711 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-10 20:24:48,720 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-10 20:24:48,723 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17904': np.int64(132), '17914': np.int64(256), '17612': np.int64(-2), '18795': np.int64(0), '18675': np.int64(750)}
2025-07-10 20:24:48,724 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-10 20:24:48,724 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17904': np.int64(132), '17914': np.int64(256), '17612': np.int64(-2), '18795': np.int64(0), '18675': np.int64(750)}
2025-07-10 20:24:48,726 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-10 20:24:48,730 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-10 20:24:48,734 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-10 20:24:48,740 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-10 20:24:48,746 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-10 20:24:48,747 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17904': np.int64(131), '17914': np.int64(255), '17612': np.int64(517), '18795': np.int64(0), '18675': np.int64(750)}
2025-07-10 20:24:48,748 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-10 20:24:48,748 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17904': np.int64(131), '17914': np.int64(255), '17612': np.int64(517), '18795': np.int64(0), '18675': np.int64(750)}
2025-07-10 20:24:48,750 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-10 20:24:48,756 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-10 20:24:48,759 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-10 20:24:48,763 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-10 20:24:48,769 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-10 20:24:48,771 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17904': np.int64(129), '17914': np.int64(248), '17612': np.int64(470), '18795': np.int64(0), '18675': np.int64(750)}
2025-07-10 20:24:48,771 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-10 20:24:48,772 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17904': np.int64(129), '17914': np.int64(248), '17612': np.int64(470), '18795': np.int64(0), '18675': np.int64(750)}
2025-07-10 20:24:48,774 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-10 20:24:48,778 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-10 20:24:48,781 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-10 20:24:48,785 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-10 20:24:48,796 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-10 20:24:48,797 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:48,797 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-10 20:24:48,799 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:48,806 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-10 20:24:48,809 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-10 20:24:48,812 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-10 20:24:48,823 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-10 20:24:48,824 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:48,824 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-10 20:24:48,826 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:48,830 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-10 20:24:48,838 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-10 20:24:48,843 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-10 20:24:48,851 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-10 20:24:48,854 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:48,856 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-10 20:24:48,857 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17904': np.int64(128), '17914': np.int64(243), '17612': np.int64(394), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:48,862 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-10 20:24:48,868 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-10 20:24:48,877 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-10 20:24:48,880 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-10 20:24:48,894 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-10 20:24:48,896 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17904': np.int64(122), '17914': np.int64(243), '17612': np.int64(749), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:48,897 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-10 20:24:48,899 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17904': np.int64(122), '17914': np.int64(243), '17612': np.int64(749), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:48,906 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-10 20:24:48,915 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-10 20:24:48,924 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-10 20:24:48,931 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-10 20:24:48,945 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-10 20:24:48,946 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17904': np.int64(121), '17914': np.int64(242), '17612': np.int64(707), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:48,947 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-10 20:24:48,948 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17904': np.int64(121), '17914': np.int64(242), '17612': np.int64(707), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:48,951 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-10 20:24:48,959 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-10 20:24:48,966 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-10 20:24:48,973 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-10 20:24:48,983 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-10 20:24:48,984 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17904': np.int64(120), '17914': np.int64(238), '17612': np.int64(534), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:48,986 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-10 20:24:48,987 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17904': np.int64(120), '17914': np.int64(238), '17612': np.int64(534), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:48,992 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-10 20:24:48,997 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-10 20:24:49,004 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-10 20:24:49,010 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-10 20:24:49,019 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-10 20:24:49,021 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17904': np.int64(118), '17914': np.int64(229), '17612': np.int64(474), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:49,022 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-10 20:24:49,023 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17904': np.int64(118), '17914': np.int64(229), '17612': np.int64(474), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:49,026 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-10 20:24:49,033 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-10 20:24:49,039 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-10 20:24:49,046 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-10 20:24:49,058 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-10 20:24:49,059 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:49,060 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-10 20:24:49,060 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:49,068 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-10 20:24:49,074 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-10 20:24:49,080 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-10 20:24:49,089 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-10 20:24:49,090 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:49,092 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-10 20:24:49,093 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:49,099 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-10 20:24:49,107 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-10 20:24:49,111 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-10 20:24:49,122 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-10 20:24:49,123 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:49,126 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-10 20:24:49,128 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17904': np.int64(115), '17914': np.int64(223), '17612': np.int64(423), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:49,131 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-10 20:24:49,143 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-10 20:24:49,147 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-10 20:24:49,153 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-10 20:24:49,160 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-10 20:24:49,163 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17904': np.int64(112), '17914': np.int64(222), '17612': np.int64(339), '18795': np.int64(0), '18675': np.int64(749)}
2025-07-10 20:24:49,183 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612            955            955
0  2025-06-01  17904            178            178
1  2025-06-01  17914            326            326
4  2025-06-01  18675            769            769
3  2025-06-01  18795              0              0
2025-07-10 20:24:49,187 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
147  2025-06-30  17612            423            339
145  2025-06-30  17904            115            112
146  2025-06-30  17914            223            222
149  2025-06-30  18675            749            749
148  2025-06-30  18795              0              0
2025-07-10 20:24:49,189 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (150, 4)
2025-07-10 20:24:49,190 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-10 20:24:49,193 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612            955            955
0  2025-06-01  17904            178            178
1  2025-06-01  17914            326            326
4  2025-06-01  18675            769            769
3  2025-06-01  18795              0              0
2025-07-10 20:24:49,197 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
147  2025-06-30  17612            423            339
145  2025-06-30  17904            115            112
146  2025-06-30  17914            223            222
149  2025-06-30  18675            749            749
148  2025-06-30  18795              0              0
2025-07-10 20:24:49,198 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (150, 4)
2025-07-10 20:24:49,212 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     150.000000
mean      339.020000
std       298.957259
min        -2.000000
25%       120.250000
50%       243.000000
75%       736.000000
max      1149.000000
2025-07-10 20:24:49,218 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
2    2025-06-01            955
7    2025-06-02            884
12   2025-06-03            790
17   2025-06-04           1149
22   2025-06-05            853
27   2025-06-06            736
32   2025-06-07            736
37   2025-06-08            736
42   2025-06-09            689
47   2025-06-10            602
52   2025-06-11            535
57   2025-06-12            301
62   2025-06-13            218
67   2025-06-14            218
72   2025-06-15            218
77   2025-06-16             54
82   2025-06-17             -2
87   2025-06-18            517
92   2025-06-19            470
97   2025-06-20            394
102  2025-06-21            394
107  2025-06-22            394
112  2025-06-23            749
117  2025-06-24            707
122  2025-06-25            534
127  2025-06-26            474
132  2025-06-27            423
137  2025-06-28            423
142  2025-06-29            423
147  2025-06-30            339
2025-07-10 20:24:49,225 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
0    2025-06-01            178
5    2025-06-02            176
10   2025-06-03            163
15   2025-06-04            156
20   2025-06-05            155
25   2025-06-06            153
30   2025-06-07            153
35   2025-06-08            153
40   2025-06-09            151
45   2025-06-10            151
50   2025-06-11            150
55   2025-06-12            136
60   2025-06-13            135
65   2025-06-14            135
70   2025-06-15            135
75   2025-06-16            133
80   2025-06-17            132
85   2025-06-18            131
90   2025-06-19            129
95   2025-06-20            128
100  2025-06-21            128
105  2025-06-22            128
110  2025-06-23            122
115  2025-06-24            121
120  2025-06-25            120
125  2025-06-26            118
130  2025-06-27            115
135  2025-06-28            115
140  2025-06-29            115
145  2025-06-30            112
2025-07-10 20:24:49,233 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
2025-07-10 20:24:49,266 - src.services.reporting_logic.monthly_report_generator - INFO - Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-10 20:24:49,296 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-10 20:24:49,303 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    150.000000
mean       6.813333
std        6.502851
min        0.000000
25%        2.000000
50%        4.000000
75%       16.000000
max       24.000000
2025-07-10 20:24:49,310 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
2    2025-06-01           20
7    2025-06-02           19
12   2025-06-03           17
17   2025-06-04           24
22   2025-06-05           18
27   2025-06-06           16
32   2025-06-07           16
37   2025-06-08           16
42   2025-06-09           15
47   2025-06-10           13
52   2025-06-11           12
57   2025-06-12            7
62   2025-06-13            5
67   2025-06-14            5
72   2025-06-15            5
77   2025-06-16            2
82   2025-06-17            0
87   2025-06-18           11
92   2025-06-19           10
97   2025-06-20            9
102  2025-06-21            9
107  2025-06-22            9
112  2025-06-23           16
117  2025-06-24           15
122  2025-06-25           12
127  2025-06-26           10
132  2025-06-27            9
137  2025-06-28            9
142  2025-06-29            9
147  2025-06-30            8
2025-07-10 20:24:49,315 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-10 20:24:49,316 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-10 20:24:49,317 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-10 20:24:49,318 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-10 20:24:49,324 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-10 20:24:49,327 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-10 20:24:49,329 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-10 20:24:49,341 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-10 20:24:49,342 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-10 20:24:49,343 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: ['17612', '17904', '17914', '18675']
2025-07-10 20:24:49,349 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-10 20:24:49,362 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-10 20:24:49,364 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns AFTER string conversion: ['17612', '17904', '17914', '18675']
2025-07-10 20:24:49,371 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17612_Shipped' from pivot for SKU '17612'. Head:
Date
2025-06-01      NaN
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-10 20:24:49,373 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17612_Shipped': 30
2025-07-10 20:24:49,377 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17904_Shipped' from pivot for SKU '17904'. Head:
Date
2025-06-01     NaN
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-10 20:24:49,380 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17904_Shipped': 29
2025-07-10 20:24:49,385 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '17914_Shipped' from pivot for SKU '17914'. Head:
Date
2025-06-01    NaN
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-10 20:24:49,388 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '17914_Shipped': 29
2025-07-10 20:24:49,394 - src.services.reporting_logic.monthly_report_generator - DEBUG - Populated '18675_Shipped' from pivot for SKU '18675'. Head:
Date
2025-06-01    NaN
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-10 20:24:49,396 - src.services.reporting_logic.monthly_report_generator - DEBUG - Non-zero count for '18675_Shipped': 16
2025-07-10 20:24:49,398 - src.services.reporting_logic.monthly_report_generator - WARNING - SKU '18795' not found in daily_shipped_pivot columns. '18795_Shipped' column set to 0.
2025-07-10 20:24:49,402 - src.services.reporting_logic.monthly_report_generator - DEBUG - Set '18795_Shipped' to 0. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-10 20:24:49,407 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17612_Shipped'. Head:
Date
2025-06-01      0.0
2025-06-02     71.0
2025-06-03     94.0
2025-06-04    119.0
2025-06-05    296.0
2025-07-10 20:24:49,410 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17904_Shipped'. Head:
Date
2025-06-01     0.0
2025-06-02     2.0
2025-06-03    13.0
2025-06-04     7.0
2025-06-05     1.0
2025-07-10 20:24:49,414 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '17914_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    3.0
2025-06-03    6.0
2025-06-04    7.0
2025-06-05    7.0
2025-07-10 20:24:49,419 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18675_Shipped'. Head:
Date
2025-06-01    0.0
2025-06-02    1.0
2025-06-03    0.0
2025-06-04    0.0
2025-06-05    0.0
2025-07-10 20:24:49,423 - src.services.reporting_logic.monthly_report_generator - DEBUG - Applied fillna(0) to '18795_Shipped'. Head:
Date
2025-06-01    0
2025-06-02    0
2025-06-03    0
2025-06-04    0
2025-06-05    0
2025-07-10 20:24:49,424 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (head):
2025-07-10 20:24:49,435 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-01         0.0           0.0           0.00             0.00                20.25         20.25            0.0            0.0            0.0            0.0              0
2025-06-02        19.0          77.0          80.75            57.75                19.35        157.85           71.0            2.0            3.0            1.0              0
2025-06-03        22.0         113.0          93.50            84.75                18.00        196.25           94.0           13.0            6.0            0.0              0
2025-06-04        35.0         133.0         148.75            99.75                21.15        269.65          119.0            7.0            7.0            0.0              0
2025-06-05        83.0         304.0         352.75           228.00                18.45        599.20          296.0            1.0            7.0            0.0              0
2025-07-10 20:24:49,438 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (columns and dtypes):
2025-07-10 20:24:49,449 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-10 20:24:49,450 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report DataFrame after adding SKU_Shipped columns (tail):
2025-07-10 20:24:49,461 - src.services.reporting_logic.monthly_report_generator - DEBUG -             Num_Orders  Num_Packages  Orders Charge  Packages Charge  Space Rental Charge  Total Charge  17612_Shipped  17904_Shipped  17914_Shipped  18675_Shipped  18795_Shipped
Date                                                                                                                                                                              
2025-06-26        14.0          71.0          59.50            53.25                13.95        126.70           60.0            2.0            9.0            0.0              0
2025-06-27        17.0          60.0          72.25            45.00                13.50        130.75           51.0            3.0            6.0            0.0              0
2025-06-28         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-29         0.0           0.0           0.00             0.00                13.50         13.50            0.0            0.0            0.0            0.0              0
2025-06-30        10.0          88.0          42.50            66.00                13.05        121.55           84.0            3.0            1.0            0.0              0
2025-07-10 20:24:49,489 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (head):
2025-07-10 20:24:49,496 - src.services.reporting_logic.monthly_report_generator - DEBUG -        Date  # Of Orders  17612 17904 17914 18675 18795   Orders Packages Space Rental    Total
0  6/1/2025          0.0      -     -     -     -     -    $0.00    $0.00       $20.25   $20.25
1  6/2/2025         19.0   71.0   2.0   3.0   1.0     -   $80.75   $57.75       $19.35  $157.85
2  6/3/2025         22.0   94.0  13.0   6.0     -     -   $93.50   $84.75       $18.00  $196.25
3  6/4/2025         35.0  119.0   7.0   7.0     -     -  $148.75   $99.75       $21.15  $269.65
4  6/5/2025         83.0  296.0   1.0   7.0     -     -  $352.75  $228.00       $18.45  $599.20
2025-07-10 20:24:49,497 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (columns and dtypes):
2025-07-10 20:24:49,510 - src.services.reporting_logic.monthly_report_generator - DEBUG - None
2025-07-10 20:24:49,512 - src.services.reporting_logic.monthly_report_generator - DEBUG - Final Report DataFrame AFTER all formatting (tail):
2025-07-10 20:24:49,522 - src.services.reporting_logic.monthly_report_generator - DEBUG -          Date  # Of Orders   17612 17904  17914 18675 18795    Orders  Packages Space Rental     Total
26  6/27/2025         17.0    51.0   3.0    6.0     -     -    $72.25    $45.00       $13.50   $130.75
27  6/28/2025          0.0       -     -      -     -     -     $0.00     $0.00       $13.50    $13.50
28  6/29/2025          0.0       -     -      -     -     -     $0.00     $0.00       $13.50    $13.50
29  6/30/2025         10.0    84.0   3.0    1.0     -     -    $42.50    $66.00       $13.05   $121.55
30      TOTAL        552.0  2046.0  66.0  104.0  20.0     -  $2346.00  $1677.00      $459.90  $4482.90
2025-07-10 20:24:49,524 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-10 20:24:49,526 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-10 20:24:49,527 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-10 20:24:49,528 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-10 20:24:49,538 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-10 20:24:49,796 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-10 20:24:49,799 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-10 20:24:49,801 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-10 20:24:49,802 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-10 20:24:49,865 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-10 20:24:50,031 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-10 20:24:50,034 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-10 20:24:50,433 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:50,819 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:51,260 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-10 20:24:51,638 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-10 20:24:51,644 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-10 20:24:52,150 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-10 20:24:52,153 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-10 20:24:52,154 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-10 20:24:52,157 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-10 20:24:52,158 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-10 20:24:52,159 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-10 20:24:52,159 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-10 20:24:52,164 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (2, 5)
2025-07-10 20:24:52,165 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-10 20:24:52,174 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  18795      6279         Receive
2  17612         2            Ship
3  17612         6            Ship
4  17612         1            Ship
2025-07-10 20:24:52,176 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         1            Ship
63  17914         2            Ship
2025-07-10 20:24:52,177 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (64, 3)
2025-07-10 20:24:52,193 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (5, 2)
2025-07-10 20:24:52,194 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-10 20:24:52,203 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-10
2025-07-10 20:24:52,206 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-10 20:24:52,212 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-10 20:24:52,212 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-10 20:24:52,213 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-10 20:24:52,214 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-10 20:24:52,223 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-10 20:24:52,224 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-10 20:24:52,229 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-10 20:24:52,506 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-10 20:24:52,510 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-10 20:24:52,511 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-10 20:24:52,512 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-10 20:24:52,581 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-10 20:24:52,749 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-10 20:24:52,755 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-10 20:24:53,185 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:53,630 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-10 20:24:54,001 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-10 20:24:54,387 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-10 20:24:54,388 - gspread_dataframe - DEBUG - 24 cell updates to send
2025-07-10 20:24:54,742 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD6?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-10 20:24:54,744 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D6", 'updatedRows': 6, 'updatedColumns': 4, 'updatedCells': 24}
2025-07-10 20:24:54,745 - src.services.google_sheets.api_client - INFO - Successfully wrote 5 rows to worksheet 'Weekly Report'.
2025-07-10 20:24:54,746 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-10 20:24:54,746 - __main__ - INFO - Script finished successfully.
