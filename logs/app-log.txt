2025-07-07 14:27:15,218 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 14:27:15,219 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 14:27:15,632 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 14:27:15,632 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 14:27:15,633 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 14:27:15,633 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 14:27:15,645 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 14:27:15,930 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 14:27:15,932 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 14:27:15,933 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 14:27:15,933 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 14:27:15,957 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 14:27:16,118 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 14:27:16,120 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 14:27:16,534 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:16,652 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:16,653 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 14:27:16,786 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 14:27:16,790 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 14:27:16,794 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 14:27:16,794 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 14:27:16,797 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 14:27:17,008 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 14:27:17,010 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 14:27:17,011 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 14:27:17,011 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 14:27:17,034 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 14:27:17,184 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 14:27:17,187 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 14:27:17,393 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:17,509 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:17,512 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 14:27:17,652 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 14:27:17,653 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 14:27:17,654 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 14:27:17,654 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 14:27:17,656 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 14:27:17,859 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 14:27:17,862 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 14:27:17,864 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 14:27:17,865 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 14:27:17,887 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 14:27:18,036 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 14:27:18,038 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 14:27:18,261 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:18,370 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:18,371 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 14:27:18,497 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 14:27:18,509 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 14:27:18,512 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 14:27:18,517 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 14:27:18,518 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 14:27:18,520 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 14:27:18,726 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 14:27:18,727 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 14:27:18,727 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 14:27:18,728 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 14:27:18,749 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 14:27:18,912 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 14:27:18,915 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 14:27:19,153 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:19,262 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:19,263 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 14:27:19,416 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 14:27:19,423 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 14:27:19,428 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 14:27:19,428 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 14:27:19,431 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 14:27:19,628 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 14:27:19,630 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 14:27:19,630 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 14:27:19,631 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 14:27:19,652 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 14:27:19,792 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 14:27:19,796 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 14:27:20,009 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:20,126 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:20,128 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 14:27:20,264 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 14:27:20,265 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 14:27:20,271 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 14:27:20,276 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 14:27:20,277 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 14:27:20,280 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 14:27:20,283 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 14:27:20,285 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 14:27:20,286 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 14:27:20,289 - src.services.reporting_logic.monthly_report_generator - DEBUG - Monthly report date range: 2025-06-01 to 2025-06-30
2025-07-07 14:27:20,293 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 14:27:20,297 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 14:27:20,298 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 14:27:20,301 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 14:27:20,305 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 14:27:20,305 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 14:27:20,307 - src.services.reporting_logic.inventory_calculations - INFO - Calculating daily inventory (BOD/EOD)...
2025-07-07 14:27:20,431 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 14:27:20,441 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 14:27:20,442 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 14:27:20,446 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 14:27:20,657 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 14:27:20,660 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 14:27:20,661 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 14:27:20,661 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 14:27:20,684 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 14:27:20,839 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 14:27:20,843 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 14:27:21,032 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:21,159 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:21,325 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 14:27:21,467 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 14:27:21,469 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 14:27:22,637 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 14:27:22,639 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 14:27:22,640 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 14:27:22,642 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 14:27:22,644 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 14:27:22,645 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 14:27:22,652 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 14:27:22,889 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 14:27:22,891 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 14:27:22,892 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 14:27:22,893 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 14:27:22,947 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 14:27:23,102 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 14:27:23,106 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 14:27:23,296 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:23,412 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:23,413 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 14:27:23,541 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 14:27:23,547 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 14:27:23,564 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 14:27:23,650 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 14:27:23,651 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 14:27:23,652 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 14:27:23,654 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 14:27:23,658 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 14:27:23,661 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 14:27:23,663 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 14:27:23,673 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 14:27:23,675 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 14:27:23,687 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 14:27:23,688 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 14:27:23,699 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 14:27:23,949 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 14:27:23,953 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 14:27:23,954 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 14:27:23,955 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 14:27:24,013 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 14:27:24,158 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 14:27:24,163 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 14:27:24,350 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:24,471 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 14:27:24,613 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 14:27:24,775 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 14:27:24,777 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 14:27:24,921 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 14:27:24,922 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 14:27:24,923 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 14:27:24,925 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 14:27:24,926 - __main__ - INFO - Script finished successfully.
2025-07-07 15:56:53,955 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 15:56:53,956 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 15:56:54,387 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 15:56:54,387 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 15:56:54,388 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 15:56:54,388 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 15:56:54,420 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 15:56:54,700 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 15:56:54,701 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 15:56:54,702 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 15:56:54,702 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 15:56:54,730 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 15:56:54,906 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 15:56:54,910 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 15:56:55,507 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:56:55,636 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:56:55,637 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 15:56:55,825 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 15:56:55,837 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 15:56:55,852 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 15:56:55,853 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 15:56:55,856 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 15:56:56,080 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 15:56:56,083 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 15:56:56,083 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 15:56:56,084 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 15:56:56,107 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 15:56:56,269 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 15:56:56,271 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 15:56:56,481 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:56:56,602 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:56:56,603 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 15:56:56,751 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 15:56:56,755 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 15:56:56,755 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 15:56:56,756 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 15:56:56,758 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 15:56:56,969 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 15:56:56,970 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 15:56:56,971 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 15:56:56,971 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 15:56:56,994 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 15:56:57,132 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 15:56:57,133 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 15:56:57,345 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:56:57,502 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:56:57,503 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 15:56:57,656 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 15:56:57,666 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 15:56:57,671 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 15:56:57,689 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 15:56:57,689 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 15:56:57,691 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 15:56:57,894 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 15:56:57,896 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 15:56:57,897 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 15:56:57,897 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 15:56:57,921 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 15:56:58,081 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 15:56:58,084 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 15:56:58,291 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:56:58,416 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:56:58,418 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 15:56:58,577 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 15:56:58,581 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 15:56:58,586 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 15:56:58,587 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 15:56:58,589 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 15:56:58,839 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 15:56:58,842 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 15:56:58,843 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 15:56:58,844 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 15:56:58,867 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 15:56:59,019 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 15:56:59,021 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 15:56:59,230 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:56:59,351 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:56:59,352 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 15:56:59,513 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 15:56:59,514 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 15:56:59,533 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 15:56:59,540 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 15:56:59,541 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 15:56:59,545 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 15:56:59,549 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 15:56:59,551 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 15:56:59,552 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 15:56:59,574 - src.services.reporting_logic.monthly_report_generator - DEBUG - Monthly report date range: 2025-06-01 to 2025-06-30
2025-07-07 15:56:59,579 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 15:56:59,583 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 15:56:59,584 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 15:56:59,587 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 15:56:59,591 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 15:56:59,592 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 15:56:59,594 - src.services.reporting_logic.inventory_calculations - INFO - Calculating daily inventory (BOD/EOD)...
2025-07-07 15:56:59,747 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 15:56:59,780 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 15:56:59,782 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 15:56:59,784 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 15:56:59,987 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 15:56:59,989 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 15:56:59,989 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 15:56:59,990 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 15:57:00,013 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 15:57:00,161 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 15:57:00,163 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 15:57:00,367 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:57:00,485 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:57:00,679 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 15:57:00,834 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 15:57:00,835 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 15:57:01,003 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 15:57:01,005 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 15:57:01,006 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 15:57:01,007 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 15:57:01,007 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 15:57:01,007 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 15:57:01,010 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 15:57:01,228 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 15:57:01,230 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 15:57:01,231 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 15:57:01,232 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 15:57:01,257 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 15:57:01,414 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 15:57:01,419 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 15:57:01,635 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:57:01,769 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:57:01,770 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 15:57:01,924 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 15:57:01,928 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 15:57:01,957 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 15:57:02,039 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 15:57:02,040 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 15:57:02,041 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 15:57:02,043 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 15:57:02,048 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 15:57:02,056 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 15:57:02,063 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 15:57:02,076 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 15:57:02,078 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 15:57:02,088 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 15:57:02,089 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 15:57:02,097 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 15:57:02,423 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 15:57:02,427 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 15:57:02,428 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 15:57:02,430 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 15:57:02,491 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 15:57:02,664 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 15:57:02,668 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 15:57:02,873 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:57:02,998 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 15:57:04,553 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 15:57:04,717 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 15:57:04,720 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 15:57:04,878 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 15:57:04,879 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 15:57:04,880 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 15:57:04,881 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 15:57:04,881 - __main__ - INFO - Script finished successfully.
2025-07-07 16:32:01,275 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 16:32:01,276 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 16:32:01,832 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 16:32:01,833 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 16:32:01,833 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:32:01,833 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:32:01,847 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:32:02,098 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:32:02,100 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:32:02,101 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:32:02,101 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:32:02,126 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:32:02,298 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:32:02,300 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:32:02,846 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:02,967 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:02,970 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:32:03,121 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:32:03,123 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:32:03,125 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:32:03,127 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:32:03,129 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:32:03,353 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:32:03,355 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:32:03,356 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:32:03,356 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:32:03,384 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:32:03,520 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:32:03,523 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:32:03,734 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:03,852 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:03,853 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 16:32:03,991 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 16:32:03,993 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 16:32:03,995 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:32:03,995 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:32:03,998 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:32:04,230 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:32:04,234 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:32:04,235 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:32:04,236 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:32:04,259 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:32:04,424 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:32:04,427 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:32:04,615 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:04,734 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:04,737 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 16:32:04,877 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 16:32:04,885 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 16:32:04,889 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 16:32:04,894 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:32:04,895 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:32:04,898 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:32:05,104 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:32:05,107 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:32:05,109 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:32:05,110 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:32:05,132 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:32:05,285 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:32:05,286 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:32:05,601 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:05,718 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:05,719 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 16:32:05,865 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 16:32:05,868 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 16:32:05,872 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:32:05,873 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:32:05,876 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:32:06,084 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:32:06,089 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:32:06,089 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:32:06,090 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:32:06,112 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:32:06,276 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:32:06,278 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:32:06,489 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:06,606 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:06,608 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:32:06,830 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:32:06,834 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:32:06,842 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 16:32:06,845 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 16:32:06,847 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 16:32:06,849 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 16:32:06,853 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 16:32:06,854 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 16:32:06,855 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 16:32:06,860 - src.services.reporting_logic.monthly_report_generator - DEBUG - Monthly report date range: 2025-06-01 to 2025-06-30
2025-07-07 16:32:06,865 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 16:32:06,869 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 16:32:06,871 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 16:32:06,875 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 16:32:06,878 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 16:32:06,879 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 16:32:06,880 - src.services.reporting_logic.inventory_calculations - INFO - Calculating daily inventory (BOD/EOD)...
2025-07-07 16:32:07,017 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 16:32:07,029 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:32:07,030 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:32:07,032 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:32:07,248 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:32:07,251 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:32:07,253 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:32:07,254 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 16:32:07,276 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:32:07,438 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:32:07,439 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:32:07,628 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:07,751 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:07,919 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 16:32:08,061 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 16:32:08,062 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 16:32:08,949 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 16:32:08,951 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 16:32:08,952 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 16:32:08,953 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 16:32:08,954 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:32:08,955 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:32:08,958 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:32:09,196 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:32:09,199 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:32:09,200 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:32:09,201 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:32:09,223 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:32:09,385 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:32:09,389 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:32:09,591 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:09,708 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:09,710 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 16:32:09,851 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 16:32:09,853 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 16:32:09,858 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 16:32:09,877 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 16:32:09,878 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 16:32:09,879 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 16:32:09,879 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 16:32:09,881 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 16:32:09,882 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 16:32:09,883 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 16:32:09,886 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 16:32:09,886 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 16:32:09,889 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:32:09,890 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:32:09,893 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:32:10,093 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:32:10,094 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:32:10,095 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:32:10,095 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 16:32:10,118 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:32:10,261 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:32:10,263 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:32:10,456 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:10,570 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:32:10,891 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 16:32:11,032 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 16:32:11,035 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 16:32:11,172 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 16:32:11,173 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 16:32:11,174 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 16:32:11,175 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 16:32:11,175 - __main__ - INFO - Script finished successfully.
2025-07-07 16:41:22,296 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 16:41:22,297 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 16:41:22,946 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 16:41:22,947 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 16:41:22,947 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:41:22,948 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:41:22,994 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:41:23,302 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:41:23,305 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:41:23,305 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:41:23,306 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:41:23,338 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:41:23,547 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:41:23,550 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:41:23,962 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:24,065 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:24,067 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:41:24,210 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:41:24,220 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:41:24,239 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:41:24,239 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:41:24,242 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:41:24,460 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:41:24,462 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:41:24,463 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:41:24,463 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:41:24,491 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:41:24,658 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:41:24,660 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:41:24,849 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:24,961 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:24,963 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 16:41:25,105 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 16:41:25,111 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 16:41:25,112 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:41:25,113 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:41:25,116 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:41:25,325 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:41:25,327 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:41:25,327 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:41:25,328 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:41:25,353 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:41:25,508 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:41:25,510 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:41:25,703 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:25,804 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:25,806 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 16:41:25,947 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 16:41:25,955 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 16:41:25,962 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 16:41:25,980 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:41:25,980 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:41:25,983 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:41:26,192 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:41:26,193 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:41:26,195 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:41:26,195 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:41:26,224 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:41:26,382 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:41:26,384 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:41:26,592 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:26,706 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:26,707 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 16:41:26,844 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 16:41:26,847 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 16:41:26,853 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:41:26,854 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:41:26,859 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:41:27,081 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:41:27,082 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:41:27,083 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:41:27,084 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:41:27,116 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:41:27,276 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:41:27,278 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:41:27,461 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:27,564 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:27,566 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:41:27,699 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:41:27,701 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:41:27,764 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 16:41:27,769 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 16:41:27,771 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 16:41:27,774 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 16:41:27,778 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 16:41:27,779 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 16:41:27,780 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 16:41:27,829 - src.services.reporting_logic.monthly_report_generator - ERROR - Error generating monthly charge report: 'Ship Date'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Ship Date'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\monthly_report_generator.py", line 33, in generate_monthly_charge_report
    shipped_items_df['Date'] = pd.to_datetime(shipped_items_df['Ship Date']).dt.date # Assuming 'Ship Date' is the correct column
                                              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Ship Date'
2025-07-07 16:41:27,857 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 16:41:27,858 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:41:27,859 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:41:27,863 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:41:28,098 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:41:28,099 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:41:28,100 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:41:28,101 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:41:28,133 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:41:28,301 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:41:28,303 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:41:28,497 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:28,607 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:28,609 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 16:41:28,743 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 16:41:28,747 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 16:41:28,761 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 16:41:28,763 - src.services.reporting_logic.inventory_calculations - ERROR - Error calculating current inventory: unhashable type: 'list'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 90, in calculate_current_inventory
    shipments = shipped_items_df[['SKU', 'Quantity_Shipped']].rename(columns={'Quantity_Shipped': 'Quantity'})
                ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'list'
2025-07-07 16:41:28,766 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 16:41:28,767 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 16:41:28,768 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 16:41:28,773 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 16:41:28,777 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 16:41:28,779 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 16:41:28,788 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 16:41:28,789 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 16:41:28,793 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:41:28,793 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:41:28,796 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:41:29,012 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:41:29,014 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:41:29,015 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:41:29,015 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 16:41:29,042 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:41:29,187 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:41:29,189 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:41:29,388 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:29,495 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:41:29,663 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 16:41:29,814 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 16:41:29,815 - gspread_dataframe - DEBUG - 4 cell updates to send
2025-07-07 16:41:30,812 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD1?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 16:41:30,813 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D1", 'updatedRows': 1, 'updatedColumns': 4, 'updatedCells': 4}
2025-07-07 16:41:30,814 - src.services.google_sheets.api_client - INFO - Successfully wrote 0 rows to worksheet 'Weekly Report'.
2025-07-07 16:41:30,815 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 16:41:30,815 - __main__ - INFO - Script finished successfully.
2025-07-07 16:42:14,089 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 16:42:14,090 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 16:42:14,738 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 16:42:14,738 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 16:42:14,739 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:42:14,739 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:42:14,782 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:42:15,031 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:42:15,034 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:42:15,035 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:42:15,036 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:42:15,081 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:42:15,264 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:42:15,296 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:42:15,673 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:15,789 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:15,791 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:42:15,924 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:42:15,931 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:42:15,958 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:42:15,959 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:42:15,962 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:42:16,192 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:42:16,194 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:42:16,194 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:42:16,195 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:42:16,231 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:42:16,381 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:42:16,383 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:42:16,603 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:16,716 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:16,718 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 16:42:16,856 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 16:42:16,859 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 16:42:16,860 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:42:16,861 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:42:16,864 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:42:17,072 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:42:17,074 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:42:17,074 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:42:17,075 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:42:17,101 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:42:17,262 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:42:17,263 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:42:17,446 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:17,561 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:17,563 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 16:42:17,698 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 16:42:17,709 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 16:42:17,716 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 16:42:17,736 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:42:17,738 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:42:17,742 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:42:17,949 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:42:17,951 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:42:17,952 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:42:17,953 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:42:17,982 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:42:18,142 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:42:18,144 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:42:18,348 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:18,468 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:18,469 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 16:42:18,602 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 16:42:18,605 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 16:42:18,609 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:42:18,609 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:42:18,612 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:42:18,818 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:42:18,819 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:42:18,820 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:42:18,821 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:42:18,847 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:42:19,008 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:42:19,009 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:42:19,197 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:19,311 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:19,313 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:42:19,446 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:42:19,447 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:42:19,464 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 16:42:19,478 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 16:42:19,479 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 16:42:19,486 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 16:42:19,519 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 16:42:19,534 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 16:42:19,542 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 16:42:19,568 - src.services.reporting_logic.monthly_report_generator - ERROR - Error generating monthly charge report: 'Ship Date'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Ship Date'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\monthly_report_generator.py", line 33, in generate_monthly_charge_report
    shipped_items_df['Date'] = pd.to_datetime(shipped_items_df['Ship Date']).dt.date # Assuming 'Ship Date' is the correct column
                                              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Ship Date'
2025-07-07 16:42:19,581 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 16:42:19,582 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:42:19,583 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:42:19,592 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:42:19,813 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:42:19,814 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:42:19,815 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:42:19,816 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:42:19,850 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:42:19,999 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:42:20,001 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:42:20,181 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:20,294 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:20,295 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 16:42:20,428 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 16:42:20,431 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 16:42:20,447 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 16:42:20,448 - src.services.reporting_logic.inventory_calculations - ERROR - Error calculating current inventory: unhashable type: 'list'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 90, in calculate_current_inventory
    shipments = shipped_items_df[['SKU', 'Quantity_Shipped']].rename(columns={'Quantity_Shipped': 'Quantity'})
                ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'list'
2025-07-07 16:42:20,455 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 16:42:20,457 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 16:42:20,459 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 16:42:20,465 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 16:42:20,470 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 16:42:20,476 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 16:42:20,494 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 16:42:20,494 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 16:42:20,503 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:42:20,504 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:42:20,510 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:42:20,729 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:42:20,730 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:42:20,731 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:42:20,732 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 16:42:20,765 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:42:20,921 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:42:20,924 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:42:21,110 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:21,224 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:42:21,368 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 16:42:21,507 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 16:42:21,508 - gspread_dataframe - DEBUG - 4 cell updates to send
2025-07-07 16:42:21,639 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD1?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 16:42:21,641 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D1", 'updatedRows': 1, 'updatedColumns': 4, 'updatedCells': 4}
2025-07-07 16:42:21,643 - src.services.google_sheets.api_client - INFO - Successfully wrote 0 rows to worksheet 'Weekly Report'.
2025-07-07 16:42:21,644 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 16:42:21,645 - __main__ - INFO - Script finished successfully.
2025-07-07 16:43:04,406 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 16:43:04,406 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 16:43:04,901 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 16:43:04,902 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 16:43:04,902 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:43:04,902 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:43:04,917 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:43:05,141 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:43:05,142 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:43:05,143 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:43:05,143 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:43:05,170 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:43:05,355 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:43:05,357 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:43:05,633 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:05,746 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:05,747 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:43:05,872 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:43:05,874 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:43:05,877 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:43:05,877 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:43:05,879 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:43:06,129 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:43:06,131 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:43:06,131 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:43:06,132 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:43:06,154 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:43:06,326 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:43:06,328 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:43:06,516 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:06,624 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:06,626 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 16:43:06,760 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 16:43:06,762 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 16:43:06,762 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:43:06,763 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:43:06,765 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:43:06,986 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:43:06,987 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:43:06,988 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:43:06,988 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:43:07,011 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:43:07,177 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:43:07,179 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:43:07,384 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:07,585 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:07,588 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 16:43:07,727 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 16:43:07,733 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 16:43:07,737 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 16:43:07,743 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:43:07,743 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:43:07,745 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:43:07,946 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:43:07,950 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:43:07,950 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:43:07,951 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:43:07,973 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:43:08,168 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:43:08,170 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:43:08,368 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:08,485 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:08,487 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 16:43:08,652 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 16:43:08,656 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 16:43:08,659 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:43:08,659 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:43:08,662 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:43:08,858 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:43:08,860 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:43:08,860 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:43:08,861 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:43:08,884 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:43:09,034 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:43:09,036 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:43:09,289 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:09,393 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:09,396 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:43:09,535 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:43:09,539 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:43:09,547 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 16:43:09,552 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 16:43:09,553 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 16:43:09,556 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 16:43:09,566 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 16:43:09,571 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 16:43:09,573 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 16:43:09,589 - src.services.reporting_logic.monthly_report_generator - DEBUG - Monthly report date range: 2025-06-01 to 2025-06-30
2025-07-07 16:43:09,597 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 16:43:09,609 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 16:43:09,611 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 16:43:09,623 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 16:43:09,632 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 16:43:09,635 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 16:43:09,642 - src.services.reporting_logic.inventory_calculations - INFO - Calculating daily inventory (BOD/EOD)...
2025-07-07 16:43:09,804 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 16:43:09,827 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:43:09,827 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:43:09,830 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:43:10,031 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:43:10,032 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:43:10,033 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:43:10,034 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 16:43:10,056 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:43:10,213 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:43:10,215 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:43:10,414 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:10,526 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:10,683 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 16:43:10,826 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 16:43:10,828 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 16:43:10,967 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 16:43:10,967 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 16:43:10,968 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 16:43:10,970 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 16:43:10,971 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:43:10,972 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:43:10,976 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:43:11,192 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:43:11,194 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:43:11,195 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:43:11,196 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:43:11,227 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:43:11,370 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:43:11,371 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:43:11,574 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:11,689 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:11,691 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 16:43:11,815 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 16:43:11,818 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 16:43:11,828 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 16:43:11,920 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 16:43:11,923 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 16:43:11,927 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 16:43:11,934 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 16:43:11,945 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 16:43:11,946 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 16:43:11,949 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 16:43:11,956 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 16:43:11,958 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 16:43:11,967 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:43:11,967 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:43:11,971 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:43:12,186 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:43:12,189 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:43:12,191 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:43:12,194 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 16:43:12,259 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:43:12,429 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:43:12,432 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:43:12,623 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:12,743 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:43:12,887 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 16:43:13,045 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 16:43:13,048 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 16:43:13,212 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 16:43:13,214 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 16:43:13,216 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 16:43:13,219 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 16:43:13,221 - __main__ - INFO - Script finished successfully.
2025-07-07 16:49:15,380 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 16:49:15,380 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 16:49:15,736 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 16:49:15,736 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 16:49:15,736 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:49:15,737 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:49:15,751 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:49:16,021 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:49:16,024 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:49:16,025 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:49:16,026 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:49:16,048 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:49:16,211 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:49:16,214 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:49:16,640 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:16,876 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:16,877 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:49:17,045 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:49:17,047 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:49:17,050 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:49:17,050 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:49:17,053 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:49:17,250 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:49:17,252 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:49:17,253 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:49:17,253 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:49:17,278 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:49:17,420 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:49:17,423 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:49:17,625 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:17,767 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:17,770 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 16:49:17,930 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 16:49:17,932 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 16:49:17,935 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:49:17,935 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:49:17,938 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:49:18,146 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:49:18,147 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:49:18,148 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:49:18,149 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:49:18,180 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:49:18,356 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:49:18,358 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:49:18,559 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:18,688 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:18,690 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 16:49:18,886 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 16:49:18,894 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 16:49:18,897 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 16:49:18,903 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:49:18,903 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:49:18,906 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:49:19,141 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:49:19,143 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:49:19,143 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:49:19,143 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:49:19,167 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:49:19,311 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:49:19,312 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:49:19,524 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:19,649 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:19,652 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 16:49:19,805 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 16:49:19,807 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 16:49:19,810 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:49:19,811 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:49:19,813 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:49:20,038 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:49:20,039 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:49:20,039 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:49:20,040 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:49:20,062 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:49:20,211 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:49:20,214 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:49:20,422 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:20,548 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:20,550 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:49:20,692 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:49:20,694 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:49:20,699 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 16:49:20,704 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 16:49:20,707 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 16:49:20,710 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 16:49:20,713 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 16:49:20,714 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 16:49:20,715 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 16:49:20,718 - src.services.reporting_logic.monthly_report_generator - ERROR - Error generating monthly charge report: 'Ship Date'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Ship Date'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\monthly_report_generator.py", line 36, in generate_monthly_charge_report
    shipped_orders_df['Date'] = pd.to_datetime(shipped_orders_df['Ship Date']).dt.date # Assuming 'Ship Date' is correct for orders
                                               ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Ship Date'
2025-07-07 16:49:20,724 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 16:49:20,725 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:49:20,725 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:49:20,728 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:49:20,928 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:49:20,930 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:49:20,930 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:49:20,931 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:49:20,952 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:49:21,096 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:49:21,097 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:49:21,306 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:21,437 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:21,440 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 16:49:21,598 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 16:49:21,599 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 16:49:21,604 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 16:49:21,604 - src.services.reporting_logic.inventory_calculations - WARNING - shipped_items_df was not a DataFrame in calculate_current_inventory. Attempting conversion.
2025-07-07 16:49:21,605 - src.services.reporting_logic.inventory_calculations - ERROR - Failed to convert shipped_items_df to DataFrame: If using all scalar values, you must pass an index
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 93, in calculate_current_inventory
    shipped_items_df = pd.DataFrame(shipped_items_df)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\internals\construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\internals\construction.py", line 667, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
2025-07-07 16:49:21,626 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 16:49:21,627 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 16:49:21,627 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 16:49:21,629 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 16:49:21,630 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 16:49:21,631 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 16:49:21,634 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 16:49:21,634 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 16:49:21,637 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:49:21,638 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:49:21,641 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:49:21,861 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:49:21,862 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:49:21,863 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:49:21,864 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 16:49:21,885 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:49:22,031 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:49:22,033 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:49:22,237 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:22,361 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:49:22,507 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 16:49:22,678 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 16:49:22,681 - gspread_dataframe - DEBUG - 4 cell updates to send
2025-07-07 16:49:22,816 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD1?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 16:49:22,818 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D1", 'updatedRows': 1, 'updatedColumns': 4, 'updatedCells': 4}
2025-07-07 16:49:22,819 - src.services.google_sheets.api_client - INFO - Successfully wrote 0 rows to worksheet 'Weekly Report'.
2025-07-07 16:49:22,821 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 16:49:22,822 - __main__ - INFO - Script finished successfully.
2025-07-07 16:51:26,878 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 16:51:26,879 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 16:51:27,572 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 16:51:27,573 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 16:51:27,573 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:51:27,573 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:51:27,587 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:51:27,810 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:51:27,812 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:51:27,813 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:51:27,813 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:51:27,849 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:51:28,035 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:51:28,038 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:51:28,293 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:28,406 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:28,407 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:51:28,552 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:51:28,555 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:51:28,559 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:51:28,560 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:51:28,564 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:51:28,820 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:51:28,821 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:51:28,822 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:51:28,823 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:51:28,852 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:51:28,998 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:51:29,000 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:51:29,209 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:29,327 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:29,328 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 16:51:29,465 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 16:51:29,467 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 16:51:29,468 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:51:29,469 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:51:29,472 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:51:29,702 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:51:29,704 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:51:29,705 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:51:29,706 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:51:29,737 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:51:29,890 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:51:29,892 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:51:30,086 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:30,212 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:30,214 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 16:51:30,349 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 16:51:30,366 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 16:51:30,373 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 16:51:30,384 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:51:30,385 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:51:30,390 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:51:30,611 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:51:30,613 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:51:30,615 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:51:30,616 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:51:30,660 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:51:30,815 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:51:30,818 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:51:31,010 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:31,122 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:31,127 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 16:51:31,292 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 16:51:31,304 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 16:51:31,312 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:51:31,313 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:51:31,321 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:51:31,557 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:51:31,560 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:51:31,561 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:51:31,562 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:51:31,606 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:51:31,747 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:51:31,750 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:51:31,944 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:32,065 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:32,067 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:51:32,217 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:51:32,220 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:51:32,238 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 16:51:32,247 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 16:51:32,250 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 16:51:32,261 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 16:51:32,282 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 16:51:32,306 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 16:51:32,309 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 16:51:32,341 - src.services.reporting_logic.monthly_report_generator - DEBUG - Monthly report date range: 2025-06-01 to 2025-06-30
2025-07-07 16:51:32,356 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 16:51:32,369 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 16:51:32,373 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 16:51:32,380 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 16:51:32,390 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 16:51:32,391 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 16:51:32,396 - src.services.reporting_logic.inventory_calculations - INFO - Calculating daily inventory (BOD/EOD)...
2025-07-07 16:51:32,758 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 16:51:32,799 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:51:32,801 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:51:32,806 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:51:33,047 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:51:33,051 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:51:33,052 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:51:33,053 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 16:51:33,138 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:51:33,291 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:51:33,294 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:51:33,491 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:33,603 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:33,760 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 16:51:33,908 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 16:51:33,911 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 16:51:34,062 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 16:51:34,064 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 16:51:34,065 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 16:51:34,068 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 16:51:34,069 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:51:34,070 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:51:34,076 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:51:34,377 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:51:34,379 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:51:34,380 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:51:34,380 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:51:34,419 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:51:34,575 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:51:34,578 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:51:34,780 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:34,908 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:34,910 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 16:51:35,039 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 16:51:35,042 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 16:51:35,052 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 16:51:35,116 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 16:51:35,124 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 16:51:35,134 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 16:51:35,158 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 16:51:35,169 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 16:51:35,171 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 16:51:35,174 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 16:51:35,182 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 16:51:35,183 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 16:51:35,193 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:51:35,194 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:51:35,199 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:51:35,410 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:51:35,412 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:51:35,413 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:51:35,414 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 16:51:35,450 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:51:35,592 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:51:35,594 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:51:35,789 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:35,903 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:51:36,045 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 16:51:36,177 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 16:51:36,178 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 16:51:36,314 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 16:51:36,315 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 16:51:36,316 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 16:51:36,317 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 16:51:36,318 - __main__ - INFO - Script finished successfully.
2025-07-07 16:52:56,248 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 16:52:56,248 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 16:52:56,621 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 16:52:56,621 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 16:52:56,621 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:52:56,622 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:52:56,633 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:52:56,854 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:52:56,855 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:52:56,855 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:52:56,856 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:52:56,881 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:52:57,042 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:52:57,044 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:52:57,291 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:52:57,410 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:52:57,413 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:52:57,565 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:52:57,567 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:52:57,571 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:52:57,572 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:52:57,574 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:52:57,792 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:52:57,793 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:52:57,794 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:52:57,794 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:52:57,817 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:52:57,963 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:52:57,965 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:52:58,180 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:52:58,300 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:52:58,305 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 16:52:58,434 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 16:52:58,435 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 16:52:58,437 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:52:58,437 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:52:58,440 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:52:58,632 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:52:58,637 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:52:58,639 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:52:58,640 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:52:58,672 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:52:58,821 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:52:58,822 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:52:59,019 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:52:59,148 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:52:59,149 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 16:52:59,301 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 16:52:59,307 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 16:52:59,311 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 16:52:59,315 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:52:59,315 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:52:59,318 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:52:59,528 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:52:59,529 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:52:59,530 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:52:59,530 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:52:59,553 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:52:59,697 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:52:59,700 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:52:59,889 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:00,014 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:00,016 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 16:53:00,142 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 16:53:00,148 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 16:53:00,152 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:53:00,154 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:53:00,156 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:53:00,375 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:53:00,377 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:53:00,377 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:53:00,378 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:53:00,400 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:53:00,558 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:53:00,560 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:53:00,773 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:00,890 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:00,892 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:53:01,027 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:53:01,030 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:53:01,039 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 16:53:01,042 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 16:53:01,044 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 16:53:01,048 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 16:53:01,052 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 16:53:01,053 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 16:53:01,054 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 16:53:01,057 - src.services.reporting_logic.monthly_report_generator - ERROR - Error generating monthly charge report: name 'shpped_orders_df' is not defined
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\monthly_report_generator.py", line 37, in generate_monthly_charge_report
    shipped_orders_df['Date'] = pd.to_datetime(shpped_orders_df['Date']).dt.date
                                              ^^^^^^^^^^^^^^^^
NameError: name 'shpped_orders_df' is not defined
2025-07-07 16:53:01,059 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 16:53:01,060 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:53:01,061 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:53:01,063 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:53:01,266 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:53:01,267 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:53:01,268 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:53:01,268 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:53:01,291 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:53:01,441 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:53:01,443 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:53:01,645 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:01,768 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:01,770 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 16:53:01,917 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 16:53:01,920 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 16:53:01,925 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 16:53:01,941 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 16:53:01,942 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 16:53:01,943 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 16:53:01,944 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 16:53:01,946 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 16:53:01,947 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 16:53:01,948 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 16:53:01,951 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 16:53:01,952 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 16:53:01,954 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:53:01,955 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:53:01,957 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:53:02,186 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:53:02,189 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:53:02,190 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:53:02,191 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 16:53:02,213 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:53:02,363 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:53:02,366 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:53:02,573 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:02,696 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:02,834 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 16:53:02,965 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 16:53:02,966 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 16:53:03,106 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 16:53:03,108 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 16:53:03,109 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 16:53:03,110 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 16:53:03,110 - __main__ - INFO - Script finished successfully.
2025-07-07 16:53:37,047 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 16:53:37,048 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 16:53:37,366 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 16:53:37,367 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 16:53:37,367 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:53:37,367 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:53:37,379 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:53:37,587 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:53:37,589 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:53:37,590 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:53:37,590 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:53:37,614 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:53:37,769 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:53:37,772 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:53:38,037 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:38,157 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:38,159 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:53:38,293 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:53:38,294 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:53:38,298 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:53:38,299 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:53:38,303 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:53:38,505 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:53:38,506 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:53:38,506 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:53:38,507 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:53:38,528 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:53:38,693 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:53:38,695 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:53:38,906 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:39,166 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:39,168 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 16:53:39,299 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 16:53:39,300 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 16:53:39,301 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:53:39,302 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:53:39,304 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:53:39,523 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:53:39,525 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:53:39,525 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:53:39,526 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:53:39,547 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:53:39,705 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:53:39,709 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:53:39,903 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:40,015 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:40,017 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 16:53:40,153 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 16:53:40,159 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 16:53:40,163 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 16:53:40,169 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:53:40,170 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:53:40,172 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:53:40,363 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:53:40,365 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:53:40,366 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:53:40,366 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:53:40,389 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:53:40,533 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:53:40,535 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:53:40,743 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:40,870 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:40,871 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 16:53:41,014 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 16:53:41,019 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 16:53:41,024 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:53:41,025 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:53:41,028 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:53:41,232 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:53:41,235 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:53:41,236 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:53:41,236 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:53:41,261 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:53:41,412 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:53:41,414 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:53:41,629 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:41,745 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:41,746 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 16:53:41,886 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 16:53:41,889 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 16:53:41,895 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 16:53:41,901 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 16:53:41,902 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 16:53:41,906 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 16:53:41,908 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 16:53:41,909 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 16:53:41,910 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 16:53:41,918 - src.services.reporting_logic.monthly_report_generator - DEBUG - Monthly report date range: 2025-06-01 to 2025-06-30
2025-07-07 16:53:41,922 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 16:53:41,926 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 16:53:41,927 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 16:53:41,929 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 16:53:41,934 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 16:53:41,936 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 16:53:41,939 - src.services.reporting_logic.inventory_calculations - INFO - Calculating daily inventory (BOD/EOD)...
2025-07-07 16:53:42,086 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 16:53:42,098 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:53:42,099 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:53:42,103 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:53:42,355 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:53:42,359 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:53:42,360 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:53:42,361 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 16:53:42,393 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:53:42,543 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:53:42,545 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:53:42,755 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:42,900 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:43,074 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 16:53:43,216 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 16:53:43,219 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 16:53:43,366 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 16:53:43,367 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 16:53:43,369 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 16:53:43,370 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 16:53:43,370 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:53:43,371 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:53:43,375 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:53:43,607 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:53:43,608 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:53:43,609 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:53:43,609 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 16:53:43,633 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:53:43,799 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:53:43,800 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:53:43,999 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:44,125 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:44,126 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 16:53:44,261 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 16:53:44,264 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 16:53:44,270 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 16:53:44,285 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 16:53:44,287 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 16:53:44,288 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 16:53:44,288 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 16:53:44,291 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 16:53:44,292 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 16:53:44,293 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 16:53:44,295 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 16:53:44,296 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 16:53:44,298 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 16:53:44,299 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 16:53:44,301 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 16:53:44,507 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 16:53:44,509 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 16:53:44,510 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 16:53:44,510 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 16:53:44,534 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 16:53:44,689 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 16:53:44,691 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 16:53:44,903 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:45,022 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 16:53:45,174 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 16:53:45,317 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 16:53:45,319 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 16:53:45,454 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 16:53:45,456 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 16:53:45,456 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 16:53:45,458 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 16:53:45,459 - __main__ - INFO - Script finished successfully.
2025-07-07 17:00:12,109 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:00:12,110 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:00:12,449 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:00:12,449 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:00:12,449 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:00:12,450 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:00:12,462 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:00:12,723 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:00:12,724 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:00:12,724 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:00:12,724 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:00:12,752 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:00:12,931 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:00:12,934 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:00:13,295 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:13,408 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:13,409 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:00:13,576 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:00:13,577 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:00:13,580 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:00:13,580 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:00:13,583 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:00:13,799 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:00:13,801 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:00:13,803 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:00:13,804 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:00:13,825 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:00:13,968 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:00:13,970 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:00:14,170 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:14,297 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:14,298 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:00:14,443 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:00:14,446 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:00:14,447 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:00:14,448 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:00:14,451 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:00:14,660 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:00:14,662 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:00:14,663 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:00:14,663 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:00:14,686 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:00:14,867 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:00:14,868 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:00:15,069 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:15,200 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:15,202 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:00:15,337 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:00:15,343 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:00:15,347 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:00:15,352 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:00:15,354 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:00:15,357 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:00:15,555 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:00:15,558 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:00:15,559 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:00:15,560 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:00:15,584 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:00:15,728 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:00:15,732 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:00:15,928 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:16,059 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:16,061 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:00:16,194 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:00:16,202 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:00:16,205 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:00:16,206 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:00:16,208 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:00:16,395 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:00:16,397 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:00:16,399 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:00:16,399 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:00:16,419 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:00:16,577 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:00:16,578 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:00:16,784 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:16,941 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:16,943 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:00:17,117 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:00:17,118 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:00:17,126 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:00:17,130 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:00:17,132 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:00:17,135 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:00:17,139 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:00:17,140 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:00:17,141 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:00:17,147 - src.services.reporting_logic.monthly_report_generator - DEBUG - Monthly report date range: 2025-06-01 to 2025-06-30
2025-07-07 17:00:17,151 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:00:17,155 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:00:17,155 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:00:17,157 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:00:17,159 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:00:17,160 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:00:17,161 - src.services.reporting_logic.inventory_calculations - INFO - Calculating daily inventory (BOD/EOD)...
2025-07-07 17:00:17,302 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:00:17,315 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:00:17,315 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:00:17,318 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:00:17,523 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:00:17,527 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:00:17,528 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:00:17,529 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 17:00:17,552 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:00:17,686 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:00:17,688 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:00:17,876 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:17,995 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:18,187 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:00:18,328 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:00:18,331 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 17:00:18,477 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:00:18,478 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 17:00:18,479 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 17:00:18,480 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 17:00:18,481 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:00:18,482 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:00:18,484 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:00:18,715 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:00:18,716 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:00:18,717 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:00:18,717 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:00:18,738 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:00:18,910 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:00:18,912 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:00:19,113 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:19,231 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:19,233 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 17:00:19,376 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 17:00:19,379 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 17:00:19,385 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 17:00:19,399 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 17:00:19,399 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 17:00:19,400 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 17:00:19,400 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 17:00:19,403 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 17:00:19,404 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 17:00:19,404 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 17:00:19,406 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 17:00:19,407 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 17:00:19,410 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:00:19,410 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:00:19,412 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:00:19,616 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:00:19,618 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:00:19,618 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:00:19,619 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 17:00:19,640 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:00:19,788 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:00:19,790 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:00:19,977 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:20,090 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:00:20,250 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:00:20,385 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:00:20,388 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 17:00:20,522 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:00:20,524 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 17:00:20,524 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 17:00:20,525 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 17:00:20,526 - __main__ - INFO - Script finished successfully.
2025-07-07 17:08:15,225 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:08:15,226 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:08:15,754 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:08:15,754 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:08:15,755 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:08:15,755 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:08:15,772 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:08:16,032 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:08:16,033 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:08:16,035 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:08:16,035 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:08:16,059 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:08:16,235 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:08:16,236 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:08:16,679 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:08:16,798 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:08:16,799 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:08:16,932 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:08:16,934 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:08:16,937 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:08:16,937 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:08:16,939 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:08:17,136 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:08:17,138 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:08:17,138 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:08:17,139 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:08:17,162 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:08:17,299 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:08:17,302 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:08:17,530 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:08:17,646 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:08:17,647 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:08:17,836 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:08:17,837 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:08:17,838 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:08:17,838 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:08:17,840 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:08:18,058 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:08:18,060 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:08:18,060 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:08:18,061 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:08:18,083 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:08:18,237 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:08:18,239 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:08:18,433 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:08:18,565 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:08:18,567 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:08:18,723 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:08:18,731 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:08:18,735 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:08:18,740 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:08:18,740 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:08:18,742 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:08:18,949 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:08:18,951 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:08:18,952 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:08:18,952 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:08:18,976 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:08:19,129 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:08:19,131 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:08:19,328 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:08:19,447 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:08:19,450 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:08:19,591 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:08:19,594 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:08:19,598 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:08:19,599 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:08:19,602 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:08:19,788 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:08:19,791 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:08:19,792 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:08:19,792 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:08:19,815 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:08:19,984 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:08:19,986 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:08:20,178 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:08:20,289 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:08:20,290 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:08:20,479 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:08:20,480 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:08:20,488 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:08:20,492 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:08:20,493 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:08:20,496 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:08:20,499 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:08:20,500 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:08:20,501 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:08:20,506 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:08:20,508 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:08:20,508 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:08:20,510 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:08:20,510 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:08:20,512 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:08:20,513 - src.services.reporting_logic.inventory_calculations - INFO - Calculating daily inventory (BOD/EOD)...
2025-07-07 17:08:20,699 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:08:20,699 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 17:08:20,701 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  18675            749            749
1  2025-06-01  17612              0              0
2  2025-06-01  17904              0              0
3  2025-06-01  17914              0              0
4  2025-06-01  18675              0              0
2025-07-07 17:08:20,702 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17914           -103           -104
236  2025-06-30  18675            -20            -20
237  2025-06-30  17612            425            425
238  2025-06-30  17904            115            115
239  2025-06-30  17914            223            223
2025-07-07 17:08:20,702 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 17:08:20,709 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     122.387500
std      343.684192
min     -957.000000
25%      -45.250000
50%      115.000000
75%      273.500000
max      749.000000
2025-07-07 17:08:20,711 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
5    2025-06-01            425
13   2025-06-02            425
21   2025-06-03            425
29   2025-06-04            425
37   2025-06-05            425
45   2025-06-06            425
53   2025-06-07            425
61   2025-06-08            425
69   2025-06-09            425
77   2025-06-10            425
85   2025-06-11            425
93   2025-06-12            425
101  2025-06-13            425
109  2025-06-14            425
117  2025-06-15            425
125  2025-06-16            425
133  2025-06-17            425
141  2025-06-18            425
149  2025-06-19            425
157  2025-06-20            425
165  2025-06-21            425
173  2025-06-22            425
181  2025-06-23            425
189  2025-06-24            425
197  2025-06-25            425
205  2025-06-26            425
213  2025-06-27            425
221  2025-06-28            425
229  2025-06-29            425
237  2025-06-30            425
2025-07-07 17:08:20,713 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
6    2025-06-01            115
14   2025-06-02            115
22   2025-06-03            115
30   2025-06-04            115
38   2025-06-05            115
46   2025-06-06            115
54   2025-06-07            115
62   2025-06-08            115
70   2025-06-09            115
78   2025-06-10            115
86   2025-06-11            115
94   2025-06-12            115
102  2025-06-13            115
110  2025-06-14            115
118  2025-06-15            115
126  2025-06-16            115
134  2025-06-17            115
142  2025-06-18            115
150  2025-06-19            115
158  2025-06-20            115
166  2025-06-21            115
174  2025-06-22            115
182  2025-06-23            115
190  2025-06-24            115
198  2025-06-25            115
206  2025-06-26            115
214  2025-06-27            115
222  2025-06-28            115
230  2025-06-29            115
238  2025-06-30            115
2025-07-07 17:08:20,721 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 17:08:20,723 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       3.750000
std        5.460011
min        0.000000
25%        0.000000
50%        1.000000
75%        4.500000
max       16.000000
2025-07-07 17:08:20,725 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
5    2025-06-01            9
13   2025-06-02            9
21   2025-06-03            9
29   2025-06-04            9
37   2025-06-05            9
45   2025-06-06            9
53   2025-06-07            9
61   2025-06-08            9
69   2025-06-09            9
77   2025-06-10            9
85   2025-06-11            9
93   2025-06-12            9
101  2025-06-13            9
109  2025-06-14            9
117  2025-06-15            9
125  2025-06-16            9
133  2025-06-17            9
141  2025-06-18            9
149  2025-06-19            9
157  2025-06-20            9
165  2025-06-21            9
173  2025-06-22            9
181  2025-06-23            9
189  2025-06-24            9
197  2025-06-25            9
205  2025-06-26            9
213  2025-06-27            9
221  2025-06-28            9
229  2025-06-29            9
237  2025-06-30            9
2025-07-07 17:08:20,726 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    30
2025-06-02    30
2025-06-03    30
2025-06-04    30
2025-06-05    30
2025-07-07 17:08:20,727 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    30
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    30
2025-07-07 17:08:20,727 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 17:08:20,727 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 17:08:20,729 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 17:08:20,730 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    13.5
2025-06-02    13.5
2025-06-03    13.5
2025-06-04    13.5
2025-06-05    13.5
2025-07-07 17:08:20,731 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.5
2025-06-27    13.5
2025-06-28    13.5
2025-06-29    13.5
2025-06-30    13.5
2025-07-07 17:08:20,739 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 17:08:20,739 - __main__ - CRITICAL - A critical error occurred during script execution: 'NoneType' object has no attribute 'rename'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 114, in <module>
    main()
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 83, in main
    final_monthly_df = pd.concat([monthly_report_df, monthly_totals_df.rename(index={0: 'Monthly Totals'})])
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rename'
2025-07-07 17:09:03,498 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:09:03,498 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:09:03,845 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:09:03,846 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:09:03,846 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:09:03,846 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:09:03,857 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:09:04,086 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:09:04,087 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:09:04,087 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:09:04,088 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:09:04,112 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:09:04,253 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:09:04,257 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:09:04,559 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:09:04,682 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:09:04,683 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:09:04,944 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:09:04,948 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:09:04,952 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:09:04,954 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:09:04,956 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:09:05,169 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:09:05,171 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:09:05,173 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:09:05,173 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:09:05,193 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:09:05,339 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:09:05,340 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:09:05,541 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:09:05,678 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:09:05,679 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:09:05,827 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:09:05,830 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:09:05,831 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:09:05,831 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:09:05,833 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:09:06,056 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:09:06,060 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:09:06,061 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:09:06,061 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:09:06,086 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:09:06,244 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:09:06,246 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:09:06,441 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:09:06,560 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:09:06,563 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:09:06,729 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:09:06,735 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:09:06,739 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:09:06,744 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:09:06,744 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:09:06,746 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:09:06,950 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:09:06,953 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:09:06,954 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:09:06,955 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:09:06,977 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:09:07,118 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:09:07,120 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:09:07,316 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:09:07,433 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:09:07,437 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:09:07,601 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:09:07,604 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:09:07,607 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:09:07,607 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:09:07,611 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:09:07,807 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:09:07,809 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:09:07,810 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:09:07,810 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:09:07,832 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:09:07,990 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:09:07,992 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:09:08,183 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:09:08,307 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:09:08,309 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:09:08,439 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:09:08,442 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:09:08,453 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:09:08,459 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:09:08,460 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:09:08,465 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:09:08,469 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:09:08,470 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:09:08,471 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:09:08,475 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:09:08,476 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:09:08,477 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:09:08,478 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:09:08,479 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:09:08,480 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:09:08,482 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 17:09:08,482 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 425), ('17904', 115), ('17914', 223), ('18675', 749)]...
2025-07-07 17:09:08,483 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 17:09:08,483 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 17:09:08,484 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 17:09:08,485 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 17:09:08,490 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 17:09:08,493 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 0, Received: 0, Shipped: 71, Repack: 0, EOD: -71
2025-07-07 17:09:08,494 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 0, Received: 0, Shipped: 2, Repack: 0, EOD: -2
2025-07-07 17:09:08,496 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 0, Received: 0, Shipped: 1, Repack: 0, EOD: -1
2025-07-07 17:09:08,498 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 0, Received: 0, Shipped: 3, Repack: 0, EOD: -3
2025-07-07 17:09:08,499 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 17:09:08,502 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: -71, Received: 0, Shipped: 94, Repack: 0, EOD: -165
2025-07-07 17:09:08,503 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: -2, Received: 0, Shipped: 13, Repack: 0, EOD: -15
2025-07-07 17:09:08,506 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: -3, Received: 0, Shipped: 6, Repack: 0, EOD: -9
2025-07-07 17:09:08,507 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 17:09:08,510 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: -165, Received: 478, Shipped: 119, Repack: 0, EOD: 194
2025-07-07 17:09:08,511 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: -15, Received: 0, Shipped: 7, Repack: 0, EOD: -22
2025-07-07 17:09:08,514 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: -9, Received: 0, Shipped: 7, Repack: 0, EOD: -16
2025-07-07 17:09:08,515 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 17:09:08,518 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 194, Received: 0, Shipped: 296, Repack: 0, EOD: -102
2025-07-07 17:09:08,519 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: -22, Received: 0, Shipped: 1, Repack: 0, EOD: -23
2025-07-07 17:09:08,522 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: -16, Received: 0, Shipped: 7, Repack: 0, EOD: -23
2025-07-07 17:09:08,523 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 17:09:08,525 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: -102, Received: 0, Shipped: 117, Repack: 0, EOD: -219
2025-07-07 17:09:08,526 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: -23, Received: 0, Shipped: 2, Repack: 0, EOD: -25
2025-07-07 17:09:08,527 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: -1, Received: 0, Shipped: 1, Repack: 0, EOD: -2
2025-07-07 17:09:08,529 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: -23, Received: 0, Shipped: 1, Repack: 0, EOD: -24
2025-07-07 17:09:08,539 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 17:09:08,542 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: -219, Received: 0, Shipped: 47, Repack: 0, EOD: -266
2025-07-07 17:09:08,543 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: -25, Received: 0, Shipped: 2, Repack: 0, EOD: -27
2025-07-07 17:09:08,546 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: -2, Received: 0, Shipped: 1, Repack: 0, EOD: -3
2025-07-07 17:09:08,548 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: -24, Received: 0, Shipped: 3, Repack: 0, EOD: -27
2025-07-07 17:09:08,550 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 17:09:08,553 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: -266, Received: 0, Shipped: 87, Repack: 0, EOD: -353
2025-07-07 17:09:08,556 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: -27, Received: 0, Shipped: 3, Repack: 0, EOD: -30
2025-07-07 17:09:08,557 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 17:09:08,559 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: -353, Received: 0, Shipped: 67, Repack: 0, EOD: -420
2025-07-07 17:09:08,560 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: -27, Received: 0, Shipped: 1, Repack: 0, EOD: -28
2025-07-07 17:09:08,562 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: -3, Received: 0, Shipped: 1, Repack: 0, EOD: -4
2025-07-07 17:09:08,564 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: -30, Received: 0, Shipped: 3, Repack: 0, EOD: -33
2025-07-07 17:09:08,564 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 17:09:08,567 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: -420, Received: 0, Shipped: 234, Repack: 0, EOD: -654
2025-07-07 17:09:08,569 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: -28, Received: 0, Shipped: 14, Repack: 0, EOD: -42
2025-07-07 17:09:08,571 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: -33, Received: 0, Shipped: 11, Repack: 0, EOD: -44
2025-07-07 17:09:08,572 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 17:09:08,575 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: -654, Received: 0, Shipped: 83, Repack: 0, EOD: -737
2025-07-07 17:09:08,577 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: -42, Received: 0, Shipped: 1, Repack: 0, EOD: -43
2025-07-07 17:09:08,579 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: -44, Received: 0, Shipped: 12, Repack: 0, EOD: -56
2025-07-07 17:09:08,591 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 17:09:08,595 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: -737, Received: 0, Shipped: 164, Repack: 0, EOD: -901
2025-07-07 17:09:08,597 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: -43, Received: 0, Shipped: 2, Repack: 0, EOD: -45
2025-07-07 17:09:08,598 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: -4, Received: 0, Shipped: 3, Repack: 0, EOD: -7
2025-07-07 17:09:08,603 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: -56, Received: 0, Shipped: 3, Repack: 0, EOD: -59
2025-07-07 17:09:08,603 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 17:09:08,606 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: -901, Received: 0, Shipped: 56, Repack: 0, EOD: -957
2025-07-07 17:09:08,607 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: -45, Received: 0, Shipped: 1, Repack: 0, EOD: -46
2025-07-07 17:09:08,609 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: -7, Received: 0, Shipped: 12, Repack: 0, EOD: -19
2025-07-07 17:09:08,611 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: -59, Received: 0, Shipped: 11, Repack: 0, EOD: -70
2025-07-07 17:09:08,611 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 17:09:08,612 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -957, Received: 576, Shipped: 57, Repack: 0, EOD: -438
2025-07-07 17:09:08,614 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: -46, Received: 0, Shipped: 1, Repack: 0, EOD: -47
2025-07-07 17:09:08,617 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: -70, Received: 0, Shipped: 1, Repack: 0, EOD: -71
2025-07-07 17:09:08,619 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 17:09:08,621 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: -438, Received: 0, Shipped: 47, Repack: 0, EOD: -485
2025-07-07 17:09:08,622 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: -47, Received: 0, Shipped: 2, Repack: 0, EOD: -49
2025-07-07 17:09:08,625 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: -71, Received: 0, Shipped: 7, Repack: 0, EOD: -78
2025-07-07 17:09:08,626 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 17:09:08,628 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: -485, Received: 0, Shipped: 76, Repack: 0, EOD: -561
2025-07-07 17:09:08,628 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: -49, Received: 0, Shipped: 1, Repack: 0, EOD: -50
2025-07-07 17:09:08,630 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: -19, Received: 0, Shipped: 1, Repack: 0, EOD: -20
2025-07-07 17:09:08,634 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: -78, Received: 0, Shipped: 5, Repack: 0, EOD: -83
2025-07-07 17:09:08,643 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 17:09:08,648 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: -561, Received: 376, Shipped: 21, Repack: 0, EOD: -206
2025-07-07 17:09:08,651 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: -50, Received: 0, Shipped: 6, Repack: 0, EOD: -56
2025-07-07 17:09:08,656 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 17:09:08,659 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: -206, Received: 0, Shipped: 42, Repack: 0, EOD: -248
2025-07-07 17:09:08,660 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: -56, Received: 0, Shipped: 1, Repack: 0, EOD: -57
2025-07-07 17:09:08,663 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: -83, Received: 0, Shipped: 1, Repack: 0, EOD: -84
2025-07-07 17:09:08,664 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 17:09:08,667 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: -248, Received: 0, Shipped: 173, Repack: 0, EOD: -421
2025-07-07 17:09:08,668 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: -57, Received: 0, Shipped: 1, Repack: 0, EOD: -58
2025-07-07 17:09:08,671 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: -84, Received: 0, Shipped: 4, Repack: 0, EOD: -88
2025-07-07 17:09:08,671 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 17:09:08,673 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: -421, Received: 0, Shipped: 60, Repack: 0, EOD: -481
2025-07-07 17:09:08,673 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: -58, Received: 0, Shipped: 2, Repack: 0, EOD: -60
2025-07-07 17:09:08,676 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: -88, Received: 0, Shipped: 9, Repack: 0, EOD: -97
2025-07-07 17:09:08,676 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 17:09:08,679 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: -481, Received: 0, Shipped: 51, Repack: 0, EOD: -532
2025-07-07 17:09:08,680 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: -60, Received: 0, Shipped: 3, Repack: 0, EOD: -63
2025-07-07 17:09:08,684 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: -97, Received: 0, Shipped: 6, Repack: 0, EOD: -103
2025-07-07 17:09:08,693 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 17:09:08,696 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: -532, Received: 0, Shipped: 84, Repack: 0, EOD: -616
2025-07-07 17:09:08,697 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: -63, Received: 0, Shipped: 3, Repack: 0, EOD: -66
2025-07-07 17:09:08,701 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: -103, Received: 0, Shipped: 1, Repack: 0, EOD: -104
2025-07-07 17:09:08,703 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914            223            223
1  2025-06-01  18675            749            749
2  2025-06-01  17612              0              0
3  2025-06-01  17904              0              0
4  2025-06-01  17612            425            425
2025-07-07 17:09:08,704 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17904            -63            -66
236  2025-06-30  17612            425            425
237  2025-06-30  18675            -20            -20
238  2025-06-30  17904            115            115
239  2025-06-30  17914           -103           -104
2025-07-07 17:09:08,705 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:09:08,705 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 17:09:08,706 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914            223            223
1  2025-06-01  18675            749            749
2  2025-06-01  17612              0              0
3  2025-06-01  17904              0              0
4  2025-06-01  17612            425            425
2025-07-07 17:09:08,707 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17904            -63            -66
236  2025-06-30  17612            425            425
237  2025-06-30  18675            -20            -20
238  2025-06-30  17904            115            115
239  2025-06-30  17914           -103           -104
2025-07-07 17:09:08,708 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 17:09:08,709 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     122.387500
std      343.684192
min     -957.000000
25%      -45.250000
50%      115.000000
75%      273.500000
max      749.000000
2025-07-07 17:09:08,711 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
4    2025-06-01            425
12   2025-06-02            425
20   2025-06-03            425
28   2025-06-04            425
36   2025-06-05            425
44   2025-06-06            425
52   2025-06-07            425
60   2025-06-08            425
68   2025-06-09            425
76   2025-06-10            425
84   2025-06-11            425
92   2025-06-12            425
100  2025-06-13            425
108  2025-06-14            425
116  2025-06-15            425
124  2025-06-16            425
132  2025-06-17            425
140  2025-06-18            425
148  2025-06-19            425
156  2025-06-20            425
164  2025-06-21            425
172  2025-06-22            425
180  2025-06-23            425
188  2025-06-24            425
196  2025-06-25            425
204  2025-06-26            425
212  2025-06-27            425
220  2025-06-28            425
228  2025-06-29            425
236  2025-06-30            425
2025-07-07 17:09:08,713 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
6    2025-06-01            115
14   2025-06-02            115
22   2025-06-03            115
30   2025-06-04            115
38   2025-06-05            115
46   2025-06-06            115
54   2025-06-07            115
62   2025-06-08            115
70   2025-06-09            115
78   2025-06-10            115
86   2025-06-11            115
94   2025-06-12            115
102  2025-06-13            115
110  2025-06-14            115
118  2025-06-15            115
126  2025-06-16            115
134  2025-06-17            115
142  2025-06-18            115
150  2025-06-19            115
158  2025-06-20            115
166  2025-06-21            115
174  2025-06-22            115
182  2025-06-23            115
190  2025-06-24            115
198  2025-06-25            115
206  2025-06-26            115
214  2025-06-27            115
222  2025-06-28            115
230  2025-06-29            115
238  2025-06-30            115
2025-07-07 17:09:08,720 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 17:09:08,722 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       3.750000
std        5.460011
min        0.000000
25%        0.000000
50%        1.000000
75%        4.500000
max       16.000000
2025-07-07 17:09:08,724 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
4    2025-06-01            9
12   2025-06-02            9
20   2025-06-03            9
28   2025-06-04            9
36   2025-06-05            9
44   2025-06-06            9
52   2025-06-07            9
60   2025-06-08            9
68   2025-06-09            9
76   2025-06-10            9
84   2025-06-11            9
92   2025-06-12            9
100  2025-06-13            9
108  2025-06-14            9
116  2025-06-15            9
124  2025-06-16            9
132  2025-06-17            9
140  2025-06-18            9
148  2025-06-19            9
156  2025-06-20            9
164  2025-06-21            9
172  2025-06-22            9
180  2025-06-23            9
188  2025-06-24            9
196  2025-06-25            9
204  2025-06-26            9
212  2025-06-27            9
220  2025-06-28            9
228  2025-06-29            9
236  2025-06-30            9
2025-07-07 17:09:08,725 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    30
2025-06-02    30
2025-06-03    30
2025-06-04    30
2025-06-05    30
2025-07-07 17:09:08,725 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    30
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    30
2025-07-07 17:09:08,726 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 17:09:08,726 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 17:09:08,728 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 17:09:08,729 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    13.5
2025-06-02    13.5
2025-06-03    13.5
2025-06-04    13.5
2025-06-05    13.5
2025-07-07 17:09:08,730 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.5
2025-06-27    13.5
2025-06-28    13.5
2025-06-29    13.5
2025-06-30    13.5
2025-07-07 17:09:08,737 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 17:09:08,737 - __main__ - CRITICAL - A critical error occurred during script execution: 'NoneType' object has no attribute 'rename'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 114, in <module>
    main()
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 83, in main
    final_monthly_df = pd.concat([monthly_report_df, monthly_totals_df.rename(index={0: 'Monthly Totals'})])
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rename'
2025-07-07 17:15:19,144 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:15:19,145 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:15:19,485 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:15:19,485 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:15:19,486 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:15:19,486 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:15:19,499 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:15:19,815 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:15:19,818 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:15:19,818 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:15:19,819 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:15:19,846 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:15:20,008 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:15:20,009 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:15:20,361 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:20,483 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:20,484 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:15:20,617 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:15:20,617 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:15:20,621 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:15:20,621 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:15:20,623 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:15:20,834 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:15:20,837 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:15:20,838 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:15:20,838 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:15:20,861 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:15:21,016 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:15:21,018 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:15:21,227 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:21,342 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:21,345 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:15:21,488 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:15:21,490 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:15:21,491 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:15:21,492 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:15:21,497 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:15:21,738 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:15:21,740 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:15:21,741 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:15:21,743 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:15:21,789 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:15:21,941 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:15:21,942 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:15:22,138 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:22,284 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:22,286 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:15:22,426 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:15:22,433 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:15:22,437 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:15:22,442 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:15:22,442 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:15:22,446 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:15:22,634 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:15:22,635 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:15:22,636 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:15:22,636 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:15:22,658 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:15:22,806 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:15:22,808 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:15:23,004 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:23,127 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:23,130 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:15:23,270 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:15:23,275 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:15:23,281 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:15:23,282 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:15:23,286 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:15:23,487 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:15:23,489 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:15:23,490 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:15:23,491 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:15:23,513 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:15:23,654 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:15:23,655 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:15:23,857 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:23,967 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:23,968 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:15:24,099 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:15:24,103 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:15:24,110 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:15:24,114 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:15:24,116 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:15:24,119 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:15:24,121 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:15:24,122 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:15:24,122 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:15:24,126 - src.services.reporting_logic.monthly_report_generator - DEBUG - Monthly report date range: 2025-06-01 to 2025-06-30
2025-07-07 17:15:24,129 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:15:24,134 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:15:24,134 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:15:24,137 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:15:24,139 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:15:24,139 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:15:24,141 - src.services.reporting_logic.inventory_calculations - INFO - Calculating daily inventory (BOD/EOD)...
2025-07-07 17:15:24,266 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:15:24,277 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:15:24,277 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:15:24,280 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:15:24,499 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:15:24,501 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:15:24,502 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:15:24,503 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 17:15:24,524 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:15:24,668 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:15:24,670 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:15:24,871 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:24,980 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:25,131 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:15:25,264 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:15:25,265 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 17:15:25,417 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:15:25,418 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 17:15:25,419 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 17:15:25,419 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 17:15:25,420 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:15:25,420 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:15:25,423 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:15:25,607 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:15:25,608 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:15:25,609 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:15:25,609 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:15:25,633 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:15:25,779 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:15:25,782 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:15:25,975 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:26,085 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:26,088 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 17:15:26,215 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 17:15:26,216 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 17:15:26,221 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 17:15:26,239 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 17:15:26,240 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 17:15:26,240 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 17:15:26,242 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 17:15:26,245 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 17:15:26,246 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 17:15:26,247 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 17:15:26,250 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 17:15:26,251 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 17:15:26,253 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:15:26,254 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:15:26,256 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:15:26,452 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:15:26,454 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:15:26,456 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:15:26,457 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 17:15:26,483 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:15:26,620 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:15:26,622 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:15:26,817 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:26,926 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:15:27,095 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:15:27,231 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:15:27,233 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 17:15:27,377 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:15:27,379 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 17:15:27,381 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 17:15:27,383 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 17:15:27,384 - __main__ - INFO - Script finished successfully.
2025-07-07 17:24:28,267 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:24:28,267 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:24:28,618 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:24:28,618 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:24:28,619 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:24:28,619 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:24:28,630 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:24:28,904 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:24:28,925 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:24:28,935 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:24:28,943 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:24:29,014 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:24:29,184 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:24:29,186 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:24:29,557 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:24:29,678 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:24:29,679 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:24:29,821 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:24:29,822 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:24:29,825 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:24:29,826 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:24:29,829 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:24:30,038 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:24:30,041 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:24:30,042 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:24:30,043 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:24:30,067 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:24:30,215 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:24:30,217 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:24:30,412 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:24:30,535 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:24:30,537 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:24:30,684 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:24:30,687 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:24:30,688 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:24:30,689 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:24:30,695 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:24:30,895 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:24:30,896 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:24:30,897 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:24:30,897 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:24:30,917 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:24:31,060 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:24:31,062 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:24:31,259 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:24:31,377 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:24:31,378 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:24:31,524 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:24:31,532 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:24:31,536 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:24:31,540 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:24:31,541 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:24:31,543 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:24:31,735 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:24:31,736 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:24:31,737 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:24:31,738 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:24:31,758 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:24:31,912 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:24:31,914 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:24:32,101 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:24:32,218 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:24:32,218 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:24:32,361 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:24:32,365 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:24:32,368 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:24:32,368 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:24:32,372 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:24:32,593 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:24:32,596 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:24:32,597 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:24:32,598 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:24:32,621 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:24:32,767 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:24:32,771 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:24:32,968 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:24:33,083 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:24:33,085 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:24:33,223 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:24:33,227 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:24:33,235 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:24:33,239 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:24:33,240 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:24:33,244 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:24:33,248 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:24:33,249 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:24:33,250 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:24:33,256 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:24:33,258 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:24:33,259 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:24:33,260 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:24:33,261 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:24:33,262 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:24:33,264 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 17:24:33,264 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 425), ('17904', 115), ('17914', 223), ('18675', 749)]...
2025-07-07 17:24:33,265 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 17:24:33,265 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 17:24:33,266 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 17:24:33,267 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 17:24:33,275 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 17:24:33,278 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 0, Received: 0, Shipped: 71, Repack: 0, EOD: -71
2025-07-07 17:24:33,279 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 0, Received: 0, Shipped: 2, Repack: 0, EOD: -2
2025-07-07 17:24:33,280 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 0, Received: 0, Shipped: 1, Repack: 0, EOD: -1
2025-07-07 17:24:33,282 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 0, Received: 0, Shipped: 3, Repack: 0, EOD: -3
2025-07-07 17:24:33,283 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 17:24:33,286 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: -71, Received: 0, Shipped: 94, Repack: 0, EOD: -165
2025-07-07 17:24:33,287 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: -2, Received: 0, Shipped: 13, Repack: 0, EOD: -15
2025-07-07 17:24:33,289 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: -3, Received: 0, Shipped: 6, Repack: 0, EOD: -9
2025-07-07 17:24:33,291 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 17:24:33,295 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: -165, Received: 478, Shipped: 119, Repack: 0, EOD: 194
2025-07-07 17:24:33,296 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: -15, Received: 0, Shipped: 7, Repack: 0, EOD: -22
2025-07-07 17:24:33,298 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: -9, Received: 0, Shipped: 7, Repack: 0, EOD: -16
2025-07-07 17:24:33,299 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 17:24:33,303 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 194, Received: 0, Shipped: 296, Repack: 0, EOD: -102
2025-07-07 17:24:33,304 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: -22, Received: 0, Shipped: 1, Repack: 0, EOD: -23
2025-07-07 17:24:33,306 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: -16, Received: 0, Shipped: 7, Repack: 0, EOD: -23
2025-07-07 17:24:33,307 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 17:24:33,311 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: -102, Received: 0, Shipped: 117, Repack: 0, EOD: -219
2025-07-07 17:24:33,312 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: -23, Received: 0, Shipped: 2, Repack: 0, EOD: -25
2025-07-07 17:24:33,314 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: -1, Received: 0, Shipped: 1, Repack: 0, EOD: -2
2025-07-07 17:24:33,315 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: -23, Received: 0, Shipped: 1, Repack: 0, EOD: -24
2025-07-07 17:24:33,325 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 17:24:33,329 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: -219, Received: 0, Shipped: 47, Repack: 0, EOD: -266
2025-07-07 17:24:33,331 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: -25, Received: 0, Shipped: 2, Repack: 0, EOD: -27
2025-07-07 17:24:33,332 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: -2, Received: 0, Shipped: 1, Repack: 0, EOD: -3
2025-07-07 17:24:33,334 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: -24, Received: 0, Shipped: 3, Repack: 0, EOD: -27
2025-07-07 17:24:33,335 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 17:24:33,340 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: -266, Received: 0, Shipped: 87, Repack: 0, EOD: -353
2025-07-07 17:24:33,343 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: -27, Received: 0, Shipped: 3, Repack: 0, EOD: -30
2025-07-07 17:24:33,344 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 17:24:33,347 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: -353, Received: 0, Shipped: 67, Repack: 0, EOD: -420
2025-07-07 17:24:33,348 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: -27, Received: 0, Shipped: 1, Repack: 0, EOD: -28
2025-07-07 17:24:33,349 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: -3, Received: 0, Shipped: 1, Repack: 0, EOD: -4
2025-07-07 17:24:33,350 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: -30, Received: 0, Shipped: 3, Repack: 0, EOD: -33
2025-07-07 17:24:33,351 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 17:24:33,354 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: -420, Received: 0, Shipped: 234, Repack: 0, EOD: -654
2025-07-07 17:24:33,355 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: -28, Received: 0, Shipped: 14, Repack: 0, EOD: -42
2025-07-07 17:24:33,357 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: -33, Received: 0, Shipped: 11, Repack: 0, EOD: -44
2025-07-07 17:24:33,357 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 17:24:33,360 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: -654, Received: 0, Shipped: 83, Repack: 0, EOD: -737
2025-07-07 17:24:33,361 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: -42, Received: 0, Shipped: 1, Repack: 0, EOD: -43
2025-07-07 17:24:33,363 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: -44, Received: 0, Shipped: 12, Repack: 0, EOD: -56
2025-07-07 17:24:33,372 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 17:24:33,375 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: -737, Received: 0, Shipped: 164, Repack: 0, EOD: -901
2025-07-07 17:24:33,376 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: -43, Received: 0, Shipped: 2, Repack: 0, EOD: -45
2025-07-07 17:24:33,378 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: -4, Received: 0, Shipped: 3, Repack: 0, EOD: -7
2025-07-07 17:24:33,378 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: -56, Received: 0, Shipped: 3, Repack: 0, EOD: -59
2025-07-07 17:24:33,380 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 17:24:33,384 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: -901, Received: 0, Shipped: 56, Repack: 0, EOD: -957
2025-07-07 17:24:33,385 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: -45, Received: 0, Shipped: 1, Repack: 0, EOD: -46
2025-07-07 17:24:33,387 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: -7, Received: 0, Shipped: 12, Repack: 0, EOD: -19
2025-07-07 17:24:33,388 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: -59, Received: 0, Shipped: 11, Repack: 0, EOD: -70
2025-07-07 17:24:33,389 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 17:24:33,392 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -957, Received: 576, Shipped: 57, Repack: 0, EOD: -438
2025-07-07 17:24:33,392 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: -46, Received: 0, Shipped: 1, Repack: 0, EOD: -47
2025-07-07 17:24:33,394 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: -70, Received: 0, Shipped: 1, Repack: 0, EOD: -71
2025-07-07 17:24:33,395 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 17:24:33,397 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: -438, Received: 0, Shipped: 47, Repack: 0, EOD: -485
2025-07-07 17:24:33,398 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: -47, Received: 0, Shipped: 2, Repack: 0, EOD: -49
2025-07-07 17:24:33,400 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: -71, Received: 0, Shipped: 7, Repack: 0, EOD: -78
2025-07-07 17:24:33,401 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 17:24:33,405 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: -485, Received: 0, Shipped: 76, Repack: 0, EOD: -561
2025-07-07 17:24:33,406 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: -49, Received: 0, Shipped: 1, Repack: 0, EOD: -50
2025-07-07 17:24:33,407 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: -19, Received: 0, Shipped: 1, Repack: 0, EOD: -20
2025-07-07 17:24:33,408 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: -78, Received: 0, Shipped: 5, Repack: 0, EOD: -83
2025-07-07 17:24:33,418 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 17:24:33,422 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: -561, Received: 376, Shipped: 21, Repack: 0, EOD: -206
2025-07-07 17:24:33,423 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: -50, Received: 0, Shipped: 6, Repack: 0, EOD: -56
2025-07-07 17:24:33,424 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 17:24:33,429 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: -206, Received: 0, Shipped: 42, Repack: 0, EOD: -248
2025-07-07 17:24:33,430 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: -56, Received: 0, Shipped: 1, Repack: 0, EOD: -57
2025-07-07 17:24:33,432 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: -83, Received: 0, Shipped: 1, Repack: 0, EOD: -84
2025-07-07 17:24:33,433 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 17:24:33,436 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: -248, Received: 0, Shipped: 173, Repack: 0, EOD: -421
2025-07-07 17:24:33,437 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: -57, Received: 0, Shipped: 1, Repack: 0, EOD: -58
2025-07-07 17:24:33,439 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: -84, Received: 0, Shipped: 4, Repack: 0, EOD: -88
2025-07-07 17:24:33,439 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 17:24:33,442 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: -421, Received: 0, Shipped: 60, Repack: 0, EOD: -481
2025-07-07 17:24:33,443 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: -58, Received: 0, Shipped: 2, Repack: 0, EOD: -60
2025-07-07 17:24:33,445 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: -88, Received: 0, Shipped: 9, Repack: 0, EOD: -97
2025-07-07 17:24:33,445 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 17:24:33,448 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: -481, Received: 0, Shipped: 51, Repack: 0, EOD: -532
2025-07-07 17:24:33,450 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: -60, Received: 0, Shipped: 3, Repack: 0, EOD: -63
2025-07-07 17:24:33,451 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: -97, Received: 0, Shipped: 6, Repack: 0, EOD: -103
2025-07-07 17:24:33,461 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 17:24:33,464 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: -532, Received: 0, Shipped: 84, Repack: 0, EOD: -616
2025-07-07 17:24:33,466 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: -63, Received: 0, Shipped: 3, Repack: 0, EOD: -66
2025-07-07 17:24:33,467 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: -103, Received: 0, Shipped: 1, Repack: 0, EOD: -104
2025-07-07 17:24:33,469 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            425            425
1  2025-06-01  18675            749            749
2  2025-06-01  17904            115            115
3  2025-06-01  17914            223            223
4  2025-06-01  17612              0              0
2025-07-07 17:24:33,470 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17914            223            223
236  2025-06-30  17612           -532           -616
237  2025-06-30  17904            -63            -66
238  2025-06-30  18675            -20            -20
239  2025-06-30  17914           -103           -104
2025-07-07 17:24:33,470 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:24:33,470 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 17:24:33,471 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            425            425
1  2025-06-01  18675            749            749
2  2025-06-01  17904            115            115
3  2025-06-01  17914            223            223
4  2025-06-01  17612              0              0
2025-07-07 17:24:33,472 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17914            223            223
236  2025-06-30  17612           -532           -616
237  2025-06-30  17904            -63            -66
238  2025-06-30  18675            -20            -20
239  2025-06-30  17914           -103           -104
2025-07-07 17:24:33,473 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 17:24:33,474 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     122.387500
std      343.684192
min     -957.000000
25%      -45.250000
50%      115.000000
75%      273.500000
max      749.000000
2025-07-07 17:24:33,476 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
0    2025-06-01            425
8    2025-06-02            425
16   2025-06-03            425
24   2025-06-04            425
32   2025-06-05            425
40   2025-06-06            425
48   2025-06-07            425
56   2025-06-08            425
64   2025-06-09            425
72   2025-06-10            425
80   2025-06-11            425
88   2025-06-12            425
96   2025-06-13            425
104  2025-06-14            425
112  2025-06-15            425
120  2025-06-16            425
128  2025-06-17            425
136  2025-06-18            425
144  2025-06-19            425
152  2025-06-20            425
160  2025-06-21            425
168  2025-06-22            425
176  2025-06-23            425
184  2025-06-24            425
192  2025-06-25            425
200  2025-06-26            425
208  2025-06-27            425
216  2025-06-28            425
224  2025-06-29            425
232  2025-06-30            425
2025-07-07 17:24:33,478 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            115
10   2025-06-02            115
18   2025-06-03            115
26   2025-06-04            115
34   2025-06-05            115
42   2025-06-06            115
50   2025-06-07            115
58   2025-06-08            115
66   2025-06-09            115
74   2025-06-10            115
82   2025-06-11            115
90   2025-06-12            115
98   2025-06-13            115
106  2025-06-14            115
114  2025-06-15            115
122  2025-06-16            115
130  2025-06-17            115
138  2025-06-18            115
146  2025-06-19            115
154  2025-06-20            115
162  2025-06-21            115
170  2025-06-22            115
178  2025-06-23            115
186  2025-06-24            115
194  2025-06-25            115
202  2025-06-26            115
210  2025-06-27            115
218  2025-06-28            115
226  2025-06-29            115
234  2025-06-30            115
2025-07-07 17:24:33,485 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 17:24:33,487 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       3.750000
std        5.460011
min        0.000000
25%        0.000000
50%        1.000000
75%        4.500000
max       16.000000
2025-07-07 17:24:33,489 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
0    2025-06-01            9
8    2025-06-02            9
16   2025-06-03            9
24   2025-06-04            9
32   2025-06-05            9
40   2025-06-06            9
48   2025-06-07            9
56   2025-06-08            9
64   2025-06-09            9
72   2025-06-10            9
80   2025-06-11            9
88   2025-06-12            9
96   2025-06-13            9
104  2025-06-14            9
112  2025-06-15            9
120  2025-06-16            9
128  2025-06-17            9
136  2025-06-18            9
144  2025-06-19            9
152  2025-06-20            9
160  2025-06-21            9
168  2025-06-22            9
176  2025-06-23            9
184  2025-06-24            9
192  2025-06-25            9
200  2025-06-26            9
208  2025-06-27            9
216  2025-06-28            9
224  2025-06-29            9
232  2025-06-30            9
2025-07-07 17:24:33,490 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    30
2025-06-02    30
2025-06-03    30
2025-06-04    30
2025-06-05    30
2025-07-07 17:24:33,491 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    30
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    30
2025-07-07 17:24:33,491 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 17:24:33,491 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 17:24:33,493 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 17:24:33,494 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    13.5
2025-06-02    13.5
2025-06-03    13.5
2025-06-04    13.5
2025-06-05    13.5
2025-07-07 17:24:33,495 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.5
2025-06-27    13.5
2025-06-28    13.5
2025-06-29    13.5
2025-06-30    13.5
2025-07-07 17:24:33,503 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 17:24:33,504 - __main__ - CRITICAL - A critical error occurred during script execution: 'NoneType' object has no attribute 'rename'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 114, in <module>
    main()
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 83, in main
    final_monthly_df = pd.concat([monthly_report_df, monthly_totals_df.rename(index={0: 'Monthly Totals'})])
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rename'
2025-07-07 17:27:36,016 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:27:36,016 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:27:36,431 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:27:36,432 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:27:36,432 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:27:36,432 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:27:36,446 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:27:36,652 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:27:36,655 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:27:36,656 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:27:36,656 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:27:36,680 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:27:36,837 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:27:36,839 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:27:37,154 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:37,268 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:37,270 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:27:37,461 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:27:37,462 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:27:37,466 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:27:37,466 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:27:37,468 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:27:37,685 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:27:37,688 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:27:37,689 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:27:37,689 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:27:37,711 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:27:37,871 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:27:37,872 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:27:38,089 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:38,206 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:38,208 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:27:38,353 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:27:38,355 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:27:38,356 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:27:38,357 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:27:38,359 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:27:38,578 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:27:38,581 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:27:38,582 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:27:38,583 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:27:38,607 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:27:38,756 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:27:38,760 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:27:38,946 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:39,054 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:39,056 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:27:39,201 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:27:39,208 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:27:39,212 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:27:39,217 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:27:39,218 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:27:39,220 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:27:39,427 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:27:39,429 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:27:39,430 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:27:39,431 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:27:39,453 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:27:39,609 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:27:39,611 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:27:39,792 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:39,908 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:39,911 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:27:40,033 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:27:40,038 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:27:40,041 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:27:40,041 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:27:40,044 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:27:40,242 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:27:40,244 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:27:40,245 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:27:40,245 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:27:40,267 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:27:40,415 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:27:40,416 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:27:40,602 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:40,714 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:40,717 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:27:40,843 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:27:40,845 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:27:40,857 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:27:40,865 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:27:40,868 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:27:40,872 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:27:40,874 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:27:40,876 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:27:40,877 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:27:40,884 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:27:40,886 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:27:40,887 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:27:40,887 - src.services.reporting_logic.monthly_report_generator - ERROR - Error generating monthly charge report: name 'shpped_orders_df_filtered' is not defined
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\monthly_report_generator.py", line 48, in generate_monthly_charge_report
    logger.debug(f"shipped_orders_df_filtered head: \n{shpped_orders_df_filtered.head().to_string()}")
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'shpped_orders_df_filtered' is not defined
2025-07-07 17:27:40,889 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 17:27:40,889 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:27:40,889 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:27:40,893 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:27:41,104 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:27:41,107 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:27:41,112 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:27:41,115 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:27:41,165 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:27:41,304 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:27:41,305 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:27:41,498 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:41,610 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:41,611 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 17:27:41,740 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 17:27:41,743 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 17:27:41,748 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 17:27:41,748 - src.services.reporting_logic.inventory_calculations - WARNING - shipped_items_df was not a DataFrame in calculate_current_inventory. Attempting conversion.
2025-07-07 17:27:41,749 - src.services.reporting_logic.inventory_calculations - ERROR - Failed to convert shipped_items_df to DataFrame for current inventory calculation: Cannot convert scalar list to DataFrame with expected columns without an explicit index/columns.
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 100, in calculate_current_inventory
    raise ValueError("Cannot convert scalar list to DataFrame with expected columns without an explicit index/columns.")
ValueError: Cannot convert scalar list to DataFrame with expected columns without an explicit index/columns.
2025-07-07 17:27:41,750 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 17:27:41,751 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 17:27:41,752 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 17:27:41,753 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 17:27:41,754 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 17:27:41,755 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 17:27:41,759 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 17:27:41,759 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 17:27:41,763 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:27:41,764 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:27:41,767 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:27:41,970 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:27:41,972 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:27:41,972 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:27:41,972 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 17:27:41,995 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:27:42,162 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:27:42,164 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:27:42,347 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:42,460 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:27:42,615 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:27:42,758 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:27:42,760 - gspread_dataframe - DEBUG - 4 cell updates to send
2025-07-07 17:27:42,908 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD1?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:27:42,910 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D1", 'updatedRows': 1, 'updatedColumns': 4, 'updatedCells': 4}
2025-07-07 17:27:42,911 - src.services.google_sheets.api_client - INFO - Successfully wrote 0 rows to worksheet 'Weekly Report'.
2025-07-07 17:27:42,911 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 17:27:42,912 - __main__ - INFO - Script finished successfully.
2025-07-07 17:28:34,800 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:28:34,800 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:28:35,174 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:28:35,175 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:28:35,175 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:28:35,175 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:28:35,188 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:28:35,421 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:28:35,422 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:28:35,423 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:28:35,423 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:28:35,447 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:28:35,599 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:28:35,603 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:28:35,817 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:35,915 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:35,916 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:28:36,042 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:28:36,044 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:28:36,047 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:28:36,049 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:28:36,053 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:28:36,317 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:28:36,318 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:28:36,319 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:28:36,320 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:28:36,350 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:28:36,487 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:28:36,489 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:28:36,705 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:36,869 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:36,870 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:28:36,997 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:28:36,999 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:28:36,999 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:28:37,000 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:28:37,002 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:28:37,212 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:28:37,213 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:28:37,214 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:28:37,214 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:28:37,238 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:28:37,397 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:28:37,401 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:28:37,596 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:37,716 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:37,717 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:28:37,850 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:28:37,862 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:28:37,870 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:28:37,882 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:28:37,883 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:28:37,889 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:28:38,110 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:28:38,112 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:28:38,113 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:28:38,114 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:28:38,142 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:28:38,288 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:28:38,289 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:28:38,473 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:38,589 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:38,590 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:28:38,725 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:28:38,730 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:28:38,737 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:28:38,738 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:28:38,741 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:28:38,954 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:28:38,957 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:28:38,959 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:28:38,960 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:28:38,991 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:28:39,131 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:28:39,133 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:28:39,318 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:39,437 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:39,438 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:28:39,566 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:28:39,567 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:28:39,579 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:28:39,586 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:28:39,588 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:28:39,593 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:28:39,598 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:28:39,599 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:28:39,600 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:28:39,606 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:28:39,608 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:28:39,609 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:28:39,610 - src.services.reporting_logic.monthly_report_generator - ERROR - Error generating monthly charge report: name 'shpped_orders_df_filtered' is not defined
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\monthly_report_generator.py", line 48, in generate_monthly_charge_report
    logger.debug(f"shipped_orders_df_filtered head: \n{shpped_orders_df_filtered.head().to_string()}")
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'shpped_orders_df_filtered' is not defined
2025-07-07 17:28:39,612 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 17:28:39,612 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:28:39,614 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:28:39,619 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:28:39,838 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:28:39,843 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:28:39,845 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:28:39,846 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:28:39,886 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:28:40,045 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:28:40,047 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:28:40,223 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:40,329 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:40,331 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 17:28:40,457 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 17:28:40,459 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 17:28:40,465 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 17:28:40,466 - src.services.reporting_logic.inventory_calculations - WARNING - shipped_items_df was not a DataFrame in calculate_current_inventory. Attempting conversion.
2025-07-07 17:28:40,467 - src.services.reporting_logic.inventory_calculations - ERROR - Failed to convert shipped_items_df to DataFrame for current inventory calculation: Cannot convert scalar list to DataFrame with expected columns without an explicit index/columns.
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 100, in calculate_current_inventory
    raise ValueError("Cannot convert scalar list to DataFrame with expected columns without an explicit index/columns.")
ValueError: Cannot convert scalar list to DataFrame with expected columns without an explicit index/columns.
2025-07-07 17:28:40,468 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 17:28:40,468 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 17:28:40,469 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 17:28:40,471 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 17:28:40,472 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 17:28:40,473 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 17:28:40,476 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 17:28:40,477 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 17:28:40,480 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:28:40,481 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:28:40,484 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:28:40,710 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:28:40,711 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:28:40,712 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:28:40,713 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 17:28:40,737 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:28:40,871 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:28:40,873 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:28:41,064 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:41,179 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:28:41,321 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:28:41,440 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:28:41,441 - gspread_dataframe - DEBUG - 4 cell updates to send
2025-07-07 17:28:41,572 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD1?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:28:41,574 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D1", 'updatedRows': 1, 'updatedColumns': 4, 'updatedCells': 4}
2025-07-07 17:28:41,574 - src.services.google_sheets.api_client - INFO - Successfully wrote 0 rows to worksheet 'Weekly Report'.
2025-07-07 17:28:41,575 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 17:28:41,576 - __main__ - INFO - Script finished successfully.
2025-07-07 17:29:02,989 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:29:02,990 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:29:03,335 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:29:03,336 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:29:03,336 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:29:03,336 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:29:03,350 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:29:03,574 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:29:03,576 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:29:03,577 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:29:03,577 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:29:03,601 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:29:03,791 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:29:03,794 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:29:03,992 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:04,100 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:04,101 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:29:04,220 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:29:04,222 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:29:04,225 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:29:04,226 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:29:04,229 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:29:04,448 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:29:04,450 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:29:04,451 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:29:04,451 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:29:04,475 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:29:04,635 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:29:04,638 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:29:04,825 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:04,934 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:04,937 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:29:05,067 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:29:05,070 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:29:05,071 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:29:05,072 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:29:05,078 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:29:05,291 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:29:05,296 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:29:05,297 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:29:05,298 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:29:05,321 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:29:05,500 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:29:05,502 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:29:05,681 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:05,787 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:05,791 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:29:05,929 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:29:05,937 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:29:05,941 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:29:05,945 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:29:05,946 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:29:05,948 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:29:06,162 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:29:06,165 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:29:06,166 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:29:06,166 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:29:06,189 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:29:06,337 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:29:06,338 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:29:06,522 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:06,639 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:06,643 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:29:06,857 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:29:06,864 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:29:06,868 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:29:06,868 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:29:06,871 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:29:07,086 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:29:07,088 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:29:07,089 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:29:07,089 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:29:07,111 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:29:07,274 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:29:07,276 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:29:07,447 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:07,550 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:07,552 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:29:07,682 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:29:07,685 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:29:07,694 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:29:07,698 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:29:07,700 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:29:07,702 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:29:07,705 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:29:07,705 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:29:07,706 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:29:07,712 - src.services.reporting_logic.monthly_report_generator - DEBUG - Monthly report date range: 2025-06-01 to 2025-06-30
2025-07-07 17:29:07,715 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:29:07,718 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:29:07,719 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:29:07,721 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:29:07,723 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:29:07,724 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:29:07,726 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 17:29:07,727 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 425), ('17904', 115), ('17914', 223), ('18675', 749)]...
2025-07-07 17:29:07,727 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 17:29:07,728 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 17:29:07,729 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (605, 5)
2025-07-07 17:29:07,733 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType   Notes
0  2025-06-18  17612       576         Receive  250172
1  2025-06-23  17612       376         Receive  250172
2  2025-06-04  17612       478         Receive  250101
3  2025-06-02  17612         1            Ship     NaN
4  2025-06-02  17612         1            Ship     NaN
2025-07-07 17:29:07,738 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 17:29:07,741 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 0, Received: 0, Shipped: 71, Repack: 0, EOD: -71
2025-07-07 17:29:07,742 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 0, Received: 0, Shipped: 2, Repack: 0, EOD: -2
2025-07-07 17:29:07,744 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 0, Received: 0, Shipped: 1, Repack: 0, EOD: -1
2025-07-07 17:29:07,746 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 0, Received: 0, Shipped: 3, Repack: 0, EOD: -3
2025-07-07 17:29:07,747 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 17:29:07,749 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: -71, Received: 0, Shipped: 94, Repack: 0, EOD: -165
2025-07-07 17:29:07,750 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: -2, Received: 0, Shipped: 13, Repack: 0, EOD: -15
2025-07-07 17:29:07,753 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: -3, Received: 0, Shipped: 6, Repack: 0, EOD: -9
2025-07-07 17:29:07,754 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 17:29:07,756 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: -165, Received: 478, Shipped: 119, Repack: 0, EOD: 194
2025-07-07 17:29:07,757 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: -15, Received: 0, Shipped: 7, Repack: 0, EOD: -22
2025-07-07 17:29:07,760 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: -9, Received: 0, Shipped: 7, Repack: 0, EOD: -16
2025-07-07 17:29:07,761 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 17:29:07,764 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 194, Received: 0, Shipped: 296, Repack: 0, EOD: -102
2025-07-07 17:29:07,766 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: -22, Received: 0, Shipped: 1, Repack: 0, EOD: -23
2025-07-07 17:29:07,768 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: -16, Received: 0, Shipped: 7, Repack: 0, EOD: -23
2025-07-07 17:29:07,769 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 17:29:07,771 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: -102, Received: 0, Shipped: 117, Repack: 0, EOD: -219
2025-07-07 17:29:07,772 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: -23, Received: 0, Shipped: 2, Repack: 0, EOD: -25
2025-07-07 17:29:07,773 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: -1, Received: 0, Shipped: 1, Repack: 0, EOD: -2
2025-07-07 17:29:07,775 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: -23, Received: 0, Shipped: 1, Repack: 0, EOD: -24
2025-07-07 17:29:07,787 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 17:29:07,791 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: -219, Received: 0, Shipped: 47, Repack: 0, EOD: -266
2025-07-07 17:29:07,793 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: -25, Received: 0, Shipped: 2, Repack: 0, EOD: -27
2025-07-07 17:29:07,795 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: -2, Received: 0, Shipped: 1, Repack: 0, EOD: -3
2025-07-07 17:29:07,797 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: -24, Received: 0, Shipped: 3, Repack: 0, EOD: -27
2025-07-07 17:29:07,798 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 17:29:07,803 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: -266, Received: 0, Shipped: 87, Repack: 0, EOD: -353
2025-07-07 17:29:07,806 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: -27, Received: 0, Shipped: 3, Repack: 0, EOD: -30
2025-07-07 17:29:07,808 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 17:29:07,811 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: -353, Received: 0, Shipped: 67, Repack: 0, EOD: -420
2025-07-07 17:29:07,813 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: -27, Received: 0, Shipped: 1, Repack: 0, EOD: -28
2025-07-07 17:29:07,814 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: -3, Received: 0, Shipped: 1, Repack: 0, EOD: -4
2025-07-07 17:29:07,815 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: -30, Received: 0, Shipped: 3, Repack: 0, EOD: -33
2025-07-07 17:29:07,816 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 17:29:07,819 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: -420, Received: 0, Shipped: 234, Repack: 0, EOD: -654
2025-07-07 17:29:07,820 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: -28, Received: 0, Shipped: 14, Repack: 0, EOD: -42
2025-07-07 17:29:07,823 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: -33, Received: 0, Shipped: 11, Repack: 0, EOD: -44
2025-07-07 17:29:07,824 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 17:29:07,827 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: -654, Received: 0, Shipped: 83, Repack: 0, EOD: -737
2025-07-07 17:29:07,830 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: -42, Received: 0, Shipped: 1, Repack: 0, EOD: -43
2025-07-07 17:29:07,832 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: -44, Received: 0, Shipped: 12, Repack: 0, EOD: -56
2025-07-07 17:29:07,843 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 17:29:07,850 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: -737, Received: 0, Shipped: 164, Repack: 0, EOD: -901
2025-07-07 17:29:07,852 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: -43, Received: 0, Shipped: 2, Repack: 0, EOD: -45
2025-07-07 17:29:07,855 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: -4, Received: 0, Shipped: 3, Repack: 0, EOD: -7
2025-07-07 17:29:07,859 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: -56, Received: 0, Shipped: 3, Repack: 0, EOD: -59
2025-07-07 17:29:07,862 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 17:29:07,865 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: -901, Received: 0, Shipped: 56, Repack: 0, EOD: -957
2025-07-07 17:29:07,866 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: -45, Received: 0, Shipped: 1, Repack: 0, EOD: -46
2025-07-07 17:29:07,867 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: -7, Received: 0, Shipped: 12, Repack: 0, EOD: -19
2025-07-07 17:29:07,869 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: -59, Received: 0, Shipped: 11, Repack: 0, EOD: -70
2025-07-07 17:29:07,871 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 17:29:07,874 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -957, Received: 576, Shipped: 57, Repack: 0, EOD: -438
2025-07-07 17:29:07,876 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: -46, Received: 0, Shipped: 1, Repack: 0, EOD: -47
2025-07-07 17:29:07,879 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: -70, Received: 0, Shipped: 1, Repack: 0, EOD: -71
2025-07-07 17:29:07,881 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 17:29:07,884 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: -438, Received: 0, Shipped: 47, Repack: 0, EOD: -485
2025-07-07 17:29:07,885 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: -47, Received: 0, Shipped: 2, Repack: 0, EOD: -49
2025-07-07 17:29:07,888 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: -71, Received: 0, Shipped: 7, Repack: 0, EOD: -78
2025-07-07 17:29:07,889 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 17:29:07,892 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: -485, Received: 0, Shipped: 76, Repack: 0, EOD: -561
2025-07-07 17:29:07,893 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: -49, Received: 0, Shipped: 1, Repack: 0, EOD: -50
2025-07-07 17:29:07,896 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: -19, Received: 0, Shipped: 1, Repack: 0, EOD: -20
2025-07-07 17:29:07,897 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: -78, Received: 0, Shipped: 5, Repack: 0, EOD: -83
2025-07-07 17:29:07,908 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 17:29:07,912 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: -561, Received: 376, Shipped: 21, Repack: 0, EOD: -206
2025-07-07 17:29:07,914 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: -50, Received: 0, Shipped: 6, Repack: 0, EOD: -56
2025-07-07 17:29:07,917 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 17:29:07,920 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: -206, Received: 0, Shipped: 42, Repack: 0, EOD: -248
2025-07-07 17:29:07,921 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: -56, Received: 0, Shipped: 1, Repack: 0, EOD: -57
2025-07-07 17:29:07,924 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: -83, Received: 0, Shipped: 1, Repack: 0, EOD: -84
2025-07-07 17:29:07,926 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 17:29:07,929 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: -248, Received: 0, Shipped: 173, Repack: 0, EOD: -421
2025-07-07 17:29:07,930 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: -57, Received: 0, Shipped: 1, Repack: 0, EOD: -58
2025-07-07 17:29:07,933 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: -84, Received: 0, Shipped: 4, Repack: 0, EOD: -88
2025-07-07 17:29:07,934 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 17:29:07,937 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: -421, Received: 0, Shipped: 60, Repack: 0, EOD: -481
2025-07-07 17:29:07,937 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: -58, Received: 0, Shipped: 2, Repack: 0, EOD: -60
2025-07-07 17:29:07,940 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: -88, Received: 0, Shipped: 9, Repack: 0, EOD: -97
2025-07-07 17:29:07,943 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 17:29:07,947 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: -481, Received: 0, Shipped: 51, Repack: 0, EOD: -532
2025-07-07 17:29:07,948 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: -60, Received: 0, Shipped: 3, Repack: 0, EOD: -63
2025-07-07 17:29:07,951 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: -97, Received: 0, Shipped: 6, Repack: 0, EOD: -103
2025-07-07 17:29:07,966 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 17:29:07,968 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: -532, Received: 0, Shipped: 84, Repack: 0, EOD: -616
2025-07-07 17:29:07,971 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: -63, Received: 0, Shipped: 3, Repack: 0, EOD: -66
2025-07-07 17:29:07,984 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: -103, Received: 0, Shipped: 1, Repack: 0, EOD: -104
2025-07-07 17:29:07,990 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914            223            223
1  2025-06-01  18675            749            749
2  2025-06-01  17612              0              0
3  2025-06-01  17904              0              0
4  2025-06-01  18675              0              0
2025-07-07 17:29:07,993 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17904            -63            -66
236  2025-06-30  18675            -20            -20
237  2025-06-30  17904            115            115
238  2025-06-30  17914           -103           -104
239  2025-06-30  17612            425            425
2025-07-07 17:29:07,994 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:29:08,082 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:29:08,083 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:29:08,086 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:29:08,291 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:29:08,293 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:29:08,293 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:29:08,294 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 17:29:08,316 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:29:08,476 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:29:08,479 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:29:08,672 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:08,779 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:08,952 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:29:09,085 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:29:09,086 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 17:29:09,234 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:29:09,236 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 17:29:09,237 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 17:29:09,237 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 17:29:09,238 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:29:09,238 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:29:09,240 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:29:09,436 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:29:09,437 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:29:09,439 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:29:09,440 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:29:09,464 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:29:09,622 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:29:09,624 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:29:09,827 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:09,947 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:09,949 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 17:29:10,079 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 17:29:10,082 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 17:29:10,089 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 17:29:10,090 - src.services.reporting_logic.inventory_calculations - WARNING - shipped_items_df was not a DataFrame in calculate_current_inventory. Attempting conversion.
2025-07-07 17:29:10,091 - src.services.reporting_logic.inventory_calculations - ERROR - Failed to convert shipped_items_df to DataFrame for current inventory calculation: Cannot convert scalar list to DataFrame with expected columns without an explicit index/columns.
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 100, in calculate_current_inventory
    raise ValueError("Cannot convert scalar list to DataFrame with expected columns without an explicit index/columns.")
ValueError: Cannot convert scalar list to DataFrame with expected columns without an explicit index/columns.
2025-07-07 17:29:10,094 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 17:29:10,096 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 17:29:10,097 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 17:29:10,100 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 17:29:10,101 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 17:29:10,102 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 17:29:10,105 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 17:29:10,105 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 17:29:10,108 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:29:10,108 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:29:10,112 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:29:10,340 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:29:10,342 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:29:10,344 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:29:10,344 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 17:29:10,369 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:29:10,514 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:29:10,516 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:29:10,719 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:10,837 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:29:10,972 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:29:11,100 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:29:11,101 - gspread_dataframe - DEBUG - 4 cell updates to send
2025-07-07 17:29:11,238 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD1?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:29:11,240 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D1", 'updatedRows': 1, 'updatedColumns': 4, 'updatedCells': 4}
2025-07-07 17:29:11,241 - src.services.google_sheets.api_client - INFO - Successfully wrote 0 rows to worksheet 'Weekly Report'.
2025-07-07 17:29:11,244 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 17:29:11,245 - __main__ - INFO - Script finished successfully.
2025-07-07 17:31:16,514 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:31:16,515 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:31:16,914 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:31:16,915 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:31:16,915 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:31:16,915 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:31:16,927 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:31:17,204 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:31:17,205 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:31:17,206 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:31:17,206 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:31:17,229 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:31:17,374 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:31:17,377 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:31:17,727 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:31:17,843 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:31:17,844 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:31:17,996 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:31:17,998 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:31:18,001 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:31:18,002 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:31:18,005 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:31:18,200 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:31:18,201 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:31:18,202 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:31:18,203 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:31:18,225 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:31:18,368 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:31:18,370 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:31:18,558 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:31:18,677 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:31:18,678 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:31:18,842 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:31:18,844 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:31:18,844 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:31:18,845 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:31:18,847 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:31:19,046 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:31:19,047 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:31:19,047 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:31:19,048 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:31:19,070 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:31:19,222 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:31:19,224 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:31:19,415 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:31:19,548 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:31:19,549 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:31:19,679 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:31:19,687 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:31:19,691 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:31:19,697 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:31:19,698 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:31:19,700 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:31:19,915 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:31:19,917 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:31:19,917 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:31:19,918 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:31:19,939 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:31:20,102 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:31:20,103 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:31:20,296 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:31:20,413 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:31:20,416 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:31:20,560 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:31:20,566 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:31:20,570 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:31:20,571 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:31:20,573 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:31:20,792 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:31:20,795 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:31:20,796 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:31:20,796 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:31:20,819 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:31:20,985 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:31:20,987 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:31:21,259 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:31:21,388 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:31:21,391 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:31:21,535 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:31:21,536 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:31:21,542 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:31:21,545 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:31:21,546 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:31:21,549 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:31:21,551 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:31:21,553 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:31:21,553 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:31:21,557 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:31:21,559 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:31:21,560 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:31:21,561 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:31:21,563 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:31:21,564 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:31:21,566 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 17:31:21,567 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 425), ('17904', 115), ('17914', 223), ('18675', 749)]...
2025-07-07 17:31:21,567 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 17:31:21,567 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 17:31:21,568 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 17:31:21,569 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 17:31:21,575 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 17:31:21,577 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 0, Received: 0, Shipped: 71, Repack: 0, EOD: -71
2025-07-07 17:31:21,580 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 0, Received: 0, Shipped: 2, Repack: 0, EOD: -2
2025-07-07 17:31:21,582 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 0, Received: 0, Shipped: 1, Repack: 0, EOD: -1
2025-07-07 17:31:21,584 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 0, Received: 0, Shipped: 3, Repack: 0, EOD: -3
2025-07-07 17:31:21,584 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 17:31:21,587 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: -71, Received: 0, Shipped: 94, Repack: 0, EOD: -165
2025-07-07 17:31:21,588 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: -2, Received: 0, Shipped: 13, Repack: 0, EOD: -15
2025-07-07 17:31:21,590 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: -3, Received: 0, Shipped: 6, Repack: 0, EOD: -9
2025-07-07 17:31:21,591 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 17:31:21,595 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: -165, Received: 478, Shipped: 119, Repack: 0, EOD: 194
2025-07-07 17:31:21,597 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: -15, Received: 0, Shipped: 7, Repack: 0, EOD: -22
2025-07-07 17:31:21,599 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: -9, Received: 0, Shipped: 7, Repack: 0, EOD: -16
2025-07-07 17:31:21,600 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 17:31:21,602 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 194, Received: 0, Shipped: 296, Repack: 0, EOD: -102
2025-07-07 17:31:21,603 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: -22, Received: 0, Shipped: 1, Repack: 0, EOD: -23
2025-07-07 17:31:21,605 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: -16, Received: 0, Shipped: 7, Repack: 0, EOD: -23
2025-07-07 17:31:21,606 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 17:31:21,609 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: -102, Received: 0, Shipped: 117, Repack: 0, EOD: -219
2025-07-07 17:31:21,611 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: -23, Received: 0, Shipped: 2, Repack: 0, EOD: -25
2025-07-07 17:31:21,613 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: -1, Received: 0, Shipped: 1, Repack: 0, EOD: -2
2025-07-07 17:31:21,615 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: -23, Received: 0, Shipped: 1, Repack: 0, EOD: -24
2025-07-07 17:31:21,625 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 17:31:21,629 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: -219, Received: 0, Shipped: 47, Repack: 0, EOD: -266
2025-07-07 17:31:21,631 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: -25, Received: 0, Shipped: 2, Repack: 0, EOD: -27
2025-07-07 17:31:21,633 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: -2, Received: 0, Shipped: 1, Repack: 0, EOD: -3
2025-07-07 17:31:21,635 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: -24, Received: 0, Shipped: 3, Repack: 0, EOD: -27
2025-07-07 17:31:21,635 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 17:31:21,637 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: -266, Received: 0, Shipped: 87, Repack: 0, EOD: -353
2025-07-07 17:31:21,641 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: -27, Received: 0, Shipped: 3, Repack: 0, EOD: -30
2025-07-07 17:31:21,642 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 17:31:21,645 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: -353, Received: 0, Shipped: 67, Repack: 0, EOD: -420
2025-07-07 17:31:21,647 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: -27, Received: 0, Shipped: 1, Repack: 0, EOD: -28
2025-07-07 17:31:21,648 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: -3, Received: 0, Shipped: 1, Repack: 0, EOD: -4
2025-07-07 17:31:21,649 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: -30, Received: 0, Shipped: 3, Repack: 0, EOD: -33
2025-07-07 17:31:21,650 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 17:31:21,652 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: -420, Received: 0, Shipped: 234, Repack: 0, EOD: -654
2025-07-07 17:31:21,653 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: -28, Received: 0, Shipped: 14, Repack: 0, EOD: -42
2025-07-07 17:31:21,655 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: -33, Received: 0, Shipped: 11, Repack: 0, EOD: -44
2025-07-07 17:31:21,656 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 17:31:21,659 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: -654, Received: 0, Shipped: 83, Repack: 0, EOD: -737
2025-07-07 17:31:21,660 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: -42, Received: 0, Shipped: 1, Repack: 0, EOD: -43
2025-07-07 17:31:21,663 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: -44, Received: 0, Shipped: 12, Repack: 0, EOD: -56
2025-07-07 17:31:21,672 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 17:31:21,675 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: -737, Received: 0, Shipped: 164, Repack: 0, EOD: -901
2025-07-07 17:31:21,676 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: -43, Received: 0, Shipped: 2, Repack: 0, EOD: -45
2025-07-07 17:31:21,678 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: -4, Received: 0, Shipped: 3, Repack: 0, EOD: -7
2025-07-07 17:31:21,680 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: -56, Received: 0, Shipped: 3, Repack: 0, EOD: -59
2025-07-07 17:31:21,681 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 17:31:21,684 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: -901, Received: 0, Shipped: 56, Repack: 0, EOD: -957
2025-07-07 17:31:21,685 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: -45, Received: 0, Shipped: 1, Repack: 0, EOD: -46
2025-07-07 17:31:21,686 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: -7, Received: 0, Shipped: 12, Repack: 0, EOD: -19
2025-07-07 17:31:21,687 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: -59, Received: 0, Shipped: 11, Repack: 0, EOD: -70
2025-07-07 17:31:21,687 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 17:31:21,691 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -957, Received: 576, Shipped: 57, Repack: 0, EOD: -438
2025-07-07 17:31:21,692 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: -46, Received: 0, Shipped: 1, Repack: 0, EOD: -47
2025-07-07 17:31:21,695 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: -70, Received: 0, Shipped: 1, Repack: 0, EOD: -71
2025-07-07 17:31:21,696 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 17:31:21,699 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: -438, Received: 0, Shipped: 47, Repack: 0, EOD: -485
2025-07-07 17:31:21,700 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: -47, Received: 0, Shipped: 2, Repack: 0, EOD: -49
2025-07-07 17:31:21,702 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: -71, Received: 0, Shipped: 7, Repack: 0, EOD: -78
2025-07-07 17:31:21,703 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 17:31:21,706 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: -485, Received: 0, Shipped: 76, Repack: 0, EOD: -561
2025-07-07 17:31:21,707 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: -49, Received: 0, Shipped: 1, Repack: 0, EOD: -50
2025-07-07 17:31:21,708 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: -19, Received: 0, Shipped: 1, Repack: 0, EOD: -20
2025-07-07 17:31:21,710 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: -78, Received: 0, Shipped: 5, Repack: 0, EOD: -83
2025-07-07 17:31:21,719 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 17:31:21,722 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: -561, Received: 376, Shipped: 21, Repack: 0, EOD: -206
2025-07-07 17:31:21,723 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: -50, Received: 0, Shipped: 6, Repack: 0, EOD: -56
2025-07-07 17:31:21,726 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 17:31:21,730 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: -206, Received: 0, Shipped: 42, Repack: 0, EOD: -248
2025-07-07 17:31:21,731 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: -56, Received: 0, Shipped: 1, Repack: 0, EOD: -57
2025-07-07 17:31:21,733 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: -83, Received: 0, Shipped: 1, Repack: 0, EOD: -84
2025-07-07 17:31:21,734 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 17:31:21,737 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: -248, Received: 0, Shipped: 173, Repack: 0, EOD: -421
2025-07-07 17:31:21,738 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: -57, Received: 0, Shipped: 1, Repack: 0, EOD: -58
2025-07-07 17:31:21,740 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: -84, Received: 0, Shipped: 4, Repack: 0, EOD: -88
2025-07-07 17:31:21,742 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 17:31:21,745 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: -421, Received: 0, Shipped: 60, Repack: 0, EOD: -481
2025-07-07 17:31:21,747 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: -58, Received: 0, Shipped: 2, Repack: 0, EOD: -60
2025-07-07 17:31:21,749 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: -88, Received: 0, Shipped: 9, Repack: 0, EOD: -97
2025-07-07 17:31:21,750 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 17:31:21,753 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: -481, Received: 0, Shipped: 51, Repack: 0, EOD: -532
2025-07-07 17:31:21,754 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: -60, Received: 0, Shipped: 3, Repack: 0, EOD: -63
2025-07-07 17:31:21,756 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: -97, Received: 0, Shipped: 6, Repack: 0, EOD: -103
2025-07-07 17:31:21,766 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 17:31:21,768 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: -532, Received: 0, Shipped: 84, Repack: 0, EOD: -616
2025-07-07 17:31:21,769 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: -63, Received: 0, Shipped: 3, Repack: 0, EOD: -66
2025-07-07 17:31:21,771 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: -103, Received: 0, Shipped: 1, Repack: 0, EOD: -104
2025-07-07 17:31:21,774 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17904            115            115
1  2025-06-01  17612            425            425
2  2025-06-01  18675            749            749
3  2025-06-01  17612              0              0
4  2025-06-01  17904              0              0
2025-07-07 17:31:21,775 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17612           -532           -616
236  2025-06-30  17904            -63            -66
237  2025-06-30  18675            -20            -20
238  2025-06-30  17914            223            223
239  2025-06-30  17914           -103           -104
2025-07-07 17:31:21,775 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:31:21,776 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 17:31:21,777 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17904            115            115
1  2025-06-01  17612            425            425
2  2025-06-01  18675            749            749
3  2025-06-01  17612              0              0
4  2025-06-01  17904              0              0
2025-07-07 17:31:21,778 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17612           -532           -616
236  2025-06-30  17904            -63            -66
237  2025-06-30  18675            -20            -20
238  2025-06-30  17914            223            223
239  2025-06-30  17914           -103           -104
2025-07-07 17:31:21,779 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 17:31:21,780 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     122.387500
std      343.684192
min     -957.000000
25%      -45.250000
50%      115.000000
75%      273.500000
max      749.000000
2025-07-07 17:31:21,782 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01            425
9    2025-06-02            425
17   2025-06-03            425
25   2025-06-04            425
33   2025-06-05            425
41   2025-06-06            425
49   2025-06-07            425
57   2025-06-08            425
65   2025-06-09            425
73   2025-06-10            425
81   2025-06-11            425
89   2025-06-12            425
97   2025-06-13            425
105  2025-06-14            425
113  2025-06-15            425
121  2025-06-16            425
129  2025-06-17            425
137  2025-06-18            425
145  2025-06-19            425
153  2025-06-20            425
161  2025-06-21            425
169  2025-06-22            425
177  2025-06-23            425
185  2025-06-24            425
193  2025-06-25            425
201  2025-06-26            425
209  2025-06-27            425
217  2025-06-28            425
225  2025-06-29            425
233  2025-06-30            425
2025-07-07 17:31:21,784 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
0    2025-06-01            115
8    2025-06-02            115
16   2025-06-03            115
24   2025-06-04            115
32   2025-06-05            115
40   2025-06-06            115
48   2025-06-07            115
56   2025-06-08            115
64   2025-06-09            115
72   2025-06-10            115
80   2025-06-11            115
88   2025-06-12            115
96   2025-06-13            115
104  2025-06-14            115
112  2025-06-15            115
120  2025-06-16            115
128  2025-06-17            115
136  2025-06-18            115
144  2025-06-19            115
152  2025-06-20            115
160  2025-06-21            115
168  2025-06-22            115
176  2025-06-23            115
184  2025-06-24            115
192  2025-06-25            115
200  2025-06-26            115
208  2025-06-27            115
216  2025-06-28            115
224  2025-06-29            115
232  2025-06-30            115
2025-07-07 17:31:21,789 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 17:31:21,790 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       3.750000
std        5.460011
min        0.000000
25%        0.000000
50%        1.000000
75%        4.500000
max       16.000000
2025-07-07 17:31:21,792 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01            9
9    2025-06-02            9
17   2025-06-03            9
25   2025-06-04            9
33   2025-06-05            9
41   2025-06-06            9
49   2025-06-07            9
57   2025-06-08            9
65   2025-06-09            9
73   2025-06-10            9
81   2025-06-11            9
89   2025-06-12            9
97   2025-06-13            9
105  2025-06-14            9
113  2025-06-15            9
121  2025-06-16            9
129  2025-06-17            9
137  2025-06-18            9
145  2025-06-19            9
153  2025-06-20            9
161  2025-06-21            9
169  2025-06-22            9
177  2025-06-23            9
185  2025-06-24            9
193  2025-06-25            9
201  2025-06-26            9
209  2025-06-27            9
217  2025-06-28            9
225  2025-06-29            9
233  2025-06-30            9
2025-07-07 17:31:21,794 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    30
2025-06-02    30
2025-06-03    30
2025-06-04    30
2025-06-05    30
2025-07-07 17:31:21,795 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    30
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    30
2025-07-07 17:31:21,795 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 17:31:21,796 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 17:31:21,797 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 17:31:21,798 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    13.5
2025-06-02    13.5
2025-06-03    13.5
2025-06-04    13.5
2025-06-05    13.5
2025-07-07 17:31:21,799 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.5
2025-06-27    13.5
2025-06-28    13.5
2025-06-29    13.5
2025-06-30    13.5
2025-07-07 17:31:21,805 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 17:31:21,807 - __main__ - CRITICAL - A critical error occurred during script execution: 'NoneType' object has no attribute 'rename'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 114, in <module>
    main()
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 83, in main
    final_monthly_df = pd.concat([monthly_report_df, monthly_totals_df.rename(index={0: 'Monthly Totals'})])
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rename'
2025-07-07 17:32:26,786 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:32:26,787 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:32:27,142 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:32:27,143 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:32:27,143 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:32:27,144 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:32:27,157 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:32:27,382 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:32:27,384 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:32:27,384 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:32:27,385 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:32:27,410 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:32:27,561 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:32:27,563 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:32:27,831 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:27,940 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:27,942 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:32:28,069 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:32:28,070 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:32:28,073 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:32:28,073 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:32:28,076 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:32:28,355 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:32:28,357 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:32:28,359 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:32:28,360 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:32:28,386 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:32:28,523 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:32:28,526 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:32:28,705 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:28,833 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:28,834 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:32:28,968 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:32:28,969 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:32:28,970 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:32:28,971 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:32:28,975 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:32:29,194 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:32:29,196 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:32:29,197 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:32:29,197 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:32:29,231 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:32:29,371 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:32:29,372 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:32:29,557 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:29,672 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:29,674 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:32:29,807 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:32:29,818 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:32:29,822 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:32:29,832 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:32:29,832 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:32:29,836 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:32:30,057 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:32:30,059 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:32:30,060 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:32:30,061 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:32:30,102 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:32:30,258 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:32:30,260 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:32:30,440 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:30,557 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:30,558 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:32:30,695 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:32:30,704 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:32:30,714 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:32:30,715 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:32:30,720 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:32:30,939 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:32:30,942 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:32:30,943 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:32:30,943 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:32:30,975 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:32:31,126 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:32:31,127 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:32:31,319 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:31,436 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:31,438 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:32:31,567 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:32:31,569 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:32:31,584 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:32:31,592 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:32:31,595 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:32:31,601 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:32:31,606 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:32:31,607 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:32:31,607 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:32:31,619 - src.services.reporting_logic.monthly_report_generator - DEBUG - Monthly report date range: 2025-06-01 to 2025-06-30
2025-07-07 17:32:31,625 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:32:31,634 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:32:31,635 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:32:31,639 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:32:31,644 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:32:31,645 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:32:31,648 - src.services.reporting_logic.inventory_calculations - INFO - Calculating daily inventory (BOD/EOD)...
2025-07-07 17:32:31,875 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:32:31,901 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:32:31,902 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:32:31,906 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:32:32,118 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:32:32,121 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:32:32,122 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:32:32,122 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 17:32:32,162 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:32:32,301 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:32:32,304 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:32:32,504 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:32,618 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:32,786 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:32:32,916 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:32:32,919 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 17:32:33,083 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:32:33,084 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 17:32:33,085 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 17:32:33,086 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 17:32:33,087 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:32:33,087 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:32:33,094 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:32:33,326 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:32:33,329 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:32:33,329 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:32:33,330 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:32:33,363 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:32:33,511 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:32:33,515 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:32:33,719 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:33,845 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:33,846 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 17:32:33,980 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 17:32:33,982 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 17:32:33,994 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 17:32:34,032 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 17:32:34,032 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 17:32:34,043 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 17:32:34,056 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 17:32:34,069 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 17:32:34,074 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 17:32:34,088 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 17:32:34,099 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 17:32:34,100 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 17:32:34,108 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:32:34,111 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:32:34,117 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:32:34,386 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:32:34,389 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:32:34,392 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:32:34,394 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 17:32:34,464 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:32:34,620 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:32:34,625 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:32:34,812 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:34,931 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:32:35,077 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:32:35,211 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:32:35,212 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 17:32:35,367 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:32:35,369 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 17:32:35,370 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 17:32:35,374 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 17:32:35,377 - __main__ - INFO - Script finished successfully.
2025-07-07 17:36:54,045 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:36:54,046 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:36:54,462 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:36:54,462 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:36:54,463 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:36:54,463 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:36:54,476 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:36:54,739 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:36:54,742 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:36:54,748 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:36:54,749 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:36:54,783 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:36:54,954 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:36:54,957 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:36:55,301 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:36:55,435 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:36:55,436 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:36:55,575 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:36:55,577 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:36:55,582 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:36:55,582 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:36:55,586 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:36:55,791 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:36:55,793 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:36:55,793 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:36:55,794 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:36:55,817 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:36:55,974 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:36:55,976 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:36:56,208 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:36:56,328 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:36:56,329 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:36:56,461 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:36:56,462 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:36:56,464 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:36:56,464 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:36:56,466 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:36:56,678 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:36:56,680 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:36:56,682 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:36:56,682 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:36:56,710 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:36:56,850 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:36:56,854 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:36:57,049 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:36:57,167 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:36:57,168 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:36:57,416 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:36:57,422 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:36:57,427 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:36:57,431 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:36:57,431 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:36:57,434 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:36:57,623 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:36:57,625 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:36:57,627 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:36:57,627 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:36:57,648 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:36:57,798 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:36:57,800 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:36:57,985 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:36:58,095 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:36:58,098 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:36:58,223 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:36:58,226 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:36:58,230 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:36:58,230 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:36:58,234 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:36:58,425 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:36:58,427 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:36:58,428 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:36:58,429 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:36:58,450 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:36:58,584 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:36:58,585 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:36:58,768 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:36:58,873 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:36:58,875 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:36:58,998 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:36:59,000 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:36:59,005 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:36:59,009 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:36:59,011 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:36:59,014 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:36:59,017 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:36:59,018 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:36:59,018 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:36:59,023 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:36:59,025 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:36:59,026 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:36:59,027 - src.services.reporting_logic.monthly_report_generator - ERROR - Error generating monthly charge report: name 'shpped_orders_df_filtered' is not defined
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\monthly_report_generator.py", line 48, in generate_monthly_charge_report
    logger.debug(f"shipped_orders_df_filtered head: \n{shpped_orders_df_filtered.head().to_string()}")
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'shpped_orders_df_filtered' is not defined
2025-07-07 17:36:59,028 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 17:36:59,029 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:36:59,030 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:36:59,032 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:36:59,271 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:36:59,273 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:36:59,273 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:36:59,274 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:36:59,299 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:36:59,456 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:36:59,458 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:36:59,651 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:36:59,786 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:36:59,789 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 17:36:59,943 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 17:36:59,945 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 17:36:59,949 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 17:36:59,950 - src.services.reporting_logic.inventory_calculations - WARNING - shipped_items_df was not a DataFrame in calculate_current_inventory. Attempting conversion.
2025-07-07 17:36:59,951 - src.services.reporting_logic.inventory_calculations - ERROR - Failed to convert shipped_items_df to DataFrame for current inventory calculation: Cannot convert scalar list to DataFrame with expected columns without an explicit index/columns.
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 100, in calculate_current_inventory
    raise ValueError("Cannot convert scalar list to DataFrame with expected columns without an explicit index/columns.")
ValueError: Cannot convert scalar list to DataFrame with expected columns without an explicit index/columns.
2025-07-07 17:36:59,952 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 17:36:59,953 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 17:36:59,954 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 17:36:59,956 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 17:36:59,956 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 17:36:59,957 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 17:36:59,961 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 17:36:59,962 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 17:36:59,964 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:36:59,965 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:36:59,967 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:37:00,182 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:37:00,184 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:37:00,184 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:37:00,185 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 17:37:00,208 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:37:00,361 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:37:00,363 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:37:00,544 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:37:00,659 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:37:00,811 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:37:00,973 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:37:00,975 - gspread_dataframe - DEBUG - 4 cell updates to send
2025-07-07 17:37:01,136 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD1?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:37:01,137 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D1", 'updatedRows': 1, 'updatedColumns': 4, 'updatedCells': 4}
2025-07-07 17:37:01,138 - src.services.google_sheets.api_client - INFO - Successfully wrote 0 rows to worksheet 'Weekly Report'.
2025-07-07 17:37:01,138 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 17:37:01,139 - __main__ - INFO - Script finished successfully.
2025-07-07 17:38:52,937 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:38:52,938 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:38:53,532 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:38:53,533 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:38:53,533 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:38:53,534 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:38:53,551 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:38:53,770 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:38:53,771 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:38:53,772 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:38:53,772 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:38:53,799 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:38:53,955 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:38:53,957 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:38:54,267 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:38:54,402 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:38:54,403 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:38:54,540 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:38:54,543 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:38:54,549 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:38:54,550 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:38:54,553 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:38:54,761 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:38:54,763 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:38:54,764 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:38:54,764 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:38:54,791 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:38:54,937 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:38:54,939 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:38:55,163 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:38:55,275 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:38:55,278 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:38:55,414 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:38:55,416 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:38:55,417 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:38:55,418 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:38:55,420 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:38:55,639 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:38:55,640 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:38:55,641 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:38:55,642 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:38:55,665 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:38:55,820 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:38:55,821 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:38:56,025 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:38:56,142 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:38:56,144 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:38:56,294 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:38:56,300 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:38:56,303 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:38:56,308 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:38:56,309 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:38:56,312 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:38:56,508 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:38:56,510 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:38:56,510 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:38:56,511 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:38:56,534 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:38:56,689 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:38:56,691 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:38:56,893 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:38:57,012 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:38:57,013 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:38:57,144 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:38:57,147 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:38:57,151 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:38:57,151 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:38:57,154 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:38:57,345 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:38:57,347 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:38:57,348 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:38:57,349 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:38:57,372 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:38:57,530 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:38:57,531 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:38:57,723 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:38:57,844 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:38:57,845 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:38:57,967 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:38:57,967 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:38:57,974 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:38:57,978 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:38:57,979 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:38:57,983 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:38:57,987 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:38:57,988 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:38:57,988 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:38:57,992 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:38:57,994 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:38:57,994 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:38:57,995 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:38:57,997 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:38:57,997 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:38:58,000 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 17:38:58,000 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 425), ('17904', 115), ('17914', 223), ('18675', 749)]...
2025-07-07 17:38:58,001 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 17:38:58,001 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 17:38:58,001 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 17:38:58,002 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 17:38:58,009 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 17:38:58,012 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 0, Received: 0, Shipped: 71, Repack: 0, EOD: -71
2025-07-07 17:38:58,014 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 0, Received: 0, Shipped: 2, Repack: 0, EOD: -2
2025-07-07 17:38:58,016 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 0, Received: 0, Shipped: 1, Repack: 0, EOD: -1
2025-07-07 17:38:58,018 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 0, Received: 0, Shipped: 3, Repack: 0, EOD: -3
2025-07-07 17:38:58,019 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 17:38:58,022 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: -71, Received: 0, Shipped: 94, Repack: 0, EOD: -165
2025-07-07 17:38:58,023 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: -2, Received: 0, Shipped: 13, Repack: 0, EOD: -15
2025-07-07 17:38:58,026 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: -3, Received: 0, Shipped: 6, Repack: 0, EOD: -9
2025-07-07 17:38:58,027 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 17:38:58,030 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: -165, Received: 478, Shipped: 119, Repack: 0, EOD: 194
2025-07-07 17:38:58,032 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: -15, Received: 0, Shipped: 7, Repack: 0, EOD: -22
2025-07-07 17:38:58,034 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: -9, Received: 0, Shipped: 7, Repack: 0, EOD: -16
2025-07-07 17:38:58,035 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 17:38:58,038 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 194, Received: 0, Shipped: 296, Repack: 0, EOD: -102
2025-07-07 17:38:58,039 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: -22, Received: 0, Shipped: 1, Repack: 0, EOD: -23
2025-07-07 17:38:58,043 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: -16, Received: 0, Shipped: 7, Repack: 0, EOD: -23
2025-07-07 17:38:58,045 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 17:38:58,048 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: -102, Received: 0, Shipped: 117, Repack: 0, EOD: -219
2025-07-07 17:38:58,049 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: -23, Received: 0, Shipped: 2, Repack: 0, EOD: -25
2025-07-07 17:38:58,051 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: -1, Received: 0, Shipped: 1, Repack: 0, EOD: -2
2025-07-07 17:38:58,052 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: -23, Received: 0, Shipped: 1, Repack: 0, EOD: -24
2025-07-07 17:38:58,061 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 17:38:58,064 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: -219, Received: 0, Shipped: 47, Repack: 0, EOD: -266
2025-07-07 17:38:58,067 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: -25, Received: 0, Shipped: 2, Repack: 0, EOD: -27
2025-07-07 17:38:58,069 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: -2, Received: 0, Shipped: 1, Repack: 0, EOD: -3
2025-07-07 17:38:58,071 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: -24, Received: 0, Shipped: 3, Repack: 0, EOD: -27
2025-07-07 17:38:58,071 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 17:38:58,074 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: -266, Received: 0, Shipped: 87, Repack: 0, EOD: -353
2025-07-07 17:38:58,077 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: -27, Received: 0, Shipped: 3, Repack: 0, EOD: -30
2025-07-07 17:38:58,078 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 17:38:58,081 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: -353, Received: 0, Shipped: 67, Repack: 0, EOD: -420
2025-07-07 17:38:58,082 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: -27, Received: 0, Shipped: 1, Repack: 0, EOD: -28
2025-07-07 17:38:58,083 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: -3, Received: 0, Shipped: 1, Repack: 0, EOD: -4
2025-07-07 17:38:58,085 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: -30, Received: 0, Shipped: 3, Repack: 0, EOD: -33
2025-07-07 17:38:58,085 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 17:38:58,088 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: -420, Received: 0, Shipped: 234, Repack: 0, EOD: -654
2025-07-07 17:38:58,089 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: -28, Received: 0, Shipped: 14, Repack: 0, EOD: -42
2025-07-07 17:38:58,093 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: -33, Received: 0, Shipped: 11, Repack: 0, EOD: -44
2025-07-07 17:38:58,093 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 17:38:58,096 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: -654, Received: 0, Shipped: 83, Repack: 0, EOD: -737
2025-07-07 17:38:58,097 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: -42, Received: 0, Shipped: 1, Repack: 0, EOD: -43
2025-07-07 17:38:58,100 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: -44, Received: 0, Shipped: 12, Repack: 0, EOD: -56
2025-07-07 17:38:58,110 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 17:38:58,114 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: -737, Received: 0, Shipped: 164, Repack: 0, EOD: -901
2025-07-07 17:38:58,116 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: -43, Received: 0, Shipped: 2, Repack: 0, EOD: -45
2025-07-07 17:38:58,117 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: -4, Received: 0, Shipped: 3, Repack: 0, EOD: -7
2025-07-07 17:38:58,119 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: -56, Received: 0, Shipped: 3, Repack: 0, EOD: -59
2025-07-07 17:38:58,120 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 17:38:58,122 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: -901, Received: 0, Shipped: 56, Repack: 0, EOD: -957
2025-07-07 17:38:58,124 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: -45, Received: 0, Shipped: 1, Repack: 0, EOD: -46
2025-07-07 17:38:58,125 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: -7, Received: 0, Shipped: 12, Repack: 0, EOD: -19
2025-07-07 17:38:58,127 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: -59, Received: 0, Shipped: 11, Repack: 0, EOD: -70
2025-07-07 17:38:58,128 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 17:38:58,130 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -957, Received: 576, Shipped: 57, Repack: 0, EOD: -438
2025-07-07 17:38:58,132 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: -46, Received: 0, Shipped: 1, Repack: 0, EOD: -47
2025-07-07 17:38:58,135 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: -70, Received: 0, Shipped: 1, Repack: 0, EOD: -71
2025-07-07 17:38:58,136 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 17:38:58,139 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: -438, Received: 0, Shipped: 47, Repack: 0, EOD: -485
2025-07-07 17:38:58,141 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: -47, Received: 0, Shipped: 2, Repack: 0, EOD: -49
2025-07-07 17:38:58,143 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: -71, Received: 0, Shipped: 7, Repack: 0, EOD: -78
2025-07-07 17:38:58,144 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 17:38:58,146 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: -485, Received: 0, Shipped: 76, Repack: 0, EOD: -561
2025-07-07 17:38:58,147 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: -49, Received: 0, Shipped: 1, Repack: 0, EOD: -50
2025-07-07 17:38:58,148 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: -19, Received: 0, Shipped: 1, Repack: 0, EOD: -20
2025-07-07 17:38:58,150 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: -78, Received: 0, Shipped: 5, Repack: 0, EOD: -83
2025-07-07 17:38:58,161 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 17:38:58,164 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: -561, Received: 376, Shipped: 21, Repack: 0, EOD: -206
2025-07-07 17:38:58,166 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: -50, Received: 0, Shipped: 6, Repack: 0, EOD: -56
2025-07-07 17:38:58,169 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 17:38:58,172 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: -206, Received: 0, Shipped: 42, Repack: 0, EOD: -248
2025-07-07 17:38:58,173 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: -56, Received: 0, Shipped: 1, Repack: 0, EOD: -57
2025-07-07 17:38:58,176 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: -83, Received: 0, Shipped: 1, Repack: 0, EOD: -84
2025-07-07 17:38:58,177 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 17:38:58,180 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: -248, Received: 0, Shipped: 173, Repack: 0, EOD: -421
2025-07-07 17:38:58,181 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: -57, Received: 0, Shipped: 1, Repack: 0, EOD: -58
2025-07-07 17:38:58,184 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: -84, Received: 0, Shipped: 4, Repack: 0, EOD: -88
2025-07-07 17:38:58,185 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 17:38:58,189 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: -421, Received: 0, Shipped: 60, Repack: 0, EOD: -481
2025-07-07 17:38:58,191 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: -58, Received: 0, Shipped: 2, Repack: 0, EOD: -60
2025-07-07 17:38:58,193 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: -88, Received: 0, Shipped: 9, Repack: 0, EOD: -97
2025-07-07 17:38:58,195 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 17:38:58,198 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: -481, Received: 0, Shipped: 51, Repack: 0, EOD: -532
2025-07-07 17:38:58,200 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: -60, Received: 0, Shipped: 3, Repack: 0, EOD: -63
2025-07-07 17:38:58,201 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: -97, Received: 0, Shipped: 6, Repack: 0, EOD: -103
2025-07-07 17:38:58,211 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 17:38:58,215 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: -532, Received: 0, Shipped: 84, Repack: 0, EOD: -616
2025-07-07 17:38:58,216 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: -63, Received: 0, Shipped: 3, Repack: 0, EOD: -66
2025-07-07 17:38:58,218 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: -103, Received: 0, Shipped: 1, Repack: 0, EOD: -104
2025-07-07 17:38:58,220 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914            223            223
1  2025-06-01  17904            115            115
2  2025-06-01  18675            749            749
3  2025-06-01  17612              0              0
4  2025-06-01  17904              0              0
2025-07-07 17:38:58,221 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17612           -532           -616
236  2025-06-30  17904            -63            -66
237  2025-06-30  18675            -20            -20
238  2025-06-30  17612            425            425
239  2025-06-30  17914           -103           -104
2025-07-07 17:38:58,221 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:38:58,222 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 17:38:58,223 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914            223            223
1  2025-06-01  17904            115            115
2  2025-06-01  18675            749            749
3  2025-06-01  17612              0              0
4  2025-06-01  17904              0              0
2025-07-07 17:38:58,224 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17612           -532           -616
236  2025-06-30  17904            -63            -66
237  2025-06-30  18675            -20            -20
238  2025-06-30  17612            425            425
239  2025-06-30  17914           -103           -104
2025-07-07 17:38:58,225 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 17:38:58,227 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     122.387500
std      343.684192
min     -957.000000
25%      -45.250000
50%      115.000000
75%      273.500000
max      749.000000
2025-07-07 17:38:58,230 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
6    2025-06-01            425
14   2025-06-02            425
22   2025-06-03            425
30   2025-06-04            425
38   2025-06-05            425
46   2025-06-06            425
54   2025-06-07            425
62   2025-06-08            425
70   2025-06-09            425
78   2025-06-10            425
86   2025-06-11            425
94   2025-06-12            425
102  2025-06-13            425
110  2025-06-14            425
118  2025-06-15            425
126  2025-06-16            425
134  2025-06-17            425
142  2025-06-18            425
150  2025-06-19            425
158  2025-06-20            425
166  2025-06-21            425
174  2025-06-22            425
182  2025-06-23            425
190  2025-06-24            425
198  2025-06-25            425
206  2025-06-26            425
214  2025-06-27            425
222  2025-06-28            425
230  2025-06-29            425
238  2025-06-30            425
2025-07-07 17:38:58,232 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            115
9    2025-06-02            115
17   2025-06-03            115
25   2025-06-04            115
33   2025-06-05            115
41   2025-06-06            115
49   2025-06-07            115
57   2025-06-08            115
65   2025-06-09            115
73   2025-06-10            115
81   2025-06-11            115
89   2025-06-12            115
97   2025-06-13            115
105  2025-06-14            115
113  2025-06-15            115
121  2025-06-16            115
129  2025-06-17            115
137  2025-06-18            115
145  2025-06-19            115
153  2025-06-20            115
161  2025-06-21            115
169  2025-06-22            115
177  2025-06-23            115
185  2025-06-24            115
193  2025-06-25            115
201  2025-06-26            115
209  2025-06-27            115
217  2025-06-28            115
225  2025-06-29            115
233  2025-06-30            115
2025-07-07 17:38:58,238 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 17:38:58,240 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       3.750000
std        5.460011
min        0.000000
25%        0.000000
50%        1.000000
75%        4.500000
max       16.000000
2025-07-07 17:38:58,242 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
6    2025-06-01            9
14   2025-06-02            9
22   2025-06-03            9
30   2025-06-04            9
38   2025-06-05            9
46   2025-06-06            9
54   2025-06-07            9
62   2025-06-08            9
70   2025-06-09            9
78   2025-06-10            9
86   2025-06-11            9
94   2025-06-12            9
102  2025-06-13            9
110  2025-06-14            9
118  2025-06-15            9
126  2025-06-16            9
134  2025-06-17            9
142  2025-06-18            9
150  2025-06-19            9
158  2025-06-20            9
166  2025-06-21            9
174  2025-06-22            9
182  2025-06-23            9
190  2025-06-24            9
198  2025-06-25            9
206  2025-06-26            9
214  2025-06-27            9
222  2025-06-28            9
230  2025-06-29            9
238  2025-06-30            9
2025-07-07 17:38:58,244 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    30
2025-06-02    30
2025-06-03    30
2025-06-04    30
2025-06-05    30
2025-07-07 17:38:58,245 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    30
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    30
2025-07-07 17:38:58,245 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 17:38:58,245 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 17:38:58,248 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 17:38:58,249 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    13.5
2025-06-02    13.5
2025-06-03    13.5
2025-06-04    13.5
2025-06-05    13.5
2025-07-07 17:38:58,250 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.5
2025-06-27    13.5
2025-06-28    13.5
2025-06-29    13.5
2025-06-30    13.5
2025-07-07 17:38:58,255 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 17:38:58,255 - __main__ - CRITICAL - A critical error occurred during script execution: 'NoneType' object has no attribute 'rename'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 123, in <module>
    main()
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 83, in main
    final_monthly_df = pd.concat([monthly_report_df, monthly_totals_df.rename(index={0: 'Monthly Totals'})])
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rename'
2025-07-07 17:40:42,469 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:40:42,470 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:40:42,814 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:40:42,815 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:40:42,816 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:40:42,816 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:40:42,826 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:40:43,036 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:40:43,037 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:40:43,038 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:40:43,039 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:40:43,065 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:40:43,227 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:40:43,229 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:40:43,458 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:40:43,577 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:40:43,578 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:40:43,714 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:40:43,718 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:40:43,721 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:40:43,722 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:40:43,725 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:40:43,930 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:40:43,932 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:40:43,933 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:40:43,934 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:40:43,958 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:40:44,121 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:40:44,124 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:40:44,318 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:40:44,432 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:40:44,434 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:40:44,577 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:40:44,580 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:40:44,581 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:40:44,582 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:40:44,585 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:40:44,771 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:40:44,773 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:40:44,774 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:40:44,774 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:40:44,796 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:40:44,970 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:40:44,972 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:40:45,160 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:40:45,280 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:40:45,281 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:40:45,416 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:40:45,422 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:40:45,427 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:40:45,432 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:40:45,433 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:40:45,435 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:40:45,647 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:40:45,649 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:40:45,650 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:40:45,651 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:40:45,673 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:40:45,816 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:40:45,817 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:40:46,024 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:40:46,136 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:40:46,137 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:40:46,277 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:40:46,281 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:40:46,285 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:40:46,286 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:40:46,290 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:40:46,480 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:40:46,482 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:40:46,482 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:40:46,483 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:40:46,505 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:40:46,647 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:40:46,649 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:40:46,836 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:40:46,953 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:40:46,955 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:40:47,082 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:40:47,085 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:40:47,096 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:40:47,100 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:40:47,101 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:40:47,103 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:40:47,107 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:40:47,108 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:40:47,109 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:40:47,114 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:40:47,115 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:40:47,116 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:40:47,117 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:40:47,118 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:40:47,119 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:40:47,121 - src.services.reporting_logic.inventory_calculations - INFO - Calculating daily inventory (BOD/EOD)...
2025-07-07 17:40:47,250 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:40:47,251 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 17:40:47,252 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17904            115            115
1  2025-06-01  17914            223            223
2  2025-06-01  17612            425            425
3  2025-06-01  18675            749            749
4  2025-06-01  17612              0              0
2025-07-07 17:40:47,254 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  18675            749            749
236  2025-06-30  17612           -532           -616
237  2025-06-30  17904            -63            -66
238  2025-06-30  18675            -20            -20
239  2025-06-30  17914           -103           -104
2025-07-07 17:40:47,254 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 17:40:47,256 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     122.387500
std      343.684192
min     -957.000000
25%      -45.250000
50%      115.000000
75%      273.500000
max      749.000000
2025-07-07 17:40:47,258 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
2    2025-06-01            425
10   2025-06-02            425
18   2025-06-03            425
26   2025-06-04            425
34   2025-06-05            425
42   2025-06-06            425
50   2025-06-07            425
58   2025-06-08            425
66   2025-06-09            425
74   2025-06-10            425
82   2025-06-11            425
90   2025-06-12            425
98   2025-06-13            425
106  2025-06-14            425
114  2025-06-15            425
122  2025-06-16            425
130  2025-06-17            425
138  2025-06-18            425
146  2025-06-19            425
154  2025-06-20            425
162  2025-06-21            425
170  2025-06-22            425
178  2025-06-23            425
186  2025-06-24            425
194  2025-06-25            425
202  2025-06-26            425
210  2025-06-27            425
218  2025-06-28            425
226  2025-06-29            425
234  2025-06-30            425
2025-07-07 17:40:47,261 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
0    2025-06-01            115
8    2025-06-02            115
16   2025-06-03            115
24   2025-06-04            115
32   2025-06-05            115
40   2025-06-06            115
48   2025-06-07            115
56   2025-06-08            115
64   2025-06-09            115
72   2025-06-10            115
80   2025-06-11            115
88   2025-06-12            115
96   2025-06-13            115
104  2025-06-14            115
112  2025-06-15            115
120  2025-06-16            115
128  2025-06-17            115
136  2025-06-18            115
144  2025-06-19            115
152  2025-06-20            115
160  2025-06-21            115
168  2025-06-22            115
176  2025-06-23            115
184  2025-06-24            115
192  2025-06-25            115
200  2025-06-26            115
208  2025-06-27            115
216  2025-06-28            115
224  2025-06-29            115
232  2025-06-30            115
2025-07-07 17:40:47,268 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 17:40:47,269 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       3.750000
std        5.460011
min        0.000000
25%        0.000000
50%        1.000000
75%        4.500000
max       16.000000
2025-07-07 17:40:47,272 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
2    2025-06-01            9
10   2025-06-02            9
18   2025-06-03            9
26   2025-06-04            9
34   2025-06-05            9
42   2025-06-06            9
50   2025-06-07            9
58   2025-06-08            9
66   2025-06-09            9
74   2025-06-10            9
82   2025-06-11            9
90   2025-06-12            9
98   2025-06-13            9
106  2025-06-14            9
114  2025-06-15            9
122  2025-06-16            9
130  2025-06-17            9
138  2025-06-18            9
146  2025-06-19            9
154  2025-06-20            9
162  2025-06-21            9
170  2025-06-22            9
178  2025-06-23            9
186  2025-06-24            9
194  2025-06-25            9
202  2025-06-26            9
210  2025-06-27            9
218  2025-06-28            9
226  2025-06-29            9
234  2025-06-30            9
2025-07-07 17:40:47,273 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    30
2025-06-02    30
2025-06-03    30
2025-06-04    30
2025-06-05    30
2025-07-07 17:40:47,274 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    30
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    30
2025-07-07 17:40:47,275 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 17:40:47,275 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 17:40:47,280 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 17:40:47,281 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    13.5
2025-06-02    13.5
2025-06-03    13.5
2025-06-04    13.5
2025-06-05    13.5
2025-07-07 17:40:47,282 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.5
2025-06-27    13.5
2025-06-28    13.5
2025-06-29    13.5
2025-06-30    13.5
2025-07-07 17:40:47,290 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 17:40:47,291 - __main__ - CRITICAL - A critical error occurred during script execution: 'NoneType' object has no attribute 'rename'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 123, in <module>
    main()
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 83, in main
    final_monthly_df = pd.concat([monthly_report_df, monthly_totals_df.rename(index={0: 'Monthly Totals'})])
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rename'
2025-07-07 17:41:09,787 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:41:09,788 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:41:10,592 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:41:10,593 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:41:10,593 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:41:10,594 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:41:10,616 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:41:10,838 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:41:10,840 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:41:10,841 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:41:10,842 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:41:10,874 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:41:11,023 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:41:11,026 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:41:11,264 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:41:11,388 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:41:11,390 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:41:11,523 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:41:11,526 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:41:11,529 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:41:11,530 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:41:11,532 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:41:11,822 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:41:11,826 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:41:11,827 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:41:11,828 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:41:11,861 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:41:12,008 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:41:12,010 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:41:12,206 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:41:12,340 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:41:12,341 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:41:12,469 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:41:12,471 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:41:12,472 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:41:12,473 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:41:12,476 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:41:12,684 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:41:12,685 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:41:12,686 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:41:12,686 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:41:12,710 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:41:12,876 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:41:12,878 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:41:13,070 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:41:13,201 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:41:13,203 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:41:13,332 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:41:13,342 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:41:13,348 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:41:13,355 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:41:13,356 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:41:13,359 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:41:13,582 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:41:13,583 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:41:13,584 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:41:13,584 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:41:13,606 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:41:13,751 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:41:13,753 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:41:13,957 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:41:14,083 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:41:14,084 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:41:14,223 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:41:14,229 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:41:14,234 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:41:14,235 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:41:14,240 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:41:14,452 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:41:14,453 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:41:14,454 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:41:14,454 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:41:14,489 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:41:14,642 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:41:14,645 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:41:14,837 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:41:14,958 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:41:14,961 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:41:15,097 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:41:15,099 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:41:15,109 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:41:15,119 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:41:15,123 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:41:15,133 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:41:15,137 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:41:15,139 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:41:15,140 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:41:15,153 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:41:15,156 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:41:15,159 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:41:15,162 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:41:15,165 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:41:15,167 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:41:15,171 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 17:41:15,172 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 425), ('17904', 115), ('17914', 223), ('18675', 749)]...
2025-07-07 17:41:15,174 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 17:41:15,176 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 17:41:15,177 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 17:41:15,180 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 17:41:15,202 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 17:41:15,217 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 0, Received: 0, Shipped: 71, Repack: 0, EOD: -71
2025-07-07 17:41:15,226 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 0, Received: 0, Shipped: 2, Repack: 0, EOD: -2
2025-07-07 17:41:15,239 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 0, Received: 0, Shipped: 1, Repack: 0, EOD: -1
2025-07-07 17:41:15,255 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 0, Received: 0, Shipped: 3, Repack: 0, EOD: -3
2025-07-07 17:41:15,270 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 17:41:15,288 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: -71, Received: 0, Shipped: 94, Repack: 0, EOD: -165
2025-07-07 17:41:15,294 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: -2, Received: 0, Shipped: 13, Repack: 0, EOD: -15
2025-07-07 17:41:15,304 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: -3, Received: 0, Shipped: 6, Repack: 0, EOD: -9
2025-07-07 17:41:15,309 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 17:41:15,317 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: -165, Received: 478, Shipped: 119, Repack: 0, EOD: 194
2025-07-07 17:41:15,323 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: -15, Received: 0, Shipped: 7, Repack: 0, EOD: -22
2025-07-07 17:41:15,349 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: -9, Received: 0, Shipped: 7, Repack: 0, EOD: -16
2025-07-07 17:41:15,361 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 17:41:15,379 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 194, Received: 0, Shipped: 296, Repack: 0, EOD: -102
2025-07-07 17:41:15,388 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: -22, Received: 0, Shipped: 1, Repack: 0, EOD: -23
2025-07-07 17:41:15,410 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: -16, Received: 0, Shipped: 7, Repack: 0, EOD: -23
2025-07-07 17:41:15,418 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 17:41:15,426 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: -102, Received: 0, Shipped: 117, Repack: 0, EOD: -219
2025-07-07 17:41:15,429 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: -23, Received: 0, Shipped: 2, Repack: 0, EOD: -25
2025-07-07 17:41:15,432 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: -1, Received: 0, Shipped: 1, Repack: 0, EOD: -2
2025-07-07 17:41:15,438 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: -23, Received: 0, Shipped: 1, Repack: 0, EOD: -24
2025-07-07 17:41:15,482 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 17:41:15,492 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: -219, Received: 0, Shipped: 47, Repack: 0, EOD: -266
2025-07-07 17:41:15,496 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: -25, Received: 0, Shipped: 2, Repack: 0, EOD: -27
2025-07-07 17:41:15,499 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: -2, Received: 0, Shipped: 1, Repack: 0, EOD: -3
2025-07-07 17:41:15,504 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: -24, Received: 0, Shipped: 3, Repack: 0, EOD: -27
2025-07-07 17:41:15,509 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 17:41:15,515 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: -266, Received: 0, Shipped: 87, Repack: 0, EOD: -353
2025-07-07 17:41:15,526 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: -27, Received: 0, Shipped: 3, Repack: 0, EOD: -30
2025-07-07 17:41:15,530 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 17:41:15,536 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: -353, Received: 0, Shipped: 67, Repack: 0, EOD: -420
2025-07-07 17:41:15,540 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: -27, Received: 0, Shipped: 1, Repack: 0, EOD: -28
2025-07-07 17:41:15,543 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: -3, Received: 0, Shipped: 1, Repack: 0, EOD: -4
2025-07-07 17:41:15,548 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: -30, Received: 0, Shipped: 3, Repack: 0, EOD: -33
2025-07-07 17:41:15,551 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 17:41:15,555 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: -420, Received: 0, Shipped: 234, Repack: 0, EOD: -654
2025-07-07 17:41:15,559 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: -28, Received: 0, Shipped: 14, Repack: 0, EOD: -42
2025-07-07 17:41:15,563 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: -33, Received: 0, Shipped: 11, Repack: 0, EOD: -44
2025-07-07 17:41:15,568 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 17:41:15,574 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: -654, Received: 0, Shipped: 83, Repack: 0, EOD: -737
2025-07-07 17:41:15,578 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: -42, Received: 0, Shipped: 1, Repack: 0, EOD: -43
2025-07-07 17:41:15,586 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: -44, Received: 0, Shipped: 12, Repack: 0, EOD: -56
2025-07-07 17:41:15,613 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 17:41:15,618 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: -737, Received: 0, Shipped: 164, Repack: 0, EOD: -901
2025-07-07 17:41:15,621 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: -43, Received: 0, Shipped: 2, Repack: 0, EOD: -45
2025-07-07 17:41:15,627 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: -4, Received: 0, Shipped: 3, Repack: 0, EOD: -7
2025-07-07 17:41:15,631 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: -56, Received: 0, Shipped: 3, Repack: 0, EOD: -59
2025-07-07 17:41:15,634 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 17:41:15,643 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: -901, Received: 0, Shipped: 56, Repack: 0, EOD: -957
2025-07-07 17:41:15,645 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: -45, Received: 0, Shipped: 1, Repack: 0, EOD: -46
2025-07-07 17:41:15,648 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: -7, Received: 0, Shipped: 12, Repack: 0, EOD: -19
2025-07-07 17:41:15,652 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: -59, Received: 0, Shipped: 11, Repack: 0, EOD: -70
2025-07-07 17:41:15,657 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 17:41:15,664 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -957, Received: 576, Shipped: 57, Repack: 0, EOD: -438
2025-07-07 17:41:15,668 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: -46, Received: 0, Shipped: 1, Repack: 0, EOD: -47
2025-07-07 17:41:15,678 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: -70, Received: 0, Shipped: 1, Repack: 0, EOD: -71
2025-07-07 17:41:15,684 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 17:41:15,689 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: -438, Received: 0, Shipped: 47, Repack: 0, EOD: -485
2025-07-07 17:41:15,693 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: -47, Received: 0, Shipped: 2, Repack: 0, EOD: -49
2025-07-07 17:41:15,697 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: -71, Received: 0, Shipped: 7, Repack: 0, EOD: -78
2025-07-07 17:41:15,700 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 17:41:15,710 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: -485, Received: 0, Shipped: 76, Repack: 0, EOD: -561
2025-07-07 17:41:15,713 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: -49, Received: 0, Shipped: 1, Repack: 0, EOD: -50
2025-07-07 17:41:15,716 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: -19, Received: 0, Shipped: 1, Repack: 0, EOD: -20
2025-07-07 17:41:15,719 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: -78, Received: 0, Shipped: 5, Repack: 0, EOD: -83
2025-07-07 17:41:15,748 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 17:41:15,753 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: -561, Received: 376, Shipped: 21, Repack: 0, EOD: -206
2025-07-07 17:41:15,755 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: -50, Received: 0, Shipped: 6, Repack: 0, EOD: -56
2025-07-07 17:41:15,765 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 17:41:15,770 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: -206, Received: 0, Shipped: 42, Repack: 0, EOD: -248
2025-07-07 17:41:15,773 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: -56, Received: 0, Shipped: 1, Repack: 0, EOD: -57
2025-07-07 17:41:15,780 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: -83, Received: 0, Shipped: 1, Repack: 0, EOD: -84
2025-07-07 17:41:15,784 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 17:41:15,789 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: -248, Received: 0, Shipped: 173, Repack: 0, EOD: -421
2025-07-07 17:41:15,794 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: -57, Received: 0, Shipped: 1, Repack: 0, EOD: -58
2025-07-07 17:41:15,798 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: -84, Received: 0, Shipped: 4, Repack: 0, EOD: -88
2025-07-07 17:41:15,801 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 17:41:15,805 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: -421, Received: 0, Shipped: 60, Repack: 0, EOD: -481
2025-07-07 17:41:15,811 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: -58, Received: 0, Shipped: 2, Repack: 0, EOD: -60
2025-07-07 17:41:15,816 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: -88, Received: 0, Shipped: 9, Repack: 0, EOD: -97
2025-07-07 17:41:15,819 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 17:41:15,826 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: -481, Received: 0, Shipped: 51, Repack: 0, EOD: -532
2025-07-07 17:41:15,830 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: -60, Received: 0, Shipped: 3, Repack: 0, EOD: -63
2025-07-07 17:41:15,837 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: -97, Received: 0, Shipped: 6, Repack: 0, EOD: -103
2025-07-07 17:41:15,866 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 17:41:15,870 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: -532, Received: 0, Shipped: 84, Repack: 0, EOD: -616
2025-07-07 17:41:15,872 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: -63, Received: 0, Shipped: 3, Repack: 0, EOD: -66
2025-07-07 17:41:15,878 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: -103, Received: 0, Shipped: 1, Repack: 0, EOD: -104
2025-07-07 17:41:15,883 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17904            115            115
1  2025-06-01  17612            425            425
2  2025-06-01  17612              0              0
3  2025-06-01  17904              0              0
4  2025-06-01  18675              0              0
2025-07-07 17:41:15,885 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17904            -63            -66
236  2025-06-30  18675            -20            -20
237  2025-06-30  18675            749            749
238  2025-06-30  17914           -103           -104
239  2025-06-30  17914            223            223
2025-07-07 17:41:15,886 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:41:15,886 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 17:41:15,888 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17904            115            115
1  2025-06-01  17612            425            425
2  2025-06-01  17612              0              0
3  2025-06-01  17904              0              0
4  2025-06-01  18675              0              0
2025-07-07 17:41:15,892 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17904            -63            -66
236  2025-06-30  18675            -20            -20
237  2025-06-30  18675            749            749
238  2025-06-30  17914           -103           -104
239  2025-06-30  17914            223            223
2025-07-07 17:41:15,894 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 17:41:15,897 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     122.387500
std      343.684192
min     -957.000000
25%      -45.250000
50%      115.000000
75%      273.500000
max      749.000000
2025-07-07 17:41:15,902 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01            425
9    2025-06-02            425
17   2025-06-03            425
25   2025-06-04            425
33   2025-06-05            425
41   2025-06-06            425
49   2025-06-07            425
57   2025-06-08            425
65   2025-06-09            425
73   2025-06-10            425
81   2025-06-11            425
89   2025-06-12            425
97   2025-06-13            425
105  2025-06-14            425
113  2025-06-15            425
121  2025-06-16            425
129  2025-06-17            425
137  2025-06-18            425
145  2025-06-19            425
153  2025-06-20            425
161  2025-06-21            425
169  2025-06-22            425
177  2025-06-23            425
185  2025-06-24            425
193  2025-06-25            425
201  2025-06-26            425
209  2025-06-27            425
217  2025-06-28            425
225  2025-06-29            425
233  2025-06-30            425
2025-07-07 17:41:15,909 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
0    2025-06-01            115
8    2025-06-02            115
16   2025-06-03            115
24   2025-06-04            115
32   2025-06-05            115
40   2025-06-06            115
48   2025-06-07            115
56   2025-06-08            115
64   2025-06-09            115
72   2025-06-10            115
80   2025-06-11            115
88   2025-06-12            115
96   2025-06-13            115
104  2025-06-14            115
112  2025-06-15            115
120  2025-06-16            115
128  2025-06-17            115
136  2025-06-18            115
144  2025-06-19            115
152  2025-06-20            115
160  2025-06-21            115
168  2025-06-22            115
176  2025-06-23            115
184  2025-06-24            115
192  2025-06-25            115
200  2025-06-26            115
208  2025-06-27            115
216  2025-06-28            115
224  2025-06-29            115
232  2025-06-30            115
2025-07-07 17:41:15,920 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 17:41:15,924 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       3.750000
std        5.460011
min        0.000000
25%        0.000000
50%        1.000000
75%        4.500000
max       16.000000
2025-07-07 17:41:15,931 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01            9
9    2025-06-02            9
17   2025-06-03            9
25   2025-06-04            9
33   2025-06-05            9
41   2025-06-06            9
49   2025-06-07            9
57   2025-06-08            9
65   2025-06-09            9
73   2025-06-10            9
81   2025-06-11            9
89   2025-06-12            9
97   2025-06-13            9
105  2025-06-14            9
113  2025-06-15            9
121  2025-06-16            9
129  2025-06-17            9
137  2025-06-18            9
145  2025-06-19            9
153  2025-06-20            9
161  2025-06-21            9
169  2025-06-22            9
177  2025-06-23            9
185  2025-06-24            9
193  2025-06-25            9
201  2025-06-26            9
209  2025-06-27            9
217  2025-06-28            9
225  2025-06-29            9
233  2025-06-30            9
2025-07-07 17:41:15,933 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    30
2025-06-02    30
2025-06-03    30
2025-06-04    30
2025-06-05    30
2025-07-07 17:41:15,934 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    30
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    30
2025-07-07 17:41:15,935 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 17:41:15,935 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 17:41:15,938 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 17:41:15,941 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    13.5
2025-06-02    13.5
2025-06-03    13.5
2025-06-04    13.5
2025-06-05    13.5
2025-07-07 17:41:15,944 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.5
2025-06-27    13.5
2025-06-28    13.5
2025-06-29    13.5
2025-06-30    13.5
2025-07-07 17:41:15,957 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 17:41:15,959 - __main__ - CRITICAL - A critical error occurred during script execution: 'NoneType' object has no attribute 'rename'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 123, in <module>
    main()
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 83, in main
    final_monthly_df = pd.concat([monthly_report_df, monthly_totals_df.rename(index={0: 'Monthly Totals'})])
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rename'
2025-07-07 17:42:33,288 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:42:33,291 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:42:33,876 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:42:33,878 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:42:33,878 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:42:33,878 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:42:33,917 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:42:34,197 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:42:34,198 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:42:34,198 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:42:34,199 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:42:34,227 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:42:34,414 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:42:34,418 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:42:34,876 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:42:34,994 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:42:34,995 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:42:35,123 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:42:35,131 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:42:35,147 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:42:35,147 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:42:35,149 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:42:35,359 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:42:35,361 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:42:35,362 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:42:35,362 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:42:35,384 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:42:35,527 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:42:35,528 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:42:35,723 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:42:35,839 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:42:35,841 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:42:35,974 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:42:35,980 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:42:35,981 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:42:35,981 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:42:35,983 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:42:36,202 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:42:36,204 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:42:36,204 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:42:36,205 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:42:36,228 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:42:36,395 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:42:36,397 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:42:36,592 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:42:36,704 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:42:36,706 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:42:36,839 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:42:36,845 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:42:36,853 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:42:36,870 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:42:36,870 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:42:36,872 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:42:37,066 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:42:37,068 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:42:37,069 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:42:37,070 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:42:37,094 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:42:37,251 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:42:37,253 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:42:37,457 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:42:37,570 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:42:37,571 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:42:37,715 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:42:37,718 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:42:37,721 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:42:37,722 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:42:37,725 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:42:37,952 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:42:37,954 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:42:37,954 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:42:37,954 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:42:37,979 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:42:38,138 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:42:38,141 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:42:38,324 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:42:38,444 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:42:38,445 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:42:38,575 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:42:38,577 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:42:38,586 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:42:38,591 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:42:38,592 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:42:38,594 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:42:38,596 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:42:38,597 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:42:38,598 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:42:38,611 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:42:38,613 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:42:38,613 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:42:38,614 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:42:38,615 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:42:38,616 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:42:38,618 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 17:42:38,618 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 425), ('17904', 115), ('17914', 223), ('18675', 749)]...
2025-07-07 17:42:38,619 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 17:42:38,620 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 17:42:38,620 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 17:42:38,621 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 17:42:38,628 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 17:42:38,631 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 0, Received: 0, Shipped: 71, Repack: 0, EOD: -71
2025-07-07 17:42:38,632 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 0, Received: 0, Shipped: 2, Repack: 0, EOD: -2
2025-07-07 17:42:38,633 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 0, Received: 0, Shipped: 1, Repack: 0, EOD: -1
2025-07-07 17:42:38,635 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 0, Received: 0, Shipped: 3, Repack: 0, EOD: -3
2025-07-07 17:42:38,636 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 17:42:38,640 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: -71, Received: 0, Shipped: 94, Repack: 0, EOD: -165
2025-07-07 17:42:38,643 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: -2, Received: 0, Shipped: 13, Repack: 0, EOD: -15
2025-07-07 17:42:38,645 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: -3, Received: 0, Shipped: 6, Repack: 0, EOD: -9
2025-07-07 17:42:38,646 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 17:42:38,648 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: -165, Received: 478, Shipped: 119, Repack: 0, EOD: 194
2025-07-07 17:42:38,650 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: -15, Received: 0, Shipped: 7, Repack: 0, EOD: -22
2025-07-07 17:42:38,652 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: -9, Received: 0, Shipped: 7, Repack: 0, EOD: -16
2025-07-07 17:42:38,653 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 17:42:38,655 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 194, Received: 0, Shipped: 296, Repack: 0, EOD: -102
2025-07-07 17:42:38,657 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: -22, Received: 0, Shipped: 1, Repack: 0, EOD: -23
2025-07-07 17:42:38,661 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: -16, Received: 0, Shipped: 7, Repack: 0, EOD: -23
2025-07-07 17:42:38,662 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 17:42:38,664 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: -102, Received: 0, Shipped: 117, Repack: 0, EOD: -219
2025-07-07 17:42:38,666 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: -23, Received: 0, Shipped: 2, Repack: 0, EOD: -25
2025-07-07 17:42:38,667 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: -1, Received: 0, Shipped: 1, Repack: 0, EOD: -2
2025-07-07 17:42:38,668 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: -23, Received: 0, Shipped: 1, Repack: 0, EOD: -24
2025-07-07 17:42:38,679 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 17:42:38,682 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: -219, Received: 0, Shipped: 47, Repack: 0, EOD: -266
2025-07-07 17:42:38,684 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: -25, Received: 0, Shipped: 2, Repack: 0, EOD: -27
2025-07-07 17:42:38,685 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: -2, Received: 0, Shipped: 1, Repack: 0, EOD: -3
2025-07-07 17:42:38,688 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: -24, Received: 0, Shipped: 3, Repack: 0, EOD: -27
2025-07-07 17:42:38,689 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 17:42:38,692 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: -266, Received: 0, Shipped: 87, Repack: 0, EOD: -353
2025-07-07 17:42:38,696 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: -27, Received: 0, Shipped: 3, Repack: 0, EOD: -30
2025-07-07 17:42:38,697 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 17:42:38,699 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: -353, Received: 0, Shipped: 67, Repack: 0, EOD: -420
2025-07-07 17:42:38,701 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: -27, Received: 0, Shipped: 1, Repack: 0, EOD: -28
2025-07-07 17:42:38,702 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: -3, Received: 0, Shipped: 1, Repack: 0, EOD: -4
2025-07-07 17:42:38,705 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: -30, Received: 0, Shipped: 3, Repack: 0, EOD: -33
2025-07-07 17:42:38,706 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 17:42:38,709 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: -420, Received: 0, Shipped: 234, Repack: 0, EOD: -654
2025-07-07 17:42:38,711 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: -28, Received: 0, Shipped: 14, Repack: 0, EOD: -42
2025-07-07 17:42:38,713 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: -33, Received: 0, Shipped: 11, Repack: 0, EOD: -44
2025-07-07 17:42:38,714 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 17:42:38,716 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: -654, Received: 0, Shipped: 83, Repack: 0, EOD: -737
2025-07-07 17:42:38,717 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: -42, Received: 0, Shipped: 1, Repack: 0, EOD: -43
2025-07-07 17:42:38,719 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: -44, Received: 0, Shipped: 12, Repack: 0, EOD: -56
2025-07-07 17:42:38,733 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 17:42:38,736 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: -737, Received: 0, Shipped: 164, Repack: 0, EOD: -901
2025-07-07 17:42:38,737 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: -43, Received: 0, Shipped: 2, Repack: 0, EOD: -45
2025-07-07 17:42:38,738 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: -4, Received: 0, Shipped: 3, Repack: 0, EOD: -7
2025-07-07 17:42:38,743 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: -56, Received: 0, Shipped: 3, Repack: 0, EOD: -59
2025-07-07 17:42:38,744 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 17:42:38,746 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: -901, Received: 0, Shipped: 56, Repack: 0, EOD: -957
2025-07-07 17:42:38,747 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: -45, Received: 0, Shipped: 1, Repack: 0, EOD: -46
2025-07-07 17:42:38,748 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: -7, Received: 0, Shipped: 12, Repack: 0, EOD: -19
2025-07-07 17:42:38,749 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: -59, Received: 0, Shipped: 11, Repack: 0, EOD: -70
2025-07-07 17:42:38,750 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 17:42:38,752 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -957, Received: 576, Shipped: 57, Repack: 0, EOD: -438
2025-07-07 17:42:38,753 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: -46, Received: 0, Shipped: 1, Repack: 0, EOD: -47
2025-07-07 17:42:38,755 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: -70, Received: 0, Shipped: 1, Repack: 0, EOD: -71
2025-07-07 17:42:38,757 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 17:42:38,760 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: -438, Received: 0, Shipped: 47, Repack: 0, EOD: -485
2025-07-07 17:42:38,761 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: -47, Received: 0, Shipped: 2, Repack: 0, EOD: -49
2025-07-07 17:42:38,763 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: -71, Received: 0, Shipped: 7, Repack: 0, EOD: -78
2025-07-07 17:42:38,764 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 17:42:38,766 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: -485, Received: 0, Shipped: 76, Repack: 0, EOD: -561
2025-07-07 17:42:38,767 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: -49, Received: 0, Shipped: 1, Repack: 0, EOD: -50
2025-07-07 17:42:38,768 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: -19, Received: 0, Shipped: 1, Repack: 0, EOD: -20
2025-07-07 17:42:38,770 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: -78, Received: 0, Shipped: 5, Repack: 0, EOD: -83
2025-07-07 17:42:38,781 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 17:42:38,784 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: -561, Received: 376, Shipped: 21, Repack: 0, EOD: -206
2025-07-07 17:42:38,785 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: -50, Received: 0, Shipped: 6, Repack: 0, EOD: -56
2025-07-07 17:42:38,790 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 17:42:38,793 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: -206, Received: 0, Shipped: 42, Repack: 0, EOD: -248
2025-07-07 17:42:38,794 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: -56, Received: 0, Shipped: 1, Repack: 0, EOD: -57
2025-07-07 17:42:38,798 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: -83, Received: 0, Shipped: 1, Repack: 0, EOD: -84
2025-07-07 17:42:38,799 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 17:42:38,801 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: -248, Received: 0, Shipped: 173, Repack: 0, EOD: -421
2025-07-07 17:42:38,802 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: -57, Received: 0, Shipped: 1, Repack: 0, EOD: -58
2025-07-07 17:42:38,804 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: -84, Received: 0, Shipped: 4, Repack: 0, EOD: -88
2025-07-07 17:42:38,805 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 17:42:38,808 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: -421, Received: 0, Shipped: 60, Repack: 0, EOD: -481
2025-07-07 17:42:38,810 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: -58, Received: 0, Shipped: 2, Repack: 0, EOD: -60
2025-07-07 17:42:38,812 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: -88, Received: 0, Shipped: 9, Repack: 0, EOD: -97
2025-07-07 17:42:38,813 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 17:42:38,815 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: -481, Received: 0, Shipped: 51, Repack: 0, EOD: -532
2025-07-07 17:42:38,816 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: -60, Received: 0, Shipped: 3, Repack: 0, EOD: -63
2025-07-07 17:42:38,818 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: -97, Received: 0, Shipped: 6, Repack: 0, EOD: -103
2025-07-07 17:42:38,829 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 17:42:38,832 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: -532, Received: 0, Shipped: 84, Repack: 0, EOD: -616
2025-07-07 17:42:38,833 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: -63, Received: 0, Shipped: 3, Repack: 0, EOD: -66
2025-07-07 17:42:38,836 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: -103, Received: 0, Shipped: 1, Repack: 0, EOD: -104
2025-07-07 17:42:38,842 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914            223            223
1  2025-06-01  17612            425            425
2  2025-06-01  17612              0              0
3  2025-06-01  17904              0              0
4  2025-06-01  18675              0              0
2025-07-07 17:42:38,843 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17904            -63            -66
236  2025-06-30  18675            -20            -20
237  2025-06-30  18675            749            749
238  2025-06-30  17904            115            115
239  2025-06-30  17914           -103           -104
2025-07-07 17:42:38,844 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:42:38,844 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 17:42:38,846 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914            223            223
1  2025-06-01  17612            425            425
2  2025-06-01  17612              0              0
3  2025-06-01  17904              0              0
4  2025-06-01  18675              0              0
2025-07-07 17:42:38,846 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17904            -63            -66
236  2025-06-30  18675            -20            -20
237  2025-06-30  18675            749            749
238  2025-06-30  17904            115            115
239  2025-06-30  17914           -103           -104
2025-07-07 17:42:38,847 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 17:42:38,851 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     122.387500
std      343.684192
min     -957.000000
25%      -45.250000
50%      115.000000
75%      273.500000
max      749.000000
2025-07-07 17:42:38,853 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01            425
9    2025-06-02            425
17   2025-06-03            425
25   2025-06-04            425
33   2025-06-05            425
41   2025-06-06            425
49   2025-06-07            425
57   2025-06-08            425
65   2025-06-09            425
73   2025-06-10            425
81   2025-06-11            425
89   2025-06-12            425
97   2025-06-13            425
105  2025-06-14            425
113  2025-06-15            425
121  2025-06-16            425
129  2025-06-17            425
137  2025-06-18            425
145  2025-06-19            425
153  2025-06-20            425
161  2025-06-21            425
169  2025-06-22            425
177  2025-06-23            425
185  2025-06-24            425
193  2025-06-25            425
201  2025-06-26            425
209  2025-06-27            425
217  2025-06-28            425
225  2025-06-29            425
233  2025-06-30            425
2025-07-07 17:42:38,854 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
6    2025-06-01            115
14   2025-06-02            115
22   2025-06-03            115
30   2025-06-04            115
38   2025-06-05            115
46   2025-06-06            115
54   2025-06-07            115
62   2025-06-08            115
70   2025-06-09            115
78   2025-06-10            115
86   2025-06-11            115
94   2025-06-12            115
102  2025-06-13            115
110  2025-06-14            115
118  2025-06-15            115
126  2025-06-16            115
134  2025-06-17            115
142  2025-06-18            115
150  2025-06-19            115
158  2025-06-20            115
166  2025-06-21            115
174  2025-06-22            115
182  2025-06-23            115
190  2025-06-24            115
198  2025-06-25            115
206  2025-06-26            115
214  2025-06-27            115
222  2025-06-28            115
230  2025-06-29            115
238  2025-06-30            115
2025-07-07 17:42:38,867 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 17:42:38,869 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       3.750000
std        5.460011
min        0.000000
25%        0.000000
50%        1.000000
75%        4.500000
max       16.000000
2025-07-07 17:42:38,870 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01            9
9    2025-06-02            9
17   2025-06-03            9
25   2025-06-04            9
33   2025-06-05            9
41   2025-06-06            9
49   2025-06-07            9
57   2025-06-08            9
65   2025-06-09            9
73   2025-06-10            9
81   2025-06-11            9
89   2025-06-12            9
97   2025-06-13            9
105  2025-06-14            9
113  2025-06-15            9
121  2025-06-16            9
129  2025-06-17            9
137  2025-06-18            9
145  2025-06-19            9
153  2025-06-20            9
161  2025-06-21            9
169  2025-06-22            9
177  2025-06-23            9
185  2025-06-24            9
193  2025-06-25            9
201  2025-06-26            9
209  2025-06-27            9
217  2025-06-28            9
225  2025-06-29            9
233  2025-06-30            9
2025-07-07 17:42:38,872 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    30
2025-06-02    30
2025-06-03    30
2025-06-04    30
2025-06-05    30
2025-07-07 17:42:38,873 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    30
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    30
2025-07-07 17:42:38,874 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 17:42:38,875 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 17:42:38,878 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 17:42:38,880 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    13.5
2025-06-02    13.5
2025-06-03    13.5
2025-06-04    13.5
2025-06-05    13.5
2025-07-07 17:42:38,881 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.5
2025-06-27    13.5
2025-06-28    13.5
2025-06-29    13.5
2025-06-30    13.5
2025-07-07 17:42:38,893 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 17:42:38,893 - __main__ - CRITICAL - A critical error occurred during script execution: 'NoneType' object has no attribute 'rename'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 123, in <module>
    main()
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 83, in main
    final_monthly_df = pd.concat([monthly_report_df, monthly_totals_df.rename(index={0: 'Monthly Totals'})])
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rename'
2025-07-07 17:42:58,631 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:42:58,631 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:42:59,030 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:42:59,030 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:42:59,031 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:42:59,031 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:42:59,044 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:42:59,253 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:42:59,255 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:42:59,255 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:42:59,256 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:42:59,295 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:42:59,461 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:42:59,463 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:42:59,702 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:42:59,820 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:42:59,822 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:42:59,989 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:42:59,991 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:42:59,994 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:42:59,994 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:42:59,996 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:43:00,228 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:43:00,230 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:43:00,230 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:43:00,230 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:43:00,253 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:43:00,421 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:43:00,426 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:43:00,620 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:43:00,738 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:43:00,740 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:43:00,859 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:43:00,860 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:43:00,861 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:43:00,861 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:43:00,864 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:43:01,073 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:43:01,075 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:43:01,075 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:43:01,076 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:43:01,099 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:43:01,249 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:43:01,250 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:43:01,439 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:43:01,549 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:43:01,550 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:43:01,704 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:43:01,712 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:43:01,716 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:43:01,726 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:43:01,727 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:43:01,730 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:43:01,949 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:43:01,950 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:43:01,951 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:43:01,951 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:43:01,982 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:43:02,134 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:43:02,136 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:43:02,331 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:43:02,456 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:43:02,459 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:43:02,593 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:43:02,596 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:43:02,599 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:43:02,600 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:43:02,603 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:43:02,804 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:43:02,806 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:43:02,808 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:43:02,810 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:43:02,835 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:43:02,984 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:43:02,986 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:43:03,171 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:43:03,287 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:43:03,288 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:43:03,423 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:43:03,426 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:43:03,434 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:43:03,438 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:43:03,440 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:43:03,443 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:43:03,448 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:43:03,449 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:43:03,449 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:43:03,454 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:43:03,456 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:43:03,457 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:43:03,458 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:43:03,459 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:43:03,460 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:43:03,464 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 17:43:03,465 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 425), ('17904', 115), ('17914', 223), ('18675', 749)]...
2025-07-07 17:43:03,465 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 17:43:03,465 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 17:43:03,466 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 17:43:03,467 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 17:43:03,473 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 17:43:03,476 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 0, Received: 0, Shipped: 71, Repack: 0, EOD: -71
2025-07-07 17:43:03,478 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 0, Received: 0, Shipped: 2, Repack: 0, EOD: -2
2025-07-07 17:43:03,480 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 0, Received: 0, Shipped: 1, Repack: 0, EOD: -1
2025-07-07 17:43:03,482 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 0, Received: 0, Shipped: 3, Repack: 0, EOD: -3
2025-07-07 17:43:03,483 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 17:43:03,485 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: -71, Received: 0, Shipped: 94, Repack: 0, EOD: -165
2025-07-07 17:43:03,486 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: -2, Received: 0, Shipped: 13, Repack: 0, EOD: -15
2025-07-07 17:43:03,488 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: -3, Received: 0, Shipped: 6, Repack: 0, EOD: -9
2025-07-07 17:43:03,490 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 17:43:03,493 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: -165, Received: 478, Shipped: 119, Repack: 0, EOD: 194
2025-07-07 17:43:03,495 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: -15, Received: 0, Shipped: 7, Repack: 0, EOD: -22
2025-07-07 17:43:03,497 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: -9, Received: 0, Shipped: 7, Repack: 0, EOD: -16
2025-07-07 17:43:03,498 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 17:43:03,500 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 194, Received: 0, Shipped: 296, Repack: 0, EOD: -102
2025-07-07 17:43:03,501 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: -22, Received: 0, Shipped: 1, Repack: 0, EOD: -23
2025-07-07 17:43:03,504 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: -16, Received: 0, Shipped: 7, Repack: 0, EOD: -23
2025-07-07 17:43:03,505 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 17:43:03,508 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: -102, Received: 0, Shipped: 117, Repack: 0, EOD: -219
2025-07-07 17:43:03,509 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: -23, Received: 0, Shipped: 2, Repack: 0, EOD: -25
2025-07-07 17:43:03,511 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: -1, Received: 0, Shipped: 1, Repack: 0, EOD: -2
2025-07-07 17:43:03,513 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: -23, Received: 0, Shipped: 1, Repack: 0, EOD: -24
2025-07-07 17:43:03,523 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 17:43:03,526 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: -219, Received: 0, Shipped: 47, Repack: 0, EOD: -266
2025-07-07 17:43:03,527 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: -25, Received: 0, Shipped: 2, Repack: 0, EOD: -27
2025-07-07 17:43:03,529 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: -2, Received: 0, Shipped: 1, Repack: 0, EOD: -3
2025-07-07 17:43:03,531 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: -24, Received: 0, Shipped: 3, Repack: 0, EOD: -27
2025-07-07 17:43:03,532 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 17:43:03,534 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: -266, Received: 0, Shipped: 87, Repack: 0, EOD: -353
2025-07-07 17:43:03,537 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: -27, Received: 0, Shipped: 3, Repack: 0, EOD: -30
2025-07-07 17:43:03,538 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 17:43:03,541 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: -353, Received: 0, Shipped: 67, Repack: 0, EOD: -420
2025-07-07 17:43:03,542 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: -27, Received: 0, Shipped: 1, Repack: 0, EOD: -28
2025-07-07 17:43:03,544 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: -3, Received: 0, Shipped: 1, Repack: 0, EOD: -4
2025-07-07 17:43:03,546 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: -30, Received: 0, Shipped: 3, Repack: 0, EOD: -33
2025-07-07 17:43:03,547 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 17:43:03,549 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: -420, Received: 0, Shipped: 234, Repack: 0, EOD: -654
2025-07-07 17:43:03,550 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: -28, Received: 0, Shipped: 14, Repack: 0, EOD: -42
2025-07-07 17:43:03,552 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: -33, Received: 0, Shipped: 11, Repack: 0, EOD: -44
2025-07-07 17:43:03,554 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 17:43:03,557 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: -654, Received: 0, Shipped: 83, Repack: 0, EOD: -737
2025-07-07 17:43:03,559 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: -42, Received: 0, Shipped: 1, Repack: 0, EOD: -43
2025-07-07 17:43:03,561 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: -44, Received: 0, Shipped: 12, Repack: 0, EOD: -56
2025-07-07 17:43:03,573 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 17:43:03,576 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: -737, Received: 0, Shipped: 164, Repack: 0, EOD: -901
2025-07-07 17:43:03,579 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: -43, Received: 0, Shipped: 2, Repack: 0, EOD: -45
2025-07-07 17:43:03,580 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: -4, Received: 0, Shipped: 3, Repack: 0, EOD: -7
2025-07-07 17:43:03,582 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: -56, Received: 0, Shipped: 3, Repack: 0, EOD: -59
2025-07-07 17:43:03,584 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 17:43:03,586 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: -901, Received: 0, Shipped: 56, Repack: 0, EOD: -957
2025-07-07 17:43:03,588 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: -45, Received: 0, Shipped: 1, Repack: 0, EOD: -46
2025-07-07 17:43:03,590 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: -7, Received: 0, Shipped: 12, Repack: 0, EOD: -19
2025-07-07 17:43:03,593 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: -59, Received: 0, Shipped: 11, Repack: 0, EOD: -70
2025-07-07 17:43:03,594 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 17:43:03,597 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -957, Received: 576, Shipped: 57, Repack: 0, EOD: -438
2025-07-07 17:43:03,598 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: -46, Received: 0, Shipped: 1, Repack: 0, EOD: -47
2025-07-07 17:43:03,601 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: -70, Received: 0, Shipped: 1, Repack: 0, EOD: -71
2025-07-07 17:43:03,603 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 17:43:03,606 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: -438, Received: 0, Shipped: 47, Repack: 0, EOD: -485
2025-07-07 17:43:03,607 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: -47, Received: 0, Shipped: 2, Repack: 0, EOD: -49
2025-07-07 17:43:03,609 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: -71, Received: 0, Shipped: 7, Repack: 0, EOD: -78
2025-07-07 17:43:03,611 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 17:43:03,615 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: -485, Received: 0, Shipped: 76, Repack: 0, EOD: -561
2025-07-07 17:43:03,616 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: -49, Received: 0, Shipped: 1, Repack: 0, EOD: -50
2025-07-07 17:43:03,617 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: -19, Received: 0, Shipped: 1, Repack: 0, EOD: -20
2025-07-07 17:43:03,619 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: -78, Received: 0, Shipped: 5, Repack: 0, EOD: -83
2025-07-07 17:43:03,632 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 17:43:03,635 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: -561, Received: 376, Shipped: 21, Repack: 0, EOD: -206
2025-07-07 17:43:03,636 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: -50, Received: 0, Shipped: 6, Repack: 0, EOD: -56
2025-07-07 17:43:03,640 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 17:43:03,645 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: -206, Received: 0, Shipped: 42, Repack: 0, EOD: -248
2025-07-07 17:43:03,647 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: -56, Received: 0, Shipped: 1, Repack: 0, EOD: -57
2025-07-07 17:43:03,649 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: -83, Received: 0, Shipped: 1, Repack: 0, EOD: -84
2025-07-07 17:43:03,651 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 17:43:03,654 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: -248, Received: 0, Shipped: 173, Repack: 0, EOD: -421
2025-07-07 17:43:03,655 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: -57, Received: 0, Shipped: 1, Repack: 0, EOD: -58
2025-07-07 17:43:03,659 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: -84, Received: 0, Shipped: 4, Repack: 0, EOD: -88
2025-07-07 17:43:03,663 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 17:43:03,666 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: -421, Received: 0, Shipped: 60, Repack: 0, EOD: -481
2025-07-07 17:43:03,667 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: -58, Received: 0, Shipped: 2, Repack: 0, EOD: -60
2025-07-07 17:43:03,670 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: -88, Received: 0, Shipped: 9, Repack: 0, EOD: -97
2025-07-07 17:43:03,672 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 17:43:03,678 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: -481, Received: 0, Shipped: 51, Repack: 0, EOD: -532
2025-07-07 17:43:03,680 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: -60, Received: 0, Shipped: 3, Repack: 0, EOD: -63
2025-07-07 17:43:03,682 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: -97, Received: 0, Shipped: 6, Repack: 0, EOD: -103
2025-07-07 17:43:03,701 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 17:43:03,704 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: -532, Received: 0, Shipped: 84, Repack: 0, EOD: -616
2025-07-07 17:43:03,708 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: -63, Received: 0, Shipped: 3, Repack: 0, EOD: -66
2025-07-07 17:43:03,712 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: -103, Received: 0, Shipped: 1, Repack: 0, EOD: -104
2025-07-07 17:43:03,715 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17904            115            115
1  2025-06-01  17612            425            425
2  2025-06-01  17612              0              0
3  2025-06-01  17904              0              0
4  2025-06-01  18675              0              0
2025-07-07 17:43:03,717 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17904            -63            -66
236  2025-06-30  18675            -20            -20
237  2025-06-30  18675            749            749
238  2025-06-30  17914           -103           -104
239  2025-06-30  17914            223            223
2025-07-07 17:43:03,717 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:43:03,718 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 17:43:03,719 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17904            115            115
1  2025-06-01  17612            425            425
2  2025-06-01  17612              0              0
3  2025-06-01  17904              0              0
4  2025-06-01  18675              0              0
2025-07-07 17:43:03,721 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17904            -63            -66
236  2025-06-30  18675            -20            -20
237  2025-06-30  18675            749            749
238  2025-06-30  17914           -103           -104
239  2025-06-30  17914            223            223
2025-07-07 17:43:03,721 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 17:43:03,726 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     122.387500
std      343.684192
min     -957.000000
25%      -45.250000
50%      115.000000
75%      273.500000
max      749.000000
2025-07-07 17:43:03,731 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01            425
9    2025-06-02            425
17   2025-06-03            425
25   2025-06-04            425
33   2025-06-05            425
41   2025-06-06            425
49   2025-06-07            425
57   2025-06-08            425
65   2025-06-09            425
73   2025-06-10            425
81   2025-06-11            425
89   2025-06-12            425
97   2025-06-13            425
105  2025-06-14            425
113  2025-06-15            425
121  2025-06-16            425
129  2025-06-17            425
137  2025-06-18            425
145  2025-06-19            425
153  2025-06-20            425
161  2025-06-21            425
169  2025-06-22            425
177  2025-06-23            425
185  2025-06-24            425
193  2025-06-25            425
201  2025-06-26            425
209  2025-06-27            425
217  2025-06-28            425
225  2025-06-29            425
233  2025-06-30            425
2025-07-07 17:43:03,734 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
0    2025-06-01            115
8    2025-06-02            115
16   2025-06-03            115
24   2025-06-04            115
32   2025-06-05            115
40   2025-06-06            115
48   2025-06-07            115
56   2025-06-08            115
64   2025-06-09            115
72   2025-06-10            115
80   2025-06-11            115
88   2025-06-12            115
96   2025-06-13            115
104  2025-06-14            115
112  2025-06-15            115
120  2025-06-16            115
128  2025-06-17            115
136  2025-06-18            115
144  2025-06-19            115
152  2025-06-20            115
160  2025-06-21            115
168  2025-06-22            115
176  2025-06-23            115
184  2025-06-24            115
192  2025-06-25            115
200  2025-06-26            115
208  2025-06-27            115
216  2025-06-28            115
224  2025-06-29            115
232  2025-06-30            115
2025-07-07 17:43:03,741 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 17:43:03,744 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       3.750000
std        5.460011
min        0.000000
25%        0.000000
50%        1.000000
75%        4.500000
max       16.000000
2025-07-07 17:43:03,747 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01            9
9    2025-06-02            9
17   2025-06-03            9
25   2025-06-04            9
33   2025-06-05            9
41   2025-06-06            9
49   2025-06-07            9
57   2025-06-08            9
65   2025-06-09            9
73   2025-06-10            9
81   2025-06-11            9
89   2025-06-12            9
97   2025-06-13            9
105  2025-06-14            9
113  2025-06-15            9
121  2025-06-16            9
129  2025-06-17            9
137  2025-06-18            9
145  2025-06-19            9
153  2025-06-20            9
161  2025-06-21            9
169  2025-06-22            9
177  2025-06-23            9
185  2025-06-24            9
193  2025-06-25            9
201  2025-06-26            9
209  2025-06-27            9
217  2025-06-28            9
225  2025-06-29            9
233  2025-06-30            9
2025-07-07 17:43:03,749 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    30
2025-06-02    30
2025-06-03    30
2025-06-04    30
2025-06-05    30
2025-07-07 17:43:03,749 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    30
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    30
2025-07-07 17:43:03,750 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 17:43:03,750 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 17:43:03,752 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 17:43:03,754 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    13.5
2025-06-02    13.5
2025-06-03    13.5
2025-06-04    13.5
2025-06-05    13.5
2025-07-07 17:43:03,755 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.5
2025-06-27    13.5
2025-06-28    13.5
2025-06-29    13.5
2025-06-30    13.5
2025-07-07 17:43:03,766 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 17:43:03,767 - __main__ - CRITICAL - A critical error occurred during script execution: 'NoneType' object has no attribute 'rename'
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 123, in <module>
    main()
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\shipstation_reporter.py", line 83, in main
    final_monthly_df = pd.concat([monthly_report_df, monthly_totals_df.rename(index={0: 'Monthly Totals'})])
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rename'
2025-07-07 17:44:18,669 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:44:18,670 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:44:20,292 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:44:20,293 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:44:20,293 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:44:20,294 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:44:20,314 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:44:20,566 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:44:20,568 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:44:20,569 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:44:20,570 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:44:20,608 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:44:20,773 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:44:20,775 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:44:21,022 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:21,146 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:21,148 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:44:21,278 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:44:21,280 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:44:21,286 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:44:21,287 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:44:21,292 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:44:21,595 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:44:21,598 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:44:21,599 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:44:21,600 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:44:21,661 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:44:21,807 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:44:21,810 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:44:22,004 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:22,119 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:22,167 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:44:22,292 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:44:22,295 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:44:22,297 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:44:22,298 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:44:22,306 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:44:22,519 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:44:22,521 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:44:22,522 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:44:22,523 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:44:22,556 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:44:22,695 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:44:22,700 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:44:22,887 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:23,004 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:23,006 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:44:23,131 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:44:23,142 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:44:23,147 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:44:23,154 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:44:23,156 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:44:23,160 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:44:23,543 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:44:23,547 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:44:23,548 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:44:23,549 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:44:23,595 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:44:23,736 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:44:23,739 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:44:23,938 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:24,053 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:24,056 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:44:24,180 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:44:24,189 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:44:24,198 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:44:24,200 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:44:24,208 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:44:24,494 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:44:24,513 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:44:24,521 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:44:24,525 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:44:24,594 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:44:24,735 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:44:24,740 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:44:24,943 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:25,060 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:25,061 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:44:25,200 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:44:25,204 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:44:25,229 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:44:25,254 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:44:25,268 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:44:25,314 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:44:25,329 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:44:25,331 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:44:25,332 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:44:25,348 - src.services.reporting_logic.monthly_report_generator - DEBUG - Monthly report date range: 2025-06-01 to 2025-06-30
2025-07-07 17:44:25,354 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:44:25,362 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:44:25,364 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:44:25,372 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:44:25,378 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:44:25,379 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:44:25,382 - src.services.reporting_logic.inventory_calculations - INFO - Calculating daily inventory (BOD/EOD)...
2025-07-07 17:44:25,702 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:44:25,734 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:44:25,735 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:44:25,741 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:44:26,036 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:44:26,040 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:44:26,041 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:44:26,042 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 17:44:26,105 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:44:26,259 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:44:26,273 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:44:26,481 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:26,623 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:26,815 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:44:26,979 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:44:27,007 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 17:44:27,664 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:44:27,666 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 17:44:27,668 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 17:44:27,669 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 17:44:27,678 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:44:27,679 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:44:27,691 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:44:27,984 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:44:27,987 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:44:27,989 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:44:27,990 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:44:28,073 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:44:28,230 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:44:28,233 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:44:28,440 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:28,653 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:28,656 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 17:44:28,800 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 17:44:28,804 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 17:44:28,840 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 17:44:28,957 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 17:44:28,958 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 17:44:28,959 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 17:44:28,962 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 17:44:28,969 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 17:44:28,978 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 17:44:28,984 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 17:44:28,994 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 17:44:28,995 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 17:44:29,007 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:44:29,008 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:44:29,017 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:44:29,336 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:44:29,342 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:44:29,346 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:44:29,348 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 17:44:29,433 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:44:29,570 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:44:29,574 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:44:29,857 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:30,014 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:44:30,167 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:44:30,302 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:44:30,304 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 17:44:30,434 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:44:30,437 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 17:44:30,438 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 17:44:30,443 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 17:44:30,446 - __main__ - INFO - Script finished successfully.
2025-07-07 17:46:36,681 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:46:36,682 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:46:37,168 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:46:37,169 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:46:37,170 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:46:37,170 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:46:37,189 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:46:37,425 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:46:37,427 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:46:37,427 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:46:37,427 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:46:37,460 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:46:37,631 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:46:37,633 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:46:37,874 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:46:37,983 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:46:37,986 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:46:38,122 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:46:38,124 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:48:27,648 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:48:27,648 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:48:27,967 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:48:27,967 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:48:27,967 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:48:27,968 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:48:27,980 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:48:28,242 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:48:28,244 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:48:28,244 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:48:28,245 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:48:28,269 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:48:28,435 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:48:28,437 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:48:28,901 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:48:29,053 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:48:29,057 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:48:29,213 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:48:29,215 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:50:33,687 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:50:33,688 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:50:34,042 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:50:34,042 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:50:34,042 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:50:34,042 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:50:34,052 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:50:34,260 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:50:34,263 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:50:34,264 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:50:34,265 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:50:34,292 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:50:34,462 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:50:34,464 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:50:34,725 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:34,852 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:34,854 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:50:35,001 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:50:35,004 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:50:35,007 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:50:35,008 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:50:35,011 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:50:35,233 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:50:35,237 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:50:35,244 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:50:35,245 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:50:35,270 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:50:35,428 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:50:35,430 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:50:35,629 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:35,754 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:35,756 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:50:35,908 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:50:35,942 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:50:35,968 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:50:35,977 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:50:35,981 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:50:36,203 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:50:36,205 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:50:36,206 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:50:36,206 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:50:36,230 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:50:36,374 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:50:36,376 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:50:36,574 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:36,706 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:36,708 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:50:36,862 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:50:36,869 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:50:36,873 - root - INFO - Using 'Base SKU' column from sheet for SKU identification.
2025-07-07 17:50:36,877 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:50:36,878 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:50:36,880 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:50:37,083 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:50:37,085 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:50:37,085 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:50:37,086 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:50:37,112 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:50:37,253 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:50:37,255 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:50:37,455 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:37,584 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:37,585 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 17:50:37,748 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 17:50:37,751 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 17:50:37,754 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:50:37,754 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:50:37,757 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:50:37,962 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:50:37,963 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:50:37,964 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:50:37,964 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:50:37,986 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:50:38,140 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:50:38,141 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:50:38,328 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:38,442 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:38,442 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:50:38,574 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:50:38,576 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:50:38,582 - __main__ - DEBUG - shipped_items_df head before monthly report: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:50:38,587 - __main__ - DEBUG - shipped_items_df tail before monthly report: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet SKU
732  2025-07-03  17914 - 240286                 1                       
733  2025-07-03  17612 - 250195                 1                       
734  2025-07-03  17612 - 250195                 1                       
735  2025-07-03  17612 - 250195                 3                       
736  2025-07-03  17612 - 250195                 3                       
2025-07-07 17:50:38,589 - __main__ - DEBUG - shipped_items_df dtypes before monthly report: 
Date                  object
SKU_Lot               object
Quantity_Shipped       int64
BaseSKU_from_sheet    object
SKU                   object
dtype: object
2025-07-07 17:50:38,591 - __main__ - DEBUG - shipped_orders_df head before monthly report: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:50:38,595 - __main__ - DEBUG - shipped_orders_df tail before monthly report: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:50:38,596 - __main__ - DEBUG - shipped_orders_df dtypes before monthly report: 
Date           object
OrderNumber     int64
dtype: object
2025-07-07 17:50:38,596 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 17:50:38,601 - src.services.reporting_logic.monthly_report_generator - DEBUG - Monthly report date range: 2025-06-01 to 2025-06-30
2025-07-07 17:50:38,606 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
         Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
0  2025-06-02  17612 - 250101                 1              17612  17612
1  2025-06-02  17612 - 250101                 1              17612  17612
2  2025-06-02  17612 - 250101                 2              17612  17612
3  2025-06-02  17914 - 240286                 2              17914  17914
4  2025-06-02  17612 - 250101                 1              17612  17612
2025-07-07 17:50:38,611 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
           Date         SKU_Lot  Quantity_Shipped BaseSKU_from_sheet    SKU
597  2025-06-30  17612 - 250172                 2              17612  17612
598  2025-06-30  17612 - 250172                 6              17612  17612
599  2025-06-30  17612 - 250172                16              17612  17612
600  2025-06-30  17612 - 250172                 1              17612  17612
601  2025-06-30  17612 - 250172                40              17612  17612
2025-07-07 17:50:38,612 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 5)
2025-07-07 17:50:38,616 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  OrderNumber
0  2025-06-02       660875
1  2025-06-02       660975
2  2025-06-02       661025
3  2025-06-02       660915
4  2025-06-02       660885
2025-07-07 17:50:38,618 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  OrderNumber
597  2025-06-30       666965
598  2025-06-30       666915
599  2025-06-30       666895
600  2025-06-30       666905
601  2025-06-30       666945
2025-07-07 17:50:38,619 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 17:50:38,621 - src.services.reporting_logic.inventory_calculations - INFO - Calculating daily inventory (BOD/EOD)...
2025-07-07 17:50:38,798 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 17:50:38,812 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:50:38,812 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:50:38,815 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:50:39,030 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:50:39,032 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:50:39,032 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:50:39,033 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 17:50:39,055 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:50:39,213 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:50:39,214 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:50:39,406 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:39,545 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:39,708 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:50:39,885 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:50:39,886 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 17:50:40,491 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:50:40,491 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 17:50:40,492 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 17:50:40,492 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 17:50:40,493 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:50:40,493 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:50:40,495 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:50:40,710 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:50:40,711 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:50:40,711 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:50:40,712 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:50:40,734 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:50:40,876 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:50:40,879 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:50:41,087 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:41,207 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:41,209 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 17:50:41,345 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 17:50:41,348 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 17:50:41,354 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 17:50:41,373 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 17:50:41,374 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 17:50:41,375 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 17:50:41,375 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity            object
dtype: object
2025-07-07 17:50:41,378 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 17:50:41,378 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 17:50:41,379 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 17:50:41,381 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 17:50:41,382 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 17:50:41,384 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:50:41,385 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:50:41,387 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:50:41,596 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:50:41,597 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:50:41,598 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:50:41,598 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 17:50:41,623 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:50:41,791 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:50:41,793 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:50:41,989 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:42,169 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:50:42,319 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 17:50:42,473 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 17:50:42,474 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 17:50:42,634 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 17:50:42,635 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 17:50:42,636 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 17:50:42,637 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 17:50:42,637 - __main__ - INFO - Script finished successfully.
2025-07-07 17:53:17,969 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:53:17,969 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:53:18,335 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:53:18,336 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:53:18,336 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:53:18,336 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:53:18,348 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:53:18,563 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:53:18,565 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:53:18,566 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:53:18,566 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:53:18,593 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:53:18,746 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:53:18,749 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:53:19,104 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:53:19,210 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:53:19,211 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:53:19,351 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:53:19,352 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:55:58,985 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:55:58,986 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:55:59,334 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:55:59,335 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:55:59,335 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:55:59,335 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:55:59,346 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:55:59,621 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:55:59,622 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:55:59,623 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:55:59,623 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:55:59,648 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:55:59,810 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:55:59,812 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:56:00,138 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:00,255 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:00,257 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:56:00,383 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:56:00,384 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:56:00,387 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 17:56:00,388 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 17:56:00,388 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:56:00,388 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:56:00,391 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:56:00,607 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:56:00,608 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:56:00,609 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:56:00,609 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:56:00,631 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:56:00,768 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:56:00,769 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:56:00,965 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:01,069 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:01,071 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 17:56:01,237 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 17:56:01,241 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 17:56:01,243 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 132, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 17:56:01,249 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 17:56:01,253 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 17:56:01,253 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:56:01,254 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:56:01,258 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:56:01,470 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:56:01,472 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:56:01,473 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:56:01,473 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:56:01,496 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:56:01,659 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:56:01,661 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:56:01,877 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:01,997 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:01,998 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:56:02,125 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:56:02,127 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:56:02,131 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 17:56:02,131 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 17:56:02,133 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:56:02,133 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:56:02,136 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:56:02,346 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:56:02,348 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:56:02,348 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:56:02,348 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:56:02,372 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:56:02,533 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:56:02,535 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:56:02,718 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:02,828 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:02,829 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:56:02,955 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:56:02,962 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 17:56:50,443 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 17:56:50,444 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 17:56:50,821 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 17:56:50,822 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 17:56:50,822 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:56:50,822 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:56:50,834 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:56:51,058 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:56:51,059 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:56:51,060 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:56:51,060 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:56:51,084 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:56:51,246 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:56:51,249 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:56:51,690 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:51,815 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:51,817 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 17:56:51,945 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 17:56:51,946 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 17:56:51,949 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 17:56:51,950 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 17:56:51,950 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:56:51,950 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:56:51,953 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:56:52,160 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:56:52,162 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:56:52,163 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:56:52,164 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:56:52,186 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:56:52,341 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:56:52,343 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:56:52,517 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:52,635 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:52,637 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 17:56:52,763 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 17:56:52,766 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 17:56:52,767 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 132, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 17:56:52,771 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 17:56:52,774 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 17:56:52,775 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:56:52,775 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:56:52,777 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:56:52,995 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:56:52,997 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:56:52,998 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:56:52,998 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:56:53,021 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:56:53,176 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:56:53,177 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:56:53,362 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:53,466 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:53,468 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 17:56:53,596 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 17:56:53,598 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 17:56:53,602 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 17:56:53,602 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 17:56:53,603 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 17:56:53,604 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 17:56:53,607 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 17:56:53,806 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 17:56:53,809 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 17:56:53,810 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 17:56:53,810 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 17:56:53,836 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 17:56:53,982 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 17:56:53,984 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 17:56:54,193 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:54,304 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 17:56:54,305 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 17:56:54,437 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 17:56:54,444 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 18:07:14,658 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 18:07:14,659 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 18:07:15,083 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 18:07:15,084 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 18:07:15,084 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:07:15,085 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:07:15,097 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:07:15,366 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:07:15,369 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:07:15,370 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:07:15,371 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:07:15,394 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:07:15,581 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:07:15,583 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:07:15,993 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:07:16,101 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:07:16,104 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 18:07:16,245 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 18:07:16,249 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 18:07:16,254 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 18:07:16,255 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 18:07:16,255 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:07:16,256 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:07:16,258 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:07:16,457 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:07:16,458 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:07:16,459 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:07:16,459 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:07:16,482 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:07:16,625 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:07:16,627 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:07:16,812 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:07:16,913 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:07:16,916 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 18:07:17,035 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 18:07:17,037 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 18:07:17,038 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 138, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 18:07:17,041 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 18:07:17,043 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 18:07:17,045 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:07:17,045 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:07:17,047 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:07:17,252 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:07:17,254 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:07:17,254 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:07:17,255 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:07:17,277 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:07:17,426 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:07:17,428 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:07:17,666 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:07:17,778 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:07:17,779 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 18:07:17,898 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 18:07:17,900 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 18:07:17,905 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 18:07:17,905 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 18:07:17,906 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:07:17,907 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:07:17,910 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:07:18,119 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:07:18,121 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:07:18,122 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:07:18,123 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:07:18,145 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:07:18,294 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:07:18,295 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:07:18,480 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:07:18,593 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:07:18,595 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 18:07:18,747 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 18:07:18,754 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 18:16:54,928 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 18:16:54,928 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 18:16:55,279 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 18:16:55,279 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 18:16:55,279 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:16:55,280 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:16:55,291 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:16:55,540 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:16:55,543 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:16:55,544 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:16:55,544 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:16:55,566 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:16:55,728 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:16:56,093 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:16:56,482 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:16:56,594 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:16:56,595 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 18:16:56,745 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 18:16:56,747 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 18:16:56,751 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 18:16:56,752 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 18:16:56,752 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:16:56,752 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:16:56,755 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:16:56,956 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:16:56,958 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:16:56,958 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:16:56,959 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:16:56,981 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:16:57,146 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:16:57,147 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:16:57,333 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:16:57,443 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:16:57,444 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 18:16:57,589 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 18:16:57,592 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 18:16:57,594 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 138, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 18:16:57,597 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 18:16:57,600 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 18:16:57,600 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:16:57,601 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:16:57,605 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:16:57,796 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:16:57,797 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:16:57,798 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:16:57,799 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:16:57,821 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:16:57,966 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:16:57,970 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:16:58,166 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:16:58,278 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:16:58,280 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 18:16:58,414 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 18:16:58,419 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 18:16:58,422 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 18:16:58,423 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 18:16:58,423 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:16:58,424 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:16:58,426 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:16:58,631 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:16:58,633 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:16:58,634 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:16:58,634 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:16:58,657 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:16:58,804 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:16:58,806 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:16:59,006 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:16:59,126 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:16:59,128 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 18:16:59,276 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 18:16:59,281 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 18:16:59,283 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 18:16:59,285 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 18:16:59,285 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:16:59,286 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:16:59,288 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:16:59,484 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:16:59,487 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:16:59,488 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:16:59,488 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:16:59,510 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:16:59,671 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:16:59,673 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:16:59,882 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:17:00,007 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:17:00,010 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 18:17:00,145 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 18:17:00,148 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 18:19:58,020 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 18:19:58,020 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 18:19:58,356 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 18:19:58,356 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 18:19:58,357 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:19:58,357 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:19:58,368 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:19:58,587 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:19:58,589 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:19:58,590 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:19:58,592 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:19:58,623 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:19:58,804 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:19:58,806 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:19:59,157 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:19:59,265 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:19:59,266 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 18:19:59,397 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 18:19:59,398 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 18:19:59,400 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 18:19:59,402 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 18:19:59,403 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:19:59,403 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:19:59,406 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:19:59,630 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:19:59,634 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:19:59,634 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:19:59,634 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:19:59,658 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:19:59,819 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:19:59,821 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:20:00,136 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:20:00,250 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:20:00,253 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 18:20:00,390 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 18:20:00,393 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 18:20:00,395 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 138, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 18:20:00,398 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 18:20:00,401 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 18:20:00,401 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:20:00,402 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:20:00,404 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:20:00,610 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:20:00,613 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:20:00,614 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:20:00,614 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:20:00,635 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:20:00,797 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:20:00,799 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:20:00,995 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:20:01,115 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:20:01,116 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 18:20:01,259 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 18:20:01,261 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 18:20:01,264 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 18:20:01,264 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 18:20:01,264 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:20:01,265 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:20:01,267 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:20:01,476 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:20:01,478 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:20:01,479 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:20:01,479 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:20:01,504 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:20:01,654 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:20:01,655 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:20:01,860 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:20:01,979 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:20:01,980 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 18:20:02,115 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 18:20:02,125 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 18:20:02,127 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 18:20:02,128 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 18:20:02,128 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:20:02,129 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:20:02,132 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:20:02,358 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:20:02,361 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:20:02,361 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:20:02,362 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:20:02,385 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:20:02,550 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:20:02,551 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:20:02,732 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:20:02,851 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:20:02,853 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 18:20:02,974 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 18:20:02,979 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 18:21:23,967 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 18:21:23,968 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 18:21:24,289 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 18:21:24,289 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 18:21:24,289 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:21:24,290 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:21:24,301 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:21:24,504 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:21:24,505 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:21:24,505 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:21:24,505 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:21:24,544 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:21:24,703 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:21:24,705 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:21:24,923 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:21:25,032 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:21:25,034 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 18:21:25,153 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 18:21:25,154 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 18:21:25,157 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 18:21:25,157 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 18:21:25,158 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:21:25,158 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:21:25,160 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:21:25,384 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:21:25,385 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:21:25,386 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:21:25,386 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:21:25,409 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:21:25,552 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:21:25,554 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:21:25,946 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:21:26,063 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:21:26,066 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 18:21:26,209 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 18:21:26,219 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 18:21:26,219 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 138, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 18:21:26,221 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 18:21:26,223 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 18:21:26,223 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:21:26,223 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:21:26,225 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:21:26,424 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:21:26,426 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:21:26,426 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:21:26,427 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:21:26,450 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:21:26,599 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:21:26,601 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:21:26,785 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:21:26,894 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:21:26,896 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 18:21:27,026 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 18:21:27,027 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 18:21:27,030 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 18:21:27,030 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 18:21:27,031 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:21:27,032 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:21:27,034 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:21:27,248 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:21:27,250 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:21:27,251 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:21:27,251 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:21:27,275 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:21:27,425 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:21:27,427 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:21:27,605 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:21:27,711 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:21:27,714 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 18:21:27,839 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 18:21:27,845 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 18:21:27,846 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 18:21:27,847 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 18:21:27,847 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:21:27,848 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:21:27,852 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:21:28,064 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:21:28,067 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:21:28,067 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:21:28,068 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:21:28,091 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:21:28,257 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:21:28,258 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:21:28,439 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:21:28,567 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:21:28,568 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 18:21:28,705 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 18:21:28,710 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 18:25:00,737 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 18:25:00,738 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 18:25:01,094 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 18:25:01,096 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 18:25:01,096 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:25:01,096 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:25:01,108 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:25:01,384 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:25:01,386 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:25:01,387 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:25:01,387 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:25:01,412 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:25:01,573 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:25:01,576 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:25:01,959 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:25:02,079 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:25:02,080 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 18:25:02,212 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 18:25:02,214 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 18:25:02,217 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 18:25:02,218 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 18:25:02,218 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:25:02,218 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:25:02,221 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:25:02,440 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:25:02,443 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:25:02,444 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:25:02,444 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:25:02,471 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:25:02,638 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:25:02,642 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:25:02,875 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:25:03,006 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:25:03,008 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 18:25:03,164 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 18:25:03,164 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 18:25:03,166 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 138, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 18:25:03,169 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 18:25:03,171 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 18:25:03,172 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:25:03,173 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:25:03,175 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:25:03,386 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:25:03,387 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:25:03,388 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:25:03,388 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:25:03,410 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:25:03,552 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:25:03,553 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:25:03,728 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:25:03,840 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:25:03,841 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 18:25:03,961 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 18:25:03,962 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 18:25:03,966 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 18:25:03,966 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 18:25:03,966 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:25:03,966 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:25:03,968 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:25:04,160 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:25:04,161 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:25:04,162 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:25:04,162 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:25:04,187 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:25:04,332 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:25:04,334 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:25:04,526 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:25:04,629 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:25:04,632 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 18:25:04,765 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 18:25:04,772 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 18:25:04,772 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 18:25:04,773 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 18:25:04,774 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:25:04,774 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:25:04,776 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:25:04,988 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:25:04,991 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:25:04,992 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:25:04,992 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:25:05,014 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:25:05,159 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:25:05,162 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:25:05,340 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:25:05,457 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:25:05,458 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 18:25:05,582 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 18:25:05,586 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 18:25:05,587 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 18:25:05,588 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 18:25:05,588 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:25:05,589 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:25:05,591 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:25:05,804 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:25:05,807 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:25:05,808 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:25:05,809 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:25:05,830 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:25:05,982 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:25:05,985 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:25:06,170 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:25:06,279 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:25:06,282 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 18:25:06,417 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 18:25:06,419 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 18:32:04,193 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 18:32:04,193 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 18:32:04,619 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 18:32:04,620 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 18:32:04,620 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:32:04,620 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:32:04,633 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:32:04,904 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:32:04,906 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:32:04,907 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:32:04,908 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:32:04,939 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:32:05,111 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:32:05,114 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:32:05,479 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:32:05,584 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:32:05,585 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 18:32:05,715 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 18:32:05,716 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 18:32:05,722 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 18:32:05,723 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 18:32:05,723 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:32:05,724 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:32:05,726 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:32:05,940 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:32:05,942 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:32:05,942 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:32:05,943 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:32:05,970 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:32:06,152 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:32:06,158 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:32:06,363 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:32:06,476 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:32:06,479 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 18:32:06,612 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 18:32:06,614 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 18:32:06,615 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 163, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 18:32:06,618 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 18:32:06,621 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 18:32:06,622 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:32:06,622 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:32:06,627 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:32:06,834 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:32:06,836 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:32:06,836 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:32:06,837 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:32:06,861 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:32:07,015 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:32:07,017 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:32:07,227 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:32:07,340 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:32:07,341 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 18:32:07,473 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 18:32:07,475 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 18:32:07,479 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 18:32:07,480 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 18:32:07,480 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:32:07,481 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:32:07,484 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:32:07,681 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:32:07,683 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:32:07,683 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:32:07,683 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:32:07,706 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:32:07,855 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:32:07,856 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:32:08,048 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:32:08,155 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:32:08,157 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 18:32:08,291 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 18:32:08,296 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 18:32:08,297 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 18:32:08,298 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 18:32:08,299 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:32:08,299 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:32:08,303 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:32:08,523 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:32:08,525 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:32:08,525 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:32:08,526 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:32:08,549 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:32:08,708 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:32:08,710 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:32:08,900 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:32:09,013 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:32:09,014 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 18:32:09,152 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 18:32:09,157 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 18:32:09,160 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 18:32:09,161 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 18:32:09,161 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:32:09,162 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:32:09,167 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:32:09,366 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:32:09,368 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:32:09,369 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:32:09,369 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:32:09,391 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:32:09,534 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:32:09,537 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:32:09,706 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:32:09,821 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:32:09,822 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 18:32:09,938 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 18:32:09,940 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 18:36:15,120 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 18:36:15,121 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 18:36:15,523 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 18:36:15,524 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 18:36:15,524 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:36:15,524 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:36:15,535 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:36:15,747 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:36:15,749 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:36:15,750 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:36:15,750 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:36:15,773 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:36:15,931 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:36:15,932 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:36:16,435 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:16,542 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:16,544 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 18:36:16,688 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 18:36:16,690 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 18:36:16,693 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 18:36:16,693 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 18:36:16,693 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:36:16,694 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:36:16,696 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:36:16,902 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:36:16,904 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:36:16,905 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:36:16,907 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:36:16,928 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:36:17,080 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:36:17,082 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:36:17,262 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:17,365 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:17,365 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 18:36:17,486 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 18:36:17,487 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 18:36:17,488 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 169, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 18:36:17,491 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 18:36:17,493 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 18:36:17,493 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:36:17,494 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:36:17,496 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:36:17,707 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:36:17,710 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:36:17,712 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:36:17,712 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:36:17,738 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:36:17,895 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:36:17,896 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:36:18,077 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:18,217 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:18,219 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 18:36:18,362 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 18:36:18,365 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 18:36:18,368 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 18:36:18,368 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 18:36:18,369 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:36:18,369 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:36:18,373 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:36:18,580 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:36:18,582 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:36:18,582 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:36:18,583 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:36:18,605 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:36:18,745 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:36:18,748 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:36:18,982 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:19,088 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:19,089 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 18:36:19,217 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 18:36:19,223 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 18:36:19,223 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 18:36:19,224 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 18:36:19,225 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:36:19,225 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:36:19,229 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:36:19,432 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:36:19,434 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:36:19,435 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:36:19,436 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:36:19,461 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:36:19,603 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:36:19,605 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:36:19,776 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:19,896 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:19,899 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 18:36:20,020 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 18:36:20,024 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 18:36:20,027 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 18:36:20,027 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 18:36:20,029 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:36:20,030 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:36:20,033 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:36:20,236 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:36:20,237 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:36:20,238 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:36:20,239 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:36:20,261 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:36:20,417 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:36:20,420 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:36:20,596 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:20,710 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:20,712 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 18:36:20,827 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 18:36:20,830 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 18:36:20,839 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 18:36:20,839 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 18:36:20,847 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 18:36:20,849 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 18:36:20,849 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (0, 3)
2025-07-07 18:36:20,849 - src.services.reporting_logic.monthly_report_generator - ERROR - Error generating monthly charge report: name 'shpped_orders_df_filtered' is not defined
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\monthly_report_generator.py", line 48, in generate_monthly_charge_report
    logger.debug(f"shipped_orders_df_filtered head: \n{shpped_orders_df_filtered.head().to_string()}")
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'shpped_orders_df_filtered' is not defined
2025-07-07 18:36:20,850 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 18:36:20,850 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 18:36:20,853 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 18:36:20,854 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 18:36:20,854 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 18:36:20,855 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 18:36:20,857 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 18:36:20,858 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 18:36:20,858 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 18:36:20,861 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 18:36:20,862 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 18:36:20,865 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:36:20,866 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:36:20,869 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:36:21,079 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:36:21,082 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:36:21,083 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:36:21,083 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 18:36:21,105 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:36:21,267 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:36:21,271 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:36:21,465 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:21,567 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:36:21,710 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 18:36:21,831 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 18:36:21,833 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 18:36:21,977 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 18:36:21,980 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 18:36:21,981 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 18:36:21,982 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 18:36:21,983 - __main__ - INFO - Script finished successfully.
2025-07-07 18:37:56,606 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 18:37:56,606 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 18:37:57,019 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 18:37:57,200 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 18:37:57,201 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:37:57,202 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:37:57,223 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:37:57,508 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:37:57,510 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:37:57,510 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:37:57,510 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:37:57,536 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:37:57,684 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:37:57,687 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:37:58,168 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:37:58,296 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:37:58,298 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 18:37:58,459 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 18:37:58,461 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 18:37:58,464 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 18:37:58,465 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 18:37:58,465 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:37:58,465 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:37:58,467 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:37:58,676 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:37:58,679 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:37:58,681 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:37:58,682 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:37:58,704 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:37:58,850 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:37:58,852 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:37:59,068 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:37:59,189 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:37:59,189 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 18:37:59,345 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 18:37:59,347 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 18:37:59,348 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 169, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 18:37:59,350 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 18:37:59,353 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 18:37:59,354 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:37:59,354 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:37:59,356 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:37:59,549 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:37:59,550 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:37:59,551 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:37:59,551 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:37:59,574 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:37:59,727 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:37:59,730 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:37:59,914 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:38:00,026 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:38:00,028 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 18:38:00,169 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 18:38:00,170 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 18:38:00,172 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 18:38:00,172 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 18:38:00,173 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:38:00,173 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:38:00,175 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:38:00,369 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:38:00,371 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:38:00,371 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:38:00,371 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:38:00,395 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:38:00,547 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:38:00,550 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:38:00,735 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:38:00,848 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:38:00,854 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 18:38:00,976 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 18:38:00,981 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 18:38:00,983 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 18:38:00,985 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 18:38:00,985 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:38:00,985 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:38:00,988 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:38:01,206 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:38:01,208 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:38:01,209 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:38:01,210 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:38:01,233 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:38:01,376 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:38:01,377 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:38:01,580 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:38:01,696 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:38:01,698 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 18:38:01,824 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 18:38:01,827 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 18:38:01,829 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 18:38:01,830 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 18:38:01,830 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:38:01,830 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:38:01,832 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:38:02,044 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:38:02,047 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:38:02,048 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:38:02,048 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:38:02,071 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:38:02,225 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:38:02,227 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:38:02,412 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:38:02,531 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:38:02,533 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 18:38:02,769 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 18:38:02,770 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 18:38:02,776 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 18:38:02,776 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 18:38:02,784 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 18:38:02,786 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 18:38:02,787 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (0, 3)
2025-07-07 18:38:02,788 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  Order Number
0  2025-06-02        660875
1  2025-06-02        660975
2  2025-06-02        661025
3  2025-06-02        660915
4  2025-06-02        660885
2025-07-07 18:38:02,790 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  Order Number
597  2025-06-30        666965
598  2025-06-30        666915
599  2025-06-30        666895
600  2025-06-30        666905
601  2025-06-30        666945
2025-07-07 18:38:02,790 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 18:38:02,792 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 18:38:02,792 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 425), ('17904', 115), ('17914', 223), ('18675', 749)]...
2025-07-07 18:38:02,792 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 18:38:02,793 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 18:38:02,793 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (11, 5)
2025-07-07 18:38:02,795 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 18:38:02,808 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 1 transactions found.
2025-07-07 18:38:02,812 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 0, Received: 478, Shipped: 0, Repack: 0, EOD: 478
2025-07-07 18:38:02,857 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 1 transactions found.
2025-07-07 18:38:02,860 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 478, Received: 576, Shipped: 0, Repack: 0, EOD: 1054
2025-07-07 18:38:02,875 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 1 transactions found.
2025-07-07 18:38:02,878 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 1054, Received: 376, Shipped: 0, Repack: 0, EOD: 1430
2025-07-07 18:38:02,906 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914              0              0
1  2025-06-01  17612            425            425
2  2025-06-01  17904            115            115
3  2025-06-01  17612              0              0
4  2025-06-01  17914            223            223
2025-07-07 18:38:02,907 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17612            425            425
176  2025-06-30  17904            115            115
177  2025-06-30  17612           1430           1430
178  2025-06-30  17914            223            223
179  2025-06-30  18675            749            749
2025-07-07 18:38:02,908 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (180, 4)
2025-07-07 18:38:02,908 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 18:38:02,909 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914              0              0
1  2025-06-01  17612            425            425
2  2025-06-01  17904            115            115
3  2025-06-01  17612              0              0
4  2025-06-01  17914            223            223
2025-07-07 18:38:02,910 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17612            425            425
176  2025-06-30  17904            115            115
177  2025-06-30  17612           1430           1430
178  2025-06-30  17914            223            223
179  2025-06-30  18675            749            749
2025-07-07 18:38:02,911 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (180, 4)
2025-07-07 18:38:02,913 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     180.000000
mean      382.011111
std       358.317826
min         0.000000
25%       115.000000
50%       223.000000
75%       478.000000
max      1430.000000
2025-07-07 18:38:02,915 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01            425
7    2025-06-02            425
13   2025-06-03            425
19   2025-06-04            425
25   2025-06-05            425
31   2025-06-06            425
37   2025-06-07            425
43   2025-06-08            425
49   2025-06-09            425
55   2025-06-10            425
61   2025-06-11            425
67   2025-06-12            425
73   2025-06-13            425
79   2025-06-14            425
85   2025-06-15            425
91   2025-06-16            425
97   2025-06-17            425
103  2025-06-18            425
109  2025-06-19            425
115  2025-06-20            425
121  2025-06-21            425
127  2025-06-22            425
133  2025-06-23            425
139  2025-06-24            425
145  2025-06-25            425
151  2025-06-26            425
157  2025-06-27            425
163  2025-06-28            425
169  2025-06-29            425
175  2025-06-30            425
2025-07-07 18:38:02,920 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            115
8    2025-06-02            115
14   2025-06-03            115
20   2025-06-04            115
26   2025-06-05            115
32   2025-06-06            115
38   2025-06-07            115
44   2025-06-08            115
50   2025-06-09            115
56   2025-06-10            115
62   2025-06-11            115
68   2025-06-12            115
74   2025-06-13            115
80   2025-06-14            115
86   2025-06-15            115
92   2025-06-16            115
98   2025-06-17            115
104  2025-06-18            115
110  2025-06-19            115
116  2025-06-20            115
122  2025-06-21            115
128  2025-06-22            115
134  2025-06-23            115
140  2025-06-24            115
146  2025-06-25            115
152  2025-06-26            115
158  2025-06-27            115
164  2025-06-28            115
170  2025-06-29            115
176  2025-06-30            115
2025-07-07 18:38:02,927 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 18:38:02,928 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    180.000000
mean       5.000000
std        5.789607
min        0.000000
25%        0.000000
50%        2.500000
75%        9.000000
max       16.000000
2025-07-07 18:38:02,931 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01            9
7    2025-06-02            9
13   2025-06-03            9
19   2025-06-04            9
25   2025-06-05            9
31   2025-06-06            9
37   2025-06-07            9
43   2025-06-08            9
49   2025-06-09            9
55   2025-06-10            9
61   2025-06-11            9
67   2025-06-12            9
73   2025-06-13            9
79   2025-06-14            9
85   2025-06-15            9
91   2025-06-16            9
97   2025-06-17            9
103  2025-06-18            9
109  2025-06-19            9
115  2025-06-20            9
121  2025-06-21            9
127  2025-06-22            9
133  2025-06-23            9
139  2025-06-24            9
145  2025-06-25            9
151  2025-06-26            9
157  2025-06-27            9
163  2025-06-28            9
169  2025-06-29            9
175  2025-06-30            9
2025-07-07 18:38:02,935 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    30
2025-06-02    30
2025-06-03    30
2025-06-04    30
2025-06-05    30
2025-07-07 18:38:02,936 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    30
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    30
2025-07-07 18:38:02,937 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 18:38:02,937 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 18:38:02,939 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 18:38:02,940 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    13.5
2025-06-02    13.5
2025-06-03    13.5
2025-06-04    13.5
2025-06-05    13.5
2025-07-07 18:38:02,941 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.5
2025-06-27    13.5
2025-06-28    13.5
2025-06-29    13.5
2025-06-30    13.5
2025-07-07 18:38:02,948 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 18:38:02,948 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 18:38:02,949 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:38:02,951 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:38:02,953 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:38:03,155 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:38:03,156 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:38:03,157 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:38:03,157 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 18:38:03,179 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:38:03,337 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:38:03,339 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:38:03,535 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:38:03,647 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:38:03,827 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 18:38:03,986 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 18:38:03,988 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 18:38:04,162 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 18:38:04,162 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 18:38:04,164 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 18:38:04,165 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 18:38:04,165 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 18:38:04,167 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 18:38:04,167 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 18:38:04,167 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 18:38:04,168 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 18:38:04,170 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 18:38:04,170 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 18:38:04,171 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 18:38:04,176 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 18:38:04,177 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 18:38:04,180 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:38:04,181 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:38:04,184 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:38:04,377 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:38:04,379 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:38:04,380 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:38:04,380 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 18:38:04,407 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:38:04,569 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:38:04,571 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:38:04,803 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:38:04,937 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:38:05,109 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 18:38:05,270 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 18:38:05,272 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 18:38:05,421 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 18:38:05,423 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 18:38:05,423 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 18:38:05,424 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 18:38:05,425 - __main__ - INFO - Script finished successfully.
2025-07-07 18:43:41,992 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 18:43:41,994 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 18:43:42,581 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 18:43:42,581 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 18:43:42,582 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:43:42,582 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:43:42,603 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:43:42,881 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:43:42,882 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:43:42,882 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:43:42,883 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:43:42,917 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:43:43,101 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:43:43,107 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:43:43,566 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:43,677 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:43,679 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 18:43:43,808 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 18:43:43,820 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 18:43:43,831 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 18:43:43,832 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 18:43:43,832 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:43:43,832 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:43:43,835 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:43:44,048 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:43:44,050 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:43:44,051 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:43:44,051 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:43:44,074 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:43:44,227 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:43:44,230 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:43:44,416 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:44,535 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:44,536 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 18:43:44,665 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 18:43:44,667 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 18:43:44,668 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 169, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 18:43:44,677 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 18:43:44,680 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 18:43:44,681 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:43:44,682 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:43:44,685 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:43:44,893 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:43:44,895 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:43:44,896 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:43:44,897 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:43:44,918 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:43:45,066 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:43:45,069 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:43:45,262 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:45,375 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:45,376 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 18:43:45,512 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 18:43:45,515 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 18:43:45,523 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 18:43:45,523 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 18:43:45,523 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:43:45,524 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:43:45,526 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:43:45,754 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:43:45,756 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:43:45,757 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:43:45,758 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:43:45,784 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:43:45,935 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:43:45,937 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:43:46,128 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:46,300 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:46,302 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 18:43:46,434 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 18:43:46,444 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 18:43:46,447 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 18:43:46,448 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 18:43:46,449 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:43:46,449 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:43:46,454 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:43:46,651 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:43:46,653 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:43:46,653 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:43:46,654 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:43:46,676 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:43:46,839 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:43:46,842 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:43:47,049 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:47,161 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:47,162 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 18:43:47,280 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 18:43:47,284 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 18:43:47,292 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 18:43:47,293 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 18:43:47,293 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:43:47,294 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:43:47,297 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:43:47,498 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:43:47,500 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:43:47,501 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:43:47,502 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:43:47,525 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:43:47,672 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:43:47,673 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:43:47,866 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:47,984 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:47,985 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 18:43:48,142 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 18:43:48,143 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 18:43:48,154 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 18:43:48,154 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 18:43:48,170 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 18:43:48,171 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 18:43:48,171 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (0, 3)
2025-07-07 18:43:48,172 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  Order Number
0  2025-06-02        660875
1  2025-06-02        660975
2  2025-06-02        661025
3  2025-06-02        660915
4  2025-06-02        660885
2025-07-07 18:43:48,173 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  Order Number
597  2025-06-30        666965
598  2025-06-30        666915
599  2025-06-30        666895
600  2025-06-30        666905
601  2025-06-30        666945
2025-07-07 18:43:48,173 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 18:43:48,175 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 18:43:48,175 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 425), ('17904', 115), ('17914', 223), ('18675', 749)]...
2025-07-07 18:43:48,175 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 18:43:48,177 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 18:43:48,177 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (11, 5)
2025-07-07 18:43:48,179 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 18:43:48,192 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 1 transactions found.
2025-07-07 18:43:48,196 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 0, Received: 478, Shipped: 0, Repack: 0, EOD: 478
2025-07-07 18:43:48,246 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 1 transactions found.
2025-07-07 18:43:48,251 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 478, Received: 576, Shipped: 0, Repack: 0, EOD: 1054
2025-07-07 18:43:48,268 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 1 transactions found.
2025-07-07 18:43:48,272 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 1054, Received: 376, Shipped: 0, Repack: 0, EOD: 1430
2025-07-07 18:43:48,318 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            425            425
1  2025-06-01  17914              0              0
2  2025-06-01  17904            115            115
3  2025-06-01  18675            749            749
4  2025-06-01  17914            223            223
2025-07-07 18:43:48,320 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17914              0              0
176  2025-06-30  17904            115            115
177  2025-06-30  18675            749            749
178  2025-06-30  17914            223            223
179  2025-06-30  17612           1430           1430
2025-07-07 18:43:48,320 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (180, 4)
2025-07-07 18:43:48,321 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 18:43:48,321 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            425            425
1  2025-06-01  17914              0              0
2  2025-06-01  17904            115            115
3  2025-06-01  18675            749            749
4  2025-06-01  17914            223            223
2025-07-07 18:43:48,322 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17914              0              0
176  2025-06-30  17904            115            115
177  2025-06-30  18675            749            749
178  2025-06-30  17914            223            223
179  2025-06-30  17612           1430           1430
2025-07-07 18:43:48,323 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (180, 4)
2025-07-07 18:43:48,327 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     180.000000
mean      382.011111
std       358.317826
min         0.000000
25%       115.000000
50%       223.000000
75%       478.000000
max      1430.000000
2025-07-07 18:43:48,329 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
0    2025-06-01            425
6    2025-06-02            425
12   2025-06-03            425
18   2025-06-04            425
24   2025-06-05            425
30   2025-06-06            425
36   2025-06-07            425
42   2025-06-08            425
48   2025-06-09            425
54   2025-06-10            425
60   2025-06-11            425
66   2025-06-12            425
72   2025-06-13            425
78   2025-06-14            425
84   2025-06-15            425
90   2025-06-16            425
96   2025-06-17            425
102  2025-06-18            425
108  2025-06-19            425
114  2025-06-20            425
120  2025-06-21            425
126  2025-06-22            425
132  2025-06-23            425
138  2025-06-24            425
144  2025-06-25            425
150  2025-06-26            425
156  2025-06-27            425
162  2025-06-28            425
168  2025-06-29            425
174  2025-06-30            425
2025-07-07 18:43:48,333 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            115
8    2025-06-02            115
14   2025-06-03            115
20   2025-06-04            115
26   2025-06-05            115
32   2025-06-06            115
38   2025-06-07            115
44   2025-06-08            115
50   2025-06-09            115
56   2025-06-10            115
62   2025-06-11            115
68   2025-06-12            115
74   2025-06-13            115
80   2025-06-14            115
86   2025-06-15            115
92   2025-06-16            115
98   2025-06-17            115
104  2025-06-18            115
110  2025-06-19            115
116  2025-06-20            115
122  2025-06-21            115
128  2025-06-22            115
134  2025-06-23            115
140  2025-06-24            115
146  2025-06-25            115
152  2025-06-26            115
158  2025-06-27            115
164  2025-06-28            115
170  2025-06-29            115
176  2025-06-30            115
2025-07-07 18:43:48,345 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 18:43:48,346 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    180.000000
mean       5.000000
std        5.789607
min        0.000000
25%        0.000000
50%        2.500000
75%        9.000000
max       16.000000
2025-07-07 18:43:48,349 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
0    2025-06-01            9
6    2025-06-02            9
12   2025-06-03            9
18   2025-06-04            9
24   2025-06-05            9
30   2025-06-06            9
36   2025-06-07            9
42   2025-06-08            9
48   2025-06-09            9
54   2025-06-10            9
60   2025-06-11            9
66   2025-06-12            9
72   2025-06-13            9
78   2025-06-14            9
84   2025-06-15            9
90   2025-06-16            9
96   2025-06-17            9
102  2025-06-18            9
108  2025-06-19            9
114  2025-06-20            9
120  2025-06-21            9
126  2025-06-22            9
132  2025-06-23            9
138  2025-06-24            9
144  2025-06-25            9
150  2025-06-26            9
156  2025-06-27            9
162  2025-06-28            9
168  2025-06-29            9
174  2025-06-30            9
2025-07-07 18:43:48,353 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    30
2025-06-02    30
2025-06-03    30
2025-06-04    30
2025-06-05    30
2025-07-07 18:43:48,354 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    30
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    30
2025-07-07 18:43:48,355 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 18:43:48,355 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 18:43:48,357 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 18:43:48,358 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    13.5
2025-06-02    13.5
2025-06-03    13.5
2025-06-04    13.5
2025-06-05    13.5
2025-07-07 18:43:48,359 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.5
2025-06-27    13.5
2025-06-28    13.5
2025-06-29    13.5
2025-06-30    13.5
2025-07-07 18:43:48,377 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 18:43:48,378 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 18:43:48,378 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:43:48,379 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:43:48,382 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:43:48,612 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:43:48,614 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:43:48,615 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:43:48,615 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 18:43:48,662 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:43:48,818 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:43:48,821 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:43:49,006 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:49,112 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:49,245 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 18:43:49,367 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 18:43:49,369 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 18:43:49,511 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 18:43:49,512 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 18:43:49,512 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 18:43:49,513 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 18:43:49,514 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 18:43:49,518 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 18:43:49,518 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 18:43:49,518 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 18:43:49,519 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 18:43:49,522 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 18:43:49,524 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 18:43:49,527 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 18:43:49,531 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 18:43:49,532 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 18:43:49,537 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:43:49,537 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:43:49,541 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:43:49,780 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:43:49,781 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:43:49,781 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:43:49,782 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 18:43:49,805 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:43:49,967 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:43:49,969 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:43:50,177 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:50,287 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:43:50,418 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 18:43:50,537 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 18:43:50,539 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 18:43:50,669 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 18:43:50,671 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 18:43:50,672 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 18:43:50,675 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 18:43:50,676 - __main__ - INFO - Script finished successfully.
2025-07-07 18:58:06,020 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 18:58:06,021 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 18:58:06,506 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 18:58:06,507 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 18:58:06,507 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:58:06,507 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:58:06,519 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:58:06,802 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:58:06,804 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:58:06,804 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:58:06,804 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:58:06,828 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:58:06,996 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:58:06,999 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:58:08,609 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:08,727 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:08,728 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 18:58:08,858 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 18:58:08,859 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 18:58:08,862 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 18:58:08,863 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 18:58:08,863 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:58:08,863 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:58:08,865 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:58:09,075 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:58:09,077 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:58:09,077 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:58:09,078 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:58:09,099 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:58:09,248 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:58:09,250 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:58:09,485 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:09,614 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:09,616 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 18:58:09,780 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 18:58:09,781 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 18:58:09,782 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 169, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 18:58:09,784 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 18:58:09,786 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 18:58:09,786 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:58:09,786 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:58:09,788 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:58:10,030 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:58:10,031 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:58:10,032 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:58:10,032 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:58:10,054 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:58:10,212 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:58:10,215 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:58:10,410 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:10,530 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:10,531 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 18:58:10,671 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 18:58:10,672 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 18:58:10,679 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 18:58:10,679 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 18:58:10,680 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:58:10,681 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:58:10,684 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:58:10,878 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:58:10,880 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:58:10,882 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:58:10,882 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:58:10,926 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:58:11,077 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:58:11,081 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:58:11,269 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:11,382 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:11,384 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 18:58:11,540 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 18:58:11,547 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 18:58:11,548 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 18:58:11,550 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 18:58:11,550 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:58:11,551 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:58:11,554 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:58:11,755 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:58:11,757 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:58:11,757 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:58:11,759 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:58:11,782 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:58:11,947 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:58:11,948 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:58:12,143 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:12,261 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:12,262 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 18:58:12,398 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 18:58:12,405 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 18:58:12,408 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 18:58:12,410 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 18:58:12,411 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:58:12,411 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:58:12,415 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:58:12,631 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:58:12,633 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:58:12,634 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:58:12,634 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 18:58:12,658 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:58:12,804 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:58:12,805 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:58:13,001 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:13,124 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:13,125 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 18:58:13,274 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 18:58:13,277 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 18:58:13,283 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 18:58:13,284 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 18:58:13,290 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 18:58:13,292 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 18:58:13,294 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (0, 3)
2025-07-07 18:58:13,297 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  Order Number
0  2025-06-02        660875
1  2025-06-02        660975
2  2025-06-02        661025
3  2025-06-02        660915
4  2025-06-02        660885
2025-07-07 18:58:13,299 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  Order Number
597  2025-06-30        666965
598  2025-06-30        666915
599  2025-06-30        666895
600  2025-06-30        666905
601  2025-06-30        666945
2025-07-07 18:58:13,300 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 18:58:13,303 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 18:58:13,303 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 18:58:13,304 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 18:58:13,305 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 18:58:13,306 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (11, 5)
2025-07-07 18:58:13,307 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 18:58:13,318 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 1 transactions found.
2025-07-07 18:58:13,320 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 0, Received: 478, Shipped: 0, Repack: 0, EOD: 478
2025-07-07 18:58:13,389 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 1 transactions found.
2025-07-07 18:58:13,394 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 478, Received: 576, Shipped: 0, Repack: 0, EOD: 1054
2025-07-07 18:58:13,414 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 1 transactions found.
2025-07-07 18:58:13,418 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 1054, Received: 376, Shipped: 0, Repack: 0, EOD: 1430
2025-07-07 18:58:13,453 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
1  2025-06-01  18675            769            769
2  2025-06-01  17612              0              0
3  2025-06-01  17914              0              0
4  2025-06-01  17904            178            178
2025-07-07 18:58:13,454 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  18675            769            769
176  2025-06-30  17612           1430           1430
177  2025-06-30  17914              0              0
178  2025-06-30  17904            178            178
179  2025-06-30  17914            326            326
2025-07-07 18:58:13,455 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (180, 4)
2025-07-07 18:58:13,456 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 18:58:13,457 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
1  2025-06-01  18675            769            769
2  2025-06-01  17612              0              0
3  2025-06-01  17914              0              0
4  2025-06-01  17904            178            178
2025-07-07 18:58:13,459 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  18675            769            769
176  2025-06-30  17612           1430           1430
177  2025-06-30  17914              0              0
178  2025-06-30  17904            178            178
179  2025-06-30  17914            326            326
2025-07-07 18:58:13,460 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (180, 4)
2025-07-07 18:58:13,462 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     180.000000
mean      501.344444
std       403.272997
min         0.000000
25%       178.000000
50%       326.000000
75%       769.000000
max      1430.000000
2025-07-07 18:58:13,464 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
0    2025-06-01            955
6    2025-06-02            955
12   2025-06-03            955
18   2025-06-04            955
24   2025-06-05            955
30   2025-06-06            955
36   2025-06-07            955
42   2025-06-08            955
48   2025-06-09            955
54   2025-06-10            955
60   2025-06-11            955
66   2025-06-12            955
72   2025-06-13            955
78   2025-06-14            955
84   2025-06-15            955
90   2025-06-16            955
96   2025-06-17            955
102  2025-06-18            955
108  2025-06-19            955
114  2025-06-20            955
120  2025-06-21            955
126  2025-06-22            955
132  2025-06-23            955
138  2025-06-24            955
144  2025-06-25            955
150  2025-06-26            955
156  2025-06-27            955
162  2025-06-28            955
168  2025-06-29            955
174  2025-06-30            955
2025-07-07 18:58:13,466 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
4    2025-06-01            178
10   2025-06-02            178
16   2025-06-03            178
22   2025-06-04            178
28   2025-06-05            178
34   2025-06-06            178
40   2025-06-07            178
46   2025-06-08            178
52   2025-06-09            178
58   2025-06-10            178
64   2025-06-11            178
70   2025-06-12            178
76   2025-06-13            178
82   2025-06-14            178
88   2025-06-15            178
94   2025-06-16            178
100  2025-06-17            178
106  2025-06-18            178
112  2025-06-19            178
118  2025-06-20            178
124  2025-06-21            178
130  2025-06-22            178
136  2025-06-23            178
142  2025-06-24            178
148  2025-06-25            178
154  2025-06-26            178
160  2025-06-27            178
166  2025-06-28            178
172  2025-06-29            178
178  2025-06-30            178
2025-07-07 18:58:13,472 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 18:58:13,473 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    180.000000
mean       7.500000
std        8.037969
min        0.000000
25%        0.000000
50%        4.000000
75%       17.000000
max       20.000000
2025-07-07 18:58:13,475 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
0    2025-06-01           20
6    2025-06-02           20
12   2025-06-03           20
18   2025-06-04           20
24   2025-06-05           20
30   2025-06-06           20
36   2025-06-07           20
42   2025-06-08           20
48   2025-06-09           20
54   2025-06-10           20
60   2025-06-11           20
66   2025-06-12           20
72   2025-06-13           20
78   2025-06-14           20
84   2025-06-15           20
90   2025-06-16           20
96   2025-06-17           20
102  2025-06-18           20
108  2025-06-19           20
114  2025-06-20           20
120  2025-06-21           20
126  2025-06-22           20
132  2025-06-23           20
138  2025-06-24           20
144  2025-06-25           20
150  2025-06-26           20
156  2025-06-27           20
162  2025-06-28           20
168  2025-06-29           20
174  2025-06-30           20
2025-07-07 18:58:13,478 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    45
2025-06-03    45
2025-06-04    45
2025-06-05    45
2025-07-07 18:58:13,479 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    45
2025-06-27    45
2025-06-28    45
2025-06-29    45
2025-06-30    45
2025-07-07 18:58:13,480 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 18:58:13,480 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 18:58:13,482 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 18:58:13,482 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    20.25
2025-06-03    20.25
2025-06-04    20.25
2025-06-05    20.25
2025-07-07 18:58:13,483 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    20.25
2025-06-27    20.25
2025-06-28    20.25
2025-06-29    20.25
2025-06-30    20.25
2025-07-07 18:58:13,490 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 18:58:13,490 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 18:58:13,490 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:58:13,491 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:58:13,496 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:58:13,740 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:58:13,744 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:58:13,747 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:58:13,748 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 18:58:13,818 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:58:13,962 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:58:13,965 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:58:14,162 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:14,277 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:14,514 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 18:58:14,650 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 18:58:14,655 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 18:58:14,803 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 18:58:14,807 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 18:58:14,808 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 18:58:14,809 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 18:58:14,812 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 18:58:14,820 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 18:58:14,821 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 18:58:14,823 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 18:58:14,826 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 18:58:14,832 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 18:58:14,836 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 18:58:14,840 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 18:58:14,857 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 18:58:14,861 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 18:58:14,878 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 18:58:14,880 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 18:58:14,888 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 18:58:15,129 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 18:58:15,132 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 18:58:15,135 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 18:58:15,137 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 18:58:15,203 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 18:58:15,363 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 18:58:15,367 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 18:58:15,575 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:15,720 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 18:58:15,860 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 18:58:16,001 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 18:58:16,004 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 18:58:16,159 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 18:58:16,160 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 18:58:16,161 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 18:58:16,164 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 18:58:16,165 - __main__ - INFO - Script finished successfully.
2025-07-07 19:05:46,697 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 19:05:46,698 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 19:05:47,040 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 19:05:47,041 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 19:05:47,041 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:05:47,041 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:05:47,054 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:05:47,320 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:05:47,323 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:05:47,324 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:05:47,324 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:05:47,348 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:05:47,568 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:05:47,571 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:05:47,994 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:48,105 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:48,108 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 19:05:48,249 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 19:05:48,251 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 19:05:48,254 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 19:05:48,255 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 19:05:48,255 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:05:48,255 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:05:48,258 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:05:48,467 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:05:48,471 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:05:48,471 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:05:48,472 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:05:48,496 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:05:48,656 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:05:48,658 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:05:48,855 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:48,977 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:48,981 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 19:05:49,113 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 19:05:49,116 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 19:05:49,117 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 169, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 19:05:49,119 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 19:05:49,122 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 19:05:49,123 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:05:49,124 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:05:49,126 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:05:49,341 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:05:49,343 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:05:49,344 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:05:49,344 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:05:49,366 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:05:49,534 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:05:49,535 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:05:49,736 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:49,850 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:49,852 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 19:05:49,983 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 19:05:49,986 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 19:05:49,991 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 19:05:49,992 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 19:05:49,992 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:05:49,993 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:05:49,997 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:05:50,224 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:05:50,226 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:05:50,226 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:05:50,226 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:05:50,248 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:05:50,399 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:05:50,401 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:05:50,616 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:50,739 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:50,742 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 19:05:50,875 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 19:05:50,881 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 19:05:50,883 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 19:05:50,884 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 19:05:50,884 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:05:50,885 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:05:50,888 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:05:51,093 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:05:51,095 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:05:51,095 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:05:51,096 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:05:51,118 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:05:51,289 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:05:51,291 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:05:51,486 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:51,602 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:51,606 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 19:05:51,739 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 19:05:51,747 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 19:05:51,750 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 19:05:51,750 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 19:05:51,751 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:05:51,751 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:05:51,755 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:05:51,989 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:05:51,991 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:05:51,993 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:05:51,993 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:05:52,014 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:05:52,190 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:05:52,191 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:05:52,369 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:52,477 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:52,480 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 19:05:52,602 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 19:05:52,605 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 19:05:52,613 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 19:05:52,613 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 19:05:52,621 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 19:05:52,621 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 19:05:52,622 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (0, 3)
2025-07-07 19:05:52,623 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  Order Number
0  2025-06-02        660875
1  2025-06-02        660975
2  2025-06-02        661025
3  2025-06-02        660915
4  2025-06-02        660885
2025-07-07 19:05:52,625 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  Order Number
597  2025-06-30        666965
598  2025-06-30        666915
599  2025-06-30        666895
600  2025-06-30        666905
601  2025-06-30        666945
2025-07-07 19:05:52,625 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 19:05:52,627 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 19:05:52,628 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 19:05:52,629 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 19:05:52,630 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 19:05:52,631 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (11, 5)
2025-07-07 19:05:52,633 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 19:05:52,645 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 1 transactions found.
2025-07-07 19:05:52,647 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 0, Received: 478, Shipped: 0, Repack: 0, EOD: 478
2025-07-07 19:05:52,701 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 1 transactions found.
2025-07-07 19:05:52,704 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 478, Received: 576, Shipped: 0, Repack: 0, EOD: 1054
2025-07-07 19:05:52,719 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 1 transactions found.
2025-07-07 19:05:52,721 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 1054, Received: 376, Shipped: 0, Repack: 0, EOD: 1430
2025-07-07 19:05:52,749 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612              0              0
1  2025-06-01  17904            178            178
2  2025-06-01  17612            955            955
3  2025-06-01  17914              0              0
4  2025-06-01  17914            326            326
2025-07-07 19:05:52,751 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17904            178            178
176  2025-06-30  17612            955            955
177  2025-06-30  17914              0              0
178  2025-06-30  17914            326            326
179  2025-06-30  18675            769            769
2025-07-07 19:05:52,752 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (180, 4)
2025-07-07 19:05:52,752 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 19:05:52,753 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612              0              0
1  2025-06-01  17904            178            178
2  2025-06-01  17612            955            955
3  2025-06-01  17914              0              0
4  2025-06-01  17914            326            326
2025-07-07 19:05:52,754 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17904            178            178
176  2025-06-30  17612            955            955
177  2025-06-30  17914              0              0
178  2025-06-30  17914            326            326
179  2025-06-30  18675            769            769
2025-07-07 19:05:52,755 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (180, 4)
2025-07-07 19:05:52,756 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     180.000000
mean      501.344444
std       403.272997
min         0.000000
25%       178.000000
50%       326.000000
75%       769.000000
max      1430.000000
2025-07-07 19:05:52,758 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
2    2025-06-01            955
8    2025-06-02            955
14   2025-06-03            955
20   2025-06-04            955
26   2025-06-05            955
32   2025-06-06            955
38   2025-06-07            955
44   2025-06-08            955
50   2025-06-09            955
56   2025-06-10            955
62   2025-06-11            955
68   2025-06-12            955
74   2025-06-13            955
80   2025-06-14            955
86   2025-06-15            955
92   2025-06-16            955
98   2025-06-17            955
104  2025-06-18            955
110  2025-06-19            955
116  2025-06-20            955
122  2025-06-21            955
128  2025-06-22            955
134  2025-06-23            955
140  2025-06-24            955
146  2025-06-25            955
152  2025-06-26            955
158  2025-06-27            955
164  2025-06-28            955
170  2025-06-29            955
176  2025-06-30            955
2025-07-07 19:05:52,762 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            178
7    2025-06-02            178
13   2025-06-03            178
19   2025-06-04            178
25   2025-06-05            178
31   2025-06-06            178
37   2025-06-07            178
43   2025-06-08            178
49   2025-06-09            178
55   2025-06-10            178
61   2025-06-11            178
67   2025-06-12            178
73   2025-06-13            178
79   2025-06-14            178
85   2025-06-15            178
91   2025-06-16            178
97   2025-06-17            178
103  2025-06-18            178
109  2025-06-19            178
115  2025-06-20            178
121  2025-06-21            178
127  2025-06-22            178
133  2025-06-23            178
139  2025-06-24            178
145  2025-06-25            178
151  2025-06-26            178
157  2025-06-27            178
163  2025-06-28            178
169  2025-06-29            178
175  2025-06-30            178
2025-07-07 19:05:52,768 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 19:05:52,769 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    180.000000
mean       7.500000
std        8.037969
min        0.000000
25%        0.000000
50%        4.000000
75%       17.000000
max       20.000000
2025-07-07 19:05:52,770 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
2    2025-06-01           20
8    2025-06-02           20
14   2025-06-03           20
20   2025-06-04           20
26   2025-06-05           20
32   2025-06-06           20
38   2025-06-07           20
44   2025-06-08           20
50   2025-06-09           20
56   2025-06-10           20
62   2025-06-11           20
68   2025-06-12           20
74   2025-06-13           20
80   2025-06-14           20
86   2025-06-15           20
92   2025-06-16           20
98   2025-06-17           20
104  2025-06-18           20
110  2025-06-19           20
116  2025-06-20           20
122  2025-06-21           20
128  2025-06-22           20
134  2025-06-23           20
140  2025-06-24           20
146  2025-06-25           20
152  2025-06-26           20
158  2025-06-27           20
164  2025-06-28           20
170  2025-06-29           20
176  2025-06-30           20
2025-07-07 19:05:52,772 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    45
2025-06-03    45
2025-06-04    45
2025-06-05    45
2025-07-07 19:05:52,773 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    45
2025-06-27    45
2025-06-28    45
2025-06-29    45
2025-06-30    45
2025-07-07 19:05:52,774 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 19:05:52,775 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 19:05:52,777 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 19:05:52,780 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    20.25
2025-06-03    20.25
2025-06-04    20.25
2025-06-05    20.25
2025-07-07 19:05:52,781 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    20.25
2025-06-27    20.25
2025-06-28    20.25
2025-06-29    20.25
2025-06-30    20.25
2025-07-07 19:05:52,787 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 19:05:52,787 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 19:05:52,788 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:05:52,788 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:05:52,790 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:05:53,012 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:05:53,013 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:05:53,014 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:05:53,014 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 19:05:53,039 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:05:53,184 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:05:53,186 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:05:53,381 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:53,483 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:53,636 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:05:53,779 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:05:53,782 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 19:05:54,524 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:05:54,525 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 19:05:54,526 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 19:05:54,527 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 19:05:54,527 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 19:05:54,530 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 19:05:54,530 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 19:05:54,531 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 19:05:54,532 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 19:05:54,534 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 19:05:54,535 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 19:05:54,537 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 19:05:54,542 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 19:05:54,542 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 19:05:54,545 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:05:54,546 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:05:54,550 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:05:54,756 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:05:54,759 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:05:54,760 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:05:54,760 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 19:05:54,786 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:05:54,956 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:05:54,958 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:05:55,146 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:55,247 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:05:55,385 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:05:55,524 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:05:55,526 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 19:05:55,750 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:05:55,751 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 19:05:55,751 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 19:05:55,751 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 19:05:55,751 - __main__ - INFO - Script finished successfully.
2025-07-07 19:15:28,558 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 19:15:28,560 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 19:15:29,120 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 19:15:29,121 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 19:15:29,122 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:15:29,122 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:15:29,137 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:15:29,427 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:15:29,428 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:15:29,429 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:15:29,429 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:15:29,454 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:15:29,626 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:15:29,628 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:15:29,952 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:30,097 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:30,098 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 19:15:30,245 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 19:15:30,248 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 19:15:30,252 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 19:15:30,252 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 19:15:30,252 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:15:30,253 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:15:30,255 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:15:30,463 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:15:30,465 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:15:30,466 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:15:30,467 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:15:30,496 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:15:30,631 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:15:30,635 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:15:30,850 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:30,969 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:30,971 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 19:15:31,125 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 19:15:31,126 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 19:15:31,127 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 169, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 19:15:31,130 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 19:15:31,133 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 19:15:31,134 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:15:31,134 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:15:31,140 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:15:31,347 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:15:31,349 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:15:31,350 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:15:31,350 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:15:31,376 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:15:31,540 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:15:31,542 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:15:31,740 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:31,851 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:31,853 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 19:15:31,984 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 19:15:31,987 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 19:15:31,991 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 19:15:31,992 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 19:15:31,992 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:15:31,993 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:15:31,995 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:15:32,212 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:15:32,214 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:15:32,214 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:15:32,215 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:15:32,239 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:15:32,403 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:15:32,405 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:15:32,641 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:32,766 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:32,767 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 19:15:32,902 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 19:15:32,907 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 19:15:32,908 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 19:15:32,910 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 19:15:32,910 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:15:32,911 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:15:32,916 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:15:33,174 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:15:33,175 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:15:33,175 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:15:33,175 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:15:33,201 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:15:33,355 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:15:33,358 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:15:33,548 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:33,736 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:33,753 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 19:15:33,903 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 19:15:33,909 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 19:15:33,912 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 19:15:33,912 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 19:15:33,913 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:15:33,913 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:15:33,916 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:15:34,125 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:15:34,127 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:15:34,128 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:15:34,129 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:15:34,151 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:15:34,314 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:15:34,317 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:15:34,504 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:34,637 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:34,639 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 19:15:34,787 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 19:15:34,790 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 19:15:34,796 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 19:15:34,797 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 19:15:34,798 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Date                object
SKU                 object
Quantity_Shipped    object
2025-07-07 19:15:34,799 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
Series([], )
2025-07-07 19:15:34,801 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Date                object
SKU                 object
Quantity_Shipped    object
2025-07-07 19:15:34,801 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
Series([], )
2025-07-07 19:15:34,802 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 19:15:34,804 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 19:15:34,805 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 19:15:34,805 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (0, 3)
2025-07-07 19:15:34,806 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  Order Number
0  2025-06-02        660875
1  2025-06-02        660975
2  2025-06-02        661025
3  2025-06-02        660915
4  2025-06-02        660885
2025-07-07 19:15:34,807 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  Order Number
597  2025-06-30        666965
598  2025-06-30        666915
599  2025-06-30        666895
600  2025-06-30        666905
601  2025-06-30        666945
2025-07-07 19:15:34,808 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 19:15:34,810 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 19:15:34,810 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 19:15:34,810 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 19:15:34,811 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 19:15:34,811 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (11, 5)
2025-07-07 19:15:34,812 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 19:15:34,824 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 1 transactions found.
2025-07-07 19:15:34,827 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 0, Received: 478, Shipped: 0, Repack: 0, EOD: 478
2025-07-07 19:15:34,883 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 1 transactions found.
2025-07-07 19:15:34,885 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 478, Received: 576, Shipped: 0, Repack: 0, EOD: 1054
2025-07-07 19:15:34,903 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 1 transactions found.
2025-07-07 19:15:34,905 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 1054, Received: 376, Shipped: 0, Repack: 0, EOD: 1430
2025-07-07 19:15:34,934 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
1  2025-06-01  17612              0              0
2  2025-06-01  17914              0              0
3  2025-06-01  17914            326            326
4  2025-06-01  18675            769            769
2025-07-07 19:15:34,936 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17612           1430           1430
176  2025-06-30  17914              0              0
177  2025-06-30  17914            326            326
178  2025-06-30  18675            769            769
179  2025-06-30  17904            178            178
2025-07-07 19:15:34,937 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (180, 4)
2025-07-07 19:15:34,937 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 19:15:34,939 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
1  2025-06-01  17612              0              0
2  2025-06-01  17914              0              0
3  2025-06-01  17914            326            326
4  2025-06-01  18675            769            769
2025-07-07 19:15:34,944 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17612           1430           1430
176  2025-06-30  17914              0              0
177  2025-06-30  17914            326            326
178  2025-06-30  18675            769            769
179  2025-06-30  17904            178            178
2025-07-07 19:15:34,944 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (180, 4)
2025-07-07 19:15:34,946 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     180.000000
mean      501.344444
std       403.272997
min         0.000000
25%       178.000000
50%       326.000000
75%       769.000000
max      1430.000000
2025-07-07 19:15:34,949 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
0    2025-06-01            955
6    2025-06-02            955
12   2025-06-03            955
18   2025-06-04            955
24   2025-06-05            955
30   2025-06-06            955
36   2025-06-07            955
42   2025-06-08            955
48   2025-06-09            955
54   2025-06-10            955
60   2025-06-11            955
66   2025-06-12            955
72   2025-06-13            955
78   2025-06-14            955
84   2025-06-15            955
90   2025-06-16            955
96   2025-06-17            955
102  2025-06-18            955
108  2025-06-19            955
114  2025-06-20            955
120  2025-06-21            955
126  2025-06-22            955
132  2025-06-23            955
138  2025-06-24            955
144  2025-06-25            955
150  2025-06-26            955
156  2025-06-27            955
162  2025-06-28            955
168  2025-06-29            955
174  2025-06-30            955
2025-07-07 19:15:34,951 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
5    2025-06-01            178
11   2025-06-02            178
17   2025-06-03            178
23   2025-06-04            178
29   2025-06-05            178
35   2025-06-06            178
41   2025-06-07            178
47   2025-06-08            178
53   2025-06-09            178
59   2025-06-10            178
65   2025-06-11            178
71   2025-06-12            178
77   2025-06-13            178
83   2025-06-14            178
89   2025-06-15            178
95   2025-06-16            178
101  2025-06-17            178
107  2025-06-18            178
113  2025-06-19            178
119  2025-06-20            178
125  2025-06-21            178
131  2025-06-22            178
137  2025-06-23            178
143  2025-06-24            178
149  2025-06-25            178
155  2025-06-26            178
161  2025-06-27            178
167  2025-06-28            178
173  2025-06-29            178
179  2025-06-30            178
2025-07-07 19:15:34,959 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 19:15:34,961 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    180.000000
mean       7.500000
std        8.037969
min        0.000000
25%        0.000000
50%        4.000000
75%       17.000000
max       20.000000
2025-07-07 19:15:34,963 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
0    2025-06-01           20
6    2025-06-02           20
12   2025-06-03           20
18   2025-06-04           20
24   2025-06-05           20
30   2025-06-06           20
36   2025-06-07           20
42   2025-06-08           20
48   2025-06-09           20
54   2025-06-10           20
60   2025-06-11           20
66   2025-06-12           20
72   2025-06-13           20
78   2025-06-14           20
84   2025-06-15           20
90   2025-06-16           20
96   2025-06-17           20
102  2025-06-18           20
108  2025-06-19           20
114  2025-06-20           20
120  2025-06-21           20
126  2025-06-22           20
132  2025-06-23           20
138  2025-06-24           20
144  2025-06-25           20
150  2025-06-26           20
156  2025-06-27           20
162  2025-06-28           20
168  2025-06-29           20
174  2025-06-30           20
2025-07-07 19:15:34,966 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    45
2025-06-03    45
2025-06-04    45
2025-06-05    45
2025-07-07 19:15:34,966 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    45
2025-06-27    45
2025-06-28    45
2025-06-29    45
2025-06-30    45
2025-07-07 19:15:34,966 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 19:15:34,967 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 19:15:34,968 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 19:15:34,970 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    20.25
2025-06-03    20.25
2025-06-04    20.25
2025-06-05    20.25
2025-07-07 19:15:34,971 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    20.25
2025-06-27    20.25
2025-06-28    20.25
2025-06-29    20.25
2025-06-30    20.25
2025-07-07 19:15:34,981 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 19:15:34,981 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 19:15:34,982 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:15:34,983 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:15:34,985 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:15:35,212 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:15:35,214 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:15:35,214 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:15:35,215 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 19:15:35,237 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:15:35,401 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:15:35,404 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:15:35,591 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:35,709 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:35,868 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:15:35,995 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:15:35,997 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 19:15:36,142 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:15:36,143 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 19:15:36,144 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 19:15:36,146 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 19:15:36,146 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 19:15:36,153 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 19:15:36,155 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 19:15:36,155 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 19:15:36,158 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 19:15:36,164 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 19:15:36,167 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 19:15:36,169 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 19:15:36,175 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 19:15:36,176 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 19:15:36,183 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:15:36,184 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:15:36,191 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:15:36,451 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:15:36,456 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:15:36,459 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:15:36,460 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 19:15:36,538 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:15:36,688 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:15:36,692 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:15:36,885 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:37,004 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:15:37,281 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:15:37,442 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:15:37,442 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 19:15:37,588 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:15:37,590 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 19:15:37,591 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 19:15:37,592 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 19:15:37,593 - __main__ - INFO - Script finished successfully.
2025-07-07 19:19:04,725 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 19:19:04,726 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 19:19:05,080 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 19:19:05,080 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 19:19:05,081 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:19:05,081 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:19:05,093 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:19:05,300 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:19:05,302 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:19:05,302 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:19:05,302 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:19:05,328 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:19:05,483 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:19:05,485 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:19:05,790 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:05,909 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:05,910 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 19:19:06,038 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 19:19:06,041 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 19:19:06,044 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 19:19:06,044 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 19:19:06,044 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:19:06,044 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:19:06,047 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:19:06,264 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:19:06,266 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:19:06,267 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:19:06,267 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:19:06,292 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:19:06,455 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:19:06,457 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:19:06,642 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:06,773 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:06,775 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 19:19:06,918 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 19:19:06,920 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 19:19:06,921 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 175, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 19:19:06,923 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 19:19:06,926 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 19:19:06,927 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:19:06,928 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:19:06,931 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:19:07,149 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:19:07,163 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:19:07,175 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:19:07,176 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:19:07,219 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:19:07,381 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:19:07,383 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:19:07,577 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:07,688 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:07,690 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 19:19:07,826 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 19:19:07,827 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 19:19:07,830 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 19:19:07,830 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 19:19:07,831 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:19:07,831 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:19:07,834 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:19:08,027 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:19:08,029 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:19:08,030 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:19:08,030 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:19:08,052 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:19:08,214 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:19:08,216 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:19:08,402 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:08,509 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:08,510 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 19:19:08,645 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 19:19:08,650 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 19:19:08,651 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 19:19:08,653 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 19:19:08,653 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:19:08,654 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:19:08,656 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:19:08,849 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:19:08,850 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:19:08,852 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:19:08,852 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:19:08,875 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:19:09,020 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:19:09,022 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:19:09,216 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:09,346 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:09,348 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 19:19:09,468 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 19:19:09,471 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 19:19:09,474 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 19:19:09,475 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 19:19:09,475 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:19:09,476 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:19:09,478 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:19:09,682 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:19:09,683 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:19:09,684 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:19:09,684 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:19:09,708 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:19:09,860 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:19:09,862 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:19:10,048 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:10,159 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:10,160 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 19:19:10,282 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 19:19:10,284 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 19:19:10,290 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 19:19:10,291 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 19:19:10,292 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Date                object
SKU                 object
Quantity_Shipped    object
2025-07-07 19:19:10,293 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
Series([], )
2025-07-07 19:19:10,295 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Date                object
SKU                 object
Quantity_Shipped    object
2025-07-07 19:19:10,296 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
Series([], )
2025-07-07 19:19:10,296 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 19:19:10,298 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 19:19:10,299 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 19:19:10,299 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (0, 3)
2025-07-07 19:19:10,300 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  Order Number
0  2025-06-02        660875
1  2025-06-02        660975
2  2025-06-02        661025
3  2025-06-02        660915
4  2025-06-02        660885
2025-07-07 19:19:10,301 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  Order Number
597  2025-06-30        666965
598  2025-06-30        666915
599  2025-06-30        666895
600  2025-06-30        666905
601  2025-06-30        666945
2025-07-07 19:19:10,301 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 19:19:10,304 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 19:19:10,304 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 19:19:10,305 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 19:19:10,305 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 19:19:10,306 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (11, 5)
2025-07-07 19:19:10,307 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 19:19:10,319 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 1 transactions found.
2025-07-07 19:19:10,323 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 0, Received: 478, Shipped: 0, Repack: 0, EOD: 478
2025-07-07 19:19:10,382 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 1 transactions found.
2025-07-07 19:19:10,386 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 478, Received: 576, Shipped: 0, Repack: 0, EOD: 1054
2025-07-07 19:19:10,401 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 1 transactions found.
2025-07-07 19:19:10,404 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 1054, Received: 376, Shipped: 0, Repack: 0, EOD: 1430
2025-07-07 19:19:10,432 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914            326            326
1  2025-06-01  17612            955            955
2  2025-06-01  18675            769            769
3  2025-06-01  17914              0              0
4  2025-06-01  17612              0              0
2025-07-07 19:19:10,433 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17612            955            955
176  2025-06-30  18675            769            769
177  2025-06-30  17914              0              0
178  2025-06-30  17612           1430           1430
179  2025-06-30  17904            178            178
2025-07-07 19:19:10,434 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (180, 4)
2025-07-07 19:19:10,434 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 19:19:10,435 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914            326            326
1  2025-06-01  17612            955            955
2  2025-06-01  18675            769            769
3  2025-06-01  17914              0              0
4  2025-06-01  17612              0              0
2025-07-07 19:19:10,436 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17612            955            955
176  2025-06-30  18675            769            769
177  2025-06-30  17914              0              0
178  2025-06-30  17612           1430           1430
179  2025-06-30  17904            178            178
2025-07-07 19:19:10,436 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (180, 4)
2025-07-07 19:19:10,439 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     180.000000
mean      501.344444
std       403.272997
min         0.000000
25%       178.000000
50%       326.000000
75%       769.000000
max      1430.000000
2025-07-07 19:19:10,441 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01            955
7    2025-06-02            955
13   2025-06-03            955
19   2025-06-04            955
25   2025-06-05            955
31   2025-06-06            955
37   2025-06-07            955
43   2025-06-08            955
49   2025-06-09            955
55   2025-06-10            955
61   2025-06-11            955
67   2025-06-12            955
73   2025-06-13            955
79   2025-06-14            955
85   2025-06-15            955
91   2025-06-16            955
97   2025-06-17            955
103  2025-06-18            955
109  2025-06-19            955
115  2025-06-20            955
121  2025-06-21            955
127  2025-06-22            955
133  2025-06-23            955
139  2025-06-24            955
145  2025-06-25            955
151  2025-06-26            955
157  2025-06-27            955
163  2025-06-28            955
169  2025-06-29            955
175  2025-06-30            955
2025-07-07 19:19:10,443 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
5    2025-06-01            178
11   2025-06-02            178
17   2025-06-03            178
23   2025-06-04            178
29   2025-06-05            178
35   2025-06-06            178
41   2025-06-07            178
47   2025-06-08            178
53   2025-06-09            178
59   2025-06-10            178
65   2025-06-11            178
71   2025-06-12            178
77   2025-06-13            178
83   2025-06-14            178
89   2025-06-15            178
95   2025-06-16            178
101  2025-06-17            178
107  2025-06-18            178
113  2025-06-19            178
119  2025-06-20            178
125  2025-06-21            178
131  2025-06-22            178
137  2025-06-23            178
143  2025-06-24            178
149  2025-06-25            178
155  2025-06-26            178
161  2025-06-27            178
167  2025-06-28            178
173  2025-06-29            178
179  2025-06-30            178
2025-07-07 19:19:10,448 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 19:19:10,450 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    180.000000
mean       7.500000
std        8.037969
min        0.000000
25%        0.000000
50%        4.000000
75%       17.000000
max       20.000000
2025-07-07 19:19:10,452 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           20
7    2025-06-02           20
13   2025-06-03           20
19   2025-06-04           20
25   2025-06-05           20
31   2025-06-06           20
37   2025-06-07           20
43   2025-06-08           20
49   2025-06-09           20
55   2025-06-10           20
61   2025-06-11           20
67   2025-06-12           20
73   2025-06-13           20
79   2025-06-14           20
85   2025-06-15           20
91   2025-06-16           20
97   2025-06-17           20
103  2025-06-18           20
109  2025-06-19           20
115  2025-06-20           20
121  2025-06-21           20
127  2025-06-22           20
133  2025-06-23           20
139  2025-06-24           20
145  2025-06-25           20
151  2025-06-26           20
157  2025-06-27           20
163  2025-06-28           20
169  2025-06-29           20
175  2025-06-30           20
2025-07-07 19:19:10,453 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    45
2025-06-03    45
2025-06-04    45
2025-06-05    45
2025-07-07 19:19:10,454 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    45
2025-06-27    45
2025-06-28    45
2025-06-29    45
2025-06-30    45
2025-07-07 19:19:10,455 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 19:19:10,455 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 19:19:10,457 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 19:19:10,460 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    20.25
2025-06-03    20.25
2025-06-04    20.25
2025-06-05    20.25
2025-07-07 19:19:10,461 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    20.25
2025-06-27    20.25
2025-06-28    20.25
2025-06-29    20.25
2025-06-30    20.25
2025-07-07 19:19:10,466 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 19:19:10,467 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 19:19:10,467 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:19:10,467 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:19:10,469 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:19:10,669 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:19:10,671 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:19:10,673 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:19:10,674 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 19:19:10,699 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:19:10,851 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:19:10,853 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:19:11,047 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:11,150 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:11,312 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:19:11,449 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:19:11,450 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 19:19:11,605 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:19:11,606 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 19:19:11,607 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 19:19:11,608 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 19:19:11,608 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 19:19:11,610 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 19:19:11,611 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 19:19:11,611 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 19:19:11,613 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 19:19:11,615 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 19:19:11,615 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 19:19:11,616 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 19:19:11,619 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 19:19:11,619 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 19:19:11,624 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:19:11,625 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:19:11,627 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:19:11,827 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:19:11,828 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:19:11,828 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:19:11,829 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 19:19:11,851 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:19:11,996 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:19:11,998 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:19:12,194 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:12,316 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:19:12,495 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:19:12,644 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:19:12,646 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 19:19:12,787 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:19:12,790 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 19:19:12,791 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 19:19:12,793 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 19:19:12,793 - __main__ - INFO - Script finished successfully.
2025-07-07 19:21:17,672 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 19:21:17,673 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 19:21:18,040 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 19:21:18,040 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 19:21:18,041 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:21:18,041 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:21:18,053 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:21:18,313 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:21:18,315 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:21:18,316 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:21:18,317 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:21:18,345 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:21:18,494 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:21:18,496 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:21:18,794 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:18,924 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:18,925 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 19:21:19,054 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 19:21:19,056 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 19:21:19,059 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 19:21:19,059 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 19:21:19,060 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:21:19,060 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:21:19,063 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:21:19,267 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:21:19,268 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:21:19,269 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:21:19,269 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:21:19,291 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:21:19,456 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:21:19,458 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:21:19,654 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:19,768 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:19,769 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 19:21:19,912 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 19:21:19,914 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 19:21:19,914 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 188, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 19:21:19,917 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 19:21:19,919 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 19:21:19,919 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:21:19,920 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:21:19,922 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:21:20,141 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:21:20,143 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:21:20,143 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:21:20,143 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:21:20,166 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:21:20,316 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:21:20,318 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:21:20,509 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:20,620 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:20,622 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 19:21:20,754 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 19:21:20,756 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 19:21:20,761 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 19:21:20,762 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 19:21:20,762 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:21:20,763 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:21:20,766 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:21:20,974 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:21:20,976 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:21:20,977 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:21:20,977 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:21:21,002 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:21:21,162 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:21:21,165 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:21:21,349 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:21,457 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:21,459 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 19:21:21,588 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 19:21:21,596 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 19:21:21,597 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 19:21:21,599 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 19:21:21,600 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:21:21,600 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:21:21,608 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:21:21,824 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:21:21,826 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:21:21,826 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:21:21,827 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:21:21,850 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:21:21,998 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:21:21,999 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:21:22,226 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:22,356 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:22,358 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 19:21:22,483 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 19:21:22,490 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 19:21:22,493 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 19:21:22,494 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 19:21:22,494 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:21:22,495 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:21:22,498 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:21:22,710 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:21:22,711 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:21:22,712 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:21:22,712 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:21:22,734 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:21:22,888 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:21:22,890 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:21:23,121 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:23,251 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:23,253 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 19:21:23,388 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 19:21:23,392 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 19:21:23,399 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 19:21:23,400 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 19:21:23,402 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Date                object
SKU                 object
Quantity_Shipped    object
2025-07-07 19:21:23,405 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
Series([], )
2025-07-07 19:21:23,409 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Date                object
SKU                 object
Quantity_Shipped    object
2025-07-07 19:21:23,410 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
Series([], )
2025-07-07 19:21:23,411 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 19:21:23,413 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 19:21:23,414 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 19:21:23,414 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (0, 3)
2025-07-07 19:21:23,415 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  Order Number
0  2025-06-02        660875
1  2025-06-02        660975
2  2025-06-02        661025
3  2025-06-02        660915
4  2025-06-02        660885
2025-07-07 19:21:23,416 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  Order Number
597  2025-06-30        666965
598  2025-06-30        666915
599  2025-06-30        666895
600  2025-06-30        666905
601  2025-06-30        666945
2025-07-07 19:21:23,417 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 19:21:23,419 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 19:21:23,420 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 19:21:23,420 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 19:21:23,421 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 19:21:23,422 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (11, 5)
2025-07-07 19:21:23,423 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 19:21:23,436 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 1 transactions found.
2025-07-07 19:21:23,445 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 0, Received: 478, Shipped: 0, Repack: 0, EOD: 478
2025-07-07 19:21:23,493 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 1 transactions found.
2025-07-07 19:21:23,496 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 478, Received: 576, Shipped: 0, Repack: 0, EOD: 1054
2025-07-07 19:21:23,511 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 1 transactions found.
2025-07-07 19:21:23,514 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 1054, Received: 376, Shipped: 0, Repack: 0, EOD: 1430
2025-07-07 19:21:23,543 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914              0              0
1  2025-06-01  17914            326            326
2  2025-06-01  17612            955            955
3  2025-06-01  18675            769            769
4  2025-06-01  17612              0              0
2025-07-07 19:21:23,546 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17914            326            326
176  2025-06-30  17612            955            955
177  2025-06-30  18675            769            769
178  2025-06-30  17612           1430           1430
179  2025-06-30  17904            178            178
2025-07-07 19:21:23,546 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (180, 4)
2025-07-07 19:21:23,546 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 19:21:23,547 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914              0              0
1  2025-06-01  17914            326            326
2  2025-06-01  17612            955            955
3  2025-06-01  18675            769            769
4  2025-06-01  17612              0              0
2025-07-07 19:21:23,548 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17914            326            326
176  2025-06-30  17612            955            955
177  2025-06-30  18675            769            769
178  2025-06-30  17612           1430           1430
179  2025-06-30  17904            178            178
2025-07-07 19:21:23,549 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (180, 4)
2025-07-07 19:21:23,551 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     180.000000
mean      501.344444
std       403.272997
min         0.000000
25%       178.000000
50%       326.000000
75%       769.000000
max      1430.000000
2025-07-07 19:21:23,553 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
2    2025-06-01            955
8    2025-06-02            955
14   2025-06-03            955
20   2025-06-04            955
26   2025-06-05            955
32   2025-06-06            955
38   2025-06-07            955
44   2025-06-08            955
50   2025-06-09            955
56   2025-06-10            955
62   2025-06-11            955
68   2025-06-12            955
74   2025-06-13            955
80   2025-06-14            955
86   2025-06-15            955
92   2025-06-16            955
98   2025-06-17            955
104  2025-06-18            955
110  2025-06-19            955
116  2025-06-20            955
122  2025-06-21            955
128  2025-06-22            955
134  2025-06-23            955
140  2025-06-24            955
146  2025-06-25            955
152  2025-06-26            955
158  2025-06-27            955
164  2025-06-28            955
170  2025-06-29            955
176  2025-06-30            955
2025-07-07 19:21:23,556 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
5    2025-06-01            178
11   2025-06-02            178
17   2025-06-03            178
23   2025-06-04            178
29   2025-06-05            178
35   2025-06-06            178
41   2025-06-07            178
47   2025-06-08            178
53   2025-06-09            178
59   2025-06-10            178
65   2025-06-11            178
71   2025-06-12            178
77   2025-06-13            178
83   2025-06-14            178
89   2025-06-15            178
95   2025-06-16            178
101  2025-06-17            178
107  2025-06-18            178
113  2025-06-19            178
119  2025-06-20            178
125  2025-06-21            178
131  2025-06-22            178
137  2025-06-23            178
143  2025-06-24            178
149  2025-06-25            178
155  2025-06-26            178
161  2025-06-27            178
167  2025-06-28            178
173  2025-06-29            178
179  2025-06-30            178
2025-07-07 19:21:23,563 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 19:21:23,564 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    180.000000
mean       7.500000
std        8.037969
min        0.000000
25%        0.000000
50%        4.000000
75%       17.000000
max       20.000000
2025-07-07 19:21:23,566 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
2    2025-06-01           20
8    2025-06-02           20
14   2025-06-03           20
20   2025-06-04           20
26   2025-06-05           20
32   2025-06-06           20
38   2025-06-07           20
44   2025-06-08           20
50   2025-06-09           20
56   2025-06-10           20
62   2025-06-11           20
68   2025-06-12           20
74   2025-06-13           20
80   2025-06-14           20
86   2025-06-15           20
92   2025-06-16           20
98   2025-06-17           20
104  2025-06-18           20
110  2025-06-19           20
116  2025-06-20           20
122  2025-06-21           20
128  2025-06-22           20
134  2025-06-23           20
140  2025-06-24           20
146  2025-06-25           20
152  2025-06-26           20
158  2025-06-27           20
164  2025-06-28           20
170  2025-06-29           20
176  2025-06-30           20
2025-07-07 19:21:23,567 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    45
2025-06-03    45
2025-06-04    45
2025-06-05    45
2025-07-07 19:21:23,568 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    45
2025-06-27    45
2025-06-28    45
2025-06-29    45
2025-06-30    45
2025-07-07 19:21:23,569 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 19:21:23,569 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 19:21:23,572 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 19:21:23,573 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    20.25
2025-06-03    20.25
2025-06-04    20.25
2025-06-05    20.25
2025-07-07 19:21:23,574 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    20.25
2025-06-27    20.25
2025-06-28    20.25
2025-06-29    20.25
2025-06-30    20.25
2025-07-07 19:21:23,581 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 19:21:23,581 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 19:21:23,581 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:21:23,581 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:21:23,584 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:21:23,792 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:21:23,795 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:21:23,795 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:21:23,795 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 19:21:23,816 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:21:23,977 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:21:23,979 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:21:24,159 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:24,269 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:24,433 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:21:24,578 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:21:24,580 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 19:21:24,728 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:21:24,729 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 19:21:24,730 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 19:21:24,730 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 19:21:24,731 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 19:21:24,733 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 19:21:24,734 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 19:21:24,735 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 19:21:24,736 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 19:21:24,737 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 19:21:24,737 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 19:21:24,739 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 19:21:24,742 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 19:21:24,743 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 19:21:24,748 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:21:24,749 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:21:24,752 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:21:24,959 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:21:24,961 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:21:24,962 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:21:24,962 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 19:21:24,985 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:21:25,139 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:21:25,141 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:21:25,320 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:25,427 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:21:25,565 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:21:25,706 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:21:25,708 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 19:21:25,855 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:21:25,856 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 19:21:25,857 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 19:21:25,857 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 19:21:25,858 - __main__ - INFO - Script finished successfully.
2025-07-07 19:23:49,101 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 19:23:49,101 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 19:23:49,460 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 19:23:49,461 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 19:23:49,461 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:23:49,461 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:23:49,473 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:23:49,713 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:23:49,715 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:23:49,715 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:23:49,716 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:23:49,740 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:23:49,962 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:23:49,963 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:23:50,513 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:50,637 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:50,641 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 19:23:50,773 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 19:23:50,775 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 19:23:50,777 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 19:23:50,778 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 19:23:50,778 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:23:50,778 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:23:50,780 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:23:51,014 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:23:51,017 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:23:51,017 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:23:51,018 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:23:51,047 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:23:51,185 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:23:51,186 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:23:51,385 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:51,522 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:51,524 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 19:23:51,656 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 19:23:51,659 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 19:23:51,661 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 189, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 19:23:51,664 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 19:23:51,666 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 19:23:51,667 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:23:51,667 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:23:51,669 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:23:51,931 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:23:51,933 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:23:51,934 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:23:51,934 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:23:51,963 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:23:52,147 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:23:52,150 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:23:52,339 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:52,473 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:52,476 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 19:23:52,614 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 19:23:52,616 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 19:23:52,620 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 19:23:52,620 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 19:23:52,621 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:23:52,621 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:23:52,625 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:23:52,868 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:23:52,869 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:23:52,870 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:23:52,870 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:23:52,894 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:23:53,063 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:23:53,066 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:23:53,301 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:53,419 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:53,421 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 19:23:53,568 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 19:23:53,577 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 19:23:53,578 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 19:23:53,579 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 19:23:53,579 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:23:53,580 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:23:53,582 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:23:53,777 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:23:53,779 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:23:53,780 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:23:53,781 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:23:53,806 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:23:53,977 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:23:53,979 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:23:54,182 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:54,302 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:54,305 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 19:23:54,437 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 19:23:54,440 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 19:23:54,445 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 19:23:54,445 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 19:23:54,446 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:23:54,446 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:23:54,448 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:23:54,657 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:23:54,660 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:23:54,660 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:23:54,661 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:23:54,682 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:23:54,851 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:23:54,853 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:23:55,043 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:55,160 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:55,162 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 19:23:55,296 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 19:23:55,297 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 19:23:55,303 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 19:23:55,303 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 19:23:55,305 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Date                object
SKU                 object
Quantity_Shipped    object
2025-07-07 19:23:55,306 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
Series([], )
2025-07-07 19:23:55,308 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Date                object
SKU                 object
Quantity_Shipped    object
2025-07-07 19:23:55,308 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
Series([], )
2025-07-07 19:23:55,309 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 19:23:55,312 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 19:23:55,313 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 19:23:55,313 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (0, 3)
2025-07-07 19:23:55,314 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  Order Number
0  2025-06-02        660875
1  2025-06-02        660975
2  2025-06-02        661025
3  2025-06-02        660915
4  2025-06-02        660885
2025-07-07 19:23:55,315 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  Order Number
597  2025-06-30        666965
598  2025-06-30        666915
599  2025-06-30        666895
600  2025-06-30        666905
601  2025-06-30        666945
2025-07-07 19:23:55,316 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 19:23:55,318 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 19:23:55,318 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 19:23:55,319 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 19:23:55,319 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 19:23:55,319 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (11, 5)
2025-07-07 19:23:55,322 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 19:23:55,337 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 1 transactions found.
2025-07-07 19:23:55,343 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 0, Received: 478, Shipped: 0, Repack: 0, EOD: 478
2025-07-07 19:23:55,397 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 1 transactions found.
2025-07-07 19:23:55,401 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 478, Received: 576, Shipped: 0, Repack: 0, EOD: 1054
2025-07-07 19:23:55,414 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 1 transactions found.
2025-07-07 19:23:55,418 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 1054, Received: 376, Shipped: 0, Repack: 0, EOD: 1430
2025-07-07 19:23:55,444 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914              0              0
1  2025-06-01  17914            326            326
2  2025-06-01  18675            769            769
3  2025-06-01  17904            178            178
4  2025-06-01  17612              0              0
2025-07-07 19:23:55,446 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17914            326            326
176  2025-06-30  18675            769            769
177  2025-06-30  17904            178            178
178  2025-06-30  17612           1430           1430
179  2025-06-30  17612            955            955
2025-07-07 19:23:55,446 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (180, 4)
2025-07-07 19:23:55,447 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 19:23:55,448 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914              0              0
1  2025-06-01  17914            326            326
2  2025-06-01  18675            769            769
3  2025-06-01  17904            178            178
4  2025-06-01  17612              0              0
2025-07-07 19:23:55,449 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17914            326            326
176  2025-06-30  18675            769            769
177  2025-06-30  17904            178            178
178  2025-06-30  17612           1430           1430
179  2025-06-30  17612            955            955
2025-07-07 19:23:55,449 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (180, 4)
2025-07-07 19:23:55,451 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     180.000000
mean      501.344444
std       403.272997
min         0.000000
25%       178.000000
50%       326.000000
75%       769.000000
max      1430.000000
2025-07-07 19:23:55,452 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
5    2025-06-01            955
11   2025-06-02            955
17   2025-06-03            955
23   2025-06-04            955
29   2025-06-05            955
35   2025-06-06            955
41   2025-06-07            955
47   2025-06-08            955
53   2025-06-09            955
59   2025-06-10            955
65   2025-06-11            955
71   2025-06-12            955
77   2025-06-13            955
83   2025-06-14            955
89   2025-06-15            955
95   2025-06-16            955
101  2025-06-17            955
107  2025-06-18            955
113  2025-06-19            955
119  2025-06-20            955
125  2025-06-21            955
131  2025-06-22            955
137  2025-06-23            955
143  2025-06-24            955
149  2025-06-25            955
155  2025-06-26            955
161  2025-06-27            955
167  2025-06-28            955
173  2025-06-29            955
179  2025-06-30            955
2025-07-07 19:23:55,456 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
3    2025-06-01            178
9    2025-06-02            178
15   2025-06-03            178
21   2025-06-04            178
27   2025-06-05            178
33   2025-06-06            178
39   2025-06-07            178
45   2025-06-08            178
51   2025-06-09            178
57   2025-06-10            178
63   2025-06-11            178
69   2025-06-12            178
75   2025-06-13            178
81   2025-06-14            178
87   2025-06-15            178
93   2025-06-16            178
99   2025-06-17            178
105  2025-06-18            178
111  2025-06-19            178
117  2025-06-20            178
123  2025-06-21            178
129  2025-06-22            178
135  2025-06-23            178
141  2025-06-24            178
147  2025-06-25            178
153  2025-06-26            178
159  2025-06-27            178
165  2025-06-28            178
171  2025-06-29            178
177  2025-06-30            178
2025-07-07 19:23:55,463 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 19:23:55,465 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    180.000000
mean       7.500000
std        8.037969
min        0.000000
25%        0.000000
50%        4.000000
75%       17.000000
max       20.000000
2025-07-07 19:23:55,466 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
5    2025-06-01           20
11   2025-06-02           20
17   2025-06-03           20
23   2025-06-04           20
29   2025-06-05           20
35   2025-06-06           20
41   2025-06-07           20
47   2025-06-08           20
53   2025-06-09           20
59   2025-06-10           20
65   2025-06-11           20
71   2025-06-12           20
77   2025-06-13           20
83   2025-06-14           20
89   2025-06-15           20
95   2025-06-16           20
101  2025-06-17           20
107  2025-06-18           20
113  2025-06-19           20
119  2025-06-20           20
125  2025-06-21           20
131  2025-06-22           20
137  2025-06-23           20
143  2025-06-24           20
149  2025-06-25           20
155  2025-06-26           20
161  2025-06-27           20
167  2025-06-28           20
173  2025-06-29           20
179  2025-06-30           20
2025-07-07 19:23:55,468 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    45
2025-06-03    45
2025-06-04    45
2025-06-05    45
2025-07-07 19:23:55,468 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    45
2025-06-27    45
2025-06-28    45
2025-06-29    45
2025-06-30    45
2025-07-07 19:23:55,469 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 19:23:55,469 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 19:23:55,472 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 19:23:55,475 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    20.25
2025-06-03    20.25
2025-06-04    20.25
2025-06-05    20.25
2025-07-07 19:23:55,478 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    20.25
2025-06-27    20.25
2025-06-28    20.25
2025-06-29    20.25
2025-06-30    20.25
2025-07-07 19:23:55,484 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 19:23:55,484 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 19:23:55,485 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:23:55,485 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:23:55,488 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:23:55,697 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:23:55,698 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:23:55,700 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:23:55,700 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 19:23:55,725 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:23:55,888 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:23:55,890 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:23:56,080 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:56,216 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:56,375 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:23:56,524 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:23:56,526 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 19:23:56,713 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:23:56,714 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 19:23:56,715 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 19:23:56,718 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 19:23:56,720 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 19:23:56,728 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 19:23:56,728 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 19:23:56,730 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 19:23:56,732 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 19:23:56,737 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 19:23:56,738 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 19:23:56,740 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 19:23:56,749 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 19:23:56,750 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 19:23:56,754 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:23:56,755 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:23:56,760 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:23:56,987 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:23:56,990 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:23:56,992 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:23:56,993 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 19:23:57,039 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:23:57,201 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:23:57,204 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:23:57,394 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:57,507 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:23:57,653 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:23:57,827 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:23:57,828 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 19:23:57,968 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:23:57,971 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 19:23:57,973 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 19:23:57,974 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 19:23:57,975 - __main__ - INFO - Script finished successfully.
2025-07-07 19:30:33,941 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 19:30:33,941 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 19:30:34,301 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 19:30:34,302 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 19:30:34,302 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:30:34,302 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:30:34,316 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:30:34,578 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:30:34,580 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:30:34,581 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:30:34,581 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:30:34,607 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:30:34,770 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:30:34,772 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:30:35,341 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:35,453 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:35,455 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 19:30:35,579 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 19:30:35,580 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 19:30:35,582 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 19:30:35,583 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 19:30:35,583 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:30:35,583 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:30:35,585 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:30:35,807 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:30:35,809 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:30:35,810 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:30:35,811 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:30:35,834 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:30:35,989 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:30:35,990 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:30:36,187 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:36,324 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:36,325 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 19:30:36,458 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 19:30:36,460 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 19:30:36,461 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 199, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 19:30:36,463 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 19:30:36,466 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 19:30:36,466 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:30:36,467 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:30:36,470 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:30:36,744 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:30:36,747 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:30:36,749 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:30:36,753 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:30:36,809 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:30:36,954 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:30:36,957 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:30:37,140 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:37,245 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:37,247 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 19:30:37,370 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 19:30:37,372 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 19:30:37,374 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 19:30:37,374 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 19:30:37,380 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 19:30:37,381 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 19:30:37,381 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 19:30:37,382 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:30:37,382 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:30:37,391 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:30:37,620 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:30:37,622 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:30:37,623 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:30:37,623 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:30:37,645 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:30:37,798 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:30:37,800 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:30:37,985 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:38,091 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:38,092 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 19:30:38,222 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 19:30:38,228 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 19:30:38,229 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'Quantity Shipped' column in Shipped_Items_Data. Cannot process shipment quantities.
2025-07-07 19:30:38,229 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 19:30:38,230 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:30:38,231 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:30:38,233 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:30:38,443 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:30:38,445 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:30:38,446 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:30:38,447 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:30:38,468 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:30:38,620 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:30:38,622 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:30:38,894 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:39,003 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:39,005 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 19:30:39,133 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 19:30:39,139 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 19:30:39,143 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 19:30:39,143 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 19:30:39,144 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:30:39,144 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:30:39,148 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:30:39,361 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:30:39,363 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:30:39,364 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:30:39,364 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:30:39,387 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:30:39,533 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:30:39,534 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:30:39,709 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:39,815 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:39,817 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 19:30:39,979 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 19:30:39,980 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 19:30:39,986 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 19:30:39,986 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 19:30:39,988 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Date                object
SKU                 object
Quantity_Shipped    object
2025-07-07 19:30:39,988 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
Series([], )
2025-07-07 19:30:39,990 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Date                object
SKU                 object
Quantity_Shipped    object
2025-07-07 19:30:39,991 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
Series([], )
2025-07-07 19:30:39,991 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 19:30:39,993 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 19:30:39,994 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
Empty DataFrame
Columns: [Date, SKU, Quantity_Shipped]
Index: []
2025-07-07 19:30:39,995 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (0, 3)
2025-07-07 19:30:39,995 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  Order Number
0  2025-06-02        660875
1  2025-06-02        660975
2  2025-06-02        661025
3  2025-06-02        660915
4  2025-06-02        660885
2025-07-07 19:30:39,998 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  Order Number
597  2025-06-30        666965
598  2025-06-30        666915
599  2025-06-30        666895
600  2025-06-30        666905
601  2025-06-30        666945
2025-07-07 19:30:40,000 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 19:30:40,002 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 19:30:40,003 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 19:30:40,003 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 19:30:40,004 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 19:30:40,004 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (11, 5)
2025-07-07 19:30:40,005 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 19:30:40,018 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 1 transactions found.
2025-07-07 19:30:40,023 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 0, Received: 478, Shipped: 0, Repack: 0, EOD: 478
2025-07-07 19:30:40,075 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 1 transactions found.
2025-07-07 19:30:40,079 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 478, Received: 576, Shipped: 0, Repack: 0, EOD: 1054
2025-07-07 19:30:40,094 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 1 transactions found.
2025-07-07 19:30:40,100 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 1054, Received: 376, Shipped: 0, Repack: 0, EOD: 1430
2025-07-07 19:30:40,131 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914            326            326
1  2025-06-01  17904            178            178
2  2025-06-01  17612            955            955
3  2025-06-01  17914              0              0
4  2025-06-01  17612              0              0
2025-07-07 19:30:40,132 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17904            178            178
176  2025-06-30  17612            955            955
177  2025-06-30  17914              0              0
178  2025-06-30  17612           1430           1430
179  2025-06-30  18675            769            769
2025-07-07 19:30:40,132 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (180, 4)
2025-07-07 19:30:40,133 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 19:30:40,134 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17914            326            326
1  2025-06-01  17904            178            178
2  2025-06-01  17612            955            955
3  2025-06-01  17914              0              0
4  2025-06-01  17612              0              0
2025-07-07 19:30:40,135 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
175  2025-06-30  17904            178            178
176  2025-06-30  17612            955            955
177  2025-06-30  17914              0              0
178  2025-06-30  17612           1430           1430
179  2025-06-30  18675            769            769
2025-07-07 19:30:40,135 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (180, 4)
2025-07-07 19:30:40,138 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     180.000000
mean      501.344444
std       403.272997
min         0.000000
25%       178.000000
50%       326.000000
75%       769.000000
max      1430.000000
2025-07-07 19:30:40,140 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
2    2025-06-01            955
8    2025-06-02            955
14   2025-06-03            955
20   2025-06-04            955
26   2025-06-05            955
32   2025-06-06            955
38   2025-06-07            955
44   2025-06-08            955
50   2025-06-09            955
56   2025-06-10            955
62   2025-06-11            955
68   2025-06-12            955
74   2025-06-13            955
80   2025-06-14            955
86   2025-06-15            955
92   2025-06-16            955
98   2025-06-17            955
104  2025-06-18            955
110  2025-06-19            955
116  2025-06-20            955
122  2025-06-21            955
128  2025-06-22            955
134  2025-06-23            955
140  2025-06-24            955
146  2025-06-25            955
152  2025-06-26            955
158  2025-06-27            955
164  2025-06-28            955
170  2025-06-29            955
176  2025-06-30            955
2025-07-07 19:30:40,143 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            178
7    2025-06-02            178
13   2025-06-03            178
19   2025-06-04            178
25   2025-06-05            178
31   2025-06-06            178
37   2025-06-07            178
43   2025-06-08            178
49   2025-06-09            178
55   2025-06-10            178
61   2025-06-11            178
67   2025-06-12            178
73   2025-06-13            178
79   2025-06-14            178
85   2025-06-15            178
91   2025-06-16            178
97   2025-06-17            178
103  2025-06-18            178
109  2025-06-19            178
115  2025-06-20            178
121  2025-06-21            178
127  2025-06-22            178
133  2025-06-23            178
139  2025-06-24            178
145  2025-06-25            178
151  2025-06-26            178
157  2025-06-27            178
163  2025-06-28            178
169  2025-06-29            178
175  2025-06-30            178
2025-07-07 19:30:40,148 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 19:30:40,150 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    180.000000
mean       7.500000
std        8.037969
min        0.000000
25%        0.000000
50%        4.000000
75%       17.000000
max       20.000000
2025-07-07 19:30:40,152 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
2    2025-06-01           20
8    2025-06-02           20
14   2025-06-03           20
20   2025-06-04           20
26   2025-06-05           20
32   2025-06-06           20
38   2025-06-07           20
44   2025-06-08           20
50   2025-06-09           20
56   2025-06-10           20
62   2025-06-11           20
68   2025-06-12           20
74   2025-06-13           20
80   2025-06-14           20
86   2025-06-15           20
92   2025-06-16           20
98   2025-06-17           20
104  2025-06-18           20
110  2025-06-19           20
116  2025-06-20           20
122  2025-06-21           20
128  2025-06-22           20
134  2025-06-23           20
140  2025-06-24           20
146  2025-06-25           20
152  2025-06-26           20
158  2025-06-27           20
164  2025-06-28           20
170  2025-06-29           20
176  2025-06-30           20
2025-07-07 19:30:40,153 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    45
2025-06-03    45
2025-06-04    45
2025-06-05    45
2025-07-07 19:30:40,154 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    45
2025-06-27    45
2025-06-28    45
2025-06-29    45
2025-06-30    45
2025-07-07 19:30:40,156 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 19:30:40,156 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 19:30:40,160 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 19:30:40,161 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    20.25
2025-06-03    20.25
2025-06-04    20.25
2025-06-05    20.25
2025-07-07 19:30:40,162 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    20.25
2025-06-27    20.25
2025-06-28    20.25
2025-06-29    20.25
2025-06-30    20.25
2025-07-07 19:30:40,169 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 19:30:40,169 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 19:30:40,170 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:30:40,171 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:30:40,173 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:30:40,377 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:30:40,378 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:30:40,379 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:30:40,380 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 19:30:40,402 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:30:40,552 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:30:40,556 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:30:40,738 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:40,849 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:41,477 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:30:41,621 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:30:41,623 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 19:30:41,772 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:30:41,774 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 19:30:41,775 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 19:30:41,778 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 19:30:41,779 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 19:30:41,791 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 19:30:41,792 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 19:30:41,794 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 19:30:41,795 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 19:30:41,800 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 19:30:41,802 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 19:30:41,805 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 19:30:41,814 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 19:30:41,815 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 19:30:41,824 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:30:41,825 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:30:41,830 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:30:42,064 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:30:42,067 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:30:42,073 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:30:42,079 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 19:30:42,128 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:30:42,288 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:30:42,291 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:30:42,497 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:42,618 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:30:42,770 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:30:42,904 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:30:42,906 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 19:30:43,071 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:30:43,074 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 19:30:43,075 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 19:30:43,081 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 19:30:43,085 - __main__ - INFO - Script finished successfully.
2025-07-07 19:37:58,444 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 19:37:58,446 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 19:37:58,996 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 19:37:58,996 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 19:37:58,997 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:37:58,997 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:37:59,009 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:37:59,290 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:37:59,292 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:37:59,292 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:37:59,293 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:37:59,328 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:37:59,527 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:37:59,532 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:37:59,968 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:00,073 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:00,074 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 19:38:00,209 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 19:38:00,217 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 19:38:00,232 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 19:38:00,233 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 19:38:00,234 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:38:00,235 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:38:00,241 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:38:00,527 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:38:00,529 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:38:00,529 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:38:00,530 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:38:00,559 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:38:00,716 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:38:00,718 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:38:00,925 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:01,030 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:01,032 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 19:38:01,168 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 19:38:01,170 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 19:38:01,171 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 199, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 19:38:01,176 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 19:38:01,179 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 19:38:01,180 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:38:01,181 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:38:01,188 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:38:01,405 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:38:01,407 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:38:01,408 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:38:01,408 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:38:01,430 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:38:01,587 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:38:01,589 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:38:01,768 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:01,872 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:01,874 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 19:38:02,000 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 19:38:02,008 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 19:38:02,010 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 19:38:02,012 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 19:38:02,026 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 19:38:02,028 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 19:38:02,029 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 19:38:02,029 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:38:02,029 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:38:02,031 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:38:02,245 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:38:02,248 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:38:02,249 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:38:02,250 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:38:02,273 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:38:02,427 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:38:02,429 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:38:02,643 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:02,756 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:02,757 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 19:38:02,882 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 19:38:02,888 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 19:38:02,891 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
Base SKU            object
Quantity_Shipped     int64
2025-07-07 19:38:02,892 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Ship Date' column head BEFORE conversion (if exists):
0    6/2/2025
1    6/2/2025
2    6/2/2025
3    6/2/2025
4    6/2/2025
2025-07-07 19:38:02,893 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head BEFORE conversion (if exists):
Series([], )
2025-07-07 19:38:02,897 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 19:38:02,898 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 19:38:02,899 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 19:38:02,899 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:38:02,900 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:38:02,903 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:38:03,113 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:38:03,115 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:38:03,115 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:38:03,116 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:38:03,138 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:38:03,285 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:38:03,288 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:38:03,497 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:03,607 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:03,609 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 19:38:03,748 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 19:38:03,757 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 19:38:03,763 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 19:38:03,763 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 19:38:03,763 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:38:03,765 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:38:03,774 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:38:03,996 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:38:03,998 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:38:03,998 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:38:03,999 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:38:04,027 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:38:04,172 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:38:04,174 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:38:04,378 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:04,485 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:04,487 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 19:38:04,614 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 19:38:04,615 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 19:38:04,625 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 19:38:04,626 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 19:38:04,631 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 19:38:04,632 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 19:38:04,637 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 19:38:04,638 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 19:38:04,639 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 19:38:04,643 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 19:38:04,645 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 19:38:04,646 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 19:38:04,648 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
         Date  Order Number
0  2025-06-02        660875
1  2025-06-02        660975
2  2025-06-02        661025
3  2025-06-02        660915
4  2025-06-02        660885
2025-07-07 19:38:04,649 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
           Date  Order Number
597  2025-06-30        666965
598  2025-06-30        666915
599  2025-06-30        666895
600  2025-06-30        666905
601  2025-06-30        666945
2025-07-07 19:38:04,650 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 2)
2025-07-07 19:38:04,652 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 19:38:04,653 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 19:38:04,653 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 19:38:04,653 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 19:38:04,653 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 19:38:04,655 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 19:38:04,662 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 19:38:04,664 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 0, Received: 0, Shipped: 71, Repack: 0, EOD: -71
2025-07-07 19:38:04,666 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 0, Received: 0, Shipped: 2, Repack: 0, EOD: -2
2025-07-07 19:38:04,669 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 0, Received: 0, Shipped: 1, Repack: 0, EOD: -1
2025-07-07 19:38:04,675 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 0, Received: 0, Shipped: 3, Repack: 0, EOD: -3
2025-07-07 19:38:04,677 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 19:38:04,680 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: -71, Received: 0, Shipped: 94, Repack: 0, EOD: -165
2025-07-07 19:38:04,681 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: -2, Received: 0, Shipped: 13, Repack: 0, EOD: -15
2025-07-07 19:38:04,688 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: -3, Received: 0, Shipped: 6, Repack: 0, EOD: -9
2025-07-07 19:38:04,691 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 19:38:04,692 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: -165, Received: 478, Shipped: 119, Repack: 0, EOD: 194
2025-07-07 19:38:04,694 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: -15, Received: 0, Shipped: 7, Repack: 0, EOD: -22
2025-07-07 19:38:04,705 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: -9, Received: 0, Shipped: 7, Repack: 0, EOD: -16
2025-07-07 19:38:04,710 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 19:38:04,712 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 194, Received: 0, Shipped: 296, Repack: 0, EOD: -102
2025-07-07 19:38:04,715 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: -22, Received: 0, Shipped: 1, Repack: 0, EOD: -23
2025-07-07 19:38:04,724 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: -16, Received: 0, Shipped: 7, Repack: 0, EOD: -23
2025-07-07 19:38:04,730 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 19:38:04,733 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: -102, Received: 0, Shipped: 117, Repack: 0, EOD: -219
2025-07-07 19:38:04,740 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: -23, Received: 0, Shipped: 2, Repack: 0, EOD: -25
2025-07-07 19:38:04,744 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: -1, Received: 0, Shipped: 1, Repack: 0, EOD: -2
2025-07-07 19:38:04,747 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: -23, Received: 0, Shipped: 1, Repack: 0, EOD: -24
2025-07-07 19:38:04,775 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 19:38:04,777 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: -219, Received: 0, Shipped: 47, Repack: 0, EOD: -266
2025-07-07 19:38:04,778 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: -25, Received: 0, Shipped: 2, Repack: 0, EOD: -27
2025-07-07 19:38:04,779 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: -2, Received: 0, Shipped: 1, Repack: 0, EOD: -3
2025-07-07 19:38:04,780 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: -24, Received: 0, Shipped: 3, Repack: 0, EOD: -27
2025-07-07 19:38:04,783 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 19:38:04,786 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: -266, Received: 0, Shipped: 87, Repack: 0, EOD: -353
2025-07-07 19:38:04,791 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: -27, Received: 0, Shipped: 3, Repack: 0, EOD: -30
2025-07-07 19:38:04,793 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 19:38:04,795 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: -353, Received: 0, Shipped: 67, Repack: 0, EOD: -420
2025-07-07 19:38:04,796 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: -27, Received: 0, Shipped: 1, Repack: 0, EOD: -28
2025-07-07 19:38:04,797 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: -3, Received: 0, Shipped: 1, Repack: 0, EOD: -4
2025-07-07 19:38:04,799 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: -30, Received: 0, Shipped: 3, Repack: 0, EOD: -33
2025-07-07 19:38:04,801 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 19:38:04,805 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: -420, Received: 0, Shipped: 234, Repack: 0, EOD: -654
2025-07-07 19:38:04,806 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: -28, Received: 0, Shipped: 14, Repack: 0, EOD: -42
2025-07-07 19:38:04,808 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: -33, Received: 0, Shipped: 11, Repack: 0, EOD: -44
2025-07-07 19:38:04,811 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 19:38:04,812 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: -654, Received: 0, Shipped: 83, Repack: 0, EOD: -737
2025-07-07 19:38:04,813 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: -42, Received: 0, Shipped: 1, Repack: 0, EOD: -43
2025-07-07 19:38:04,815 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: -44, Received: 0, Shipped: 12, Repack: 0, EOD: -56
2025-07-07 19:38:04,832 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 19:38:04,834 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: -737, Received: 0, Shipped: 164, Repack: 0, EOD: -901
2025-07-07 19:38:04,837 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: -43, Received: 0, Shipped: 2, Repack: 0, EOD: -45
2025-07-07 19:38:04,839 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: -4, Received: 0, Shipped: 3, Repack: 0, EOD: -7
2025-07-07 19:38:04,842 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: -56, Received: 0, Shipped: 3, Repack: 0, EOD: -59
2025-07-07 19:38:04,844 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 19:38:04,845 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: -901, Received: 0, Shipped: 56, Repack: 0, EOD: -957
2025-07-07 19:38:04,846 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: -45, Received: 0, Shipped: 1, Repack: 0, EOD: -46
2025-07-07 19:38:04,847 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: -7, Received: 0, Shipped: 12, Repack: 0, EOD: -19
2025-07-07 19:38:04,849 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: -59, Received: 0, Shipped: 11, Repack: 0, EOD: -70
2025-07-07 19:38:04,854 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 19:38:04,856 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -957, Received: 576, Shipped: 57, Repack: 0, EOD: -438
2025-07-07 19:38:04,857 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: -46, Received: 0, Shipped: 1, Repack: 0, EOD: -47
2025-07-07 19:38:04,859 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: -70, Received: 0, Shipped: 1, Repack: 0, EOD: -71
2025-07-07 19:38:04,862 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 19:38:04,863 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: -438, Received: 0, Shipped: 47, Repack: 0, EOD: -485
2025-07-07 19:38:04,864 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: -47, Received: 0, Shipped: 2, Repack: 0, EOD: -49
2025-07-07 19:38:04,866 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: -71, Received: 0, Shipped: 7, Repack: 0, EOD: -78
2025-07-07 19:38:04,869 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 19:38:04,873 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: -485, Received: 0, Shipped: 76, Repack: 0, EOD: -561
2025-07-07 19:38:04,874 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: -49, Received: 0, Shipped: 1, Repack: 0, EOD: -50
2025-07-07 19:38:04,875 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: -19, Received: 0, Shipped: 1, Repack: 0, EOD: -20
2025-07-07 19:38:04,876 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: -78, Received: 0, Shipped: 5, Repack: 0, EOD: -83
2025-07-07 19:38:04,891 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 19:38:04,893 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: -561, Received: 376, Shipped: 21, Repack: 0, EOD: -206
2025-07-07 19:38:04,894 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: -50, Received: 0, Shipped: 6, Repack: 0, EOD: -56
2025-07-07 19:38:04,900 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 19:38:04,902 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: -206, Received: 0, Shipped: 42, Repack: 0, EOD: -248
2025-07-07 19:38:04,905 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: -56, Received: 0, Shipped: 1, Repack: 0, EOD: -57
2025-07-07 19:38:04,908 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: -83, Received: 0, Shipped: 1, Repack: 0, EOD: -84
2025-07-07 19:38:04,911 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 19:38:04,912 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: -248, Received: 0, Shipped: 173, Repack: 0, EOD: -421
2025-07-07 19:38:04,914 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: -57, Received: 0, Shipped: 1, Repack: 0, EOD: -58
2025-07-07 19:38:04,916 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: -84, Received: 0, Shipped: 4, Repack: 0, EOD: -88
2025-07-07 19:38:04,919 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 19:38:04,922 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: -421, Received: 0, Shipped: 60, Repack: 0, EOD: -481
2025-07-07 19:38:04,923 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: -58, Received: 0, Shipped: 2, Repack: 0, EOD: -60
2025-07-07 19:38:04,925 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: -88, Received: 0, Shipped: 9, Repack: 0, EOD: -97
2025-07-07 19:38:04,927 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 19:38:04,928 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: -481, Received: 0, Shipped: 51, Repack: 0, EOD: -532
2025-07-07 19:38:04,929 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: -60, Received: 0, Shipped: 3, Repack: 0, EOD: -63
2025-07-07 19:38:04,931 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: -97, Received: 0, Shipped: 6, Repack: 0, EOD: -103
2025-07-07 19:38:04,944 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 19:38:04,946 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: -532, Received: 0, Shipped: 84, Repack: 0, EOD: -616
2025-07-07 19:38:04,947 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: -63, Received: 0, Shipped: 3, Repack: 0, EOD: -66
2025-07-07 19:38:04,950 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: -103, Received: 0, Shipped: 1, Repack: 0, EOD: -104
2025-07-07 19:38:04,958 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612              0              0
1  2025-06-01  17904              0              0
2  2025-06-01  18675              0              0
3  2025-06-01  17904            178            178
4  2025-06-01  17914              0              0
2025-07-07 19:38:04,959 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17904            178            178
236  2025-06-30  17914           -103           -104
237  2025-06-30  17612            955            955
238  2025-06-30  17914            326            326
239  2025-06-30  18675            769            769
2025-07-07 19:38:04,960 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 19:38:04,960 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 19:38:04,961 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612              0              0
1  2025-06-01  17904              0              0
2  2025-06-01  18675              0              0
3  2025-06-01  17904            178            178
4  2025-06-01  17914              0              0
2025-07-07 19:38:04,962 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17904            178            178
236  2025-06-30  17914           -103           -104
237  2025-06-30  17612            955            955
238  2025-06-30  17914            326            326
239  2025-06-30  18675            769            769
2025-07-07 19:38:04,963 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 19:38:04,971 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     211.887500
std      439.442172
min     -957.000000
25%      -45.250000
50%      178.000000
75%      436.750000
max      955.000000
2025-07-07 19:38:04,974 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
5    2025-06-01            955
13   2025-06-02            955
21   2025-06-03            955
29   2025-06-04            955
37   2025-06-05            955
45   2025-06-06            955
53   2025-06-07            955
61   2025-06-08            955
69   2025-06-09            955
77   2025-06-10            955
85   2025-06-11            955
93   2025-06-12            955
101  2025-06-13            955
109  2025-06-14            955
117  2025-06-15            955
125  2025-06-16            955
133  2025-06-17            955
141  2025-06-18            955
149  2025-06-19            955
157  2025-06-20            955
165  2025-06-21            955
173  2025-06-22            955
181  2025-06-23            955
189  2025-06-24            955
197  2025-06-25            955
205  2025-06-26            955
213  2025-06-27            955
221  2025-06-28            955
229  2025-06-29            955
237  2025-06-30            955
2025-07-07 19:38:04,976 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
3    2025-06-01            178
11   2025-06-02            178
19   2025-06-03            178
27   2025-06-04            178
35   2025-06-05            178
43   2025-06-06            178
51   2025-06-07            178
59   2025-06-08            178
67   2025-06-09            178
75   2025-06-10            178
83   2025-06-11            178
91   2025-06-12            178
99   2025-06-13            178
107  2025-06-14            178
115  2025-06-15            178
123  2025-06-16            178
131  2025-06-17            178
139  2025-06-18            178
147  2025-06-19            178
155  2025-06-20            178
163  2025-06-21            178
171  2025-06-22            178
179  2025-06-23            178
187  2025-06-24            178
195  2025-06-25            178
203  2025-06-26            178
211  2025-06-27            178
219  2025-06-28            178
227  2025-06-29            178
235  2025-06-30            178
2025-07-07 19:38:04,993 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 19:38:04,995 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       5.625000
std        7.679852
min        0.000000
25%        0.000000
50%        1.500000
75%        8.000000
max       20.000000
2025-07-07 19:38:04,997 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
5    2025-06-01           20
13   2025-06-02           20
21   2025-06-03           20
29   2025-06-04           20
37   2025-06-05           20
45   2025-06-06           20
53   2025-06-07           20
61   2025-06-08           20
69   2025-06-09           20
77   2025-06-10           20
85   2025-06-11           20
93   2025-06-12           20
101  2025-06-13           20
109  2025-06-14           20
117  2025-06-15           20
125  2025-06-16           20
133  2025-06-17           20
141  2025-06-18           20
149  2025-06-19           20
157  2025-06-20           20
165  2025-06-21           20
173  2025-06-22           20
181  2025-06-23           20
189  2025-06-24           20
197  2025-06-25           20
205  2025-06-26           20
213  2025-06-27           20
221  2025-06-28           20
229  2025-06-29           20
237  2025-06-30           20
2025-07-07 19:38:04,999 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    45
2025-06-03    45
2025-06-04    45
2025-06-05    45
2025-07-07 19:38:04,999 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    45
2025-06-27    45
2025-06-28    45
2025-06-29    45
2025-06-30    45
2025-07-07 19:38:05,000 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 19:38:05,000 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 19:38:05,005 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 19:38:05,006 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    20.25
2025-06-03    20.25
2025-06-04    20.25
2025-06-05    20.25
2025-07-07 19:38:05,007 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    20.25
2025-06-27    20.25
2025-06-28    20.25
2025-06-29    20.25
2025-06-30    20.25
2025-07-07 19:38:05,016 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 19:38:05,017 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 19:38:05,018 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:38:05,021 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:38:05,024 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:38:05,240 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:38:05,241 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:38:05,242 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:38:05,242 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 19:38:05,267 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:38:05,412 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:38:05,421 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:38:05,614 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:05,733 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:05,878 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:38:06,013 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:38:06,017 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 19:38:06,175 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:38:06,177 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 19:38:06,178 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 19:38:06,180 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 19:38:06,181 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 19:38:06,264 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 19:38:06,265 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 19:38:06,266 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 19:38:06,268 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 19:38:06,272 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 19:38:06,277 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 19:38:06,280 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 19:38:06,289 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 19:38:06,291 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 19:38:06,300 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:38:06,301 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:38:06,308 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:38:06,555 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:38:06,557 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:38:06,559 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:38:06,560 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 19:38:06,634 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:38:06,781 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:38:06,784 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:38:06,987 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:07,097 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:38:07,399 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:38:07,528 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:38:07,530 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 19:38:07,672 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:38:07,674 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 19:38:07,675 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 19:38:07,677 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 19:38:07,678 - __main__ - INFO - Script finished successfully.
2025-07-07 19:47:29,673 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 19:47:29,674 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 19:47:30,061 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 19:47:30,061 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 19:47:30,061 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:47:30,063 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:47:30,074 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:47:30,348 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:47:30,350 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:47:30,350 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:47:30,351 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:47:30,378 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:47:30,566 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:47:30,570 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:47:30,860 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:30,970 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:30,971 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 19:47:31,103 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 19:47:31,109 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 19:47:31,123 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 19:47:31,124 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 19:47:31,125 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:47:31,125 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:47:31,129 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:47:31,353 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:47:31,354 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:47:31,355 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:47:31,355 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:47:31,385 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:47:31,532 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:47:31,535 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:47:31,729 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:31,855 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:31,857 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 19:47:31,984 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 19:47:31,985 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 19:47:31,986 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 199, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 19:47:31,993 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 19:47:31,996 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 19:47:31,996 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:47:31,997 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:47:32,001 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:47:32,197 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:47:32,201 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:47:32,203 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:47:32,205 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:47:32,239 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:47:32,390 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:47:32,393 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:47:32,579 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:32,697 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:32,698 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 19:47:32,836 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 19:47:32,841 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 19:47:32,843 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 19:47:32,844 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 19:47:32,857 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 19:47:32,862 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 19:47:32,862 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 19:47:32,862 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:47:32,862 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:47:32,865 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:47:33,073 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:47:33,075 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:47:33,075 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:47:33,076 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:47:33,100 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:47:33,249 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:47:33,251 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:47:33,459 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:33,573 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:33,574 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 19:47:33,704 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 19:47:33,710 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 19:47:33,713 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
Base SKU            object
Quantity_Shipped     int64
2025-07-07 19:47:33,714 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Ship Date' column head BEFORE conversion (if exists):
0    6/2/2025
1    6/2/2025
2    6/2/2025
3    6/2/2025
4    6/2/2025
2025-07-07 19:47:33,714 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head BEFORE conversion (if exists):
Series([], )
2025-07-07 19:47:33,721 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 19:47:33,724 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 19:47:33,724 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 19:47:33,725 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:47:33,725 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:47:33,728 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:47:33,942 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:47:33,944 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:47:33,945 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:47:33,946 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:47:33,979 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:47:34,134 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:47:34,136 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:47:34,325 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:34,449 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:34,450 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 19:47:34,593 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 19:47:34,596 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 19:47:34,600 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 19:47:34,601 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 19:47:34,601 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:47:34,601 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:47:34,604 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:47:34,846 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:47:34,850 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:47:34,850 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:47:34,850 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 19:47:34,881 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:47:35,035 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:47:35,037 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:47:35,220 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:35,336 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:35,338 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 19:47:35,487 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 19:47:35,489 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 19:47:35,498 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 19:47:35,499 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 19:47:35,507 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 19:47:35,508 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 19:47:35,514 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 19:47:35,515 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 19:47:35,517 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 19:47:35,522 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 19:47:35,524 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 19:47:35,525 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 19:47:35,526 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 19:47:35,528 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 19:47:35,529 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 19:47:35,530 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 19:47:35,531 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 19:47:35,532 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 19:47:35,532 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 19:47:35,533 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 19:47:35,535 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 19:47:35,542 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 19:47:35,546 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 0, Received: 0, Shipped: 71, Repack: 0, EOD: -71
2025-07-07 19:47:35,547 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 0, Received: 0, Shipped: 2, Repack: 0, EOD: -2
2025-07-07 19:47:35,553 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 0, Received: 0, Shipped: 1, Repack: 0, EOD: -1
2025-07-07 19:47:35,554 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 0, Received: 0, Shipped: 3, Repack: 0, EOD: -3
2025-07-07 19:47:35,555 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 19:47:35,557 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: -71, Received: 0, Shipped: 94, Repack: 0, EOD: -165
2025-07-07 19:47:35,558 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: -2, Received: 0, Shipped: 13, Repack: 0, EOD: -15
2025-07-07 19:47:35,561 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: -3, Received: 0, Shipped: 6, Repack: 0, EOD: -9
2025-07-07 19:47:35,562 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 19:47:35,563 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: -165, Received: 478, Shipped: 119, Repack: 0, EOD: 194
2025-07-07 19:47:35,564 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: -15, Received: 0, Shipped: 7, Repack: 0, EOD: -22
2025-07-07 19:47:35,570 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: -9, Received: 0, Shipped: 7, Repack: 0, EOD: -16
2025-07-07 19:47:35,572 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 19:47:35,574 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 194, Received: 0, Shipped: 296, Repack: 0, EOD: -102
2025-07-07 19:47:35,575 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: -22, Received: 0, Shipped: 1, Repack: 0, EOD: -23
2025-07-07 19:47:35,579 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: -16, Received: 0, Shipped: 7, Repack: 0, EOD: -23
2025-07-07 19:47:35,580 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 19:47:35,581 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: -102, Received: 0, Shipped: 117, Repack: 0, EOD: -219
2025-07-07 19:47:35,583 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: -23, Received: 0, Shipped: 2, Repack: 0, EOD: -25
2025-07-07 19:47:35,588 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: -1, Received: 0, Shipped: 1, Repack: 0, EOD: -2
2025-07-07 19:47:35,590 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: -23, Received: 0, Shipped: 1, Repack: 0, EOD: -24
2025-07-07 19:47:35,601 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 19:47:35,604 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: -219, Received: 0, Shipped: 47, Repack: 0, EOD: -266
2025-07-07 19:47:35,606 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: -25, Received: 0, Shipped: 2, Repack: 0, EOD: -27
2025-07-07 19:47:35,609 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: -2, Received: 0, Shipped: 1, Repack: 0, EOD: -3
2025-07-07 19:47:35,610 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: -24, Received: 0, Shipped: 3, Repack: 0, EOD: -27
2025-07-07 19:47:35,611 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 19:47:35,612 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: -266, Received: 0, Shipped: 87, Repack: 0, EOD: -353
2025-07-07 19:47:35,617 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: -27, Received: 0, Shipped: 3, Repack: 0, EOD: -30
2025-07-07 19:47:35,620 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 19:47:35,621 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: -353, Received: 0, Shipped: 67, Repack: 0, EOD: -420
2025-07-07 19:47:35,622 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: -27, Received: 0, Shipped: 1, Repack: 0, EOD: -28
2025-07-07 19:47:35,625 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: -3, Received: 0, Shipped: 1, Repack: 0, EOD: -4
2025-07-07 19:47:35,626 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: -30, Received: 0, Shipped: 3, Repack: 0, EOD: -33
2025-07-07 19:47:35,627 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 19:47:35,628 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: -420, Received: 0, Shipped: 234, Repack: 0, EOD: -654
2025-07-07 19:47:35,629 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: -28, Received: 0, Shipped: 14, Repack: 0, EOD: -42
2025-07-07 19:47:35,633 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: -33, Received: 0, Shipped: 11, Repack: 0, EOD: -44
2025-07-07 19:47:35,636 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 19:47:35,637 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: -654, Received: 0, Shipped: 83, Repack: 0, EOD: -737
2025-07-07 19:47:35,638 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: -42, Received: 0, Shipped: 1, Repack: 0, EOD: -43
2025-07-07 19:47:35,642 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: -44, Received: 0, Shipped: 12, Repack: 0, EOD: -56
2025-07-07 19:47:35,652 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 19:47:35,654 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: -737, Received: 0, Shipped: 164, Repack: 0, EOD: -901
2025-07-07 19:47:35,655 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: -43, Received: 0, Shipped: 2, Repack: 0, EOD: -45
2025-07-07 19:47:35,658 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: -4, Received: 0, Shipped: 3, Repack: 0, EOD: -7
2025-07-07 19:47:35,660 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: -56, Received: 0, Shipped: 3, Repack: 0, EOD: -59
2025-07-07 19:47:35,661 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 19:47:35,664 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: -901, Received: 0, Shipped: 56, Repack: 0, EOD: -957
2025-07-07 19:47:35,665 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: -45, Received: 0, Shipped: 1, Repack: 0, EOD: -46
2025-07-07 19:47:35,670 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: -7, Received: 0, Shipped: 12, Repack: 0, EOD: -19
2025-07-07 19:47:35,674 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: -59, Received: 0, Shipped: 11, Repack: 0, EOD: -70
2025-07-07 19:47:35,674 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 19:47:35,676 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -957, Received: 576, Shipped: 57, Repack: 0, EOD: -438
2025-07-07 19:47:35,677 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: -46, Received: 0, Shipped: 1, Repack: 0, EOD: -47
2025-07-07 19:47:35,681 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: -70, Received: 0, Shipped: 1, Repack: 0, EOD: -71
2025-07-07 19:47:35,683 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 19:47:35,686 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: -438, Received: 0, Shipped: 47, Repack: 0, EOD: -485
2025-07-07 19:47:35,689 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: -47, Received: 0, Shipped: 2, Repack: 0, EOD: -49
2025-07-07 19:47:35,693 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: -71, Received: 0, Shipped: 7, Repack: 0, EOD: -78
2025-07-07 19:47:35,695 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 19:47:35,696 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: -485, Received: 0, Shipped: 76, Repack: 0, EOD: -561
2025-07-07 19:47:35,697 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: -49, Received: 0, Shipped: 1, Repack: 0, EOD: -50
2025-07-07 19:47:35,706 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: -19, Received: 0, Shipped: 1, Repack: 0, EOD: -20
2025-07-07 19:47:35,708 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: -78, Received: 0, Shipped: 5, Repack: 0, EOD: -83
2025-07-07 19:47:35,722 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 19:47:35,726 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: -561, Received: 376, Shipped: 21, Repack: 0, EOD: -206
2025-07-07 19:47:35,728 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: -50, Received: 0, Shipped: 6, Repack: 0, EOD: -56
2025-07-07 19:47:35,738 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 19:47:35,740 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: -206, Received: 0, Shipped: 42, Repack: 0, EOD: -248
2025-07-07 19:47:35,741 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: -56, Received: 0, Shipped: 1, Repack: 0, EOD: -57
2025-07-07 19:47:35,745 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: -83, Received: 0, Shipped: 1, Repack: 0, EOD: -84
2025-07-07 19:47:35,746 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 19:47:35,749 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: -248, Received: 0, Shipped: 173, Repack: 0, EOD: -421
2025-07-07 19:47:35,754 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: -57, Received: 0, Shipped: 1, Repack: 0, EOD: -58
2025-07-07 19:47:35,759 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: -84, Received: 0, Shipped: 4, Repack: 0, EOD: -88
2025-07-07 19:47:35,760 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 19:47:35,762 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: -421, Received: 0, Shipped: 60, Repack: 0, EOD: -481
2025-07-07 19:47:35,763 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: -58, Received: 0, Shipped: 2, Repack: 0, EOD: -60
2025-07-07 19:47:35,770 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: -88, Received: 0, Shipped: 9, Repack: 0, EOD: -97
2025-07-07 19:47:35,771 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 19:47:35,773 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: -481, Received: 0, Shipped: 51, Repack: 0, EOD: -532
2025-07-07 19:47:35,774 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: -60, Received: 0, Shipped: 3, Repack: 0, EOD: -63
2025-07-07 19:47:35,779 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: -97, Received: 0, Shipped: 6, Repack: 0, EOD: -103
2025-07-07 19:47:35,793 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 19:47:35,795 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: -532, Received: 0, Shipped: 84, Repack: 0, EOD: -616
2025-07-07 19:47:35,796 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: -63, Received: 0, Shipped: 3, Repack: 0, EOD: -66
2025-07-07 19:47:35,805 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: -103, Received: 0, Shipped: 1, Repack: 0, EOD: -104
2025-07-07 19:47:35,811 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612              0              0
1  2025-06-01  17904              0              0
2  2025-06-01  17914            326            326
3  2025-06-01  17612            955            955
4  2025-06-01  17904            178            178
2025-07-07 19:47:35,812 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17612            955            955
236  2025-06-30  17904            178            178
237  2025-06-30  18675            -20            -20
238  2025-06-30  18675            769            769
239  2025-06-30  17914           -103           -104
2025-07-07 19:47:35,813 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 19:47:35,813 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 19:47:35,814 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612              0              0
1  2025-06-01  17904              0              0
2  2025-06-01  17914            326            326
3  2025-06-01  17612            955            955
4  2025-06-01  17904            178            178
2025-07-07 19:47:35,816 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  17612            955            955
236  2025-06-30  17904            178            178
237  2025-06-30  18675            -20            -20
238  2025-06-30  18675            769            769
239  2025-06-30  17914           -103           -104
2025-07-07 19:47:35,817 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 19:47:35,824 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     211.887500
std      439.442172
min     -957.000000
25%      -45.250000
50%      178.000000
75%      436.750000
max      955.000000
2025-07-07 19:47:35,826 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01            955
11   2025-06-02            955
19   2025-06-03            955
27   2025-06-04            955
35   2025-06-05            955
43   2025-06-06            955
51   2025-06-07            955
59   2025-06-08            955
67   2025-06-09            955
75   2025-06-10            955
83   2025-06-11            955
91   2025-06-12            955
99   2025-06-13            955
107  2025-06-14            955
115  2025-06-15            955
123  2025-06-16            955
131  2025-06-17            955
139  2025-06-18            955
147  2025-06-19            955
155  2025-06-20            955
163  2025-06-21            955
171  2025-06-22            955
179  2025-06-23            955
187  2025-06-24            955
195  2025-06-25            955
203  2025-06-26            955
211  2025-06-27            955
219  2025-06-28            955
227  2025-06-29            955
235  2025-06-30            955
2025-07-07 19:47:35,829 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
4    2025-06-01            178
12   2025-06-02            178
20   2025-06-03            178
28   2025-06-04            178
36   2025-06-05            178
44   2025-06-06            178
52   2025-06-07            178
60   2025-06-08            178
68   2025-06-09            178
76   2025-06-10            178
84   2025-06-11            178
92   2025-06-12            178
100  2025-06-13            178
108  2025-06-14            178
116  2025-06-15            178
124  2025-06-16            178
132  2025-06-17            178
140  2025-06-18            178
148  2025-06-19            178
156  2025-06-20            178
164  2025-06-21            178
172  2025-06-22            178
180  2025-06-23            178
188  2025-06-24            178
196  2025-06-25            178
204  2025-06-26            178
212  2025-06-27            178
220  2025-06-28            178
228  2025-06-29            178
236  2025-06-30            178
2025-07-07 19:47:35,848 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 19:47:35,851 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       5.625000
std        7.679852
min        0.000000
25%        0.000000
50%        1.500000
75%        8.000000
max       20.000000
2025-07-07 19:47:35,855 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           20
11   2025-06-02           20
19   2025-06-03           20
27   2025-06-04           20
35   2025-06-05           20
43   2025-06-06           20
51   2025-06-07           20
59   2025-06-08           20
67   2025-06-09           20
75   2025-06-10           20
83   2025-06-11           20
91   2025-06-12           20
99   2025-06-13           20
107  2025-06-14           20
115  2025-06-15           20
123  2025-06-16           20
131  2025-06-17           20
139  2025-06-18           20
147  2025-06-19           20
155  2025-06-20           20
163  2025-06-21           20
171  2025-06-22           20
179  2025-06-23           20
187  2025-06-24           20
195  2025-06-25           20
203  2025-06-26           20
211  2025-06-27           20
219  2025-06-28           20
227  2025-06-29           20
235  2025-06-30           20
2025-07-07 19:47:35,857 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    45
2025-06-03    45
2025-06-04    45
2025-06-05    45
2025-07-07 19:47:35,858 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    45
2025-06-27    45
2025-06-28    45
2025-06-29    45
2025-06-30    45
2025-07-07 19:47:35,858 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 19:47:35,859 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 19:47:35,861 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 19:47:35,862 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    20.25
2025-06-03    20.25
2025-06-04    20.25
2025-06-05    20.25
2025-07-07 19:47:35,862 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    20.25
2025-06-27    20.25
2025-06-28    20.25
2025-06-29    20.25
2025-06-30    20.25
2025-07-07 19:47:35,876 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 19:47:35,876 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 19:47:35,877 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:47:35,877 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:47:35,880 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:47:36,121 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:47:36,131 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:47:36,137 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:47:36,138 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 19:47:36,189 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:47:36,325 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:47:36,328 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:47:36,523 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:36,645 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:36,786 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:47:36,923 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:47:36,926 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 19:47:37,069 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:47:37,070 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 19:47:37,071 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 19:47:37,071 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 19:47:37,072 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 19:47:37,094 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 19:47:37,094 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 19:47:37,095 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 19:47:37,096 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 19:47:37,097 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 19:47:37,100 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 19:47:37,102 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 19:47:37,105 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 19:47:37,106 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 19:47:37,109 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 19:47:37,109 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 19:47:37,111 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 19:47:37,344 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 19:47:37,352 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 19:47:37,357 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 19:47:37,362 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 19:47:37,429 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 19:47:37,589 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 19:47:37,595 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 19:47:37,793 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:37,899 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 19:47:38,044 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 19:47:38,176 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 19:47:38,178 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 19:47:38,317 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 19:47:38,318 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 19:47:38,319 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 19:47:38,320 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 19:47:38,320 - __main__ - INFO - Script finished successfully.
2025-07-07 21:27:33,142 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 21:27:33,142 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 21:29:07,859 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 21:29:07,860 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 21:29:08,227 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 21:29:08,227 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 21:29:08,228 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:29:08,228 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:29:08,242 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:29:08,538 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:29:08,541 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:29:08,541 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:29:08,542 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:29:08,578 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:29:08,774 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:29:08,778 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:29:09,474 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:09,698 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:09,701 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 21:29:09,971 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 21:29:09,976 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 21:29:09,991 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 21:29:09,992 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 21:29:09,992 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:29:09,993 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:29:09,995 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:29:10,219 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:29:10,221 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:29:10,221 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:29:10,221 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:29:10,243 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:29:10,408 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:29:10,411 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:29:10,726 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:10,939 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:10,942 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 21:29:11,205 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 21:29:11,206 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 21:29:11,207 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 199, in load_product_names_map
    if raw_data is None or not raw_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 21:29:11,210 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 21:29:11,212 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 21:29:11,213 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:29:11,214 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:29:11,217 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:29:11,433 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:29:11,435 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:29:11,436 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:29:11,437 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:29:11,465 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:29:11,606 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:29:11,608 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:29:11,851 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:12,090 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:12,092 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 21:29:12,351 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 21:29:12,354 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 21:29:12,356 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 21:29:12,356 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 21:29:12,368 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 21:29:12,371 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 21:29:12,372 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 21:29:12,372 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:29:12,372 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:29:12,374 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:29:12,588 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:29:12,592 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:29:12,593 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:29:12,594 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:29:12,623 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:29:12,764 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:29:12,765 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:29:13,115 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:13,362 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:13,363 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 21:29:13,637 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 21:29:13,641 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 21:29:13,644 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
Base SKU            object
Quantity_Shipped     int64
2025-07-07 21:29:13,645 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Ship Date' column head BEFORE conversion (if exists):
0    6/2/2025
1    6/2/2025
2    6/2/2025
3    6/2/2025
4    6/2/2025
2025-07-07 21:29:13,646 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head BEFORE conversion (if exists):
Series([], )
2025-07-07 21:29:13,656 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 21:29:13,658 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 21:29:13,658 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 21:29:13,659 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:29:13,659 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:29:13,661 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:29:13,877 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:29:13,880 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:29:13,882 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:29:13,887 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:29:13,917 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:29:14,060 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:29:14,062 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:29:14,329 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:14,581 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:14,582 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 21:29:14,834 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 21:29:14,837 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 21:29:14,839 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 21:29:14,840 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 21:29:14,840 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:29:14,841 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:29:14,844 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:29:15,073 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:29:15,076 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:29:15,077 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:29:15,077 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:29:15,102 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:29:15,278 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:29:15,280 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:29:15,644 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:15,885 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:15,886 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 21:29:16,054 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 21:29:16,057 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 21:29:16,071 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 21:29:16,072 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 21:29:16,083 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 21:29:16,084 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 21:29:16,089 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 21:29:16,091 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 21:29:16,092 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 21:29:16,098 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 21:29:16,102 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 21:29:16,103 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 21:29:16,105 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 21:29:16,108 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 21:29:16,109 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 21:29:16,114 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 21:29:16,117 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 21:29:16,117 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 21:29:16,118 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 21:29:16,118 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 21:29:16,121 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 21:29:16,123 - src.services.reporting_logic.inventory_calculations - ERROR - Error calculating daily inventory: isinstance() arg 2 must be a type, a tuple of types, or a union
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in calculate_daily_inventory
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\series.py", line 4935, in apply
    ).apply()
      ^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1422, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1502, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in <lambda>
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: isinstance() arg 2 must be a type, a tuple of types, or a union
2025-07-07 21:29:16,277 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 21:29:16,278 - src.services.reporting_logic.monthly_report_generator - ERROR - daily_inventory_df is None or empty after daily inventory calculation. Cannot proceed with report generation.
2025-07-07 21:29:16,278 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 21:29:16,278 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 21:29:16,314 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 21:29:16,316 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 21:29:16,317 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 21:29:16,319 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 21:29:16,322 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 21:29:16,325 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 21:29:16,327 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 21:29:16,339 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 21:29:16,339 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 21:29:16,342 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:29:16,343 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:29:16,345 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:29:16,593 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:29:16,595 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:29:16,595 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:29:16,597 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 21:29:16,625 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:29:16,777 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:29:16,778 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:29:17,124 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:17,338 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:29:17,951 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 21:29:18,241 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 21:29:18,242 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 21:29:19,085 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 21:29:19,087 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 21:29:19,088 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 21:29:19,090 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 21:29:19,092 - __main__ - INFO - Script finished successfully.
2025-07-07 21:32:33,085 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 21:32:33,087 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 21:32:33,455 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 21:32:33,456 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 21:32:33,456 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:32:33,456 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:32:33,468 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:32:33,700 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:32:33,701 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:32:33,702 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:32:33,702 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:32:33,728 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:32:33,925 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:32:33,928 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:32:34,391 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:34,531 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:34,533 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 21:32:34,783 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 21:32:34,788 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 21:32:34,807 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 21:32:34,808 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 21:32:34,808 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:32:34,808 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:32:34,811 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:32:35,046 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:32:35,047 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:32:35,048 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:32:35,048 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:32:35,072 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:32:35,248 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:32:35,250 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:32:35,582 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:35,727 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:35,728 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 21:32:36,013 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 21:32:36,014 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 21:32:36,018 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 21:32:36,020 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 21:32:36,020 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:32:36,020 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:32:36,023 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:32:36,225 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:32:36,227 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:32:36,228 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:32:36,229 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:32:36,253 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:32:36,414 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:32:36,415 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:32:36,738 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:36,995 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:36,996 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 21:32:37,241 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 21:32:37,246 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 21:32:37,248 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 21:32:37,249 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 21:32:37,260 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 21:32:37,263 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 21:32:37,264 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 21:32:37,264 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:32:37,264 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:32:37,267 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:32:37,475 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:32:37,477 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:32:37,478 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:32:37,478 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:32:37,502 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:32:37,641 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:32:37,645 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:32:37,995 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:38,138 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:38,139 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 21:32:38,309 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 21:32:38,319 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 21:32:38,329 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 21:32:38,331 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 21:32:38,332 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 21:32:38,333 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:32:38,334 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:32:38,340 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:32:38,558 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:32:38,559 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:32:38,560 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:32:38,560 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:32:38,588 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:32:38,754 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:32:38,757 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:32:39,097 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:39,234 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:39,236 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 21:32:39,505 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 21:32:39,513 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 21:32:39,525 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 21:32:39,526 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 21:32:39,526 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:32:39,527 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:32:39,531 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:32:39,787 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:32:39,789 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:32:39,790 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:32:39,791 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:32:39,818 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:32:39,971 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:32:39,972 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:32:40,216 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:40,384 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:40,385 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 21:32:40,675 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 21:32:40,677 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 21:32:40,685 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 21:32:40,685 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 21:32:40,691 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 21:32:40,692 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 21:32:40,694 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 21:32:40,695 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 21:32:40,695 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 21:32:40,700 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 21:32:40,702 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 21:32:40,703 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 21:32:40,705 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 21:32:40,706 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 21:32:40,706 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 21:32:40,708 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 21:32:40,708 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 21:32:40,708 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 21:32:40,709 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 21:32:40,709 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 21:32:40,711 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 21:32:40,712 - src.services.reporting_logic.inventory_calculations - ERROR - Error calculating daily inventory: isinstance() arg 2 must be a type, a tuple of types, or a union
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in calculate_daily_inventory
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\series.py", line 4935, in apply
    ).apply()
      ^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1422, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1502, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in <lambda>
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: isinstance() arg 2 must be a type, a tuple of types, or a union
2025-07-07 21:32:40,721 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 21:32:40,721 - src.services.reporting_logic.monthly_report_generator - ERROR - daily_inventory_df is None or empty after daily inventory calculation. Cannot proceed with report generation.
2025-07-07 21:32:40,722 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 21:32:40,722 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 21:32:40,743 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 21:32:40,744 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 21:32:40,745 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 21:32:40,746 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 21:32:40,749 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 21:32:40,755 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 21:32:40,756 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 21:32:40,770 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 21:32:40,771 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 21:32:40,774 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:32:40,775 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:32:40,777 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:32:40,985 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:32:40,986 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:32:40,987 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:32:40,987 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 21:32:41,009 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:32:41,159 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:32:41,160 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:32:41,394 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:41,649 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:32:41,893 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 21:32:42,068 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 21:32:42,069 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 21:32:43,728 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 21:32:43,732 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 21:32:43,733 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 21:32:43,737 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 21:32:43,738 - __main__ - INFO - Script finished successfully.
2025-07-07 21:33:05,693 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 21:33:05,694 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 21:33:06,078 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 21:33:06,078 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 21:33:06,079 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:33:06,079 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:33:06,092 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:33:06,352 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:33:06,354 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:33:06,354 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:33:06,354 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:33:06,378 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:33:06,535 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:33:06,537 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:33:06,873 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:07,017 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:07,019 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 21:33:07,287 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 21:33:07,291 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 21:33:07,296 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 21:33:07,297 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 21:33:07,297 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:33:07,298 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:33:07,301 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:33:07,521 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:33:07,523 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:33:07,524 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:33:07,524 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:33:07,547 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:33:07,697 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:33:07,700 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:33:08,062 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:08,237 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:08,240 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 21:33:08,560 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 21:33:08,563 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 21:33:08,565 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 21:33:08,565 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 21:33:08,566 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:33:08,566 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:33:08,569 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:33:08,805 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:33:08,808 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:33:08,809 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:33:08,811 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:33:08,832 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:33:09,000 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:33:09,003 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:33:09,326 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:09,490 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:09,492 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 21:33:09,765 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 21:33:09,768 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 21:33:09,771 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 21:33:09,771 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 21:33:09,774 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 21:33:09,776 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 21:33:09,776 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 21:33:09,777 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:33:09,777 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:33:09,781 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:33:10,005 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:33:10,007 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:33:10,008 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:33:10,008 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:33:10,029 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:33:10,200 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:33:10,203 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:33:10,566 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:10,698 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:10,699 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 21:33:10,985 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 21:33:10,990 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 21:33:10,993 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 21:33:10,995 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 21:33:10,995 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 21:33:10,996 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:33:10,997 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:33:11,000 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:33:11,226 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:33:11,230 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:33:11,231 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:33:11,232 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:33:11,254 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:33:11,430 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:33:11,434 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:33:11,672 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:11,819 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:11,821 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 21:33:11,992 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 21:33:11,999 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 21:33:12,003 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 21:33:12,004 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 21:33:12,004 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:33:12,005 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:33:12,009 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:33:12,236 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:33:12,239 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:33:12,239 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:33:12,240 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:33:12,262 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:33:12,415 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:33:12,416 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:33:12,744 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:12,876 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:12,877 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 21:33:13,123 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 21:33:13,126 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 21:33:13,137 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 21:33:13,138 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 21:33:13,143 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 21:33:13,144 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 21:33:13,148 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 21:33:13,151 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 21:33:13,152 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 21:33:13,161 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 21:33:13,164 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 21:33:13,165 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 21:33:13,168 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 21:33:13,171 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 21:33:13,172 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 21:33:13,176 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 21:33:13,177 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 21:33:13,178 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 21:33:13,179 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 21:33:13,181 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 21:33:13,186 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 21:33:13,187 - src.services.reporting_logic.inventory_calculations - ERROR - Error calculating daily inventory: isinstance() arg 2 must be a type, a tuple of types, or a union
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in calculate_daily_inventory
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\series.py", line 4935, in apply
    ).apply()
      ^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1422, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1502, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in <lambda>
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: isinstance() arg 2 must be a type, a tuple of types, or a union
2025-07-07 21:33:13,196 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 21:33:13,197 - src.services.reporting_logic.monthly_report_generator - ERROR - daily_inventory_df is None or empty after daily inventory calculation. Cannot proceed with report generation.
2025-07-07 21:33:13,199 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 21:33:13,200 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 21:33:13,280 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 21:33:13,281 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 21:33:13,282 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 21:33:13,284 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 21:33:13,288 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 21:33:13,290 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 21:33:13,292 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 21:33:13,299 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 21:33:13,301 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 21:33:13,311 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:33:13,312 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:33:13,321 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:33:13,561 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:33:13,565 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:33:13,566 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:33:13,568 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 21:33:13,637 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:33:13,780 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:33:13,783 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:33:14,020 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:14,263 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:33:14,458 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 21:33:14,744 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 21:33:14,746 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 21:33:14,933 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 21:33:14,934 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 21:33:14,935 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 21:33:14,937 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 21:33:14,938 - __main__ - INFO - Script finished successfully.
2025-07-07 21:35:33,527 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 21:35:33,529 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 21:35:33,957 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 21:35:33,957 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 21:35:33,958 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:35:33,958 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:35:33,982 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:35:34,287 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:35:34,288 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:35:34,289 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:35:34,289 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:35:34,315 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:35:34,506 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:35:34,509 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:35:35,159 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:35,398 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:35,399 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 21:35:35,693 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 21:35:35,703 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 21:35:35,719 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 21:35:35,720 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 21:35:35,720 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:35:35,721 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:35:35,723 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:35:35,942 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:35:35,944 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:35:35,945 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:35:35,946 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:35:35,967 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:35:36,128 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:35:36,130 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:35:36,460 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:36,709 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:36,710 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 21:35:36,978 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 21:35:36,980 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 21:35:36,982 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 21:35:36,983 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 21:35:36,984 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:35:36,984 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:35:36,989 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:35:37,210 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:35:37,213 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:35:37,213 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:35:37,214 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:35:37,236 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:35:37,407 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:35:37,408 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:35:37,774 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:38,017 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:38,019 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 21:35:38,284 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 21:35:38,287 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 21:35:38,289 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 21:35:38,290 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 21:35:38,306 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 21:35:38,308 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 21:35:38,308 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 21:35:38,309 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:35:38,309 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:35:38,312 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:35:38,538 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:35:38,540 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:35:38,540 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:35:38,541 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:35:38,565 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:35:38,735 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:35:38,738 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:35:39,064 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:39,296 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:39,298 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 21:35:39,567 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 21:35:39,574 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 21:35:39,580 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 21:35:39,581 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 21:35:39,581 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 21:35:39,582 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:35:39,582 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:35:39,585 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:35:39,784 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:35:39,785 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:35:39,786 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:35:39,786 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:35:39,809 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:35:39,963 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:35:39,965 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:35:40,209 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:40,433 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:40,434 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 21:35:40,700 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 21:35:40,704 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 21:35:40,707 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 21:35:40,707 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 21:35:40,709 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:35:40,709 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:35:40,714 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:35:40,914 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:35:40,915 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:35:40,916 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:35:40,916 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 21:35:40,938 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:35:41,098 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:35:41,102 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:35:41,349 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:41,564 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:41,568 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 21:35:41,814 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 21:35:41,820 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 21:35:41,838 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 21:35:41,839 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 21:35:41,851 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 21:35:41,852 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 21:35:41,858 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 21:35:41,860 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 21:35:41,862 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 21:35:41,871 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 21:35:41,874 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 21:35:41,874 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 21:35:41,876 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 21:35:41,877 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 21:35:41,878 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 21:35:41,884 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 21:35:41,885 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 21:35:41,886 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 21:35:41,887 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 21:35:41,888 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 21:35:41,892 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 21:35:41,893 - src.services.reporting_logic.inventory_calculations - ERROR - Error calculating daily inventory: isinstance() arg 2 must be a type, a tuple of types, or a union
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in calculate_daily_inventory
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\series.py", line 4935, in apply
    ).apply()
      ^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1422, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1502, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in <lambda>
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: isinstance() arg 2 must be a type, a tuple of types, or a union
2025-07-07 21:35:41,907 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 21:35:41,908 - src.services.reporting_logic.monthly_report_generator - ERROR - daily_inventory_df is None or empty after daily inventory calculation. Cannot proceed with report generation.
2025-07-07 21:35:41,909 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 21:35:41,910 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 21:35:41,989 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 21:35:41,990 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 21:35:41,990 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 21:35:41,992 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 21:35:41,996 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 21:35:42,000 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 21:35:42,003 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 21:35:42,018 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 21:35:42,019 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 21:35:42,024 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 21:35:42,025 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 21:35:42,029 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 21:35:42,275 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 21:35:42,277 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 21:35:42,278 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 21:35:42,279 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 21:35:42,334 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 21:35:42,496 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 21:35:42,498 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 21:35:42,855 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:43,081 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 21:35:43,298 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 21:35:43,531 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 21:35:43,534 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 21:35:43,871 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 21:35:43,874 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 21:35:43,875 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 21:35:43,877 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 21:35:43,879 - __main__ - INFO - Script finished successfully.
2025-07-07 22:00:27,884 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:00:27,886 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:00:28,240 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:00:28,241 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:00:28,242 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:00:28,243 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:00:28,255 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:00:28,552 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:00:28,554 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:00:28,555 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:00:28,555 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:00:28,582 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:00:28,780 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:00:28,784 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:00:29,283 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:29,542 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:29,544 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:00:29,747 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:00:29,759 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:00:29,777 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:00:29,779 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:00:29,779 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:00:29,779 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:00:29,782 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:00:30,002 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:00:30,005 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:00:30,006 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:00:30,007 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:00:30,029 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:00:30,201 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:00:30,205 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:00:30,458 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:30,615 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:30,616 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:00:30,784 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:00:30,786 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:00:30,787 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 22:00:30,788 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:00:30,789 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:00:30,789 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:00:30,793 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:00:31,020 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:00:31,024 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:00:31,025 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:00:31,026 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:00:31,048 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:00:31,219 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:00:31,228 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:00:31,674 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:31,914 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:31,915 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:00:32,169 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:00:32,173 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:00:32,174 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 22:00:32,176 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 22:00:32,187 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 22:00:32,189 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 22:00:32,190 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 22:00:32,190 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:00:32,191 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:00:32,195 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:00:32,450 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:00:32,451 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:00:32,452 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:00:32,452 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:00:32,481 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:00:32,638 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:00:32,640 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:00:32,904 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:33,159 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:33,160 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 22:00:33,455 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 22:00:33,460 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 22:00:33,467 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 22:00:33,468 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 22:00:33,468 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 22:00:33,469 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:00:33,469 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:00:33,471 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:00:33,684 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:00:33,685 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:00:33,685 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:00:33,686 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:00:33,710 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:00:33,870 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:00:33,873 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:00:34,130 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:34,361 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:34,362 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 22:00:34,539 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 22:00:34,543 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 22:00:34,550 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 22:00:34,551 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 22:00:34,551 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:00:34,552 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:00:34,555 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:00:34,768 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:00:34,770 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:00:34,771 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:00:34,771 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:00:34,801 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:00:34,990 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:00:34,992 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:00:35,329 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:35,473 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:35,476 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 22:00:35,765 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 22:00:35,767 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 22:00:35,784 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 22:00:35,786 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 22:00:35,798 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 22:00:35,799 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 22:00:35,803 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 22:00:35,804 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 22:00:35,804 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 22:00:35,814 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 22:00:35,819 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 22:00:35,820 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 22:00:35,821 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 22:00:35,823 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 22:00:35,825 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 22:00:35,830 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 22:00:35,830 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 22:00:35,831 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 22:00:35,832 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 22:00:35,832 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 22:00:35,834 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 22:00:35,835 - src.services.reporting_logic.inventory_calculations - ERROR - Error calculating daily inventory: isinstance() arg 2 must be a type, a tuple of types, or a union
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in calculate_daily_inventory
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\series.py", line 4935, in apply
    ).apply()
      ^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1422, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1502, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in <lambda>
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: isinstance() arg 2 must be a type, a tuple of types, or a union
2025-07-07 22:00:35,843 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 22:00:35,844 - src.services.reporting_logic.monthly_report_generator - ERROR - daily_inventory_df is None or empty after daily inventory calculation. Cannot proceed with report generation.
2025-07-07 22:00:35,845 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 22:00:35,846 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 22:00:35,899 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 22:00:35,900 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 22:00:35,901 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 22:00:35,903 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 22:00:35,906 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 22:00:35,909 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 22:00:35,911 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 22:00:35,926 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 22:00:35,927 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 22:00:35,935 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:00:35,935 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:00:35,942 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:00:36,208 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:00:36,210 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:00:36,211 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:00:36,213 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 22:00:36,273 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:00:36,434 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:00:36,438 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:00:36,709 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:36,941 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:00:37,330 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:00:37,614 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:00:37,617 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 22:00:38,249 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:00:38,251 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 22:00:38,253 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 22:00:38,255 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 22:00:38,256 - __main__ - INFO - Script finished successfully.
2025-07-07 22:06:34,997 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:06:34,998 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:06:35,377 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:08:39,334 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:08:39,334 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:08:39,681 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:08:39,682 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:08:39,682 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:08:39,682 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:08:39,696 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:08:39,984 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:08:39,986 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:08:39,986 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:08:39,987 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:08:40,014 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:08:40,200 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:08:40,202 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:08:40,746 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:40,883 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:40,884 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:08:41,053 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:08:41,054 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:08:41,059 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:08:41,060 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:08:41,060 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:08:41,060 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:08:41,063 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:08:41,271 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:08:41,273 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:08:41,273 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:08:41,274 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:08:41,299 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:08:41,453 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:08:41,455 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:08:41,776 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:41,993 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:41,995 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:08:42,242 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:08:42,243 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:08:42,245 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 22:08:42,246 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:08:42,246 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:08:42,246 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:08:42,248 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:08:42,451 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:08:42,452 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:08:42,453 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:08:42,453 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:08:42,475 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:08:42,627 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:08:42,629 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:08:43,008 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:43,258 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:43,259 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:08:43,418 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:08:43,420 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:08:43,421 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 22:08:43,422 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 22:08:43,426 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 22:08:43,427 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 22:08:43,427 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 22:08:43,427 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:08:43,428 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:08:43,430 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:08:43,629 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:08:43,632 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:08:43,633 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:08:43,633 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:08:43,655 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:08:43,822 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:08:43,823 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:08:44,061 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:44,287 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:44,288 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 22:08:44,459 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 22:08:44,466 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 22:08:44,470 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 22:08:44,471 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 22:08:44,471 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 22:08:44,471 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:08:44,472 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:08:44,475 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:08:44,681 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:08:44,683 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:08:44,684 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:08:44,685 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:08:44,706 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:08:44,857 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:08:44,860 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:08:45,096 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:45,326 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:45,327 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 22:08:45,496 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 22:08:45,500 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 22:08:45,503 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 22:08:45,504 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 22:08:45,504 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:08:45,505 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:08:45,509 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:08:45,726 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:08:45,728 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:08:45,729 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:08:45,729 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:08:45,752 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:08:45,920 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:08:45,923 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:08:46,173 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:46,321 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:46,322 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 22:08:46,614 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 22:08:46,617 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 22:08:46,624 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 22:08:46,625 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 22:08:46,627 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 22:08:46,627 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 22:08:46,630 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 22:08:46,631 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 22:08:46,632 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 22:08:46,635 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 22:08:46,636 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 22:08:46,637 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 22:08:46,638 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 22:08:46,640 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 22:08:46,641 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 22:08:46,643 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 22:08:46,644 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 22:08:46,645 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 22:08:46,646 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 22:08:46,647 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 22:08:46,648 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 22:08:46,649 - src.services.reporting_logic.inventory_calculations - ERROR - Error calculating daily inventory: isinstance() arg 2 must be a type, a tuple of types, or a union
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in calculate_daily_inventory
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\series.py", line 4935, in apply
    ).apply()
      ^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1422, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1502, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in <lambda>
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: isinstance() arg 2 must be a type, a tuple of types, or a union
2025-07-07 22:08:46,652 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 22:08:46,653 - src.services.reporting_logic.monthly_report_generator - ERROR - daily_inventory_df is None or empty after daily inventory calculation. Cannot proceed with report generation.
2025-07-07 22:08:46,653 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 22:08:46,654 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 22:08:46,674 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 22:08:46,675 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 22:08:46,676 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 22:08:46,677 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 22:08:46,680 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 22:08:46,681 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 22:08:46,682 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 22:08:46,685 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 22:08:46,686 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 22:08:46,689 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:08:46,691 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:08:46,693 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:08:46,892 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:08:46,895 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:08:46,896 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:08:46,897 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 22:08:46,919 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:08:47,082 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:08:47,086 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:08:47,328 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:47,466 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:08:47,671 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:08:47,843 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:08:47,846 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 22:08:48,657 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:08:48,659 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 22:08:48,660 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 22:08:48,661 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 22:08:48,662 - __main__ - INFO - Script finished successfully.
2025-07-07 22:10:33,474 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:10:33,474 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:10:33,846 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:15:51,737 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:15:51,737 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:15:52,107 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:15:52,108 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:15:52,108 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:15:52,109 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:15:52,122 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:15:52,405 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:15:52,406 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:15:52,407 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:15:52,407 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:15:52,431 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:15:52,608 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:15:52,610 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:15:53,443 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:15:53,678 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:15:53,680 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:15:53,933 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:15:53,937 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:15:53,943 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:15:53,944 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:15:53,944 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:15:53,945 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:15:53,948 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:15:54,173 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:15:54,175 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:15:54,176 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:15:54,176 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:15:54,197 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:15:54,365 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:15:54,368 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:15:54,635 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:15:54,779 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:15:54,781 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:15:55,015 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:15:55,018 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:15:55,020 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 22:15:55,022 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:15:55,022 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:15:55,023 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:15:55,025 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:15:55,223 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:15:55,224 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:15:55,225 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:15:55,225 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:15:55,246 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:15:55,391 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:15:55,394 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:15:55,744 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:15:55,881 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:15:55,883 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:15:56,150 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:15:56,152 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:15:56,154 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 22:15:56,156 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 22:15:56,160 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 22:15:56,161 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 22:15:56,163 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 22:15:56,164 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:15:56,165 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:15:56,168 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:15:56,387 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:15:56,391 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:15:56,392 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:15:56,393 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:15:56,416 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:15:56,567 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:15:56,569 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:15:56,900 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:15:57,040 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:15:57,041 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 22:15:57,317 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 22:15:57,322 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 22:15:57,327 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 22:15:57,328 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 22:15:57,328 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 22:15:57,329 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:15:57,329 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:15:57,331 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:15:57,584 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:15:57,588 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:15:57,590 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:15:57,590 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:15:57,613 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:15:57,771 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:15:57,774 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:15:58,012 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:15:58,158 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:15:58,160 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 22:15:58,428 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 22:15:58,434 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 22:15:58,436 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 22:15:58,437 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 22:15:58,438 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:15:58,438 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:15:58,441 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:15:58,662 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:15:58,664 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:15:58,665 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:15:58,665 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:15:58,687 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:15:58,844 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:15:58,846 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:15:59,085 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:15:59,232 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:15:59,234 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 22:15:59,566 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 22:15:59,568 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 22:15:59,576 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 22:15:59,577 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 22:15:59,578 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 22:15:59,578 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 22:15:59,581 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 22:15:59,582 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 22:15:59,582 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 22:15:59,585 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 22:15:59,585 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 22:15:59,587 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 22:15:59,588 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 22:15:59,588 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 22:15:59,589 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 22:15:59,591 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 22:15:59,591 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 22:15:59,592 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 22:15:59,593 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 22:15:59,594 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 22:15:59,597 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 22:15:59,597 - src.services.reporting_logic.inventory_calculations - ERROR - Error calculating daily inventory: isinstance() arg 2 must be a type, a tuple of types, or a union
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in calculate_daily_inventory
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\series.py", line 4935, in apply
    ).apply()
      ^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1422, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\apply.py", line 1502, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 27, in <lambda>
    transactions_df['Date'] = transactions_df['Date'].apply(lambda x: x if isinstance(x, datetime.date) else x.date())
                                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: isinstance() arg 2 must be a type, a tuple of types, or a union
2025-07-07 22:15:59,600 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 22:15:59,600 - src.services.reporting_logic.monthly_report_generator - ERROR - daily_inventory_df is None or empty after daily inventory calculation. Cannot proceed with report generation.
2025-07-07 22:15:59,601 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 22:15:59,601 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 22:15:59,617 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 22:15:59,618 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 22:15:59,618 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 22:15:59,620 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 22:15:59,622 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 22:15:59,623 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 22:15:59,625 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 22:15:59,629 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 22:15:59,630 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 22:15:59,633 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:15:59,633 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:15:59,635 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:15:59,822 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:15:59,824 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:15:59,824 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:15:59,825 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 22:15:59,846 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:15:59,991 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:15:59,995 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:16:00,213 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:00,357 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:00,541 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:16:00,708 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:16:00,709 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 22:16:08,172 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:16:08,173 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 22:16:08,174 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 22:16:08,174 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 22:16:08,175 - __main__ - INFO - Script finished successfully.
2025-07-07 22:16:18,611 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:16:18,611 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:16:18,973 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:16:18,973 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:16:18,973 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:16:18,974 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:16:18,985 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:16:19,201 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:16:19,203 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:16:19,203 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:16:19,204 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:16:19,229 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:16:19,377 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:16:19,380 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:16:19,655 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:19,888 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:19,892 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:16:20,058 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:16:20,060 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:16:20,064 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:16:20,065 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:16:20,065 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:16:20,066 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:16:20,071 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:16:20,284 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:16:20,285 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:16:20,286 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:16:20,286 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:16:20,313 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:16:20,483 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:16:20,485 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:16:20,816 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:20,968 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:20,969 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:16:21,235 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:16:21,236 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:16:21,237 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 22:16:21,239 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:16:21,239 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:16:21,239 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:16:21,243 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:16:21,463 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:16:21,465 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:16:21,465 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:16:21,466 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:16:21,488 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:16:21,637 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:16:21,640 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:16:21,991 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:22,139 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:22,140 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:16:22,326 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:16:22,327 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:16:22,329 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 22:16:22,329 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 22:16:22,332 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 22:16:22,333 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 22:16:22,334 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 22:16:22,334 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:16:22,334 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:16:22,336 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:16:22,545 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:16:22,546 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:16:22,547 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:16:22,548 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:16:22,573 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:16:22,729 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:16:22,731 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:16:22,975 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:23,125 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:23,126 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 22:16:23,304 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 22:16:23,313 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 22:16:23,318 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 22:16:23,320 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 22:16:23,322 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 22:16:23,324 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:16:23,325 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:16:23,328 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:16:23,584 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:16:23,587 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:16:23,587 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:16:23,588 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:16:23,613 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:16:23,763 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:16:23,767 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:16:24,028 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:24,258 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:24,259 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 22:16:24,493 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 22:16:24,497 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 22:16:24,501 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 22:16:24,501 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 22:16:24,501 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:16:24,501 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:16:24,504 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:16:24,696 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:16:24,698 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:16:24,698 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:16:24,699 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:16:24,723 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:16:24,890 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:16:24,893 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:16:25,139 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:25,292 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:25,294 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 22:16:25,495 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 22:16:25,497 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 22:16:25,512 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 22:16:25,512 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 22:16:25,516 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 22:16:25,518 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 22:16:25,524 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 22:16:25,526 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 22:16:25,527 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 22:16:25,535 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 22:16:25,536 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 22:16:25,536 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 22:16:25,537 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 22:16:25,540 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 22:16:25,540 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 22:16:25,545 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 22:16:25,545 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 22:16:25,546 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 22:16:25,548 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 22:16:25,549 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 22:16:25,551 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 22:16:25,552 - src.services.reporting_logic.inventory_calculations - ERROR - Error calculating daily inventory: isinstance() arg 2 must be a type, a tuple of types, or a union
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 29, in calculate_daily_inventory
    if not transactions_df['Date'].empty and not isinstance(transactions_df['Date'].iloc[0], datetime.date):
                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: isinstance() arg 2 must be a type, a tuple of types, or a union
2025-07-07 22:16:25,554 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 22:16:25,555 - src.services.reporting_logic.monthly_report_generator - ERROR - daily_inventory_df is None or empty after daily inventory calculation. Cannot proceed with report generation.
2025-07-07 22:16:25,556 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-07 22:16:25,556 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 22:16:25,645 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 22:16:25,656 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 22:16:25,661 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 22:16:25,668 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 22:16:25,681 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 22:16:25,687 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 22:16:25,691 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 22:16:25,703 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 22:16:25,705 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 22:16:25,718 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:16:25,719 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:16:25,726 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:16:25,927 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:16:25,928 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:16:25,929 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:16:25,929 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 22:16:25,951 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:16:26,095 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:16:26,097 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:16:26,362 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:26,509 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:16:26,694 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:16:26,880 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:16:26,883 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 22:16:27,061 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:16:27,065 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 22:16:27,066 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 22:16:27,067 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 22:16:27,067 - __main__ - INFO - Script finished successfully.
2025-07-07 22:20:51,792 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:20:51,793 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:20:52,283 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:20:52,284 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:20:52,284 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:20:52,284 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:20:52,298 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:20:52,560 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:20:52,562 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:20:52,563 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:20:52,563 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:20:52,590 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:20:52,755 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:20:52,765 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:20:53,327 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:20:53,562 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:20:53,564 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:20:53,738 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:20:53,740 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:20:53,744 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:20:53,745 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:20:53,745 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:20:53,746 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:20:53,748 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:20:53,958 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:20:53,959 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:20:53,960 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:20:53,960 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:20:53,983 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:20:54,160 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:20:54,161 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:20:54,390 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:20:54,528 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:20:54,529 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:20:54,679 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:20:54,681 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:20:54,682 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 22:20:54,683 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:20:54,683 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:20:54,684 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:20:54,688 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:20:54,894 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:20:54,895 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:20:54,896 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:20:54,896 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:20:54,921 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:20:55,060 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:20:55,063 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:20:55,292 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:20:55,428 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:20:55,429 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:20:55,601 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:20:55,604 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:20:55,606 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 22:20:55,607 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 22:20:55,611 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 22:20:55,612 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 22:20:55,612 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 22:20:55,613 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:20:55,613 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:20:55,618 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:20:55,834 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:20:55,836 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:20:55,837 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:20:55,838 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:20:55,862 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:20:56,005 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:20:56,007 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:20:56,237 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:20:56,457 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:20:56,459 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 22:20:56,725 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 22:20:56,739 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 22:20:56,745 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 22:20:56,746 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 22:20:56,747 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 22:20:56,748 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:20:56,749 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:20:56,752 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:20:56,947 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:20:56,949 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:20:56,949 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:20:56,950 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:20:56,975 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:20:57,136 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:20:57,139 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:20:57,355 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:20:57,608 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:20:57,609 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 22:20:57,764 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 22:20:57,769 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 22:20:57,773 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 22:20:57,774 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 22:20:57,775 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:20:57,776 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:20:57,779 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:20:58,010 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:20:58,013 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:20:58,015 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:20:58,015 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:20:58,042 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:20:58,207 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:20:58,210 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:20:58,438 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:20:58,691 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:20:58,692 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 22:20:58,850 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 22:20:58,852 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 22:20:58,859 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 22:20:58,860 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 22:20:58,861 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 22:20:58,862 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 22:20:58,864 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 22:20:58,865 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 22:20:58,866 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 22:20:58,870 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 22:20:58,872 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 22:20:58,873 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 22:20:58,874 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 22:20:58,875 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 22:20:58,876 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 22:20:58,878 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 22:20:58,879 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 22:20:58,879 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 22:20:58,880 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 22:20:58,880 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 22:20:58,883 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 22:20:58,884 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 326, '18675': 769, 17612: 0, 17904: 0, 18675: 0, '17612': 955, 17914: 0, '17904': 178}
2025-07-07 22:20:58,885 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-07 22:20:58,885 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 326, '18675': 769, 17612: 0, 17904: 0, 18675: 0, '17612': 955, 17914: 0, '17904': 178}
2025-07-07 22:20:58,888 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:58,890 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:58,893 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:58,895 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:58,896 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(0), 17904: np.int64(0), 18675: np.int64(0), '17612': np.int64(955), 17914: np.int64(0), '17904': np.int64(178)}
2025-07-07 22:20:58,896 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-07 22:20:58,897 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(0), 17904: np.int64(0), 18675: np.int64(0), '17612': np.int64(955), 17914: np.int64(0), '17904': np.int64(178)}
2025-07-07 22:20:58,899 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 22:20:58,902 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:58,904 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:58,906 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 0, Received: 0, Shipped: 71, Repack: 0, EOD: -71
2025-07-07 22:20:58,907 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 0, Received: 0, Shipped: 2, Repack: 0, EOD: -2
2025-07-07 22:20:58,909 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 0, Received: 0, Shipped: 1, Repack: 0, EOD: -1
2025-07-07 22:20:58,910 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:58,912 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 0, Received: 0, Shipped: 3, Repack: 0, EOD: -3
2025-07-07 22:20:58,914 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:58,915 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-71), 17904: np.int64(-2), 18675: np.int64(-1), '17612': np.int64(955), 17914: np.int64(-3), '17904': np.int64(178)}
2025-07-07 22:20:58,915 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-07 22:20:58,915 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-71), 17904: np.int64(-2), 18675: np.int64(-1), '17612': np.int64(955), 17914: np.int64(-3), '17904': np.int64(178)}
2025-07-07 22:20:58,917 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 22:20:58,920 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:58,922 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:58,924 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: -71, Received: 0, Shipped: 94, Repack: 0, EOD: -165
2025-07-07 22:20:58,926 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: -2, Received: 0, Shipped: 13, Repack: 0, EOD: -15
2025-07-07 22:20:58,929 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:58,931 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: -3, Received: 0, Shipped: 6, Repack: 0, EOD: -9
2025-07-07 22:20:58,935 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:58,936 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-165), 17904: np.int64(-15), 18675: np.int64(-1), '17612': np.int64(955), 17914: np.int64(-9), '17904': np.int64(178)}
2025-07-07 22:20:58,936 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-07 22:20:58,936 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-165), 17904: np.int64(-15), 18675: np.int64(-1), '17612': np.int64(955), 17914: np.int64(-9), '17904': np.int64(178)}
2025-07-07 22:20:58,937 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 22:20:58,939 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:58,941 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:58,943 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: -165, Received: 478, Shipped: 119, Repack: 0, EOD: 194
2025-07-07 22:20:58,945 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: -15, Received: 0, Shipped: 7, Repack: 0, EOD: -22
2025-07-07 22:20:58,948 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:58,951 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: -9, Received: 0, Shipped: 7, Repack: 0, EOD: -16
2025-07-07 22:20:58,953 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:58,954 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(194), 17904: np.int64(-22), 18675: np.int64(-1), '17612': np.int64(955), 17914: np.int64(-16), '17904': np.int64(178)}
2025-07-07 22:20:58,955 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-07 22:20:58,955 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(194), 17904: np.int64(-22), 18675: np.int64(-1), '17612': np.int64(955), 17914: np.int64(-16), '17904': np.int64(178)}
2025-07-07 22:20:58,956 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 22:20:58,958 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:58,959 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:58,961 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 194, Received: 0, Shipped: 296, Repack: 0, EOD: -102
2025-07-07 22:20:58,963 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: -22, Received: 0, Shipped: 1, Repack: 0, EOD: -23
2025-07-07 22:20:58,966 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:58,968 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: -16, Received: 0, Shipped: 7, Repack: 0, EOD: -23
2025-07-07 22:20:58,969 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:58,969 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-102), 17904: np.int64(-23), 18675: np.int64(-1), '17612': np.int64(955), 17914: np.int64(-23), '17904': np.int64(178)}
2025-07-07 22:20:58,970 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-07 22:20:58,970 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-102), 17904: np.int64(-23), 18675: np.int64(-1), '17612': np.int64(955), 17914: np.int64(-23), '17904': np.int64(178)}
2025-07-07 22:20:58,971 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 22:20:58,972 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:58,974 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:58,975 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: -102, Received: 0, Shipped: 117, Repack: 0, EOD: -219
2025-07-07 22:20:58,976 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: -23, Received: 0, Shipped: 2, Repack: 0, EOD: -25
2025-07-07 22:20:58,977 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: -1, Received: 0, Shipped: 1, Repack: 0, EOD: -2
2025-07-07 22:20:58,979 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:58,982 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: -23, Received: 0, Shipped: 1, Repack: 0, EOD: -24
2025-07-07 22:20:58,985 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:58,986 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-219), 17904: np.int64(-25), 18675: np.int64(-2), '17612': np.int64(955), 17914: np.int64(-24), '17904': np.int64(178)}
2025-07-07 22:20:58,987 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-07 22:20:58,987 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-219), 17904: np.int64(-25), 18675: np.int64(-2), '17612': np.int64(955), 17914: np.int64(-24), '17904': np.int64(178)}
2025-07-07 22:20:58,989 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:58,991 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:58,994 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:58,996 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:58,997 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-219), 17904: np.int64(-25), 18675: np.int64(-2), '17612': np.int64(955), 17914: np.int64(-24), '17904': np.int64(178)}
2025-07-07 22:20:58,997 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-07 22:20:58,997 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-219), 17904: np.int64(-25), 18675: np.int64(-2), '17612': np.int64(955), 17914: np.int64(-24), '17904': np.int64(178)}
2025-07-07 22:20:59,000 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,001 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,005 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,008 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,008 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-219), 17904: np.int64(-25), 18675: np.int64(-2), '17612': np.int64(955), 17914: np.int64(-24), '17904': np.int64(178)}
2025-07-07 22:20:59,008 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-07 22:20:59,008 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-219), 17904: np.int64(-25), 18675: np.int64(-2), '17612': np.int64(955), 17914: np.int64(-24), '17904': np.int64(178)}
2025-07-07 22:20:59,008 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 22:20:59,010 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,011 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,014 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: -219, Received: 0, Shipped: 47, Repack: 0, EOD: -266
2025-07-07 22:20:59,017 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: -25, Received: 0, Shipped: 2, Repack: 0, EOD: -27
2025-07-07 22:20:59,019 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: -2, Received: 0, Shipped: 1, Repack: 0, EOD: -3
2025-07-07 22:20:59,021 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,024 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: -24, Received: 0, Shipped: 3, Repack: 0, EOD: -27
2025-07-07 22:20:59,025 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,026 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-266), 17904: np.int64(-27), 18675: np.int64(-3), '17612': np.int64(955), 17914: np.int64(-27), '17904': np.int64(178)}
2025-07-07 22:20:59,026 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-07 22:20:59,026 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-266), 17904: np.int64(-27), 18675: np.int64(-3), '17612': np.int64(955), 17914: np.int64(-27), '17904': np.int64(178)}
2025-07-07 22:20:59,027 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 22:20:59,029 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,031 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,033 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: -266, Received: 0, Shipped: 87, Repack: 0, EOD: -353
2025-07-07 22:20:59,037 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,039 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: -27, Received: 0, Shipped: 3, Repack: 0, EOD: -30
2025-07-07 22:20:59,041 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,041 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-353), 17904: np.int64(-27), 18675: np.int64(-3), '17612': np.int64(955), 17914: np.int64(-30), '17904': np.int64(178)}
2025-07-07 22:20:59,042 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-07 22:20:59,042 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-353), 17904: np.int64(-27), 18675: np.int64(-3), '17612': np.int64(955), 17914: np.int64(-30), '17904': np.int64(178)}
2025-07-07 22:20:59,043 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 22:20:59,045 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,047 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,049 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: -353, Received: 0, Shipped: 67, Repack: 0, EOD: -420
2025-07-07 22:20:59,053 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: -27, Received: 0, Shipped: 1, Repack: 0, EOD: -28
2025-07-07 22:20:59,055 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: -3, Received: 0, Shipped: 1, Repack: 0, EOD: -4
2025-07-07 22:20:59,057 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,059 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: -30, Received: 0, Shipped: 3, Repack: 0, EOD: -33
2025-07-07 22:20:59,060 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,061 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-420), 17904: np.int64(-28), 18675: np.int64(-4), '17612': np.int64(955), 17914: np.int64(-33), '17904': np.int64(178)}
2025-07-07 22:20:59,061 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-07 22:20:59,061 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-420), 17904: np.int64(-28), 18675: np.int64(-4), '17612': np.int64(955), 17914: np.int64(-33), '17904': np.int64(178)}
2025-07-07 22:20:59,065 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 22:20:59,066 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,067 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,068 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: -420, Received: 0, Shipped: 234, Repack: 0, EOD: -654
2025-07-07 22:20:59,070 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: -28, Received: 0, Shipped: 14, Repack: 0, EOD: -42
2025-07-07 22:20:59,073 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,075 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: -33, Received: 0, Shipped: 11, Repack: 0, EOD: -44
2025-07-07 22:20:59,078 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,078 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-654), 17904: np.int64(-42), 18675: np.int64(-4), '17612': np.int64(955), 17914: np.int64(-44), '17904': np.int64(178)}
2025-07-07 22:20:59,079 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-07 22:20:59,079 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-654), 17904: np.int64(-42), 18675: np.int64(-4), '17612': np.int64(955), 17914: np.int64(-44), '17904': np.int64(178)}
2025-07-07 22:20:59,081 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 22:20:59,083 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,085 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,086 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: -654, Received: 0, Shipped: 83, Repack: 0, EOD: -737
2025-07-07 22:20:59,088 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: -42, Received: 0, Shipped: 1, Repack: 0, EOD: -43
2025-07-07 22:20:59,090 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,091 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: -44, Received: 0, Shipped: 12, Repack: 0, EOD: -56
2025-07-07 22:20:59,093 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,093 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-737), 17904: np.int64(-43), 18675: np.int64(-4), '17612': np.int64(955), 17914: np.int64(-56), '17904': np.int64(178)}
2025-07-07 22:20:59,094 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-07 22:20:59,094 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-737), 17904: np.int64(-43), 18675: np.int64(-4), '17612': np.int64(955), 17914: np.int64(-56), '17904': np.int64(178)}
2025-07-07 22:20:59,095 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,097 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,100 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,103 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,104 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-737), 17904: np.int64(-43), 18675: np.int64(-4), '17612': np.int64(955), 17914: np.int64(-56), '17904': np.int64(178)}
2025-07-07 22:20:59,104 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-07 22:20:59,104 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-737), 17904: np.int64(-43), 18675: np.int64(-4), '17612': np.int64(955), 17914: np.int64(-56), '17904': np.int64(178)}
2025-07-07 22:20:59,106 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,108 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,112 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,116 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,116 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-737), 17904: np.int64(-43), 18675: np.int64(-4), '17612': np.int64(955), 17914: np.int64(-56), '17904': np.int64(178)}
2025-07-07 22:20:59,116 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-07 22:20:59,117 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-737), 17904: np.int64(-43), 18675: np.int64(-4), '17612': np.int64(955), 17914: np.int64(-56), '17904': np.int64(178)}
2025-07-07 22:20:59,117 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 22:20:59,120 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,122 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,124 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: -737, Received: 0, Shipped: 164, Repack: 0, EOD: -901
2025-07-07 22:20:59,125 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: -43, Received: 0, Shipped: 2, Repack: 0, EOD: -45
2025-07-07 22:20:59,127 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: -4, Received: 0, Shipped: 3, Repack: 0, EOD: -7
2025-07-07 22:20:59,129 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,131 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: -56, Received: 0, Shipped: 3, Repack: 0, EOD: -59
2025-07-07 22:20:59,134 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,134 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-901), 17904: np.int64(-45), 18675: np.int64(-7), '17612': np.int64(955), 17914: np.int64(-59), '17904': np.int64(178)}
2025-07-07 22:20:59,135 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-07 22:20:59,135 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-901), 17904: np.int64(-45), 18675: np.int64(-7), '17612': np.int64(955), 17914: np.int64(-59), '17904': np.int64(178)}
2025-07-07 22:20:59,136 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 22:20:59,138 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,140 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,142 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: -901, Received: 0, Shipped: 56, Repack: 0, EOD: -957
2025-07-07 22:20:59,143 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: -45, Received: 0, Shipped: 1, Repack: 0, EOD: -46
2025-07-07 22:20:59,145 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: -7, Received: 0, Shipped: 12, Repack: 0, EOD: -19
2025-07-07 22:20:59,146 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,147 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: -59, Received: 0, Shipped: 11, Repack: 0, EOD: -70
2025-07-07 22:20:59,151 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,151 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-957), 17904: np.int64(-46), 18675: np.int64(-19), '17612': np.int64(955), 17914: np.int64(-70), '17904': np.int64(178)}
2025-07-07 22:20:59,152 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-07 22:20:59,152 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-957), 17904: np.int64(-46), 18675: np.int64(-19), '17612': np.int64(955), 17914: np.int64(-70), '17904': np.int64(178)}
2025-07-07 22:20:59,152 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 22:20:59,155 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,156 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,157 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -957, Received: 576, Shipped: 57, Repack: 0, EOD: -438
2025-07-07 22:20:59,158 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: -46, Received: 0, Shipped: 1, Repack: 0, EOD: -47
2025-07-07 22:20:59,162 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,162 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: -70, Received: 0, Shipped: 1, Repack: 0, EOD: -71
2025-07-07 22:20:59,164 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,164 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-438), 17904: np.int64(-47), 18675: np.int64(-19), '17612': np.int64(955), 17914: np.int64(-71), '17904': np.int64(178)}
2025-07-07 22:20:59,164 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-07 22:20:59,165 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-438), 17904: np.int64(-47), 18675: np.int64(-19), '17612': np.int64(955), 17914: np.int64(-71), '17904': np.int64(178)}
2025-07-07 22:20:59,168 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 22:20:59,170 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,172 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,173 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: -438, Received: 0, Shipped: 47, Repack: 0, EOD: -485
2025-07-07 22:20:59,174 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: -47, Received: 0, Shipped: 2, Repack: 0, EOD: -49
2025-07-07 22:20:59,177 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,178 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: -71, Received: 0, Shipped: 7, Repack: 0, EOD: -78
2025-07-07 22:20:59,179 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,180 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-485), 17904: np.int64(-49), 18675: np.int64(-19), '17612': np.int64(955), 17914: np.int64(-78), '17904': np.int64(178)}
2025-07-07 22:20:59,180 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-07 22:20:59,181 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-485), 17904: np.int64(-49), 18675: np.int64(-19), '17612': np.int64(955), 17914: np.int64(-78), '17904': np.int64(178)}
2025-07-07 22:20:59,183 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 22:20:59,185 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,186 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,189 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: -485, Received: 0, Shipped: 76, Repack: 0, EOD: -561
2025-07-07 22:20:59,190 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: -49, Received: 0, Shipped: 1, Repack: 0, EOD: -50
2025-07-07 22:20:59,192 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: -19, Received: 0, Shipped: 1, Repack: 0, EOD: -20
2025-07-07 22:20:59,193 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,194 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: -78, Received: 0, Shipped: 5, Repack: 0, EOD: -83
2025-07-07 22:20:59,195 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,197 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-561), 17904: np.int64(-50), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-83), '17904': np.int64(178)}
2025-07-07 22:20:59,198 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-07 22:20:59,198 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-561), 17904: np.int64(-50), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-83), '17904': np.int64(178)}
2025-07-07 22:20:59,201 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,202 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,205 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,207 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,209 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-561), 17904: np.int64(-50), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-83), '17904': np.int64(178)}
2025-07-07 22:20:59,209 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-07 22:20:59,210 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-561), 17904: np.int64(-50), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-83), '17904': np.int64(178)}
2025-07-07 22:20:59,212 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,213 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,217 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,221 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,221 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-561), 17904: np.int64(-50), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-83), '17904': np.int64(178)}
2025-07-07 22:20:59,222 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-07 22:20:59,222 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-561), 17904: np.int64(-50), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-83), '17904': np.int64(178)}
2025-07-07 22:20:59,223 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 22:20:59,225 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,226 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,228 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: -561, Received: 376, Shipped: 21, Repack: 0, EOD: -206
2025-07-07 22:20:59,230 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: -50, Received: 0, Shipped: 6, Repack: 0, EOD: -56
2025-07-07 22:20:59,235 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,237 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,238 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-206), 17904: np.int64(-56), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-83), '17904': np.int64(178)}
2025-07-07 22:20:59,238 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-07 22:20:59,238 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-206), 17904: np.int64(-56), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-83), '17904': np.int64(178)}
2025-07-07 22:20:59,239 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 22:20:59,241 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,242 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,244 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: -206, Received: 0, Shipped: 42, Repack: 0, EOD: -248
2025-07-07 22:20:59,245 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: -56, Received: 0, Shipped: 1, Repack: 0, EOD: -57
2025-07-07 22:20:59,247 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,251 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: -83, Received: 0, Shipped: 1, Repack: 0, EOD: -84
2025-07-07 22:20:59,253 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,254 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-248), 17904: np.int64(-57), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-84), '17904': np.int64(178)}
2025-07-07 22:20:59,254 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-07 22:20:59,255 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-248), 17904: np.int64(-57), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-84), '17904': np.int64(178)}
2025-07-07 22:20:59,256 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 22:20:59,259 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,261 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,263 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: -248, Received: 0, Shipped: 173, Repack: 0, EOD: -421
2025-07-07 22:20:59,267 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: -57, Received: 0, Shipped: 1, Repack: 0, EOD: -58
2025-07-07 22:20:59,270 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,272 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: -84, Received: 0, Shipped: 4, Repack: 0, EOD: -88
2025-07-07 22:20:59,274 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,275 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-421), 17904: np.int64(-58), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-88), '17904': np.int64(178)}
2025-07-07 22:20:59,275 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-07 22:20:59,275 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-421), 17904: np.int64(-58), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-88), '17904': np.int64(178)}
2025-07-07 22:20:59,276 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 22:20:59,278 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,280 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,283 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: -421, Received: 0, Shipped: 60, Repack: 0, EOD: -481
2025-07-07 22:20:59,285 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: -58, Received: 0, Shipped: 2, Repack: 0, EOD: -60
2025-07-07 22:20:59,288 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,290 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: -88, Received: 0, Shipped: 9, Repack: 0, EOD: -97
2025-07-07 22:20:59,292 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,292 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-481), 17904: np.int64(-60), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-97), '17904': np.int64(178)}
2025-07-07 22:20:59,293 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-07 22:20:59,293 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-481), 17904: np.int64(-60), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-97), '17904': np.int64(178)}
2025-07-07 22:20:59,295 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 22:20:59,297 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,299 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,300 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: -481, Received: 0, Shipped: 51, Repack: 0, EOD: -532
2025-07-07 22:20:59,302 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: -60, Received: 0, Shipped: 3, Repack: 0, EOD: -63
2025-07-07 22:20:59,306 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,307 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: -97, Received: 0, Shipped: 6, Repack: 0, EOD: -103
2025-07-07 22:20:59,336 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,337 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-532), 17904: np.int64(-63), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-103), '17904': np.int64(178)}
2025-07-07 22:20:59,337 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-07 22:20:59,338 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-532), 17904: np.int64(-63), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-103), '17904': np.int64(178)}
2025-07-07 22:20:59,340 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,341 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,346 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,348 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,349 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-532), 17904: np.int64(-63), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-103), '17904': np.int64(178)}
2025-07-07 22:20:59,349 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-07 22:20:59,349 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-532), 17904: np.int64(-63), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-103), '17904': np.int64(178)}
2025-07-07 22:20:59,352 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,354 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,357 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,362 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,362 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-532), 17904: np.int64(-63), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-103), '17904': np.int64(178)}
2025-07-07 22:20:59,363 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-07 22:20:59,363 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-532), 17904: np.int64(-63), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-103), '17904': np.int64(178)}
2025-07-07 22:20:59,364 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 22:20:59,365 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:20:59,367 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:20:59,373 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: -532, Received: 0, Shipped: 84, Repack: 0, EOD: -616
2025-07-07 22:20:59,379 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: -63, Received: 0, Shipped: 3, Repack: 0, EOD: -66
2025-07-07 22:20:59,392 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:20:59,402 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: -103, Received: 0, Shipped: 1, Repack: 0, EOD: -104
2025-07-07 22:20:59,408 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:20:59,410 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(326), '18675': np.int64(769), 17612: np.int64(-616), 17904: np.int64(-66), 18675: np.int64(-20), '17612': np.int64(955), 17914: np.int64(-104), '17904': np.int64(178)}
2025-07-07 22:20:59,430 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612              0              0
3  2025-06-01  17904              0              0
6  2025-06-01  17914              0              0
4  2025-06-01  18675              0              0
5  2025-06-01  17612            955            955
2025-07-07 22:20:59,432 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
236  2025-06-30  18675            -20            -20
237  2025-06-30  17612            955            955
239  2025-06-30  17904            178            178
232  2025-06-30  17914            326            326
233  2025-06-30  18675            769            769
2025-07-07 22:20:59,433 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 22:20:59,433 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 22:20:59,436 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612              0              0
3  2025-06-01  17904              0              0
6  2025-06-01  17914              0              0
4  2025-06-01  18675              0              0
5  2025-06-01  17612            955            955
2025-07-07 22:20:59,439 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
236  2025-06-30  18675            -20            -20
237  2025-06-30  17612            955            955
239  2025-06-30  17904            178            178
232  2025-06-30  17914            326            326
233  2025-06-30  18675            769            769
2025-07-07 22:20:59,440 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 22:20:59,450 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     211.887500
std      439.442172
min     -957.000000
25%      -45.250000
50%      178.000000
75%      436.750000
max      955.000000
2025-07-07 22:20:59,454 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
5    2025-06-01            955
13   2025-06-02            955
21   2025-06-03            955
29   2025-06-04            955
37   2025-06-05            955
45   2025-06-06            955
53   2025-06-07            955
61   2025-06-08            955
69   2025-06-09            955
77   2025-06-10            955
85   2025-06-11            955
93   2025-06-12            955
101  2025-06-13            955
109  2025-06-14            955
117  2025-06-15            955
125  2025-06-16            955
133  2025-06-17            955
141  2025-06-18            955
149  2025-06-19            955
157  2025-06-20            955
165  2025-06-21            955
173  2025-06-22            955
181  2025-06-23            955
189  2025-06-24            955
197  2025-06-25            955
205  2025-06-26            955
213  2025-06-27            955
221  2025-06-28            955
229  2025-06-29            955
237  2025-06-30            955
2025-07-07 22:20:59,458 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
7    2025-06-01            178
15   2025-06-02            178
23   2025-06-03            178
31   2025-06-04            178
39   2025-06-05            178
47   2025-06-06            178
55   2025-06-07            178
63   2025-06-08            178
71   2025-06-09            178
79   2025-06-10            178
87   2025-06-11            178
95   2025-06-12            178
103  2025-06-13            178
111  2025-06-14            178
119  2025-06-15            178
127  2025-06-16            178
135  2025-06-17            178
143  2025-06-18            178
151  2025-06-19            178
159  2025-06-20            178
167  2025-06-21            178
175  2025-06-22            178
183  2025-06-23            178
191  2025-06-24            178
199  2025-06-25            178
207  2025-06-26            178
215  2025-06-27            178
223  2025-06-28            178
231  2025-06-29            178
239  2025-06-30            178
2025-07-07 22:20:59,481 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 22:20:59,484 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       5.625000
std        7.679852
min        0.000000
25%        0.000000
50%        1.500000
75%        8.000000
max       20.000000
2025-07-07 22:20:59,488 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
5    2025-06-01           20
13   2025-06-02           20
21   2025-06-03           20
29   2025-06-04           20
37   2025-06-05           20
45   2025-06-06           20
53   2025-06-07           20
61   2025-06-08           20
69   2025-06-09           20
77   2025-06-10           20
85   2025-06-11           20
93   2025-06-12           20
101  2025-06-13           20
109  2025-06-14           20
117  2025-06-15           20
125  2025-06-16           20
133  2025-06-17           20
141  2025-06-18           20
149  2025-06-19           20
157  2025-06-20           20
165  2025-06-21           20
173  2025-06-22           20
181  2025-06-23           20
189  2025-06-24           20
197  2025-06-25           20
205  2025-06-26           20
213  2025-06-27           20
221  2025-06-28           20
229  2025-06-29           20
237  2025-06-30           20
2025-07-07 22:20:59,493 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    45
2025-06-03    45
2025-06-04    45
2025-06-05    45
2025-07-07 22:20:59,495 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    45
2025-06-27    45
2025-06-28    45
2025-06-29    45
2025-06-30    45
2025-07-07 22:20:59,497 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 22:20:59,498 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 22:20:59,504 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 22:20:59,508 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    20.25
2025-06-03    20.25
2025-06-04    20.25
2025-06-05    20.25
2025-07-07 22:20:59,514 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    20.25
2025-06-27    20.25
2025-06-28    20.25
2025-06-29    20.25
2025-06-30    20.25
2025-07-07 22:20:59,552 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 22:20:59,554 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 22:20:59,555 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:20:59,557 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:20:59,563 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:20:59,815 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:20:59,817 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:20:59,818 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:20:59,819 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 22:20:59,876 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:21:00,015 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:21:00,018 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:21:00,366 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:00,585 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:00,916 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:21:01,095 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:21:01,098 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 22:21:01,298 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:21:01,300 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 22:21:01,301 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 22:21:01,303 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 22:21:01,304 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 22:21:01,402 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 22:21:01,403 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 22:21:01,404 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 22:21:01,407 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 22:21:01,412 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 22:21:01,414 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 22:21:01,416 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 22:21:01,425 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 22:21:01,427 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 22:21:01,437 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:21:01,438 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:21:01,447 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:21:01,709 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:21:01,714 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:21:01,716 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:21:01,718 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 22:21:01,789 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:21:01,960 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:21:01,962 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:21:02,240 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:02,470 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:02,664 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:21:02,871 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:21:02,874 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 22:21:03,066 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:21:03,068 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 22:21:03,069 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 22:21:03,070 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 22:21:03,071 - __main__ - INFO - Script finished successfully.
2025-07-07 22:21:24,131 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:21:24,131 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:21:24,760 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:21:24,761 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:21:24,761 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:21:24,761 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:21:24,775 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:21:25,002 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:21:25,004 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:21:25,005 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:21:25,006 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:21:25,032 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:21:25,180 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:21:25,181 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:21:25,482 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:25,642 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:25,643 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:21:25,817 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:21:25,822 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:21:25,831 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:21:25,834 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:21:25,836 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:21:25,838 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:21:25,846 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:21:26,091 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:21:26,094 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:21:26,095 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:21:26,096 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:21:26,134 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:21:26,277 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:21:26,280 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:21:26,530 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:26,677 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:26,678 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:21:26,845 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:21:26,847 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:21:26,849 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 22:21:26,851 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:21:26,852 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:21:26,852 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:21:26,856 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:21:27,117 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:21:27,122 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:21:27,122 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:21:27,123 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:21:27,160 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:21:27,312 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:21:27,316 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:21:27,542 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:27,692 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:27,693 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:21:27,870 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:21:27,872 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:21:27,874 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 22:21:27,876 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 22:21:27,886 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 22:21:27,888 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 22:21:27,888 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 22:21:27,889 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:21:27,890 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:21:27,893 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:21:28,102 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:21:28,104 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:21:28,105 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:21:28,105 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:21:28,130 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:21:28,271 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:21:28,272 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:21:28,497 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:28,643 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:28,645 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 22:21:28,819 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 22:21:28,835 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 22:21:28,843 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 22:21:28,845 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 22:21:28,846 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 22:21:28,847 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:21:28,848 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:21:28,853 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:21:29,071 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:21:29,074 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:21:29,075 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:21:29,075 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:21:29,099 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:21:29,252 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:21:29,254 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:21:29,505 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:29,642 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:29,645 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 22:21:29,831 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 22:21:29,836 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 22:21:29,844 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 22:21:29,845 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 22:21:29,845 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:21:29,847 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:21:29,851 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:21:30,066 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:21:30,067 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:21:30,067 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:21:30,067 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:21:30,091 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:21:30,246 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:21:30,248 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:21:30,487 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:30,637 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:30,638 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 22:21:30,891 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 22:21:30,893 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 22:21:30,902 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 22:21:30,902 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 22:21:30,905 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes BEFORE date conversion and filtering:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 22:21:30,906 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head BEFORE conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 22:21:30,914 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df dtypes AFTER date conversion:
Ship Date           object
SKU - Lot           object
Quantity Shipped     int64
SKU                 object
Quantity_Shipped     int64
Date                object
2025-07-07 22:21:30,915 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df 'Date' column head AFTER conversion:
0    2025-06-02
1    2025-06-02
2    2025-06-02
3    2025-06-02
4    2025-06-02
2025-07-07 22:21:30,916 - src.services.reporting_logic.monthly_report_generator - DEBUG - Report start_date: 2025-06-01, end_date: 2025-06-30
2025-07-07 22:21:30,922 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 22:21:30,924 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 22:21:30,925 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 22:21:30,929 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 22:21:30,932 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 22:21:30,933 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 22:21:30,937 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 22:21:30,938 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 22:21:30,938 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 22:21:30,940 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 22:21:30,940 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 22:21:30,943 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 22:21:30,946 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17904': 178, 17612: 0, '17914': 326, '17612': 955, 17904: 0, 18675: 0, '18675': 769, 17914: 0}
2025-07-07 22:21:30,946 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-07 22:21:30,947 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17904': 178, 17612: 0, '17914': 326, '17612': 955, 17904: 0, 18675: 0, '18675': 769, 17914: 0}
2025-07-07 22:21:30,951 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:30,956 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:30,961 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:30,967 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:30,970 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17904': np.int64(178), 17612: np.int64(0), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(0), 18675: np.int64(0), '18675': np.int64(769), 17914: np.int64(0)}
2025-07-07 22:21:30,972 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-07 22:21:30,972 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17904': np.int64(178), 17612: np.int64(0), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(0), 18675: np.int64(0), '18675': np.int64(769), 17914: np.int64(0)}
2025-07-07 22:21:30,974 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 22:21:30,980 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:30,983 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 0, Received: 0, Shipped: 71, Repack: 0, EOD: -71
2025-07-07 22:21:30,986 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:30,990 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:30,996 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 0, Received: 0, Shipped: 2, Repack: 0, EOD: -2
2025-07-07 22:21:30,998 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 0, Received: 0, Shipped: 1, Repack: 0, EOD: -1
2025-07-07 22:21:31,001 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,006 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 0, Received: 0, Shipped: 3, Repack: 0, EOD: -3
2025-07-07 22:21:31,007 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17904': np.int64(178), 17612: np.int64(-71), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-2), 18675: np.int64(-1), '18675': np.int64(769), 17914: np.int64(-3)}
2025-07-07 22:21:31,007 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-07 22:21:31,008 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17904': np.int64(178), 17612: np.int64(-71), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-2), 18675: np.int64(-1), '18675': np.int64(769), 17914: np.int64(-3)}
2025-07-07 22:21:31,010 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 22:21:31,015 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,018 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: -71, Received: 0, Shipped: 94, Repack: 0, EOD: -165
2025-07-07 22:21:31,023 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,027 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,031 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: -2, Received: 0, Shipped: 13, Repack: 0, EOD: -15
2025-07-07 22:21:31,038 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,044 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: -3, Received: 0, Shipped: 6, Repack: 0, EOD: -9
2025-07-07 22:21:31,045 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17904': np.int64(178), 17612: np.int64(-165), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-15), 18675: np.int64(-1), '18675': np.int64(769), 17914: np.int64(-9)}
2025-07-07 22:21:31,047 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-07 22:21:31,048 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17904': np.int64(178), 17612: np.int64(-165), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-15), 18675: np.int64(-1), '18675': np.int64(769), 17914: np.int64(-9)}
2025-07-07 22:21:31,049 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 22:21:31,053 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,057 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: -165, Received: 478, Shipped: 119, Repack: 0, EOD: 194
2025-07-07 22:21:31,065 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,069 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,075 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: -15, Received: 0, Shipped: 7, Repack: 0, EOD: -22
2025-07-07 22:21:31,081 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,084 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: -9, Received: 0, Shipped: 7, Repack: 0, EOD: -16
2025-07-07 22:21:31,085 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17904': np.int64(178), 17612: np.int64(194), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-22), 18675: np.int64(-1), '18675': np.int64(769), 17914: np.int64(-16)}
2025-07-07 22:21:31,085 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-07 22:21:31,086 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17904': np.int64(178), 17612: np.int64(194), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-22), 18675: np.int64(-1), '18675': np.int64(769), 17914: np.int64(-16)}
2025-07-07 22:21:31,089 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 22:21:31,097 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,102 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 194, Received: 0, Shipped: 296, Repack: 0, EOD: -102
2025-07-07 22:21:31,106 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,114 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,117 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: -22, Received: 0, Shipped: 1, Repack: 0, EOD: -23
2025-07-07 22:21:31,126 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,129 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: -16, Received: 0, Shipped: 7, Repack: 0, EOD: -23
2025-07-07 22:21:31,130 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17904': np.int64(178), 17612: np.int64(-102), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-23), 18675: np.int64(-1), '18675': np.int64(769), 17914: np.int64(-23)}
2025-07-07 22:21:31,131 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-07 22:21:31,131 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17904': np.int64(178), 17612: np.int64(-102), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-23), 18675: np.int64(-1), '18675': np.int64(769), 17914: np.int64(-23)}
2025-07-07 22:21:31,132 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 22:21:31,135 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,139 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: -102, Received: 0, Shipped: 117, Repack: 0, EOD: -219
2025-07-07 22:21:31,145 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,150 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,153 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: -23, Received: 0, Shipped: 2, Repack: 0, EOD: -25
2025-07-07 22:21:31,156 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: -1, Received: 0, Shipped: 1, Repack: 0, EOD: -2
2025-07-07 22:21:31,163 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,166 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: -23, Received: 0, Shipped: 1, Repack: 0, EOD: -24
2025-07-07 22:21:31,167 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17904': np.int64(178), 17612: np.int64(-219), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-25), 18675: np.int64(-2), '18675': np.int64(769), 17914: np.int64(-24)}
2025-07-07 22:21:31,167 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-07 22:21:31,168 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17904': np.int64(178), 17612: np.int64(-219), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-25), 18675: np.int64(-2), '18675': np.int64(769), 17914: np.int64(-24)}
2025-07-07 22:21:31,171 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,179 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,182 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,195 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,201 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17904': np.int64(178), 17612: np.int64(-219), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-25), 18675: np.int64(-2), '18675': np.int64(769), 17914: np.int64(-24)}
2025-07-07 22:21:31,204 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-07 22:21:31,208 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17904': np.int64(178), 17612: np.int64(-219), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-25), 18675: np.int64(-2), '18675': np.int64(769), 17914: np.int64(-24)}
2025-07-07 22:21:31,214 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,221 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,226 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,235 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,242 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17904': np.int64(178), 17612: np.int64(-219), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-25), 18675: np.int64(-2), '18675': np.int64(769), 17914: np.int64(-24)}
2025-07-07 22:21:31,244 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-07 22:21:31,245 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17904': np.int64(178), 17612: np.int64(-219), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-25), 18675: np.int64(-2), '18675': np.int64(769), 17914: np.int64(-24)}
2025-07-07 22:21:31,246 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 22:21:31,249 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,257 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: -219, Received: 0, Shipped: 47, Repack: 0, EOD: -266
2025-07-07 22:21:31,266 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,271 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,276 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: -25, Received: 0, Shipped: 2, Repack: 0, EOD: -27
2025-07-07 22:21:31,281 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: -2, Received: 0, Shipped: 1, Repack: 0, EOD: -3
2025-07-07 22:21:31,285 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,289 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: -24, Received: 0, Shipped: 3, Repack: 0, EOD: -27
2025-07-07 22:21:31,290 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17904': np.int64(178), 17612: np.int64(-266), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-27), 18675: np.int64(-3), '18675': np.int64(769), 17914: np.int64(-27)}
2025-07-07 22:21:31,291 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-07 22:21:31,293 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17904': np.int64(178), 17612: np.int64(-266), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-27), 18675: np.int64(-3), '18675': np.int64(769), 17914: np.int64(-27)}
2025-07-07 22:21:31,295 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 22:21:31,301 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,307 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: -266, Received: 0, Shipped: 87, Repack: 0, EOD: -353
2025-07-07 22:21:31,312 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,316 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,323 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,331 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: -27, Received: 0, Shipped: 3, Repack: 0, EOD: -30
2025-07-07 22:21:31,332 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17904': np.int64(178), 17612: np.int64(-353), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-27), 18675: np.int64(-3), '18675': np.int64(769), 17914: np.int64(-30)}
2025-07-07 22:21:31,332 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-07 22:21:31,334 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17904': np.int64(178), 17612: np.int64(-353), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-27), 18675: np.int64(-3), '18675': np.int64(769), 17914: np.int64(-30)}
2025-07-07 22:21:31,335 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 22:21:31,340 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,349 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: -353, Received: 0, Shipped: 67, Repack: 0, EOD: -420
2025-07-07 22:21:31,355 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,358 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,362 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: -27, Received: 0, Shipped: 1, Repack: 0, EOD: -28
2025-07-07 22:21:31,366 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: -3, Received: 0, Shipped: 1, Repack: 0, EOD: -4
2025-07-07 22:21:31,369 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,372 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: -30, Received: 0, Shipped: 3, Repack: 0, EOD: -33
2025-07-07 22:21:31,373 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17904': np.int64(178), 17612: np.int64(-420), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-28), 18675: np.int64(-4), '18675': np.int64(769), 17914: np.int64(-33)}
2025-07-07 22:21:31,373 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-07 22:21:31,375 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17904': np.int64(178), 17612: np.int64(-420), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-28), 18675: np.int64(-4), '18675': np.int64(769), 17914: np.int64(-33)}
2025-07-07 22:21:31,377 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 22:21:31,380 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,383 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: -420, Received: 0, Shipped: 234, Repack: 0, EOD: -654
2025-07-07 22:21:31,387 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,392 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,398 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: -28, Received: 0, Shipped: 14, Repack: 0, EOD: -42
2025-07-07 22:21:31,411 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,421 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: -33, Received: 0, Shipped: 11, Repack: 0, EOD: -44
2025-07-07 22:21:31,421 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17904': np.int64(178), 17612: np.int64(-654), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-42), 18675: np.int64(-4), '18675': np.int64(769), 17914: np.int64(-44)}
2025-07-07 22:21:31,422 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-07 22:21:31,425 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17904': np.int64(178), 17612: np.int64(-654), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-42), 18675: np.int64(-4), '18675': np.int64(769), 17914: np.int64(-44)}
2025-07-07 22:21:31,427 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 22:21:31,431 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,434 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: -654, Received: 0, Shipped: 83, Repack: 0, EOD: -737
2025-07-07 22:21:31,440 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,447 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,450 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: -42, Received: 0, Shipped: 1, Repack: 0, EOD: -43
2025-07-07 22:21:31,455 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,460 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: -44, Received: 0, Shipped: 12, Repack: 0, EOD: -56
2025-07-07 22:21:31,461 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17904': np.int64(178), 17612: np.int64(-737), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-43), 18675: np.int64(-4), '18675': np.int64(769), 17914: np.int64(-56)}
2025-07-07 22:21:31,462 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-07 22:21:31,462 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17904': np.int64(178), 17612: np.int64(-737), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-43), 18675: np.int64(-4), '18675': np.int64(769), 17914: np.int64(-56)}
2025-07-07 22:21:31,466 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,473 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,477 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,490 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,502 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17904': np.int64(178), 17612: np.int64(-737), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-43), 18675: np.int64(-4), '18675': np.int64(769), 17914: np.int64(-56)}
2025-07-07 22:21:31,504 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-07 22:21:31,509 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17904': np.int64(178), 17612: np.int64(-737), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-43), 18675: np.int64(-4), '18675': np.int64(769), 17914: np.int64(-56)}
2025-07-07 22:21:31,533 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,552 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,557 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,584 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,594 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17904': np.int64(178), 17612: np.int64(-737), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-43), 18675: np.int64(-4), '18675': np.int64(769), 17914: np.int64(-56)}
2025-07-07 22:21:31,595 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-07 22:21:31,598 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17904': np.int64(178), 17612: np.int64(-737), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-43), 18675: np.int64(-4), '18675': np.int64(769), 17914: np.int64(-56)}
2025-07-07 22:21:31,601 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 22:21:31,609 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,617 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: -737, Received: 0, Shipped: 164, Repack: 0, EOD: -901
2025-07-07 22:21:31,624 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,631 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,635 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: -43, Received: 0, Shipped: 2, Repack: 0, EOD: -45
2025-07-07 22:21:31,644 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: -4, Received: 0, Shipped: 3, Repack: 0, EOD: -7
2025-07-07 22:21:31,648 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,654 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: -56, Received: 0, Shipped: 3, Repack: 0, EOD: -59
2025-07-07 22:21:31,656 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17904': np.int64(178), 17612: np.int64(-901), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-45), 18675: np.int64(-7), '18675': np.int64(769), 17914: np.int64(-59)}
2025-07-07 22:21:31,657 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-07 22:21:31,657 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17904': np.int64(178), 17612: np.int64(-901), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-45), 18675: np.int64(-7), '18675': np.int64(769), 17914: np.int64(-59)}
2025-07-07 22:21:31,659 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 22:21:31,664 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,668 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: -901, Received: 0, Shipped: 56, Repack: 0, EOD: -957
2025-07-07 22:21:31,674 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,680 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,685 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: -45, Received: 0, Shipped: 1, Repack: 0, EOD: -46
2025-07-07 22:21:31,694 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: -7, Received: 0, Shipped: 12, Repack: 0, EOD: -19
2025-07-07 22:21:31,700 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,707 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: -59, Received: 0, Shipped: 11, Repack: 0, EOD: -70
2025-07-07 22:21:31,710 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17904': np.int64(178), 17612: np.int64(-957), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-46), 18675: np.int64(-19), '18675': np.int64(769), 17914: np.int64(-70)}
2025-07-07 22:21:31,712 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-07 22:21:31,713 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17904': np.int64(178), 17612: np.int64(-957), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-46), 18675: np.int64(-19), '18675': np.int64(769), 17914: np.int64(-70)}
2025-07-07 22:21:31,715 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 22:21:31,721 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,725 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -957, Received: 576, Shipped: 57, Repack: 0, EOD: -438
2025-07-07 22:21:31,729 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,732 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,735 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: -46, Received: 0, Shipped: 1, Repack: 0, EOD: -47
2025-07-07 22:21:31,740 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,747 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: -70, Received: 0, Shipped: 1, Repack: 0, EOD: -71
2025-07-07 22:21:31,748 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17904': np.int64(178), 17612: np.int64(-438), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-47), 18675: np.int64(-19), '18675': np.int64(769), 17914: np.int64(-71)}
2025-07-07 22:21:31,748 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-07 22:21:31,749 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17904': np.int64(178), 17612: np.int64(-438), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-47), 18675: np.int64(-19), '18675': np.int64(769), 17914: np.int64(-71)}
2025-07-07 22:21:31,750 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 22:21:31,754 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,761 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: -438, Received: 0, Shipped: 47, Repack: 0, EOD: -485
2025-07-07 22:21:31,765 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,767 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,772 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: -47, Received: 0, Shipped: 2, Repack: 0, EOD: -49
2025-07-07 22:21:31,782 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,788 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: -71, Received: 0, Shipped: 7, Repack: 0, EOD: -78
2025-07-07 22:21:31,789 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17904': np.int64(178), 17612: np.int64(-485), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-49), 18675: np.int64(-19), '18675': np.int64(769), 17914: np.int64(-78)}
2025-07-07 22:21:31,794 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-07 22:21:31,794 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17904': np.int64(178), 17612: np.int64(-485), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-49), 18675: np.int64(-19), '18675': np.int64(769), 17914: np.int64(-78)}
2025-07-07 22:21:31,797 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 22:21:31,802 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,809 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: -485, Received: 0, Shipped: 76, Repack: 0, EOD: -561
2025-07-07 22:21:31,817 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,823 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,835 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: -49, Received: 0, Shipped: 1, Repack: 0, EOD: -50
2025-07-07 22:21:31,844 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: -19, Received: 0, Shipped: 1, Repack: 0, EOD: -20
2025-07-07 22:21:31,848 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,854 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: -78, Received: 0, Shipped: 5, Repack: 0, EOD: -83
2025-07-07 22:21:31,859 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17904': np.int64(178), 17612: np.int64(-561), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-50), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-83)}
2025-07-07 22:21:31,862 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-07 22:21:31,862 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17904': np.int64(178), 17612: np.int64(-561), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-50), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-83)}
2025-07-07 22:21:31,868 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,880 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,887 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,911 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,918 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17904': np.int64(178), 17612: np.int64(-561), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-50), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-83)}
2025-07-07 22:21:31,919 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-07 22:21:31,920 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17904': np.int64(178), 17612: np.int64(-561), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-50), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-83)}
2025-07-07 22:21:31,928 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,934 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,940 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,953 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:31,959 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17904': np.int64(178), 17612: np.int64(-561), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-50), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-83)}
2025-07-07 22:21:31,962 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-07 22:21:31,964 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17904': np.int64(178), 17612: np.int64(-561), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-50), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-83)}
2025-07-07 22:21:31,966 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 22:21:31,975 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:31,984 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: -561, Received: 376, Shipped: 21, Repack: 0, EOD: -206
2025-07-07 22:21:31,993 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:31,996 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:31,999 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: -50, Received: 0, Shipped: 6, Repack: 0, EOD: -56
2025-07-07 22:21:32,010 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:32,013 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17904': np.int64(178), 17612: np.int64(-206), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-56), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-83)}
2025-07-07 22:21:32,014 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-07 22:21:32,015 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17904': np.int64(178), 17612: np.int64(-206), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-56), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-83)}
2025-07-07 22:21:32,016 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 22:21:32,034 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:32,058 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: -206, Received: 0, Shipped: 42, Repack: 0, EOD: -248
2025-07-07 22:21:32,062 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:32,066 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:32,070 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: -56, Received: 0, Shipped: 1, Repack: 0, EOD: -57
2025-07-07 22:21:32,079 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:32,083 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: -83, Received: 0, Shipped: 1, Repack: 0, EOD: -84
2025-07-07 22:21:32,084 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17904': np.int64(178), 17612: np.int64(-248), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-57), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-84)}
2025-07-07 22:21:32,084 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-07 22:21:32,085 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17904': np.int64(178), 17612: np.int64(-248), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-57), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-84)}
2025-07-07 22:21:32,088 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 22:21:32,095 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:32,098 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: -248, Received: 0, Shipped: 173, Repack: 0, EOD: -421
2025-07-07 22:21:32,102 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:32,112 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:32,116 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: -57, Received: 0, Shipped: 1, Repack: 0, EOD: -58
2025-07-07 22:21:32,125 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:32,136 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: -84, Received: 0, Shipped: 4, Repack: 0, EOD: -88
2025-07-07 22:21:32,139 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17904': np.int64(178), 17612: np.int64(-421), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-58), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-88)}
2025-07-07 22:21:32,141 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-07 22:21:32,143 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17904': np.int64(178), 17612: np.int64(-421), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-58), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-88)}
2025-07-07 22:21:32,145 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 22:21:32,149 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:32,152 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: -421, Received: 0, Shipped: 60, Repack: 0, EOD: -481
2025-07-07 22:21:32,158 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:32,162 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:32,165 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: -58, Received: 0, Shipped: 2, Repack: 0, EOD: -60
2025-07-07 22:21:32,171 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:32,177 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: -88, Received: 0, Shipped: 9, Repack: 0, EOD: -97
2025-07-07 22:21:32,178 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17904': np.int64(178), 17612: np.int64(-481), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-60), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-97)}
2025-07-07 22:21:32,180 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-07 22:21:32,180 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17904': np.int64(178), 17612: np.int64(-481), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-60), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-97)}
2025-07-07 22:21:32,181 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 22:21:32,185 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:32,189 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: -481, Received: 0, Shipped: 51, Repack: 0, EOD: -532
2025-07-07 22:21:32,193 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:32,197 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:32,201 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: -60, Received: 0, Shipped: 3, Repack: 0, EOD: -63
2025-07-07 22:21:32,209 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:32,251 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: -97, Received: 0, Shipped: 6, Repack: 0, EOD: -103
2025-07-07 22:21:32,252 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17904': np.int64(178), 17612: np.int64(-532), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-63), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-103)}
2025-07-07 22:21:32,253 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-07 22:21:32,253 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17904': np.int64(178), 17612: np.int64(-532), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-63), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-103)}
2025-07-07 22:21:32,260 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:32,265 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:32,267 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:32,277 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:32,279 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17904': np.int64(178), 17612: np.int64(-532), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-63), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-103)}
2025-07-07 22:21:32,280 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-07 22:21:32,280 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17904': np.int64(178), 17612: np.int64(-532), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-63), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-103)}
2025-07-07 22:21:32,283 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:32,291 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:32,298 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:32,312 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:32,315 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17904': np.int64(178), 17612: np.int64(-532), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-63), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-103)}
2025-07-07 22:21:32,316 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-07 22:21:32,317 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17904': np.int64(178), 17612: np.int64(-532), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-63), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-103)}
2025-07-07 22:21:32,318 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 22:21:32,324 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:21:32,329 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: -532, Received: 0, Shipped: 84, Repack: 0, EOD: -616
2025-07-07 22:21:32,332 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:21:32,334 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:21:32,339 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: -63, Received: 0, Shipped: 3, Repack: 0, EOD: -66
2025-07-07 22:21:32,347 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:21:32,350 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: -103, Received: 0, Shipped: 1, Repack: 0, EOD: -104
2025-07-07 22:21:32,351 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17904': np.int64(178), 17612: np.int64(-616), '17914': np.int64(326), '17612': np.int64(955), 17904: np.int64(-66), 18675: np.int64(-20), '18675': np.int64(769), 17914: np.int64(-104)}
2025-07-07 22:21:32,357 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612              0              0
4  2025-06-01  17904              0              0
7  2025-06-01  17914              0              0
5  2025-06-01  18675              0              0
3  2025-06-01  17612            955            955
2025-07-07 22:21:32,361 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
237  2025-06-30  18675            -20            -20
235  2025-06-30  17612            955            955
232  2025-06-30  17904            178            178
234  2025-06-30  17914            326            326
238  2025-06-30  18675            769            769
2025-07-07 22:21:32,361 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 22:21:32,363 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 22:21:32,365 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612              0              0
4  2025-06-01  17904              0              0
7  2025-06-01  17914              0              0
5  2025-06-01  18675              0              0
3  2025-06-01  17612            955            955
2025-07-07 22:21:32,367 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
237  2025-06-30  18675            -20            -20
235  2025-06-30  17612            955            955
232  2025-06-30  17904            178            178
234  2025-06-30  17914            326            326
238  2025-06-30  18675            769            769
2025-07-07 22:21:32,368 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 22:21:32,372 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     211.887500
std      439.442172
min     -957.000000
25%      -45.250000
50%      178.000000
75%      436.750000
max      955.000000
2025-07-07 22:21:32,376 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01            955
11   2025-06-02            955
19   2025-06-03            955
27   2025-06-04            955
35   2025-06-05            955
43   2025-06-06            955
51   2025-06-07            955
59   2025-06-08            955
67   2025-06-09            955
75   2025-06-10            955
83   2025-06-11            955
91   2025-06-12            955
99   2025-06-13            955
107  2025-06-14            955
115  2025-06-15            955
123  2025-06-16            955
131  2025-06-17            955
139  2025-06-18            955
147  2025-06-19            955
155  2025-06-20            955
163  2025-06-21            955
171  2025-06-22            955
179  2025-06-23            955
187  2025-06-24            955
195  2025-06-25            955
203  2025-06-26            955
211  2025-06-27            955
219  2025-06-28            955
227  2025-06-29            955
235  2025-06-30            955
2025-07-07 22:21:32,381 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
0    2025-06-01            178
8    2025-06-02            178
16   2025-06-03            178
24   2025-06-04            178
32   2025-06-05            178
40   2025-06-06            178
48   2025-06-07            178
56   2025-06-08            178
64   2025-06-09            178
72   2025-06-10            178
80   2025-06-11            178
88   2025-06-12            178
96   2025-06-13            178
104  2025-06-14            178
112  2025-06-15            178
120  2025-06-16            178
128  2025-06-17            178
136  2025-06-18            178
144  2025-06-19            178
152  2025-06-20            178
160  2025-06-21            178
168  2025-06-22            178
176  2025-06-23            178
184  2025-06-24            178
192  2025-06-25            178
200  2025-06-26            178
208  2025-06-27            178
216  2025-06-28            178
224  2025-06-29            178
232  2025-06-30            178
2025-07-07 22:21:32,393 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 22:21:32,399 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       5.625000
std        7.679852
min        0.000000
25%        0.000000
50%        1.500000
75%        8.000000
max       20.000000
2025-07-07 22:21:32,402 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           20
11   2025-06-02           20
19   2025-06-03           20
27   2025-06-04           20
35   2025-06-05           20
43   2025-06-06           20
51   2025-06-07           20
59   2025-06-08           20
67   2025-06-09           20
75   2025-06-10           20
83   2025-06-11           20
91   2025-06-12           20
99   2025-06-13           20
107  2025-06-14           20
115  2025-06-15           20
123  2025-06-16           20
131  2025-06-17           20
139  2025-06-18           20
147  2025-06-19           20
155  2025-06-20           20
163  2025-06-21           20
171  2025-06-22           20
179  2025-06-23           20
187  2025-06-24           20
195  2025-06-25           20
203  2025-06-26           20
211  2025-06-27           20
219  2025-06-28           20
227  2025-06-29           20
235  2025-06-30           20
2025-07-07 22:21:32,405 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    45
2025-06-03    45
2025-06-04    45
2025-06-05    45
2025-07-07 22:21:32,409 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    45
2025-06-27    45
2025-06-28    45
2025-06-29    45
2025-06-30    45
2025-07-07 22:21:32,410 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 22:21:32,411 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 22:21:32,414 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 22:21:32,416 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    20.25
2025-06-03    20.25
2025-06-04    20.25
2025-06-05    20.25
2025-07-07 22:21:32,417 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    20.25
2025-06-27    20.25
2025-06-28    20.25
2025-06-29    20.25
2025-06-30    20.25
2025-07-07 22:21:32,432 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 22:21:32,433 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 22:21:32,434 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:21:32,434 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:21:32,440 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:21:32,642 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:21:32,645 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:21:32,645 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:21:32,647 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 22:21:32,686 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:21:32,843 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:21:32,847 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:21:33,061 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:33,206 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:33,390 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:21:33,574 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:21:33,575 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 22:21:33,741 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:21:33,742 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 22:21:33,743 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 22:21:33,744 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 22:21:33,744 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 22:21:33,763 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 22:21:33,764 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 22:21:33,764 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 22:21:33,765 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 22:21:33,767 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 22:21:33,767 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 22:21:33,768 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 22:21:33,772 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 22:21:33,773 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 22:21:33,777 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:21:33,777 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:21:33,780 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:21:33,983 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:21:33,985 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:21:33,986 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:21:33,987 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 22:21:34,017 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:21:34,174 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:21:34,175 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:21:34,405 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:34,547 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:21:34,775 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:21:35,079 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:21:35,080 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 22:21:35,346 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:21:35,347 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 22:21:35,348 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 22:21:35,349 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 22:21:35,349 - __main__ - INFO - Script finished successfully.
2025-07-07 22:28:42,491 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:28:42,492 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:28:42,862 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:28:42,862 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:28:42,862 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:28:42,862 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:28:42,873 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:28:43,160 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:28:43,163 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:28:43,163 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:28:43,164 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:28:43,189 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:28:43,347 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:28:43,350 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:28:43,837 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:43,986 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:43,989 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:28:44,172 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:28:44,175 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:28:44,180 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:28:44,181 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:28:44,181 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:28:44,182 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:28:44,184 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:28:44,388 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:28:44,391 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:28:44,392 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:28:44,392 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:28:44,414 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:28:44,569 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:28:44,573 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:28:44,799 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:44,948 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:44,950 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:28:45,123 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:28:45,125 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:28:45,127 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 22:28:45,128 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:28:45,129 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:28:45,129 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:28:45,131 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:28:45,343 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:28:45,344 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:28:45,344 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:28:45,344 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:28:45,368 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:28:45,535 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:28:45,540 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:28:45,794 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:45,947 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:45,947 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:28:46,208 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:28:46,211 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:28:46,212 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 22:28:46,213 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 22:28:46,216 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 22:28:46,217 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 22:28:46,218 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 22:28:46,219 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:28:46,219 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:28:46,221 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:28:46,468 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:28:46,470 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:28:46,472 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:28:46,473 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:28:46,506 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:28:46,691 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:28:46,695 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:28:46,937 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:47,077 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:47,079 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 22:28:47,242 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 22:28:47,249 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 22:28:47,253 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 22:28:47,255 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 22:28:47,255 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 22:28:47,257 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:28:47,258 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:28:47,260 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:28:47,455 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:28:47,457 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:28:47,457 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:28:47,458 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:28:47,480 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:28:47,628 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:28:47,629 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:28:47,920 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:48,055 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:48,056 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 22:28:48,217 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 22:28:48,222 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 22:28:48,225 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 22:28:48,225 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 22:28:48,225 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:28:48,226 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:28:48,228 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:28:48,426 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:28:48,427 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:28:48,428 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:28:48,428 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:28:48,449 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:28:48,608 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:28:48,609 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:28:48,935 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:49,088 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:49,090 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 22:28:49,272 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 22:28:49,275 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 22:28:49,282 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 22:28:49,283 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 22:28:49,290 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 22:28:49,292 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 22:28:49,292 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 22:28:49,293 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 22:28:49,294 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 22:28:49,295 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 22:28:49,297 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 22:28:49,298 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 22:28:49,298 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 22:28:49,298 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 22:28:49,299 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 22:28:49,300 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 22:28:49,300 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {17612: 0, 17904: 0, 17914: 0, 18675: 0, '18675': 769, '17612': 955, '17914': 326, '17904': 178}
2025-07-07 22:28:49,301 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-07 22:28:49,301 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {17612: 0, 17904: 0, 17914: 0, 18675: 0, '18675': 769, '17612': 955, '17914': 326, '17904': 178}
2025-07-07 22:28:49,306 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,308 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,310 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,311 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,312 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {17612: np.int64(0), 17904: np.int64(0), 17914: np.int64(0), 18675: np.int64(0), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,312 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-07 22:28:49,313 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {17612: np.int64(0), 17904: np.int64(0), 17914: np.int64(0), 18675: np.int64(0), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,313 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 22:28:49,316 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 0, Received: 0, Shipped: 71, Repack: 0, EOD: -71
2025-07-07 22:28:49,317 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 0, Received: 0, Shipped: 2, Repack: 0, EOD: -2
2025-07-07 22:28:49,319 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 0, Received: 0, Shipped: 3, Repack: 0, EOD: -3
2025-07-07 22:28:49,322 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 0, Received: 0, Shipped: 1, Repack: 0, EOD: -1
2025-07-07 22:28:49,324 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,326 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,328 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,329 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,330 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {17612: np.int64(-71), 17904: np.int64(-2), 17914: np.int64(-3), 18675: np.int64(-1), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,330 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-07 22:28:49,330 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {17612: np.int64(-71), 17904: np.int64(-2), 17914: np.int64(-3), 18675: np.int64(-1), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,331 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 22:28:49,333 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: -71, Received: 0, Shipped: 94, Repack: 0, EOD: -165
2025-07-07 22:28:49,334 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: -2, Received: 0, Shipped: 13, Repack: 0, EOD: -15
2025-07-07 22:28:49,335 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: -3, Received: 0, Shipped: 6, Repack: 0, EOD: -9
2025-07-07 22:28:49,340 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,343 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,345 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,346 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,347 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {17612: np.int64(-165), 17904: np.int64(-15), 17914: np.int64(-9), 18675: np.int64(-1), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,347 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-07 22:28:49,347 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {17612: np.int64(-165), 17904: np.int64(-15), 17914: np.int64(-9), 18675: np.int64(-1), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,348 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 22:28:49,350 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: -165, Received: 478, Shipped: 119, Repack: 0, EOD: 194
2025-07-07 22:28:49,351 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: -15, Received: 0, Shipped: 7, Repack: 0, EOD: -22
2025-07-07 22:28:49,355 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: -9, Received: 0, Shipped: 7, Repack: 0, EOD: -16
2025-07-07 22:28:49,357 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,359 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,360 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,362 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,363 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {17612: np.int64(194), 17904: np.int64(-22), 17914: np.int64(-16), 18675: np.int64(-1), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,363 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-07 22:28:49,363 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {17612: np.int64(194), 17904: np.int64(-22), 17914: np.int64(-16), 18675: np.int64(-1), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,364 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 22:28:49,365 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 194, Received: 0, Shipped: 296, Repack: 0, EOD: -102
2025-07-07 22:28:49,367 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: -22, Received: 0, Shipped: 1, Repack: 0, EOD: -23
2025-07-07 22:28:49,369 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: -16, Received: 0, Shipped: 7, Repack: 0, EOD: -23
2025-07-07 22:28:49,374 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,375 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,376 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,379 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,379 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {17612: np.int64(-102), 17904: np.int64(-23), 17914: np.int64(-23), 18675: np.int64(-1), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,380 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-07 22:28:49,380 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {17612: np.int64(-102), 17904: np.int64(-23), 17914: np.int64(-23), 18675: np.int64(-1), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,380 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 22:28:49,382 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: -102, Received: 0, Shipped: 117, Repack: 0, EOD: -219
2025-07-07 22:28:49,383 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: -23, Received: 0, Shipped: 2, Repack: 0, EOD: -25
2025-07-07 22:28:49,385 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: -23, Received: 0, Shipped: 1, Repack: 0, EOD: -24
2025-07-07 22:28:49,389 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: -1, Received: 0, Shipped: 1, Repack: 0, EOD: -2
2025-07-07 22:28:49,391 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,393 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,394 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,396 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,396 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {17612: np.int64(-219), 17904: np.int64(-25), 17914: np.int64(-24), 18675: np.int64(-2), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,396 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-07 22:28:49,397 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {17612: np.int64(-219), 17904: np.int64(-25), 17914: np.int64(-24), 18675: np.int64(-2), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,401 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,403 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,406 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,407 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,408 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {17612: np.int64(-219), 17904: np.int64(-25), 17914: np.int64(-24), 18675: np.int64(-2), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,408 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-07 22:28:49,408 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {17612: np.int64(-219), 17904: np.int64(-25), 17914: np.int64(-24), 18675: np.int64(-2), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,413 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,414 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,417 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,418 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {17612: np.int64(-219), 17904: np.int64(-25), 17914: np.int64(-24), 18675: np.int64(-2), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,418 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-07 22:28:49,419 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {17612: np.int64(-219), 17904: np.int64(-25), 17914: np.int64(-24), 18675: np.int64(-2), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,420 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 22:28:49,423 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: -219, Received: 0, Shipped: 47, Repack: 0, EOD: -266
2025-07-07 22:28:49,425 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: -25, Received: 0, Shipped: 2, Repack: 0, EOD: -27
2025-07-07 22:28:49,426 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: -24, Received: 0, Shipped: 3, Repack: 0, EOD: -27
2025-07-07 22:28:49,428 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: -2, Received: 0, Shipped: 1, Repack: 0, EOD: -3
2025-07-07 22:28:49,429 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,431 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,432 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,434 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,435 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {17612: np.int64(-266), 17904: np.int64(-27), 17914: np.int64(-27), 18675: np.int64(-3), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,436 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-07 22:28:49,436 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {17612: np.int64(-266), 17904: np.int64(-27), 17914: np.int64(-27), 18675: np.int64(-3), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,438 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 22:28:49,440 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: -266, Received: 0, Shipped: 87, Repack: 0, EOD: -353
2025-07-07 22:28:49,444 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: -27, Received: 0, Shipped: 3, Repack: 0, EOD: -30
2025-07-07 22:28:49,445 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,446 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,449 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,451 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,451 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {17612: np.int64(-353), 17904: np.int64(-27), 17914: np.int64(-30), 18675: np.int64(-3), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,451 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-07 22:28:49,451 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {17612: np.int64(-353), 17904: np.int64(-27), 17914: np.int64(-30), 18675: np.int64(-3), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,452 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 22:28:49,457 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: -353, Received: 0, Shipped: 67, Repack: 0, EOD: -420
2025-07-07 22:28:49,459 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: -27, Received: 0, Shipped: 1, Repack: 0, EOD: -28
2025-07-07 22:28:49,459 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: -30, Received: 0, Shipped: 3, Repack: 0, EOD: -33
2025-07-07 22:28:49,462 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: -3, Received: 0, Shipped: 1, Repack: 0, EOD: -4
2025-07-07 22:28:49,463 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,464 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,466 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,467 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,469 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {17612: np.int64(-420), 17904: np.int64(-28), 17914: np.int64(-33), 18675: np.int64(-4), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,470 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-07 22:28:49,470 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {17612: np.int64(-420), 17904: np.int64(-28), 17914: np.int64(-33), 18675: np.int64(-4), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,472 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 22:28:49,474 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: -420, Received: 0, Shipped: 234, Repack: 0, EOD: -654
2025-07-07 22:28:49,475 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: -28, Received: 0, Shipped: 14, Repack: 0, EOD: -42
2025-07-07 22:28:49,477 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: -33, Received: 0, Shipped: 11, Repack: 0, EOD: -44
2025-07-07 22:28:49,479 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,480 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,481 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,483 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,484 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {17612: np.int64(-654), 17904: np.int64(-42), 17914: np.int64(-44), 18675: np.int64(-4), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,484 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-07 22:28:49,484 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {17612: np.int64(-654), 17904: np.int64(-42), 17914: np.int64(-44), 18675: np.int64(-4), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,486 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 22:28:49,489 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: -654, Received: 0, Shipped: 83, Repack: 0, EOD: -737
2025-07-07 22:28:49,491 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: -42, Received: 0, Shipped: 1, Repack: 0, EOD: -43
2025-07-07 22:28:49,493 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: -44, Received: 0, Shipped: 12, Repack: 0, EOD: -56
2025-07-07 22:28:49,495 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,497 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,499 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,500 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,501 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {17612: np.int64(-737), 17904: np.int64(-43), 17914: np.int64(-56), 18675: np.int64(-4), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,501 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-07 22:28:49,502 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {17612: np.int64(-737), 17904: np.int64(-43), 17914: np.int64(-56), 18675: np.int64(-4), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,508 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,510 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,511 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,513 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,513 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {17612: np.int64(-737), 17904: np.int64(-43), 17914: np.int64(-56), 18675: np.int64(-4), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,513 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-07 22:28:49,514 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {17612: np.int64(-737), 17904: np.int64(-43), 17914: np.int64(-56), 18675: np.int64(-4), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,518 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,521 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,523 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,524 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,524 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {17612: np.int64(-737), 17904: np.int64(-43), 17914: np.int64(-56), 18675: np.int64(-4), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,525 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-07 22:28:49,525 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {17612: np.int64(-737), 17904: np.int64(-43), 17914: np.int64(-56), 18675: np.int64(-4), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,526 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 22:28:49,527 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: -737, Received: 0, Shipped: 164, Repack: 0, EOD: -901
2025-07-07 22:28:49,529 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: -43, Received: 0, Shipped: 2, Repack: 0, EOD: -45
2025-07-07 22:28:49,531 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: -56, Received: 0, Shipped: 3, Repack: 0, EOD: -59
2025-07-07 22:28:49,533 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: -4, Received: 0, Shipped: 3, Repack: 0, EOD: -7
2025-07-07 22:28:49,535 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,538 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,540 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,541 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,542 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {17612: np.int64(-901), 17904: np.int64(-45), 17914: np.int64(-59), 18675: np.int64(-7), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,542 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-07 22:28:49,542 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {17612: np.int64(-901), 17904: np.int64(-45), 17914: np.int64(-59), 18675: np.int64(-7), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,543 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 22:28:49,544 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: -901, Received: 0, Shipped: 56, Repack: 0, EOD: -957
2025-07-07 22:28:49,545 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: -45, Received: 0, Shipped: 1, Repack: 0, EOD: -46
2025-07-07 22:28:49,548 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: -59, Received: 0, Shipped: 11, Repack: 0, EOD: -70
2025-07-07 22:28:49,550 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: -7, Received: 0, Shipped: 12, Repack: 0, EOD: -19
2025-07-07 22:28:49,552 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,556 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,558 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,559 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,560 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {17612: np.int64(-957), 17904: np.int64(-46), 17914: np.int64(-70), 18675: np.int64(-19), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,560 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-07 22:28:49,560 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {17612: np.int64(-957), 17904: np.int64(-46), 17914: np.int64(-70), 18675: np.int64(-19), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,561 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 22:28:49,563 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -957, Received: 576, Shipped: 57, Repack: 0, EOD: -438
2025-07-07 22:28:49,564 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: -46, Received: 0, Shipped: 1, Repack: 0, EOD: -47
2025-07-07 22:28:49,566 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: -70, Received: 0, Shipped: 1, Repack: 0, EOD: -71
2025-07-07 22:28:49,568 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,571 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,573 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,575 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,575 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {17612: np.int64(-438), 17904: np.int64(-47), 17914: np.int64(-71), 18675: np.int64(-19), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,575 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-07 22:28:49,577 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {17612: np.int64(-438), 17904: np.int64(-47), 17914: np.int64(-71), 18675: np.int64(-19), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,577 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 22:28:49,578 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: -438, Received: 0, Shipped: 47, Repack: 0, EOD: -485
2025-07-07 22:28:49,581 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: -47, Received: 0, Shipped: 2, Repack: 0, EOD: -49
2025-07-07 22:28:49,582 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: -71, Received: 0, Shipped: 7, Repack: 0, EOD: -78
2025-07-07 22:28:49,584 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,586 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,589 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,591 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,591 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {17612: np.int64(-485), 17904: np.int64(-49), 17914: np.int64(-78), 18675: np.int64(-19), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,591 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-07 22:28:49,592 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {17612: np.int64(-485), 17904: np.int64(-49), 17914: np.int64(-78), 18675: np.int64(-19), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,592 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 22:28:49,594 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: -485, Received: 0, Shipped: 76, Repack: 0, EOD: -561
2025-07-07 22:28:49,595 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: -49, Received: 0, Shipped: 1, Repack: 0, EOD: -50
2025-07-07 22:28:49,597 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: -78, Received: 0, Shipped: 5, Repack: 0, EOD: -83
2025-07-07 22:28:49,599 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: -19, Received: 0, Shipped: 1, Repack: 0, EOD: -20
2025-07-07 22:28:49,600 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,602 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,604 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,606 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,607 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {17612: np.int64(-561), 17904: np.int64(-50), 17914: np.int64(-83), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,607 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-07 22:28:49,607 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {17612: np.int64(-561), 17904: np.int64(-50), 17914: np.int64(-83), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,612 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,613 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,615 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,617 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,617 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {17612: np.int64(-561), 17904: np.int64(-50), 17914: np.int64(-83), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,618 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-07 22:28:49,618 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {17612: np.int64(-561), 17904: np.int64(-50), 17914: np.int64(-83), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,624 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,625 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,628 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,628 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,629 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {17612: np.int64(-561), 17904: np.int64(-50), 17914: np.int64(-83), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,629 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-07 22:28:49,630 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {17612: np.int64(-561), 17904: np.int64(-50), 17914: np.int64(-83), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,631 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 22:28:49,632 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: -561, Received: 376, Shipped: 21, Repack: 0, EOD: -206
2025-07-07 22:28:49,634 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: -50, Received: 0, Shipped: 6, Repack: 0, EOD: -56
2025-07-07 22:28:49,638 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,640 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,641 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,643 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,643 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {17612: np.int64(-206), 17904: np.int64(-56), 17914: np.int64(-83), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,643 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-07 22:28:49,644 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {17612: np.int64(-206), 17904: np.int64(-56), 17914: np.int64(-83), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,644 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 22:28:49,645 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: -206, Received: 0, Shipped: 42, Repack: 0, EOD: -248
2025-07-07 22:28:49,648 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: -56, Received: 0, Shipped: 1, Repack: 0, EOD: -57
2025-07-07 22:28:49,649 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: -83, Received: 0, Shipped: 1, Repack: 0, EOD: -84
2025-07-07 22:28:49,652 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,655 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,656 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,658 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,659 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {17612: np.int64(-248), 17904: np.int64(-57), 17914: np.int64(-84), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,659 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-07 22:28:49,659 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {17612: np.int64(-248), 17904: np.int64(-57), 17914: np.int64(-84), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,660 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 22:28:49,661 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: -248, Received: 0, Shipped: 173, Repack: 0, EOD: -421
2025-07-07 22:28:49,663 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: -57, Received: 0, Shipped: 1, Repack: 0, EOD: -58
2025-07-07 22:28:49,664 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: -84, Received: 0, Shipped: 4, Repack: 0, EOD: -88
2025-07-07 22:28:49,666 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,668 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,671 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,672 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,673 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {17612: np.int64(-421), 17904: np.int64(-58), 17914: np.int64(-88), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,673 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-07 22:28:49,674 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {17612: np.int64(-421), 17904: np.int64(-58), 17914: np.int64(-88), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,674 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 22:28:49,675 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: -421, Received: 0, Shipped: 60, Repack: 0, EOD: -481
2025-07-07 22:28:49,678 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: -58, Received: 0, Shipped: 2, Repack: 0, EOD: -60
2025-07-07 22:28:49,679 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: -88, Received: 0, Shipped: 9, Repack: 0, EOD: -97
2025-07-07 22:28:49,682 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,683 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,685 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,688 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,688 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {17612: np.int64(-481), 17904: np.int64(-60), 17914: np.int64(-97), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,688 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-07 22:28:49,689 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {17612: np.int64(-481), 17904: np.int64(-60), 17914: np.int64(-97), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,690 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 22:28:49,691 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: -481, Received: 0, Shipped: 51, Repack: 0, EOD: -532
2025-07-07 22:28:49,693 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: -60, Received: 0, Shipped: 3, Repack: 0, EOD: -63
2025-07-07 22:28:49,694 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: -97, Received: 0, Shipped: 6, Repack: 0, EOD: -103
2025-07-07 22:28:49,697 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,698 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,700 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,726 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,727 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {17612: np.int64(-532), 17904: np.int64(-63), 17914: np.int64(-103), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,728 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-07 22:28:49,728 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {17612: np.int64(-532), 17904: np.int64(-63), 17914: np.int64(-103), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,733 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,735 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,738 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,741 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,741 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {17612: np.int64(-532), 17904: np.int64(-63), 17914: np.int64(-103), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,742 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-07 22:28:49,743 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {17612: np.int64(-532), 17904: np.int64(-63), 17914: np.int64(-103), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,759 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,763 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,766 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,770 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,772 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {17612: np.int64(-532), 17904: np.int64(-63), 17914: np.int64(-103), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,772 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-07 22:28:49,773 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {17612: np.int64(-532), 17904: np.int64(-63), 17914: np.int64(-103), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,774 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 22:28:49,777 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: -532, Received: 0, Shipped: 84, Repack: 0, EOD: -616
2025-07-07 22:28:49,778 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: -63, Received: 0, Shipped: 3, Repack: 0, EOD: -66
2025-07-07 22:28:49,780 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: -103, Received: 0, Shipped: 1, Repack: 0, EOD: -104
2025-07-07 22:28:49,784 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:28:49,789 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:28:49,791 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:28:49,792 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:28:49,793 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {17612: np.int64(-616), 17904: np.int64(-66), 17914: np.int64(-104), 18675: np.int64(-20), '18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:28:49,795 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612              0              0
1  2025-06-01  17904              0              0
2  2025-06-01  17914              0              0
3  2025-06-01  18675              0              0
5  2025-06-01  17612            955            955
2025-07-07 22:28:49,797 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  18675            -20            -20
237  2025-06-30  17612            955            955
239  2025-06-30  17904            178            178
238  2025-06-30  17914            326            326
236  2025-06-30  18675            769            769
2025-07-07 22:28:49,797 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (240, 4)
2025-07-07 22:28:49,797 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 22:28:49,798 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612              0              0
1  2025-06-01  17904              0              0
2  2025-06-01  17914              0              0
3  2025-06-01  18675              0              0
5  2025-06-01  17612            955            955
2025-07-07 22:28:49,799 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
235  2025-06-30  18675            -20            -20
237  2025-06-30  17612            955            955
239  2025-06-30  17904            178            178
238  2025-06-30  17914            326            326
236  2025-06-30  18675            769            769
2025-07-07 22:28:49,801 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (240, 4)
2025-07-07 22:28:49,802 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count    240.000000
mean     211.887500
std      439.442172
min     -957.000000
25%      -45.250000
50%      178.000000
75%      436.750000
max      955.000000
2025-07-07 22:28:49,804 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
5    2025-06-01            955
13   2025-06-02            955
21   2025-06-03            955
29   2025-06-04            955
37   2025-06-05            955
45   2025-06-06            955
53   2025-06-07            955
61   2025-06-08            955
69   2025-06-09            955
77   2025-06-10            955
85   2025-06-11            955
93   2025-06-12            955
101  2025-06-13            955
109  2025-06-14            955
117  2025-06-15            955
125  2025-06-16            955
133  2025-06-17            955
141  2025-06-18            955
149  2025-06-19            955
157  2025-06-20            955
165  2025-06-21            955
173  2025-06-22            955
181  2025-06-23            955
189  2025-06-24            955
197  2025-06-25            955
205  2025-06-26            955
213  2025-06-27            955
221  2025-06-28            955
229  2025-06-29            955
237  2025-06-30            955
2025-07-07 22:28:49,806 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
7    2025-06-01            178
15   2025-06-02            178
23   2025-06-03            178
31   2025-06-04            178
39   2025-06-05            178
47   2025-06-06            178
55   2025-06-07            178
63   2025-06-08            178
71   2025-06-09            178
79   2025-06-10            178
87   2025-06-11            178
95   2025-06-12            178
103  2025-06-13            178
111  2025-06-14            178
119  2025-06-15            178
127  2025-06-16            178
135  2025-06-17            178
143  2025-06-18            178
151  2025-06-19            178
159  2025-06-20            178
167  2025-06-21            178
175  2025-06-22            178
183  2025-06-23            178
191  2025-06-24            178
199  2025-06-25            178
207  2025-06-26            178
215  2025-06-27            178
223  2025-06-28            178
231  2025-06-29            178
239  2025-06-30            178
2025-07-07 22:28:49,812 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-07 22:28:49,817 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 22:28:49,819 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    240.000000
mean       5.625000
std        7.679852
min        0.000000
25%        0.000000
50%        1.500000
75%        8.000000
max       20.000000
2025-07-07 22:28:49,822 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
5    2025-06-01           20
13   2025-06-02           20
21   2025-06-03           20
29   2025-06-04           20
37   2025-06-05           20
45   2025-06-06           20
53   2025-06-07           20
61   2025-06-08           20
69   2025-06-09           20
77   2025-06-10           20
85   2025-06-11           20
93   2025-06-12           20
101  2025-06-13           20
109  2025-06-14           20
117  2025-06-15           20
125  2025-06-16           20
133  2025-06-17           20
141  2025-06-18           20
149  2025-06-19           20
157  2025-06-20           20
165  2025-06-21           20
173  2025-06-22           20
181  2025-06-23           20
189  2025-06-24           20
197  2025-06-25           20
205  2025-06-26           20
213  2025-06-27           20
221  2025-06-28           20
229  2025-06-29           20
237  2025-06-30           20
2025-07-07 22:28:49,825 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    45
2025-06-03    45
2025-06-04    45
2025-06-05    45
2025-07-07 22:28:49,825 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    45
2025-06-27    45
2025-06-28    45
2025-06-29    45
2025-06-30    45
2025-07-07 22:28:49,827 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 22:28:49,827 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 22:28:49,829 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 22:28:49,830 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    20.25
2025-06-03    20.25
2025-06-04    20.25
2025-06-05    20.25
2025-07-07 22:28:49,831 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    20.25
2025-06-27    20.25
2025-06-28    20.25
2025-06-29    20.25
2025-06-30    20.25
2025-07-07 22:28:49,837 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 22:28:49,838 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 22:28:49,838 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:28:49,839 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:28:49,841 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:28:50,055 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:28:50,056 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:28:50,057 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:28:50,058 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 22:28:50,079 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:28:50,247 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:28:50,250 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:28:50,468 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:50,611 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:50,904 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:28:51,050 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:28:51,052 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 22:28:51,235 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:28:51,236 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 22:28:51,237 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 22:28:51,238 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 22:28:51,239 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 22:28:51,255 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 22:28:51,255 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 22:28:51,256 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 22:28:51,257 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 22:28:51,258 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 22:28:51,259 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 22:28:51,260 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 22:28:51,263 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 22:28:51,263 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 22:28:51,265 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:28:51,266 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:28:51,268 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:28:51,473 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:28:51,477 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:28:51,478 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:28:51,478 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 22:28:51,501 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:28:51,662 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:28:51,664 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:28:51,922 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:52,063 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:28:53,646 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:28:53,805 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:28:53,809 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 22:28:53,967 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:28:53,969 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 22:28:53,970 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 22:28:53,970 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 22:28:53,971 - __main__ - INFO - Script finished successfully.
2025-07-07 22:35:10,588 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:35:10,589 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:35:10,964 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:35:10,965 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:35:10,965 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:35:10,965 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:35:10,977 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:35:11,249 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:35:11,253 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:35:11,254 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:35:11,254 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:35:11,278 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:35:11,440 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:35:11,442 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:35:11,896 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:12,049 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:12,052 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:35:12,243 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:35:12,244 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:35:12,249 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:35:12,250 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:35:12,250 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:35:12,251 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:35:12,254 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:35:12,470 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:35:12,471 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:35:12,472 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:35:12,472 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:35:12,494 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:35:12,639 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:35:12,641 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:35:12,877 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:13,014 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:13,015 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:35:13,187 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:35:13,188 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:35:13,189 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 22:35:13,190 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:35:13,191 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:35:13,191 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:35:13,193 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:35:13,395 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:35:13,396 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:35:13,397 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:35:13,397 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:35:13,424 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:35:13,588 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:35:13,590 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:35:13,848 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:13,983 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:13,986 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:35:14,158 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:35:14,160 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:35:14,162 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 22:35:14,162 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 22:35:14,165 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 22:35:14,167 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 22:35:14,167 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 22:35:14,168 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:35:14,168 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:35:14,170 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:35:14,382 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:35:14,383 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:35:14,383 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:35:14,383 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:35:14,409 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:35:14,561 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:35:14,563 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:35:14,899 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:15,044 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:15,045 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 22:35:15,222 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 22:35:15,228 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 22:35:15,232 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 22:35:15,234 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 22:35:15,234 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 22:35:15,234 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:35:15,236 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:35:15,239 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:35:15,446 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:35:15,448 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:35:15,449 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:35:15,449 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:35:15,472 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:35:15,622 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:35:15,624 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:35:15,865 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:16,008 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:16,010 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 22:35:16,173 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 22:35:16,177 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 22:35:16,180 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 22:35:16,181 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 22:35:16,181 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:35:16,182 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:35:16,184 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:35:16,380 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:35:16,382 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:35:16,383 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:35:16,383 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:35:16,406 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:35:16,572 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:35:16,573 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:35:16,807 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:16,942 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:16,943 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 22:35:17,122 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 22:35:17,124 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 22:35:17,137 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 22:35:17,138 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 22:35:17,146 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 22:35:17,148 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 22:35:17,149 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 22:35:17,150 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 22:35:17,151 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 22:35:17,152 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 22:35:17,154 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 22:35:17,155 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 22:35:17,155 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 22:35:17,156 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 22:35:17,156 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 22:35:17,158 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 22:35:17,159 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 326, '17612': 955, '17904': 178, '18675': 769}
2025-07-07 22:35:17,159 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-07 22:35:17,160 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 326, '17612': 955, '17904': 178, '18675': 769}
2025-07-07 22:35:17,162 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:35:17,164 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:35:17,165 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:35:17,167 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:35:17,167 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(326), '17612': np.int64(955), '17904': np.int64(178), '18675': np.int64(769)}
2025-07-07 22:35:17,168 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-07 22:35:17,169 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(326), '17612': np.int64(955), '17904': np.int64(178), '18675': np.int64(769)}
2025-07-07 22:35:17,170 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 22:35:17,173 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-07 22:35:17,176 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-07 22:35:17,178 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-07 22:35:17,179 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-07 22:35:17,179 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(323), '17612': np.int64(884), '17904': np.int64(176), '18675': np.int64(768)}
2025-07-07 22:35:17,180 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-07 22:35:17,180 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(323), '17612': np.int64(884), '17904': np.int64(176), '18675': np.int64(768)}
2025-07-07 22:35:17,181 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 22:35:17,183 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-07 22:35:17,186 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-07 22:35:17,190 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-07 22:35:17,193 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-07 22:35:17,193 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(317), '17612': np.int64(790), '17904': np.int64(163), '18675': np.int64(768)}
2025-07-07 22:35:17,194 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-07 22:35:17,194 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(317), '17612': np.int64(790), '17904': np.int64(163), '18675': np.int64(768)}
2025-07-07 22:35:17,195 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 22:35:17,198 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-07 22:35:17,200 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-07 22:35:17,202 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-07 22:35:17,205 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-07 22:35:17,206 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(310), '17612': np.int64(1149), '17904': np.int64(156), '18675': np.int64(768)}
2025-07-07 22:35:17,207 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-07 22:35:17,207 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(310), '17612': np.int64(1149), '17904': np.int64(156), '18675': np.int64(768)}
2025-07-07 22:35:17,208 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 22:35:17,210 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-07 22:35:17,211 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-07 22:35:17,213 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-07 22:35:17,215 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-07 22:35:17,216 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(303), '17612': np.int64(853), '17904': np.int64(155), '18675': np.int64(768)}
2025-07-07 22:35:17,216 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-07 22:35:17,217 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(303), '17612': np.int64(853), '17904': np.int64(155), '18675': np.int64(768)}
2025-07-07 22:35:17,219 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 22:35:17,222 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-07 22:35:17,225 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-07 22:35:17,227 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-07 22:35:17,230 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-07 22:35:17,230 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(302), '17612': np.int64(736), '17904': np.int64(153), '18675': np.int64(767)}
2025-07-07 22:35:17,231 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-07 22:35:17,231 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(302), '17612': np.int64(736), '17904': np.int64(153), '18675': np.int64(767)}
2025-07-07 22:35:17,234 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-07 22:35:17,237 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-07 22:35:17,240 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-07 22:35:17,242 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-07 22:35:17,243 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(302), '17612': np.int64(736), '17904': np.int64(153), '18675': np.int64(767)}
2025-07-07 22:35:17,244 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-07 22:35:17,244 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(302), '17612': np.int64(736), '17904': np.int64(153), '18675': np.int64(767)}
2025-07-07 22:35:17,247 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-07 22:35:17,249 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-07 22:35:17,252 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-07 22:35:17,254 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-07 22:35:17,255 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(302), '17612': np.int64(736), '17904': np.int64(153), '18675': np.int64(767)}
2025-07-07 22:35:17,255 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-07 22:35:17,255 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(302), '17612': np.int64(736), '17904': np.int64(153), '18675': np.int64(767)}
2025-07-07 22:35:17,257 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 22:35:17,258 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-07 22:35:17,260 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-07 22:35:17,261 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-07 22:35:17,264 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-07 22:35:17,264 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(299), '17612': np.int64(689), '17904': np.int64(151), '18675': np.int64(766)}
2025-07-07 22:35:17,265 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-07 22:35:17,265 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(299), '17612': np.int64(689), '17904': np.int64(151), '18675': np.int64(766)}
2025-07-07 22:35:17,266 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 22:35:17,269 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-07 22:35:17,272 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-07 22:35:17,274 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 22:35:17,275 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-07 22:35:17,276 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(296), '17612': np.int64(602), '17904': np.int64(151), '18675': np.int64(766)}
2025-07-07 22:35:17,276 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-07 22:35:17,276 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(296), '17612': np.int64(602), '17904': np.int64(151), '18675': np.int64(766)}
2025-07-07 22:35:17,277 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 22:35:17,279 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-07 22:35:17,280 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-07 22:35:17,282 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-07 22:35:17,283 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-07 22:35:17,284 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(293), '17612': np.int64(535), '17904': np.int64(150), '18675': np.int64(765)}
2025-07-07 22:35:17,284 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-07 22:35:17,284 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(293), '17612': np.int64(535), '17904': np.int64(150), '18675': np.int64(765)}
2025-07-07 22:35:17,285 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 22:35:17,288 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-07 22:35:17,289 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-07 22:35:17,291 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-07 22:35:17,293 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-07 22:35:17,293 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(282), '17612': np.int64(301), '17904': np.int64(136), '18675': np.int64(765)}
2025-07-07 22:35:17,293 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-07 22:35:17,293 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(282), '17612': np.int64(301), '17904': np.int64(136), '18675': np.int64(765)}
2025-07-07 22:35:17,294 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 22:35:17,296 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-07 22:35:17,297 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-07 22:35:17,299 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-07 22:35:17,300 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-07 22:35:17,301 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(270), '17612': np.int64(218), '17904': np.int64(135), '18675': np.int64(765)}
2025-07-07 22:35:17,301 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-07 22:35:17,302 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(270), '17612': np.int64(218), '17904': np.int64(135), '18675': np.int64(765)}
2025-07-07 22:35:17,304 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-07 22:35:17,306 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-07 22:35:17,308 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-07 22:35:17,309 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-07 22:35:17,310 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(270), '17612': np.int64(218), '17904': np.int64(135), '18675': np.int64(765)}
2025-07-07 22:35:17,310 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-07 22:35:17,310 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(270), '17612': np.int64(218), '17904': np.int64(135), '18675': np.int64(765)}
2025-07-07 22:35:17,312 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-07 22:35:17,314 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-07 22:35:17,315 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-07 22:35:17,316 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-07 22:35:17,317 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(270), '17612': np.int64(218), '17904': np.int64(135), '18675': np.int64(765)}
2025-07-07 22:35:17,317 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-07 22:35:17,318 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(270), '17612': np.int64(218), '17904': np.int64(135), '18675': np.int64(765)}
2025-07-07 22:35:17,319 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 22:35:17,321 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-07 22:35:17,323 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-07 22:35:17,324 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-07 22:35:17,326 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-07 22:35:17,326 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(267), '17612': np.int64(54), '17904': np.int64(133), '18675': np.int64(762)}
2025-07-07 22:35:17,326 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-07 22:35:17,326 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(267), '17612': np.int64(54), '17904': np.int64(133), '18675': np.int64(762)}
2025-07-07 22:35:17,327 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 22:35:17,329 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-07 22:35:17,330 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-07 22:35:17,332 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-07 22:35:17,333 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-07 22:35:17,333 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(256), '17612': np.int64(-2), '17904': np.int64(132), '18675': np.int64(750)}
2025-07-07 22:35:17,333 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-07 22:35:17,335 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(256), '17612': np.int64(-2), '17904': np.int64(132), '18675': np.int64(750)}
2025-07-07 22:35:17,335 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 22:35:17,337 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-07 22:35:17,339 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-07 22:35:17,341 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-07 22:35:17,343 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-07 22:35:17,343 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(255), '17612': np.int64(517), '17904': np.int64(131), '18675': np.int64(750)}
2025-07-07 22:35:17,344 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-07 22:35:17,344 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(255), '17612': np.int64(517), '17904': np.int64(131), '18675': np.int64(750)}
2025-07-07 22:35:17,347 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 22:35:17,349 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-07 22:35:17,350 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-07 22:35:17,352 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-07 22:35:17,354 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-07 22:35:17,355 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(248), '17612': np.int64(470), '17904': np.int64(129), '18675': np.int64(750)}
2025-07-07 22:35:17,355 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-07 22:35:17,355 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(248), '17612': np.int64(470), '17904': np.int64(129), '18675': np.int64(750)}
2025-07-07 22:35:17,357 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 22:35:17,359 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-07 22:35:17,360 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-07 22:35:17,362 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-07 22:35:17,363 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-07 22:35:17,364 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(243), '17612': np.int64(394), '17904': np.int64(128), '18675': np.int64(749)}
2025-07-07 22:35:17,364 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-07 22:35:17,364 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(243), '17612': np.int64(394), '17904': np.int64(128), '18675': np.int64(749)}
2025-07-07 22:35:17,366 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-07 22:35:17,368 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-07 22:35:17,369 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-07 22:35:17,371 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:35:17,372 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(243), '17612': np.int64(394), '17904': np.int64(128), '18675': np.int64(749)}
2025-07-07 22:35:17,372 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-07 22:35:17,373 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(243), '17612': np.int64(394), '17904': np.int64(128), '18675': np.int64(749)}
2025-07-07 22:35:17,374 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-07 22:35:17,375 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-07 22:35:17,377 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-07 22:35:17,378 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:35:17,378 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(243), '17612': np.int64(394), '17904': np.int64(128), '18675': np.int64(749)}
2025-07-07 22:35:17,379 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-07 22:35:17,379 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(243), '17612': np.int64(394), '17904': np.int64(128), '18675': np.int64(749)}
2025-07-07 22:35:17,379 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 22:35:17,381 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-07 22:35:17,382 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-07 22:35:17,384 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-07 22:35:17,386 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:35:17,387 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(243), '17612': np.int64(749), '17904': np.int64(122), '18675': np.int64(749)}
2025-07-07 22:35:17,387 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-07 22:35:17,389 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(243), '17612': np.int64(749), '17904': np.int64(122), '18675': np.int64(749)}
2025-07-07 22:35:17,389 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 22:35:17,391 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-07 22:35:17,392 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-07 22:35:17,394 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-07 22:35:17,395 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:35:17,395 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(242), '17612': np.int64(707), '17904': np.int64(121), '18675': np.int64(749)}
2025-07-07 22:35:17,395 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-07 22:35:17,396 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(242), '17612': np.int64(707), '17904': np.int64(121), '18675': np.int64(749)}
2025-07-07 22:35:17,396 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 22:35:17,398 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-07 22:35:17,399 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-07 22:35:17,401 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-07 22:35:17,402 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:35:17,403 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(238), '17612': np.int64(534), '17904': np.int64(120), '18675': np.int64(749)}
2025-07-07 22:35:17,403 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-07 22:35:17,404 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(238), '17612': np.int64(534), '17904': np.int64(120), '18675': np.int64(749)}
2025-07-07 22:35:17,405 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 22:35:17,407 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-07 22:35:17,409 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-07 22:35:17,410 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-07 22:35:17,411 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:35:17,412 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(229), '17612': np.int64(474), '17904': np.int64(118), '18675': np.int64(749)}
2025-07-07 22:35:17,412 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-07 22:35:17,412 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(229), '17612': np.int64(474), '17904': np.int64(118), '18675': np.int64(749)}
2025-07-07 22:35:17,413 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 22:35:17,415 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-07 22:35:17,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-07 22:35:17,418 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-07 22:35:17,420 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:35:17,420 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(223), '17612': np.int64(423), '17904': np.int64(115), '18675': np.int64(749)}
2025-07-07 22:35:17,420 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-07 22:35:17,421 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(223), '17612': np.int64(423), '17904': np.int64(115), '18675': np.int64(749)}
2025-07-07 22:35:17,423 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-07 22:35:17,425 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-07 22:35:17,426 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-07 22:35:17,427 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:35:17,427 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(223), '17612': np.int64(423), '17904': np.int64(115), '18675': np.int64(749)}
2025-07-07 22:35:17,428 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-07 22:35:17,428 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(223), '17612': np.int64(423), '17904': np.int64(115), '18675': np.int64(749)}
2025-07-07 22:35:17,431 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-07 22:35:17,433 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-07 22:35:17,434 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-07 22:35:17,435 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:35:17,436 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(223), '17612': np.int64(423), '17904': np.int64(115), '18675': np.int64(749)}
2025-07-07 22:35:17,436 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-07 22:35:17,437 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(223), '17612': np.int64(423), '17904': np.int64(115), '18675': np.int64(749)}
2025-07-07 22:35:17,438 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 22:35:17,440 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-07 22:35:17,441 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-07 22:35:17,442 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-07 22:35:17,444 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:35:17,444 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(222), '17612': np.int64(339), '17904': np.int64(112), '18675': np.int64(749)}
2025-07-07 22:35:17,447 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
5  2025-06-02  17612            955            884
2025-07-07 22:35:17,448 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
117  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-07 22:35:17,448 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-07 22:35:17,449 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 22:35:17,450 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
3  2025-06-01  18675            769            769
5  2025-06-02  17612            955            884
2025-07-07 22:35:17,451 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            749            749
117  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
119  2025-06-30  18675            749            749
2025-07-07 22:35:17,452 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-07 22:35:17,454 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-07 22:35:17,456 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01            955
5    2025-06-02            884
9    2025-06-03            790
13   2025-06-04           1149
17   2025-06-05            853
21   2025-06-06            736
25   2025-06-07            736
29   2025-06-08            736
33   2025-06-09            689
37   2025-06-10            602
41   2025-06-11            535
45   2025-06-12            301
49   2025-06-13            218
53   2025-06-14            218
57   2025-06-15            218
61   2025-06-16             54
65   2025-06-17             -2
69   2025-06-18            517
73   2025-06-19            470
77   2025-06-20            394
81   2025-06-21            394
85   2025-06-22            394
89   2025-06-23            749
93   2025-06-24            707
97   2025-06-25            534
101  2025-06-26            474
105  2025-06-27            423
109  2025-06-28            423
113  2025-06-29            423
117  2025-06-30            339
2025-07-07 22:35:17,458 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            178
6    2025-06-02            176
10   2025-06-03            163
14   2025-06-04            156
18   2025-06-05            155
22   2025-06-06            153
26   2025-06-07            153
30   2025-06-08            153
34   2025-06-09            151
38   2025-06-10            151
42   2025-06-11            150
46   2025-06-12            136
50   2025-06-13            135
54   2025-06-14            135
58   2025-06-15            135
62   2025-06-16            133
66   2025-06-17            132
70   2025-06-18            131
74   2025-06-19            129
78   2025-06-20            128
82   2025-06-21            128
86   2025-06-22            128
90   2025-06-23            122
94   2025-06-24            121
98   2025-06-25            120
102  2025-06-26            118
106  2025-06-27            115
110  2025-06-28            115
114  2025-06-29            115
118  2025-06-30            112
2025-07-07 22:35:17,464 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-07 22:35:17,468 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 22:35:17,469 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-07 22:35:17,471 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           20
5    2025-06-02           19
9    2025-06-03           17
13   2025-06-04           24
17   2025-06-05           18
21   2025-06-06           16
25   2025-06-07           16
29   2025-06-08           16
33   2025-06-09           15
37   2025-06-10           13
41   2025-06-11           12
45   2025-06-12            7
49   2025-06-13            5
53   2025-06-14            5
57   2025-06-15            5
61   2025-06-16            2
65   2025-06-17            0
69   2025-06-18           11
73   2025-06-19           10
77   2025-06-20            9
81   2025-06-21            9
85   2025-06-22            9
89   2025-06-23           16
93   2025-06-24           15
97   2025-06-25           12
101  2025-06-26           10
105  2025-06-27            9
109  2025-06-28            9
113  2025-06-29            9
117  2025-06-30            8
2025-07-07 22:35:17,474 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-07 22:35:17,475 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-07 22:35:17,475 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 22:35:17,475 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 22:35:17,477 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 22:35:17,477 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-07 22:35:17,478 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-07 22:35:17,483 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 22:35:17,484 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 22:35:17,484 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:35:17,484 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:35:17,486 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:35:17,700 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:35:17,703 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:35:17,704 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:35:17,704 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 22:35:17,725 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:35:17,901 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:35:17,903 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:35:18,140 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:18,279 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:18,479 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:35:18,645 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:35:18,650 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 22:35:19,536 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:35:19,538 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 22:35:19,540 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 22:35:19,542 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 22:35:19,543 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 22:35:19,620 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 22:35:19,623 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 22:35:19,624 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 22:35:19,626 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 22:35:19,630 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 22:35:19,632 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 22:35:19,634 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 22:35:19,645 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 22:35:19,646 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 22:35:19,657 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:35:19,659 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:35:19,668 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:35:19,943 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:35:19,948 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:35:19,949 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:35:19,952 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 22:35:20,037 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:35:20,179 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:35:20,183 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:35:20,431 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:20,688 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:35:20,883 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:35:21,043 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:35:21,044 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 22:35:21,229 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:35:21,231 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 22:35:21,232 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 22:35:21,234 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 22:35:21,235 - __main__ - INFO - Script finished successfully.
2025-07-07 22:41:21,114 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:41:21,115 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:41:52,650 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:41:52,652 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:41:53,097 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:41:53,098 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:41:53,098 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:41:53,098 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:41:53,111 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:41:53,394 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:41:53,395 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:41:53,396 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:41:53,396 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:41:53,423 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:41:53,600 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:41:53,604 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:41:54,035 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:41:54,178 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:41:54,179 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:41:54,358 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:41:54,367 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:41:54,386 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:41:54,388 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:41:54,388 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:41:54,389 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:41:54,392 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:41:54,592 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:41:54,593 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:41:54,594 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:41:54,594 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:41:54,621 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:41:54,788 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:41:54,789 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:41:55,044 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:41:55,237 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:41:55,238 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:41:55,392 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:41:55,393 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:41:55,395 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 22:41:55,396 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:41:55,396 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:41:55,397 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:41:55,399 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:41:55,604 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:41:55,606 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:41:55,606 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:41:55,607 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:41:55,629 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:41:55,793 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:41:55,795 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:41:56,048 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:41:56,196 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:41:56,196 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:41:56,345 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:41:56,350 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:41:56,354 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 22:41:56,355 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 22:41:56,371 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 22:41:56,385 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 22:41:56,386 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 22:41:56,387 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:41:56,388 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:41:56,392 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:41:56,617 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:41:56,618 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:41:56,619 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:41:56,619 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:41:56,650 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:41:56,808 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:41:56,810 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:41:57,024 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:41:57,158 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:41:57,159 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 22:42:00,501 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 22:42:00,506 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 22:42:00,513 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 22:42:00,516 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 22:42:00,517 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 22:42:00,518 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:42:00,518 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:42:00,521 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:42:00,775 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:42:00,776 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:42:00,777 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:42:00,777 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:42:00,800 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:42:00,952 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:42:00,956 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:42:01,180 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:42:01,328 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:42:01,330 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 22:42:01,523 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 22:42:01,528 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 22:42:01,535 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 22:42:01,536 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 22:42:01,536 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:42:01,537 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:42:01,541 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:42:01,756 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:42:01,758 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:42:01,759 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:42:01,759 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:42:01,788 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:42:01,930 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:42:01,933 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:42:02,165 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:42:02,316 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:42:02,320 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 22:42:02,484 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 22:42:02,486 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 22:42:02,508 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 22:42:02,508 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 22:42:02,556 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 22:42:02,559 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 22:42:02,560 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 22:42:02,562 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 22:42:02,564 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 22:42:02,564 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 22:42:02,571 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 22:42:02,572 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 22:42:02,572 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 22:42:02,576 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 22:42:02,577 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 22:42:02,579 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 22:42:02,581 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'18675': 769, '17612': 955, '17914': 326, '17904': 178}
2025-07-07 22:42:02,581 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-07 22:42:02,582 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'18675': 769, '17612': 955, '17914': 326, '17904': 178}
2025-07-07 22:42:02,588 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:42:02,592 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:42:02,595 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:42:02,598 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:42:02,598 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:42:02,599 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-07 22:42:02,600 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'18675': np.int64(769), '17612': np.int64(955), '17914': np.int64(326), '17904': np.int64(178)}
2025-07-07 22:42:02,602 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 22:42:02,607 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-07 22:42:02,612 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-07 22:42:02,615 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-07 22:42:02,619 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-07 22:42:02,620 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'18675': np.int64(768), '17612': np.int64(884), '17914': np.int64(323), '17904': np.int64(176)}
2025-07-07 22:42:02,620 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-07 22:42:02,621 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'18675': np.int64(768), '17612': np.int64(884), '17914': np.int64(323), '17904': np.int64(176)}
2025-07-07 22:42:02,624 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 22:42:02,627 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-07 22:42:02,630 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-07 22:42:02,635 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-07 22:42:02,640 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-07 22:42:02,641 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'18675': np.int64(768), '17612': np.int64(790), '17914': np.int64(317), '17904': np.int64(163)}
2025-07-07 22:42:02,641 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-07 22:42:02,642 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'18675': np.int64(768), '17612': np.int64(790), '17914': np.int64(317), '17904': np.int64(163)}
2025-07-07 22:42:02,643 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 22:42:02,647 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-07 22:42:02,651 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-07 22:42:02,654 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-07 22:42:02,659 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-07 22:42:02,659 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'18675': np.int64(768), '17612': np.int64(1149), '17914': np.int64(310), '17904': np.int64(156)}
2025-07-07 22:42:02,660 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-07 22:42:02,660 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'18675': np.int64(768), '17612': np.int64(1149), '17914': np.int64(310), '17904': np.int64(156)}
2025-07-07 22:42:02,663 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 22:42:02,667 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-07 22:42:02,671 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-07 22:42:02,675 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-07 22:42:02,678 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-07 22:42:02,679 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'18675': np.int64(768), '17612': np.int64(853), '17914': np.int64(303), '17904': np.int64(155)}
2025-07-07 22:42:02,679 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-07 22:42:02,679 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'18675': np.int64(768), '17612': np.int64(853), '17914': np.int64(303), '17904': np.int64(155)}
2025-07-07 22:42:02,681 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 22:42:02,684 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-07 22:42:02,687 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-07 22:42:02,690 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-07 22:42:02,695 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-07 22:42:02,695 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'18675': np.int64(767), '17612': np.int64(736), '17914': np.int64(302), '17904': np.int64(153)}
2025-07-07 22:42:02,696 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-07 22:42:02,696 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'18675': np.int64(767), '17612': np.int64(736), '17914': np.int64(302), '17904': np.int64(153)}
2025-07-07 22:42:02,702 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-07 22:42:02,706 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-07 22:42:02,708 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-07 22:42:02,710 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-07 22:42:02,711 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'18675': np.int64(767), '17612': np.int64(736), '17914': np.int64(302), '17904': np.int64(153)}
2025-07-07 22:42:02,712 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-07 22:42:02,713 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'18675': np.int64(767), '17612': np.int64(736), '17914': np.int64(302), '17904': np.int64(153)}
2025-07-07 22:42:02,715 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-07 22:42:02,720 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-07 22:42:02,724 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-07 22:42:02,726 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-07 22:42:02,727 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'18675': np.int64(767), '17612': np.int64(736), '17914': np.int64(302), '17904': np.int64(153)}
2025-07-07 22:42:02,727 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-07 22:42:02,728 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'18675': np.int64(767), '17612': np.int64(736), '17914': np.int64(302), '17904': np.int64(153)}
2025-07-07 22:42:02,729 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 22:42:02,732 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-07 22:42:02,738 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-07 22:42:02,742 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-07 22:42:02,744 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-07 22:42:02,745 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'18675': np.int64(766), '17612': np.int64(689), '17914': np.int64(299), '17904': np.int64(151)}
2025-07-07 22:42:02,746 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-07 22:42:02,746 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'18675': np.int64(766), '17612': np.int64(689), '17914': np.int64(299), '17904': np.int64(151)}
2025-07-07 22:42:02,748 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 22:42:02,752 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-07 22:42:02,756 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-07 22:42:02,759 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-07 22:42:02,762 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 22:42:02,762 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'18675': np.int64(766), '17612': np.int64(602), '17914': np.int64(296), '17904': np.int64(151)}
2025-07-07 22:42:02,764 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-07 22:42:02,764 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'18675': np.int64(766), '17612': np.int64(602), '17914': np.int64(296), '17904': np.int64(151)}
2025-07-07 22:42:02,768 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 22:42:02,774 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-07 22:42:02,779 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-07 22:42:02,784 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-07 22:42:02,792 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-07 22:42:02,793 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'18675': np.int64(765), '17612': np.int64(535), '17914': np.int64(293), '17904': np.int64(150)}
2025-07-07 22:42:02,794 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-07 22:42:02,794 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'18675': np.int64(765), '17612': np.int64(535), '17914': np.int64(293), '17904': np.int64(150)}
2025-07-07 22:42:02,796 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 22:42:02,805 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-07 22:42:02,810 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-07 22:42:02,814 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-07 22:42:02,819 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-07 22:42:02,821 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'18675': np.int64(765), '17612': np.int64(301), '17914': np.int64(282), '17904': np.int64(136)}
2025-07-07 22:42:02,822 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-07 22:42:02,822 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'18675': np.int64(765), '17612': np.int64(301), '17914': np.int64(282), '17904': np.int64(136)}
2025-07-07 22:42:02,824 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 22:42:02,827 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-07 22:42:02,830 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-07 22:42:02,837 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-07 22:42:02,843 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-07 22:42:02,844 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'18675': np.int64(765), '17612': np.int64(218), '17914': np.int64(270), '17904': np.int64(135)}
2025-07-07 22:42:02,845 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-07 22:42:02,846 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'18675': np.int64(765), '17612': np.int64(218), '17914': np.int64(270), '17904': np.int64(135)}
2025-07-07 22:42:02,855 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-07 22:42:02,858 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-07 22:42:02,862 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-07 22:42:02,868 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-07 22:42:02,869 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'18675': np.int64(765), '17612': np.int64(218), '17914': np.int64(270), '17904': np.int64(135)}
2025-07-07 22:42:02,870 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-07 22:42:02,871 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'18675': np.int64(765), '17612': np.int64(218), '17914': np.int64(270), '17904': np.int64(135)}
2025-07-07 22:42:02,875 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-07 22:42:02,879 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-07 22:42:02,883 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-07 22:42:02,890 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-07 22:42:02,892 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'18675': np.int64(765), '17612': np.int64(218), '17914': np.int64(270), '17904': np.int64(135)}
2025-07-07 22:42:02,892 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-07 22:42:02,893 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'18675': np.int64(765), '17612': np.int64(218), '17914': np.int64(270), '17904': np.int64(135)}
2025-07-07 22:42:02,895 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 22:42:02,905 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-07 22:42:02,909 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-07 22:42:02,912 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-07 22:42:02,915 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-07 22:42:02,916 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'18675': np.int64(762), '17612': np.int64(54), '17914': np.int64(267), '17904': np.int64(133)}
2025-07-07 22:42:02,917 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-07 22:42:02,918 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'18675': np.int64(762), '17612': np.int64(54), '17914': np.int64(267), '17904': np.int64(133)}
2025-07-07 22:42:02,921 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 22:42:02,924 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-07 22:42:02,927 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-07 22:42:02,931 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-07 22:42:02,935 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-07 22:42:02,936 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'18675': np.int64(750), '17612': np.int64(-2), '17914': np.int64(256), '17904': np.int64(132)}
2025-07-07 22:42:02,937 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-07 22:42:02,938 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'18675': np.int64(750), '17612': np.int64(-2), '17914': np.int64(256), '17904': np.int64(132)}
2025-07-07 22:42:02,940 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 22:42:02,943 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-07 22:42:02,946 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-07 22:42:02,952 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-07 22:42:02,956 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-07 22:42:02,958 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'18675': np.int64(750), '17612': np.int64(517), '17914': np.int64(255), '17904': np.int64(131)}
2025-07-07 22:42:02,958 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-07 22:42:02,958 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'18675': np.int64(750), '17612': np.int64(517), '17914': np.int64(255), '17904': np.int64(131)}
2025-07-07 22:42:02,960 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 22:42:02,962 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-07 22:42:02,967 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-07 22:42:02,973 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-07 22:42:02,977 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-07 22:42:02,977 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'18675': np.int64(750), '17612': np.int64(470), '17914': np.int64(248), '17904': np.int64(129)}
2025-07-07 22:42:02,977 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-07 22:42:02,977 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'18675': np.int64(750), '17612': np.int64(470), '17914': np.int64(248), '17904': np.int64(129)}
2025-07-07 22:42:02,979 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 22:42:02,984 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-07 22:42:02,991 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-07 22:42:02,995 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-07 22:42:02,999 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-07 22:42:03,000 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'18675': np.int64(749), '17612': np.int64(394), '17914': np.int64(243), '17904': np.int64(128)}
2025-07-07 22:42:03,001 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-07 22:42:03,003 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'18675': np.int64(749), '17612': np.int64(394), '17914': np.int64(243), '17904': np.int64(128)}
2025-07-07 22:42:03,008 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:42:03,010 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-07 22:42:03,013 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-07 22:42:03,017 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-07 22:42:03,018 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'18675': np.int64(749), '17612': np.int64(394), '17914': np.int64(243), '17904': np.int64(128)}
2025-07-07 22:42:03,020 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-07 22:42:03,022 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'18675': np.int64(749), '17612': np.int64(394), '17914': np.int64(243), '17904': np.int64(128)}
2025-07-07 22:42:03,028 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:42:03,031 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-07 22:42:03,035 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-07 22:42:03,040 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-07 22:42:03,041 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'18675': np.int64(749), '17612': np.int64(394), '17914': np.int64(243), '17904': np.int64(128)}
2025-07-07 22:42:03,042 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-07 22:42:03,043 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'18675': np.int64(749), '17612': np.int64(394), '17914': np.int64(243), '17904': np.int64(128)}
2025-07-07 22:42:03,044 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 22:42:03,048 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:42:03,054 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-07 22:42:03,059 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-07 22:42:03,061 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-07 22:42:03,062 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'18675': np.int64(749), '17612': np.int64(749), '17914': np.int64(243), '17904': np.int64(122)}
2025-07-07 22:42:03,063 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-07 22:42:03,063 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'18675': np.int64(749), '17612': np.int64(749), '17914': np.int64(243), '17904': np.int64(122)}
2025-07-07 22:42:03,067 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 22:42:03,074 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:42:03,077 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-07 22:42:03,080 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-07 22:42:03,085 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-07 22:42:03,086 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'18675': np.int64(749), '17612': np.int64(707), '17914': np.int64(242), '17904': np.int64(121)}
2025-07-07 22:42:03,087 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-07 22:42:03,088 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'18675': np.int64(749), '17612': np.int64(707), '17914': np.int64(242), '17904': np.int64(121)}
2025-07-07 22:42:03,090 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 22:42:03,095 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:42:03,101 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-07 22:42:03,113 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-07 22:42:03,138 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-07 22:42:03,142 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'18675': np.int64(749), '17612': np.int64(534), '17914': np.int64(238), '17904': np.int64(120)}
2025-07-07 22:42:03,146 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-07 22:42:03,148 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'18675': np.int64(749), '17612': np.int64(534), '17914': np.int64(238), '17904': np.int64(120)}
2025-07-07 22:42:03,156 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 22:42:03,162 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:42:03,170 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-07 22:42:03,181 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-07 22:42:03,190 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-07 22:42:03,190 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'18675': np.int64(749), '17612': np.int64(474), '17914': np.int64(229), '17904': np.int64(118)}
2025-07-07 22:42:03,191 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-07 22:42:03,192 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'18675': np.int64(749), '17612': np.int64(474), '17914': np.int64(229), '17904': np.int64(118)}
2025-07-07 22:42:03,193 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 22:42:03,197 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:42:03,203 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-07 22:42:03,206 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-07 22:42:03,209 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-07 22:42:03,210 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'18675': np.int64(749), '17612': np.int64(423), '17914': np.int64(223), '17904': np.int64(115)}
2025-07-07 22:42:03,211 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-07 22:42:03,212 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'18675': np.int64(749), '17612': np.int64(423), '17914': np.int64(223), '17904': np.int64(115)}
2025-07-07 22:42:03,215 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:42:03,221 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-07 22:42:03,224 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-07 22:42:03,228 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-07 22:42:03,229 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'18675': np.int64(749), '17612': np.int64(423), '17914': np.int64(223), '17904': np.int64(115)}
2025-07-07 22:42:03,230 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-07 22:42:03,231 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'18675': np.int64(749), '17612': np.int64(423), '17914': np.int64(223), '17904': np.int64(115)}
2025-07-07 22:42:03,237 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:42:03,242 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-07 22:42:03,247 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-07 22:42:03,252 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-07 22:42:03,254 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'18675': np.int64(749), '17612': np.int64(423), '17914': np.int64(223), '17904': np.int64(115)}
2025-07-07 22:42:03,255 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-07 22:42:03,255 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'18675': np.int64(749), '17612': np.int64(423), '17914': np.int64(223), '17904': np.int64(115)}
2025-07-07 22:42:03,258 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 22:42:03,263 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:42:03,270 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-07 22:42:03,275 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-07 22:42:03,280 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-07 22:42:03,280 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'18675': np.int64(749), '17612': np.int64(339), '17914': np.int64(222), '17904': np.int64(112)}
2025-07-07 22:42:03,295 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612            955            955
3  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
0  2025-06-01  18675            769            769
5  2025-06-02  17612            955            884
2025-07-07 22:42:03,297 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            749            749
117  2025-06-30  17612            423            339
119  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
116  2025-06-30  18675            749            749
2025-07-07 22:42:03,297 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-07 22:42:03,298 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 22:42:03,300 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612            955            955
3  2025-06-01  17904            178            178
2  2025-06-01  17914            326            326
0  2025-06-01  18675            769            769
5  2025-06-02  17612            955            884
2025-07-07 22:42:03,305 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            749            749
117  2025-06-30  17612            423            339
119  2025-06-30  17904            115            112
118  2025-06-30  17914            223            222
116  2025-06-30  18675            749            749
2025-07-07 22:42:03,306 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-07 22:42:03,315 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-07 22:42:03,321 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01            955
5    2025-06-02            884
9    2025-06-03            790
13   2025-06-04           1149
17   2025-06-05            853
21   2025-06-06            736
25   2025-06-07            736
29   2025-06-08            736
33   2025-06-09            689
37   2025-06-10            602
41   2025-06-11            535
45   2025-06-12            301
49   2025-06-13            218
53   2025-06-14            218
57   2025-06-15            218
61   2025-06-16             54
65   2025-06-17             -2
69   2025-06-18            517
73   2025-06-19            470
77   2025-06-20            394
81   2025-06-21            394
85   2025-06-22            394
89   2025-06-23            749
93   2025-06-24            707
97   2025-06-25            534
101  2025-06-26            474
105  2025-06-27            423
109  2025-06-28            423
113  2025-06-29            423
117  2025-06-30            339
2025-07-07 22:42:03,324 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
3    2025-06-01            178
7    2025-06-02            176
11   2025-06-03            163
15   2025-06-04            156
19   2025-06-05            155
23   2025-06-06            153
27   2025-06-07            153
31   2025-06-08            153
35   2025-06-09            151
39   2025-06-10            151
43   2025-06-11            150
47   2025-06-12            136
51   2025-06-13            135
55   2025-06-14            135
59   2025-06-15            135
63   2025-06-16            133
67   2025-06-17            132
71   2025-06-18            131
75   2025-06-19            129
79   2025-06-20            128
83   2025-06-21            128
87   2025-06-22            128
91   2025-06-23            122
95   2025-06-24            121
99   2025-06-25            120
103  2025-06-26            118
107  2025-06-27            115
111  2025-06-28            115
115  2025-06-29            115
119  2025-06-30            112
2025-07-07 22:42:03,343 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-07 22:42:03,357 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 22:42:03,360 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-07 22:42:03,362 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           20
5    2025-06-02           19
9    2025-06-03           17
13   2025-06-04           24
17   2025-06-05           18
21   2025-06-06           16
25   2025-06-07           16
29   2025-06-08           16
33   2025-06-09           15
37   2025-06-10           13
41   2025-06-11           12
45   2025-06-12            7
49   2025-06-13            5
53   2025-06-14            5
57   2025-06-15            5
61   2025-06-16            2
65   2025-06-17            0
69   2025-06-18           11
73   2025-06-19           10
77   2025-06-20            9
81   2025-06-21            9
85   2025-06-22            9
89   2025-06-23           16
93   2025-06-24           15
97   2025-06-25           12
101  2025-06-26           10
105  2025-06-27            9
109  2025-06-28            9
113  2025-06-29            9
117  2025-06-30            8
2025-07-07 22:42:03,364 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-07 22:42:03,365 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-07 22:42:03,366 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 22:42:03,368 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 22:42:03,371 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 22:42:03,373 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-07 22:42:03,374 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-07 22:42:03,383 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 22:42:03,385 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 22:42:03,386 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:42:03,387 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:42:03,390 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:42:03,613 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:42:03,616 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:42:03,618 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:42:03,619 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 22:42:03,657 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:42:03,817 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:42:03,819 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:42:04,072 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:42:04,218 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:42:04,420 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:42:04,594 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:42:04,596 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 22:42:05,395 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:42:05,396 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 22:42:05,396 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 22:42:05,397 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 22:42:05,398 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 22:42:05,438 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 22:42:05,439 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 22:42:05,440 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 22:42:05,441 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 22:42:05,444 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 22:42:05,451 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 22:42:05,452 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 22:42:05,457 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 22:42:05,458 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 22:42:05,461 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:42:05,462 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:42:05,465 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:42:05,654 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:42:05,655 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:42:05,656 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:42:05,657 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 22:42:05,695 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:42:05,852 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:42:05,854 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:42:06,079 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:42:06,298 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:42:06,481 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:42:06,726 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:42:06,728 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 22:42:06,897 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:42:06,898 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 22:42:06,899 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 22:42:06,900 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 22:42:06,901 - __main__ - INFO - Script finished successfully.
2025-07-07 22:43:12,141 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:43:12,142 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:43:12,549 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:43:12,550 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:43:12,550 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:43:12,550 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:43:12,562 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:43:12,780 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:43:12,781 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:43:12,781 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:43:12,781 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:43:12,806 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:43:12,959 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:43:12,961 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:43:13,303 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:13,441 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:13,442 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:43:13,627 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:43:13,630 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:43:13,636 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:43:13,636 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:43:13,637 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:43:13,637 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:43:13,640 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:43:13,863 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:43:13,865 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:43:13,866 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:43:13,867 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:43:13,895 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:43:14,042 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:43:14,043 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:43:14,257 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:14,489 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:14,491 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:43:14,647 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:43:14,648 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:43:14,651 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 22:43:14,653 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:43:14,655 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:43:14,655 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:43:14,658 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:43:14,878 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:43:14,879 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:43:14,880 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:43:14,880 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:43:14,904 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:43:15,058 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:43:15,060 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:43:15,296 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:15,433 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:15,434 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:43:15,580 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:43:15,582 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:43:15,583 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 22:43:15,584 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 22:43:15,588 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 22:43:15,589 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 22:43:15,589 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 22:43:15,590 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:43:15,590 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:43:15,592 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:43:15,796 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:43:15,799 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:43:15,800 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:43:15,801 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:43:15,823 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:43:15,980 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:43:15,982 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:43:16,200 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:16,344 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:16,345 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 22:43:16,496 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 22:43:16,502 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 22:43:16,506 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 22:43:16,507 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 22:43:16,507 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 22:43:16,508 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:43:16,509 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:43:16,512 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:43:16,723 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:43:16,725 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:43:16,725 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:43:16,725 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:43:16,751 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:43:16,898 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:43:16,901 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:43:17,144 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:17,277 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:17,278 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 22:43:17,438 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 22:43:17,441 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 22:43:17,444 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 22:43:17,445 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 22:43:17,445 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:43:17,445 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:43:17,448 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:43:17,646 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:43:17,647 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:43:17,648 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:43:17,648 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:43:17,670 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:43:17,817 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:43:17,819 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:43:18,049 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:18,187 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:18,188 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 22:43:18,343 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 22:43:18,345 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 22:43:18,352 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 22:43:18,352 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 22:43:18,360 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 22:43:18,362 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 22:43:18,363 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 22:43:18,364 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 22:43:18,365 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 22:43:18,366 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 22:43:18,368 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 22:43:18,369 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-07 22:43:18,370 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 22:43:18,370 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 22:43:18,371 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 22:43:18,372 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 22:43:18,373 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 326, '17904': 178, '18675': 769, '17612': 955}
2025-07-07 22:43:18,373 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-07 22:43:18,374 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 326, '17904': 178, '18675': 769, '17612': 955}
2025-07-07 22:43:18,376 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-07 22:43:18,378 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-07 22:43:18,380 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-07 22:43:18,380 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-07 22:43:18,380 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(326), '17904': np.int64(178), '18675': np.int64(769), '17612': np.int64(955)}
2025-07-07 22:43:18,381 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-07 22:43:18,381 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(326), '17904': np.int64(178), '18675': np.int64(769), '17612': np.int64(955)}
2025-07-07 22:43:18,382 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 22:43:18,384 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-07 22:43:18,386 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-07 22:43:18,389 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-07 22:43:18,390 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-07 22:43:18,390 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(323), '17904': np.int64(176), '18675': np.int64(768), '17612': np.int64(884)}
2025-07-07 22:43:18,391 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-07 22:43:18,391 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(323), '17904': np.int64(176), '18675': np.int64(768), '17612': np.int64(884)}
2025-07-07 22:43:18,392 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 22:43:18,394 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-07 22:43:18,396 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-07 22:43:18,397 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-07 22:43:18,398 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-07 22:43:18,399 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(317), '17904': np.int64(163), '18675': np.int64(768), '17612': np.int64(790)}
2025-07-07 22:43:18,399 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-07 22:43:18,400 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(317), '17904': np.int64(163), '18675': np.int64(768), '17612': np.int64(790)}
2025-07-07 22:43:18,401 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 22:43:18,404 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-07 22:43:18,406 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-07 22:43:18,408 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-07 22:43:18,410 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-07 22:43:18,411 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(310), '17904': np.int64(156), '18675': np.int64(768), '17612': np.int64(1149)}
2025-07-07 22:43:18,411 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-07 22:43:18,411 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(310), '17904': np.int64(156), '18675': np.int64(768), '17612': np.int64(1149)}
2025-07-07 22:43:18,412 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 22:43:18,414 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-07 22:43:18,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-07 22:43:18,418 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-07 22:43:18,420 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-07 22:43:18,421 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(303), '17904': np.int64(155), '18675': np.int64(768), '17612': np.int64(853)}
2025-07-07 22:43:18,421 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-07 22:43:18,422 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(303), '17904': np.int64(155), '18675': np.int64(768), '17612': np.int64(853)}
2025-07-07 22:43:18,423 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 22:43:18,425 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-07 22:43:18,428 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-07 22:43:18,429 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-07 22:43:18,432 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-07 22:43:18,434 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-07 22:43:18,435 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-07 22:43:18,435 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-07 22:43:18,437 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-07 22:43:18,439 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-07 22:43:18,441 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-07 22:43:18,442 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-07 22:43:18,444 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-07 22:43:18,444 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-07 22:43:18,444 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-07 22:43:18,447 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-07 22:43:18,448 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-07 22:43:18,450 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-07 22:43:18,452 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-07 22:43:18,453 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-07 22:43:18,453 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-07 22:43:18,454 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-07 22:43:18,455 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 22:43:18,457 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-07 22:43:18,459 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-07 22:43:18,461 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-07 22:43:18,462 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-07 22:43:18,463 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(299), '17904': np.int64(151), '18675': np.int64(766), '17612': np.int64(689)}
2025-07-07 22:43:18,463 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-07 22:43:18,463 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(299), '17904': np.int64(151), '18675': np.int64(766), '17612': np.int64(689)}
2025-07-07 22:43:18,464 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 22:43:18,467 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-07 22:43:18,470 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 22:43:18,472 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-07 22:43:18,474 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-07 22:43:18,474 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(296), '17904': np.int64(151), '18675': np.int64(766), '17612': np.int64(602)}
2025-07-07 22:43:18,475 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-07 22:43:18,475 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(296), '17904': np.int64(151), '18675': np.int64(766), '17612': np.int64(602)}
2025-07-07 22:43:18,476 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 22:43:18,478 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-07 22:43:18,479 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-07 22:43:18,481 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-07 22:43:18,484 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-07 22:43:18,485 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(293), '17904': np.int64(150), '18675': np.int64(765), '17612': np.int64(535)}
2025-07-07 22:43:18,486 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-07 22:43:18,486 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(293), '17904': np.int64(150), '18675': np.int64(765), '17612': np.int64(535)}
2025-07-07 22:43:18,488 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 22:43:18,490 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-07 22:43:18,492 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-07 22:43:18,495 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-07 22:43:18,496 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-07 22:43:18,496 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(282), '17904': np.int64(136), '18675': np.int64(765), '17612': np.int64(301)}
2025-07-07 22:43:18,497 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-07 22:43:18,497 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(282), '17904': np.int64(136), '18675': np.int64(765), '17612': np.int64(301)}
2025-07-07 22:43:18,498 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 22:43:18,501 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-07 22:43:18,504 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-07 22:43:18,506 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-07 22:43:18,507 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-07 22:43:18,508 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-07 22:43:18,508 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-07 22:43:18,508 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-07 22:43:18,511 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-07 22:43:18,518 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-07 22:43:18,524 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-07 22:43:18,527 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-07 22:43:18,528 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-07 22:43:18,529 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-07 22:43:18,530 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-07 22:43:18,536 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-07 22:43:18,540 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-07 22:43:18,545 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-07 22:43:18,548 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-07 22:43:18,549 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-07 22:43:18,550 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-07 22:43:18,551 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-07 22:43:18,553 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 22:43:18,558 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-07 22:43:18,564 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-07 22:43:18,568 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-07 22:43:18,571 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-07 22:43:18,572 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(267), '17904': np.int64(133), '18675': np.int64(762), '17612': np.int64(54)}
2025-07-07 22:43:18,572 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-07 22:43:18,573 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(267), '17904': np.int64(133), '18675': np.int64(762), '17612': np.int64(54)}
2025-07-07 22:43:18,574 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 22:43:18,577 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-07 22:43:18,579 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-07 22:43:18,581 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-07 22:43:18,584 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-07 22:43:18,586 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(256), '17904': np.int64(132), '18675': np.int64(750), '17612': np.int64(-2)}
2025-07-07 22:43:18,588 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-07 22:43:18,588 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(256), '17904': np.int64(132), '18675': np.int64(750), '17612': np.int64(-2)}
2025-07-07 22:43:18,590 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 22:43:18,593 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-07 22:43:18,595 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-07 22:43:18,597 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-07 22:43:18,599 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-07 22:43:18,600 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(255), '17904': np.int64(131), '18675': np.int64(750), '17612': np.int64(517)}
2025-07-07 22:43:18,600 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-07 22:43:18,601 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(255), '17904': np.int64(131), '18675': np.int64(750), '17612': np.int64(517)}
2025-07-07 22:43:18,602 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 22:43:18,605 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-07 22:43:18,607 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-07 22:43:18,609 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-07 22:43:18,611 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-07 22:43:18,611 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(248), '17904': np.int64(129), '18675': np.int64(750), '17612': np.int64(470)}
2025-07-07 22:43:18,612 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-07 22:43:18,613 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(248), '17904': np.int64(129), '18675': np.int64(750), '17612': np.int64(470)}
2025-07-07 22:43:18,614 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 22:43:18,616 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-07 22:43:18,619 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-07 22:43:18,622 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-07 22:43:18,624 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-07 22:43:18,624 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-07 22:43:18,624 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-07 22:43:18,625 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-07 22:43:18,627 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-07 22:43:18,629 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-07 22:43:18,631 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:43:18,634 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-07 22:43:18,635 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-07 22:43:18,636 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-07 22:43:18,636 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-07 22:43:18,639 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-07 22:43:18,641 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-07 22:43:18,642 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:43:18,644 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-07 22:43:18,645 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-07 22:43:18,645 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-07 22:43:18,646 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-07 22:43:18,647 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 22:43:18,649 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-07 22:43:18,651 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-07 22:43:18,654 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:43:18,656 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-07 22:43:18,657 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(243), '17904': np.int64(122), '18675': np.int64(749), '17612': np.int64(749)}
2025-07-07 22:43:18,657 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-07 22:43:18,657 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(243), '17904': np.int64(122), '18675': np.int64(749), '17612': np.int64(749)}
2025-07-07 22:43:18,658 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 22:43:18,660 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-07 22:43:18,662 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-07 22:43:18,664 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:43:18,666 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-07 22:43:18,666 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(242), '17904': np.int64(121), '18675': np.int64(749), '17612': np.int64(707)}
2025-07-07 22:43:18,667 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-07 22:43:18,667 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(242), '17904': np.int64(121), '18675': np.int64(749), '17612': np.int64(707)}
2025-07-07 22:43:18,668 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 22:43:18,671 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-07 22:43:18,673 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-07 22:43:18,675 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:43:18,678 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-07 22:43:18,678 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(238), '17904': np.int64(120), '18675': np.int64(749), '17612': np.int64(534)}
2025-07-07 22:43:18,678 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-07 22:43:18,679 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(238), '17904': np.int64(120), '18675': np.int64(749), '17612': np.int64(534)}
2025-07-07 22:43:18,680 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 22:43:18,682 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-07 22:43:18,684 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-07 22:43:18,686 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:43:18,688 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-07 22:43:18,689 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(229), '17904': np.int64(118), '18675': np.int64(749), '17612': np.int64(474)}
2025-07-07 22:43:18,690 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-07 22:43:18,690 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(229), '17904': np.int64(118), '18675': np.int64(749), '17612': np.int64(474)}
2025-07-07 22:43:18,691 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 22:43:18,694 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-07 22:43:18,696 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-07 22:43:18,698 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:43:18,700 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-07 22:43:18,701 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-07 22:43:18,702 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-07 22:43:18,702 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-07 22:43:18,704 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-07 22:43:18,705 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-07 22:43:18,707 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:43:18,709 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-07 22:43:18,709 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-07 22:43:18,710 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-07 22:43:18,710 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-07 22:43:18,713 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-07 22:43:18,715 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-07 22:43:18,718 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:43:18,720 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-07 22:43:18,721 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-07 22:43:18,721 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-07 22:43:18,722 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-07 22:43:18,723 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 22:43:18,725 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-07 22:43:18,727 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-07 22:43:18,729 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:43:18,731 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-07 22:43:18,732 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(222), '17904': np.int64(112), '18675': np.int64(749), '17612': np.int64(339)}
2025-07-07 22:43:18,735 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
2  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-07 22:43:18,738 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
118  2025-06-30  18675            749            749
2025-07-07 22:43:18,738 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-07 22:43:18,739 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 22:43:18,740 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
2  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-07 22:43:18,742 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
118  2025-06-30  18675            749            749
2025-07-07 22:43:18,742 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-07 22:43:18,744 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-07 22:43:18,746 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01            955
7    2025-06-02            884
11   2025-06-03            790
15   2025-06-04           1149
19   2025-06-05            853
23   2025-06-06            736
27   2025-06-07            736
31   2025-06-08            736
35   2025-06-09            689
39   2025-06-10            602
43   2025-06-11            535
47   2025-06-12            301
51   2025-06-13            218
55   2025-06-14            218
59   2025-06-15            218
63   2025-06-16             54
67   2025-06-17             -2
71   2025-06-18            517
75   2025-06-19            470
79   2025-06-20            394
83   2025-06-21            394
87   2025-06-22            394
91   2025-06-23            749
95   2025-06-24            707
99   2025-06-25            534
103  2025-06-26            474
107  2025-06-27            423
111  2025-06-28            423
115  2025-06-29            423
119  2025-06-30            339
2025-07-07 22:43:18,749 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            178
5    2025-06-02            176
9    2025-06-03            163
13   2025-06-04            156
17   2025-06-05            155
21   2025-06-06            153
25   2025-06-07            153
29   2025-06-08            153
33   2025-06-09            151
37   2025-06-10            151
41   2025-06-11            150
45   2025-06-12            136
49   2025-06-13            135
53   2025-06-14            135
57   2025-06-15            135
61   2025-06-16            133
65   2025-06-17            132
69   2025-06-18            131
73   2025-06-19            129
77   2025-06-20            128
81   2025-06-21            128
85   2025-06-22            128
89   2025-06-23            122
93   2025-06-24            121
97   2025-06-25            120
101  2025-06-26            118
105  2025-06-27            115
109  2025-06-28            115
113  2025-06-29            115
117  2025-06-30            112
2025-07-07 22:43:18,758 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-07 22:43:18,762 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 22:43:18,764 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-07 22:43:18,767 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           20
7    2025-06-02           19
11   2025-06-03           17
15   2025-06-04           24
19   2025-06-05           18
23   2025-06-06           16
27   2025-06-07           16
31   2025-06-08           16
35   2025-06-09           15
39   2025-06-10           13
43   2025-06-11           12
47   2025-06-12            7
51   2025-06-13            5
55   2025-06-14            5
59   2025-06-15            5
63   2025-06-16            2
67   2025-06-17            0
71   2025-06-18           11
75   2025-06-19           10
79   2025-06-20            9
83   2025-06-21            9
87   2025-06-22            9
91   2025-06-23           16
95   2025-06-24           15
99   2025-06-25           12
103  2025-06-26           10
107  2025-06-27            9
111  2025-06-28            9
115  2025-06-29            9
119  2025-06-30            8
2025-07-07 22:43:18,769 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-07 22:43:18,770 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-07 22:43:18,771 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 22:43:18,772 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 22:43:18,774 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 22:43:18,775 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-07 22:43:18,776 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-07 22:43:18,782 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 22:43:18,784 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 22:43:18,784 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:43:18,784 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:43:18,788 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:43:18,997 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:43:19,000 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:43:19,001 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:43:19,002 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 22:43:19,029 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:43:19,168 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:43:19,170 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:43:19,404 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:19,533 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:19,715 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:43:19,893 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:43:19,895 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 22:43:20,071 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:43:20,072 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 22:43:20,075 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 22:43:20,077 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 22:43:20,079 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 22:43:20,177 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 22:43:20,178 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 22:43:20,179 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 22:43:20,181 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 22:43:20,185 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 22:43:20,188 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 22:43:20,190 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 22:43:20,197 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 22:43:20,198 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 22:43:20,204 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:43:20,205 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:43:20,213 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:43:20,453 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:43:20,457 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:43:20,458 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:43:20,460 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 22:43:20,533 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:43:20,697 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:43:20,702 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:43:20,933 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:21,065 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:43:21,238 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:43:21,385 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:43:21,386 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 22:43:21,594 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:43:21,596 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 22:43:21,597 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 22:43:21,598 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 22:43:21,599 - __main__ - INFO - Script finished successfully.
2025-07-07 22:49:46,007 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:49:46,009 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:49:46,345 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:49:46,345 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:49:46,346 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:49:46,346 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:49:46,358 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:49:46,577 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:49:46,579 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:49:46,579 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:49:46,581 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:49:46,605 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:49:46,749 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:49:46,752 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:49:47,183 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:49:47,319 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:49:47,321 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:49:47,496 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:49:47,497 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:49:47,502 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:49:47,503 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:49:47,503 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:49:47,504 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:49:47,507 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:49:47,722 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:49:47,723 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:49:47,724 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:49:47,724 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:49:47,750 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:49:47,898 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:49:47,901 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:49:48,205 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:49:48,346 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:49:48,347 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:49:48,516 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:49:48,517 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:49:48,519 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 229, in load_product_names_map
    if raw_data is None or (isinstance(raw_data, (bool, list, pd.DataFrame)) and not raw_data): # Handles False, empty list/df
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 22:49:48,524 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 22:49:48,526 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:49:48,527 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:49:48,527 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:49:48,529 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:49:48,756 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:49:48,758 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:49:48,758 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:49:48,759 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:49:48,782 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:49:48,938 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:49:48,940 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:49:49,155 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:49:49,300 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:49:49,302 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:49:49,474 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:49:49,475 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:53:17,505 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:53:17,506 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:53:17,873 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:53:17,873 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:53:17,873 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:53:17,874 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:53:17,888 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:53:18,188 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:53:18,190 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:53:18,190 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:53:18,190 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:53:18,217 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:53:18,420 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:53:18,427 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:53:18,890 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:53:19,025 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:53:19,026 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:53:19,193 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:53:19,201 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:53:19,215 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:53:19,216 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:53:19,217 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:53:19,217 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:53:19,220 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:53:19,467 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:53:19,469 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:53:19,470 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:53:19,471 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:53:19,492 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:53:19,636 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:53:19,638 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:53:19,877 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:53:20,013 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:53:20,016 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:53:20,159 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:53:20,160 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:53:20,161 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 229, in load_product_names_map
    if raw_data is None or (isinstance(raw_data, (bool, list, pd.DataFrame)) and not raw_data): # Handles False, empty list/df
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 22:53:20,165 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 22:53:20,166 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:53:20,167 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:53:20,167 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:53:20,170 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:53:20,382 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:53:20,383 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:53:20,384 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:53:20,384 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:53:20,406 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:53:20,559 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:53:20,563 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:53:20,776 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:53:20,914 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:53:20,916 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:53:21,089 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:53:21,095 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:54:21,376 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:54:21,377 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:54:21,750 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:54:21,751 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:54:21,751 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:54:21,751 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:54:21,763 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:54:21,980 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:54:21,982 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:54:21,983 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:54:21,983 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:54:22,006 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:54:22,162 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:54:22,166 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:54:22,437 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:22,589 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:22,591 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:54:22,785 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:54:22,789 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:54:22,794 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:54:22,795 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:54:22,796 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:54:22,796 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:54:22,800 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:54:23,041 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:54:23,046 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:54:23,047 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:54:23,048 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:54:23,070 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:54:23,221 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:54:23,224 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:54:23,460 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:23,615 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:23,616 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:54:23,798 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:54:23,799 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:54:23,800 - src.services.reporting_logic.report_data_loader - ERROR - Error loading product names map: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\report_data_loader.py", line 229, in load_product_names_map
    if raw_data is None or (isinstance(raw_data, (bool, list, pd.DataFrame)) and not raw_data): # Handles False, empty list/df
       ^^^^^^^^^^^^^^^^
  File "C:\Users\NathanNeely\Projects\ORA_Automation\venv\Lib\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-07 22:54:23,803 - __main__ - ERROR - Failed to load product names map. Weekly report might be incomplete.
2025-07-07 22:54:23,804 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:54:23,804 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:54:23,804 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:54:23,806 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:54:24,001 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:54:24,004 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:54:24,005 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:54:24,006 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:54:24,030 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:54:24,180 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:54:24,185 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:54:24,396 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:24,545 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:24,547 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:54:24,712 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:54:24,714 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:54:51,564 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:54:51,565 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:54:51,931 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:54:51,931 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:54:51,932 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:54:51,932 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:54:51,944 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:54:52,162 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:54:52,165 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:54:52,166 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:54:52,166 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:54:52,190 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:54:52,359 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:54:52,361 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:54:52,780 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:52,936 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:52,939 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:54:53,118 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:54:53,121 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 22:54:53,129 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 22:54:53,131 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 22:54:53,132 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:54:53,132 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:54:53,138 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:54:53,332 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:54:53,336 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:54:53,338 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:54:53,338 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:54:53,364 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:54:53,508 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:54:53,510 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:54:53,749 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:53,901 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:53,903 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 22:54:54,060 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 22:54:54,062 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 22:54:54,066 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 22:54:54,068 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 22:54:54,068 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:54:54,070 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:54:54,072 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:54:54,269 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:54:54,272 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:54:54,273 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:54:54,274 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:54:54,310 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:54:54,457 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:54:54,459 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:54:54,658 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:54,801 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:54,802 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 22:54:54,956 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 22:54:54,958 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 22:54:54,964 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 22:54:54,965 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 22:54:54,987 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 22:54:54,991 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 22:54:54,992 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 22:54:54,992 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:54:54,993 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:54:54,995 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:54:55,199 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:54:55,201 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:54:55,203 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:54:55,204 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:54:55,242 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:54:55,391 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:54:55,392 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:54:55,775 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:55,908 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:55,909 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 22:54:56,070 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 22:54:56,082 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 22:54:56,091 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 22:54:56,092 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 22:54:56,093 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 22:54:56,093 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:54:56,093 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:54:56,096 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:54:56,350 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:54:56,351 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:54:56,352 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:54:56,353 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:54:56,386 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:54:56,532 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:54:56,535 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:54:56,848 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:57,002 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:57,005 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 22:54:57,178 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 22:54:57,186 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 22:54:57,193 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 22:54:57,194 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 22:54:57,195 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:54:57,195 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:54:57,202 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:54:57,514 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:54:57,518 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:54:57,521 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:54:57,522 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:54:57,578 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:54:57,734 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:54:57,737 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:54:57,959 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:58,108 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:54:58,109 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 22:54:58,276 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 22:54:58,279 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 22:54:58,299 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 22:54:58,302 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 22:54:58,328 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 22:54:58,334 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 22:54:58,335 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 22:54:58,338 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 22:54:58,341 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 22:54:58,342 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 22:54:58,347 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 22:54:58,348 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-07 22:54:58,350 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 22:54:58,352 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 22:54:58,353 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 22:54:58,357 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 22:54:58,359 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'18675': 749, '17612': 1006, '17914': 175, '17904': 108}
2025-07-07 22:54:58,360 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-07 22:54:58,361 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'18675': 749, '17612': 1006, '17914': 175, '17904': 108}
2025-07-07 22:54:58,368 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 22:54:58,373 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-07 22:54:58,377 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-07 22:54:58,382 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-07 22:54:58,383 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'18675': np.int64(749), '17612': np.int64(1006), '17914': np.int64(175), '17904': np.int64(108)}
2025-07-07 22:54:58,385 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-07 22:54:58,385 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'18675': np.int64(749), '17612': np.int64(1006), '17914': np.int64(175), '17904': np.int64(108)}
2025-07-07 22:54:58,388 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 22:54:58,393 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-07 22:54:58,398 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-07 22:54:58,407 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-07 22:54:58,426 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-07 22:54:58,440 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'18675': np.int64(748), '17612': np.int64(935), '17914': np.int64(172), '17904': np.int64(106)}
2025-07-07 22:54:58,453 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-07 22:54:58,456 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'18675': np.int64(748), '17612': np.int64(935), '17914': np.int64(172), '17904': np.int64(106)}
2025-07-07 22:54:58,462 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 22:54:58,579 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 22:54:58,595 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-07 22:54:58,617 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-07 22:54:58,633 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-07 22:54:58,661 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'18675': np.int64(748), '17612': np.int64(841), '17914': np.int64(166), '17904': np.int64(93)}
2025-07-07 22:54:58,663 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-07 22:54:58,672 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'18675': np.int64(748), '17612': np.int64(841), '17914': np.int64(166), '17904': np.int64(93)}
2025-07-07 22:54:58,675 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 22:54:58,682 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 22:54:58,708 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-07 22:54:58,719 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-07 22:54:58,729 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-07 22:54:58,739 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'18675': np.int64(748), '17612': np.int64(1200), '17914': np.int64(159), '17904': np.int64(86)}
2025-07-07 22:54:58,741 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-07 22:54:58,743 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'18675': np.int64(748), '17612': np.int64(1200), '17914': np.int64(159), '17904': np.int64(86)}
2025-07-07 22:54:58,748 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 22:54:58,761 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 22:54:58,772 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-07 22:54:58,779 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-07 22:54:58,787 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-07 22:54:58,789 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'18675': np.int64(748), '17612': np.int64(904), '17914': np.int64(152), '17904': np.int64(85)}
2025-07-07 22:54:58,789 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-07 22:54:58,790 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'18675': np.int64(748), '17612': np.int64(904), '17914': np.int64(152), '17904': np.int64(85)}
2025-07-07 22:54:58,793 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 22:54:58,801 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-07 22:54:58,806 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-07 22:54:58,810 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-07 22:54:58,813 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-07 22:54:58,815 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'18675': np.int64(747), '17612': np.int64(787), '17914': np.int64(151), '17904': np.int64(83)}
2025-07-07 22:54:58,816 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-07 22:54:58,818 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'18675': np.int64(747), '17612': np.int64(787), '17914': np.int64(151), '17904': np.int64(83)}
2025-07-07 22:54:58,827 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-07 22:54:58,834 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-07 22:54:58,841 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 22:54:58,847 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-07 22:54:58,848 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'18675': np.int64(747), '17612': np.int64(787), '17914': np.int64(151), '17904': np.int64(83)}
2025-07-07 22:54:58,850 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-07 22:54:58,851 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'18675': np.int64(747), '17612': np.int64(787), '17914': np.int64(151), '17904': np.int64(83)}
2025-07-07 22:54:58,862 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-07 22:54:58,871 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-07 22:54:58,875 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 22:54:58,879 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-07 22:54:58,880 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'18675': np.int64(747), '17612': np.int64(787), '17914': np.int64(151), '17904': np.int64(83)}
2025-07-07 22:54:58,881 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-07 22:54:58,882 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'18675': np.int64(747), '17612': np.int64(787), '17914': np.int64(151), '17904': np.int64(83)}
2025-07-07 22:54:58,886 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 22:54:58,892 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-07 22:54:58,897 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-07 22:54:58,904 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-07 22:54:58,909 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-07 22:54:58,910 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'18675': np.int64(746), '17612': np.int64(740), '17914': np.int64(148), '17904': np.int64(81)}
2025-07-07 22:54:58,911 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-07 22:54:58,912 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'18675': np.int64(746), '17612': np.int64(740), '17914': np.int64(148), '17904': np.int64(81)}
2025-07-07 22:54:58,916 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 22:54:58,923 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-07 22:54:58,927 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-07 22:54:58,935 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-07 22:54:58,941 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-07 22:54:58,942 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'18675': np.int64(746), '17612': np.int64(653), '17914': np.int64(145), '17904': np.int64(81)}
2025-07-07 22:54:58,943 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-07 22:54:58,944 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'18675': np.int64(746), '17612': np.int64(653), '17914': np.int64(145), '17904': np.int64(81)}
2025-07-07 22:54:58,947 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 22:54:58,955 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-07 22:54:58,960 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-07 22:54:58,967 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-07 22:54:58,972 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-07 22:54:58,973 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'18675': np.int64(745), '17612': np.int64(586), '17914': np.int64(142), '17904': np.int64(80)}
2025-07-07 22:54:58,974 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-07 22:54:58,975 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'18675': np.int64(745), '17612': np.int64(586), '17914': np.int64(142), '17904': np.int64(80)}
2025-07-07 22:54:58,977 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 22:54:58,983 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 22:54:58,988 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-07 22:54:58,992 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-07 22:54:58,995 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-07 22:54:58,997 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'18675': np.int64(745), '17612': np.int64(352), '17914': np.int64(131), '17904': np.int64(66)}
2025-07-07 22:54:58,998 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-07 22:54:58,998 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'18675': np.int64(745), '17612': np.int64(352), '17914': np.int64(131), '17904': np.int64(66)}
2025-07-07 22:54:59,002 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 22:54:59,053 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 22:54:59,067 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-07 22:54:59,074 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-07 22:54:59,081 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-07 22:54:59,083 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'18675': np.int64(745), '17612': np.int64(269), '17914': np.int64(119), '17904': np.int64(65)}
2025-07-07 22:54:59,084 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-07 22:54:59,091 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'18675': np.int64(745), '17612': np.int64(269), '17914': np.int64(119), '17904': np.int64(65)}
2025-07-07 22:54:59,097 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 22:54:59,101 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-07 22:54:59,107 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-07 22:54:59,113 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-07 22:54:59,114 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'18675': np.int64(745), '17612': np.int64(269), '17914': np.int64(119), '17904': np.int64(65)}
2025-07-07 22:54:59,115 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-07 22:54:59,117 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'18675': np.int64(745), '17612': np.int64(269), '17914': np.int64(119), '17904': np.int64(65)}
2025-07-07 22:54:59,124 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 22:54:59,127 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-07 22:54:59,139 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-07 22:54:59,145 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-07 22:54:59,146 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'18675': np.int64(745), '17612': np.int64(269), '17914': np.int64(119), '17904': np.int64(65)}
2025-07-07 22:54:59,147 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-07 22:54:59,148 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'18675': np.int64(745), '17612': np.int64(269), '17914': np.int64(119), '17904': np.int64(65)}
2025-07-07 22:54:59,152 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 22:54:59,156 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-07 22:54:59,159 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-07 22:54:59,166 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-07 22:54:59,172 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-07 22:54:59,173 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'18675': np.int64(742), '17612': np.int64(105), '17914': np.int64(116), '17904': np.int64(63)}
2025-07-07 22:54:59,173 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-07 22:54:59,174 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'18675': np.int64(742), '17612': np.int64(105), '17914': np.int64(116), '17904': np.int64(63)}
2025-07-07 22:54:59,176 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 22:54:59,181 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-07 22:54:59,185 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-07 22:54:59,190 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-07 22:54:59,193 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-07 22:54:59,194 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'18675': np.int64(730), '17612': np.int64(49), '17914': np.int64(105), '17904': np.int64(62)}
2025-07-07 22:54:59,196 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-07 22:54:59,196 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'18675': np.int64(730), '17612': np.int64(49), '17914': np.int64(105), '17904': np.int64(62)}
2025-07-07 22:54:59,200 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 22:54:59,204 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-07 22:54:59,208 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-07 22:54:59,212 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-07 22:54:59,218 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-07 22:54:59,219 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'18675': np.int64(730), '17612': np.int64(568), '17914': np.int64(104), '17904': np.int64(61)}
2025-07-07 22:54:59,221 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-07 22:54:59,221 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'18675': np.int64(730), '17612': np.int64(568), '17914': np.int64(104), '17904': np.int64(61)}
2025-07-07 22:54:59,223 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 22:54:59,228 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-07 22:54:59,234 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-07 22:54:59,239 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-07 22:54:59,242 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-07 22:54:59,243 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'18675': np.int64(730), '17612': np.int64(521), '17914': np.int64(97), '17904': np.int64(59)}
2025-07-07 22:54:59,244 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-07 22:54:59,244 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'18675': np.int64(730), '17612': np.int64(521), '17914': np.int64(97), '17904': np.int64(59)}
2025-07-07 22:54:59,246 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 22:54:59,251 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-07 22:54:59,255 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-07 22:54:59,260 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-07 22:54:59,263 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-07 22:54:59,265 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'18675': np.int64(729), '17612': np.int64(445), '17914': np.int64(92), '17904': np.int64(58)}
2025-07-07 22:54:59,266 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-07 22:54:59,267 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'18675': np.int64(729), '17612': np.int64(445), '17914': np.int64(92), '17904': np.int64(58)}
2025-07-07 22:54:59,272 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 22:54:59,278 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-07 22:54:59,284 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 22:54:59,291 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-07 22:54:59,292 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'18675': np.int64(729), '17612': np.int64(445), '17914': np.int64(92), '17904': np.int64(58)}
2025-07-07 22:54:59,294 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-07 22:54:59,295 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'18675': np.int64(729), '17612': np.int64(445), '17914': np.int64(92), '17904': np.int64(58)}
2025-07-07 22:54:59,307 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 22:54:59,312 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-07 22:54:59,319 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 22:54:59,326 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-07 22:54:59,327 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'18675': np.int64(729), '17612': np.int64(445), '17914': np.int64(92), '17904': np.int64(58)}
2025-07-07 22:54:59,328 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-07 22:54:59,329 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'18675': np.int64(729), '17612': np.int64(445), '17914': np.int64(92), '17904': np.int64(58)}
2025-07-07 22:54:59,333 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 22:54:59,340 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 22:54:59,349 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-07 22:54:59,359 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 22:54:59,366 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-07 22:54:59,368 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'18675': np.int64(729), '17612': np.int64(800), '17914': np.int64(92), '17904': np.int64(52)}
2025-07-07 22:54:59,369 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-07 22:54:59,372 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'18675': np.int64(729), '17612': np.int64(800), '17914': np.int64(92), '17904': np.int64(52)}
2025-07-07 22:54:59,375 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 22:54:59,381 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 22:54:59,389 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-07 22:54:59,395 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-07 22:54:59,403 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-07 22:54:59,405 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'18675': np.int64(729), '17612': np.int64(758), '17914': np.int64(91), '17904': np.int64(51)}
2025-07-07 22:54:59,406 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-07 22:54:59,407 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'18675': np.int64(729), '17612': np.int64(758), '17914': np.int64(91), '17904': np.int64(51)}
2025-07-07 22:54:59,411 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 22:54:59,419 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 22:54:59,428 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-07 22:54:59,438 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-07 22:54:59,444 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-07 22:54:59,445 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'18675': np.int64(729), '17612': np.int64(585), '17914': np.int64(87), '17904': np.int64(50)}
2025-07-07 22:54:59,447 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-07 22:54:59,448 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'18675': np.int64(729), '17612': np.int64(585), '17914': np.int64(87), '17904': np.int64(50)}
2025-07-07 22:54:59,452 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 22:54:59,460 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 22:54:59,467 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-07 22:54:59,475 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-07 22:54:59,484 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-07 22:54:59,487 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'18675': np.int64(729), '17612': np.int64(525), '17914': np.int64(78), '17904': np.int64(48)}
2025-07-07 22:54:59,489 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-07 22:54:59,490 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'18675': np.int64(729), '17612': np.int64(525), '17914': np.int64(78), '17904': np.int64(48)}
2025-07-07 22:54:59,495 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 22:54:59,506 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 22:54:59,515 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-07 22:54:59,523 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-07 22:54:59,529 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-07 22:54:59,531 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'18675': np.int64(729), '17612': np.int64(474), '17914': np.int64(72), '17904': np.int64(45)}
2025-07-07 22:54:59,532 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-07 22:54:59,533 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'18675': np.int64(729), '17612': np.int64(474), '17914': np.int64(72), '17904': np.int64(45)}
2025-07-07 22:54:59,542 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 22:54:59,547 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-07 22:54:59,553 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-07 22:54:59,560 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-07 22:54:59,561 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'18675': np.int64(729), '17612': np.int64(474), '17914': np.int64(72), '17904': np.int64(45)}
2025-07-07 22:54:59,562 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-07 22:54:59,564 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'18675': np.int64(729), '17612': np.int64(474), '17914': np.int64(72), '17904': np.int64(45)}
2025-07-07 22:54:59,573 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 22:54:59,578 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-07 22:54:59,584 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-07 22:54:59,591 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-07 22:54:59,592 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'18675': np.int64(729), '17612': np.int64(474), '17914': np.int64(72), '17904': np.int64(45)}
2025-07-07 22:54:59,594 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-07 22:54:59,595 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'18675': np.int64(729), '17612': np.int64(474), '17914': np.int64(72), '17904': np.int64(45)}
2025-07-07 22:54:59,600 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 22:54:59,610 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 22:54:59,616 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-07 22:54:59,625 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-07 22:54:59,633 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-07 22:54:59,635 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'18675': np.int64(729), '17612': np.int64(390), '17914': np.int64(71), '17904': np.int64(42)}
2025-07-07 22:54:59,654 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
2  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-07 22:54:59,660 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
118  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-07 22:54:59,663 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-07 22:54:59,664 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 22:54:59,670 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
2  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-07 22:54:59,676 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
118  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-07 22:54:59,677 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-07 22:54:59,693 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-07 22:54:59,702 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01           1006
5    2025-06-02            935
9    2025-06-03            841
13   2025-06-04           1200
17   2025-06-05            904
21   2025-06-06            787
25   2025-06-07            787
29   2025-06-08            787
33   2025-06-09            740
37   2025-06-10            653
41   2025-06-11            586
45   2025-06-12            352
49   2025-06-13            269
53   2025-06-14            269
57   2025-06-15            269
61   2025-06-16            105
65   2025-06-17             49
69   2025-06-18            568
73   2025-06-19            521
77   2025-06-20            445
81   2025-06-21            445
85   2025-06-22            445
89   2025-06-23            800
93   2025-06-24            758
97   2025-06-25            585
101  2025-06-26            525
105  2025-06-27            474
109  2025-06-28            474
113  2025-06-29            474
117  2025-06-30            390
2025-07-07 22:54:59,712 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
3    2025-06-01            108
7    2025-06-02            106
11   2025-06-03             93
15   2025-06-04             86
19   2025-06-05             85
23   2025-06-06             83
27   2025-06-07             83
31   2025-06-08             83
35   2025-06-09             81
39   2025-06-10             81
43   2025-06-11             80
47   2025-06-12             66
51   2025-06-13             65
55   2025-06-14             65
59   2025-06-15             65
63   2025-06-16             63
67   2025-06-17             62
71   2025-06-18             61
75   2025-06-19             59
79   2025-06-20             58
83   2025-06-21             58
87   2025-06-22             58
91   2025-06-23             52
95   2025-06-24             51
99   2025-06-25             50
103  2025-06-26             48
107  2025-06-27             45
111  2025-06-28             45
115  2025-06-29             45
119  2025-06-30             42
2025-07-07 22:54:59,758 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-07 22:54:59,789 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 22:54:59,799 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-07 22:54:59,812 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           21
5    2025-06-02           20
9    2025-06-03           18
13   2025-06-04           25
17   2025-06-05           19
21   2025-06-06           17
25   2025-06-07           17
29   2025-06-08           17
33   2025-06-09           16
37   2025-06-10           14
41   2025-06-11           13
45   2025-06-12            8
49   2025-06-13            6
53   2025-06-14            6
57   2025-06-15            6
61   2025-06-16            3
65   2025-06-17            2
69   2025-06-18           12
73   2025-06-19           11
77   2025-06-20           10
81   2025-06-21           10
85   2025-06-22           10
89   2025-06-23           17
93   2025-06-24           16
97   2025-06-25           13
101  2025-06-26           11
105  2025-06-27           10
109  2025-06-28           10
113  2025-06-29           10
117  2025-06-30            9
2025-07-07 22:54:59,818 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-07 22:54:59,821 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-07 22:54:59,822 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 22:54:59,824 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 22:54:59,833 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 22:54:59,838 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-07 22:54:59,842 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-07 22:54:59,866 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 22:54:59,868 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 22:54:59,869 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:54:59,870 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:54:59,881 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:55:00,123 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:55:00,125 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:55:00,127 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:55:00,127 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 22:55:00,198 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:55:00,353 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:55:00,356 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:55:00,588 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:55:00,827 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:55:01,029 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:55:01,194 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:55:01,199 - gspread_dataframe - DEBUG - 352 cell updates to send
2025-07-07 22:55:01,385 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AK32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:55:01,389 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:K32", 'updatedRows': 32, 'updatedColumns': 11, 'updatedCells': 352}
2025-07-07 22:55:01,391 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 22:55:01,394 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 22:55:01,395 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 22:55:01,518 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 22:55:01,520 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 22:55:01,521 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 22:55:01,524 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 22:55:01,533 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 22:55:01,538 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 22:55:01,542 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 22:55:01,554 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 22:55:01,557 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 22:55:01,566 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:55:01,569 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:55:01,578 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:55:01,820 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:55:01,824 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:55:01,827 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:55:01,828 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 22:55:01,890 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:55:02,055 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:55:02,062 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:55:02,323 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:55:02,478 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:55:02,664 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 22:55:02,855 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 22:55:02,856 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 22:55:03,039 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 22:55:03,041 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 22:55:03,042 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 22:55:03,043 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 22:55:03,044 - __main__ - INFO - Script finished successfully.
2025-07-07 22:56:13,487 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:56:13,487 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:59:03,232 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 22:59:03,233 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 22:59:03,600 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 22:59:03,600 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 22:59:03,601 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 22:59:03,601 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 22:59:03,616 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 22:59:03,861 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 22:59:03,863 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 22:59:03,864 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 22:59:03,864 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 22:59:03,888 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 22:59:04,070 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 22:59:04,072 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 22:59:04,405 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:59:04,546 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 22:59:04,547 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 22:59:04,704 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 22:59:04,705 - src.services.google_sheets.api_client - INFO - Successfully fetched 21 rows from worksheet 'ORA_Configuration'.
2025-07-07 23:03:21,681 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 23:03:21,682 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 23:03:22,072 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 23:03:22,072 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 23:03:22,073 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:03:22,073 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:03:22,088 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:03:22,286 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:03:22,287 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:03:22,287 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:03:22,289 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:03:22,314 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:03:22,473 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:03:22,475 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:03:22,913 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:23,135 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:23,136 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 23:03:23,304 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 23:03:23,307 - src.services.google_sheets.api_client - INFO - Successfully fetched 22 rows from worksheet 'ORA_Configuration'.
2025-07-07 23:03:23,311 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 23:03:23,312 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 23:03:23,312 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:03:23,313 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:03:23,316 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:03:23,524 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:03:23,526 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:03:23,526 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:03:23,526 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:03:23,549 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:03:23,697 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:03:23,700 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:03:23,923 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:24,058 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:24,060 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 23:03:24,234 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 23:03:24,235 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 23:03:24,236 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 23:03:24,237 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 23:03:24,237 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:03:24,238 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:03:24,240 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:03:24,469 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:03:24,471 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:03:24,472 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:03:24,473 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:03:24,496 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:03:24,669 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:03:24,671 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:03:24,918 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:25,059 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:25,062 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 23:03:25,224 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 23:03:25,226 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 23:03:25,228 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 23:03:25,229 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 23:03:25,233 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 23:03:25,235 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 23:03:25,235 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 23:03:25,237 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:03:25,238 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:03:25,241 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:03:25,454 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:03:25,455 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:03:25,456 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:03:25,456 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:03:25,479 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:03:25,630 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:03:25,634 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:03:25,852 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:25,981 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:25,983 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 23:03:26,144 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 23:03:26,152 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 23:03:26,155 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 23:03:26,156 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 23:03:26,157 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 23:03:26,157 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:03:26,158 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:03:26,160 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:03:26,373 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:03:26,373 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:03:26,375 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:03:26,375 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:03:26,397 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:03:26,552 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:03:26,554 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:03:26,782 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:26,925 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:26,927 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 23:03:27,095 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 23:03:27,100 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 23:03:27,104 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 23:03:27,104 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 23:03:27,105 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:03:27,105 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:03:27,108 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:03:27,314 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:03:27,318 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:03:27,319 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:03:27,320 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:03:27,344 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:03:27,510 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:03:27,514 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:03:27,748 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:27,887 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:27,890 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 23:03:28,047 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 23:03:28,050 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 23:03:28,057 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 23:03:28,057 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 23:03:28,064 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 23:03:28,066 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 23:03:28,066 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 23:03:28,067 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 23:03:28,069 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 23:03:28,069 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 23:03:28,071 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 23:03:28,071 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-07 23:03:28,071 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 23:03:28,072 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 23:03:28,072 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 23:03:28,073 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 23:03:28,074 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 175, '17612': 1006, '18675': 749, '17904': 108}
2025-07-07 23:03:28,074 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-07 23:03:28,075 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 175, '17612': 1006, '18675': 749, '17904': 108}
2025-07-07 23:03:28,077 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-07 23:03:28,079 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-07 23:03:28,081 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 23:03:28,083 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-07 23:03:28,083 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(175), '17612': np.int64(1006), '18675': np.int64(749), '17904': np.int64(108)}
2025-07-07 23:03:28,083 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-07 23:03:28,084 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(175), '17612': np.int64(1006), '18675': np.int64(749), '17904': np.int64(108)}
2025-07-07 23:03:28,085 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 23:03:28,086 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-07 23:03:28,088 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-07 23:03:28,090 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-07 23:03:28,091 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-07 23:03:28,092 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(172), '17612': np.int64(935), '18675': np.int64(748), '17904': np.int64(106)}
2025-07-07 23:03:28,092 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-07 23:03:28,092 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(172), '17612': np.int64(935), '18675': np.int64(748), '17904': np.int64(106)}
2025-07-07 23:03:28,093 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 23:03:28,095 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-07 23:03:28,098 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-07 23:03:28,099 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:03:28,101 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-07 23:03:28,102 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(166), '17612': np.int64(841), '18675': np.int64(748), '17904': np.int64(93)}
2025-07-07 23:03:28,102 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-07 23:03:28,103 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(166), '17612': np.int64(841), '18675': np.int64(748), '17904': np.int64(93)}
2025-07-07 23:03:28,104 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 23:03:28,105 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-07 23:03:28,107 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-07 23:03:28,108 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:03:28,109 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-07 23:03:28,110 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(159), '17612': np.int64(1200), '18675': np.int64(748), '17904': np.int64(86)}
2025-07-07 23:03:28,110 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-07 23:03:28,110 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(159), '17612': np.int64(1200), '18675': np.int64(748), '17904': np.int64(86)}
2025-07-07 23:03:28,112 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 23:03:28,114 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-07 23:03:28,117 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-07 23:03:28,117 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:03:28,120 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-07 23:03:28,120 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(152), '17612': np.int64(904), '18675': np.int64(748), '17904': np.int64(85)}
2025-07-07 23:03:28,121 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-07 23:03:28,121 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(152), '17612': np.int64(904), '18675': np.int64(748), '17904': np.int64(85)}
2025-07-07 23:03:28,122 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 23:03:28,124 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-07 23:03:28,126 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-07 23:03:28,127 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-07 23:03:28,129 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-07 23:03:28,130 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-07 23:03:28,130 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-07 23:03:28,131 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-07 23:03:28,133 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 23:03:28,135 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-07 23:03:28,136 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-07 23:03:28,138 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-07 23:03:28,138 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-07 23:03:28,139 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-07 23:03:28,139 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-07 23:03:28,141 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 23:03:28,143 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-07 23:03:28,144 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-07 23:03:28,146 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-07 23:03:28,147 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-07 23:03:28,147 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-07 23:03:28,148 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-07 23:03:28,149 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 23:03:28,150 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-07 23:03:28,151 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-07 23:03:28,153 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-07 23:03:28,155 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-07 23:03:28,155 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(148), '17612': np.int64(740), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-07 23:03:28,155 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-07 23:03:28,156 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(148), '17612': np.int64(740), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-07 23:03:28,157 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 23:03:28,159 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-07 23:03:28,161 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-07 23:03:28,163 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-07 23:03:28,165 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-07 23:03:28,165 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(145), '17612': np.int64(653), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-07 23:03:28,166 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-07 23:03:28,166 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(145), '17612': np.int64(653), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-07 23:03:28,167 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 23:03:28,169 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-07 23:03:28,171 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-07 23:03:28,173 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-07 23:03:28,174 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-07 23:03:28,175 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(142), '17612': np.int64(586), '18675': np.int64(745), '17904': np.int64(80)}
2025-07-07 23:03:28,175 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-07 23:03:28,176 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(142), '17612': np.int64(586), '18675': np.int64(745), '17904': np.int64(80)}
2025-07-07 23:03:28,176 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 23:03:28,178 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-07 23:03:28,181 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-07 23:03:28,183 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:03:28,184 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-07 23:03:28,185 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(131), '17612': np.int64(352), '18675': np.int64(745), '17904': np.int64(66)}
2025-07-07 23:03:28,185 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-07 23:03:28,185 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(131), '17612': np.int64(352), '18675': np.int64(745), '17904': np.int64(66)}
2025-07-07 23:03:28,186 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 23:03:28,188 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-07 23:03:28,190 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-07 23:03:28,191 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:03:28,193 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-07 23:03:28,193 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-07 23:03:28,193 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-07 23:03:28,194 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-07 23:03:28,197 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-07 23:03:28,198 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-07 23:03:28,200 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:03:28,202 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-07 23:03:28,202 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-07 23:03:28,202 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-07 23:03:28,203 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-07 23:03:28,205 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-07 23:03:28,206 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-07 23:03:28,207 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:03:28,209 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-07 23:03:28,209 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-07 23:03:28,210 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-07 23:03:28,210 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-07 23:03:28,211 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 23:03:28,214 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-07 23:03:28,216 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-07 23:03:28,217 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-07 23:03:28,220 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-07 23:03:28,220 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(116), '17612': np.int64(105), '18675': np.int64(742), '17904': np.int64(63)}
2025-07-07 23:03:28,220 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-07 23:03:28,221 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(116), '17612': np.int64(105), '18675': np.int64(742), '17904': np.int64(63)}
2025-07-07 23:03:28,221 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 23:03:28,223 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-07 23:03:28,224 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-07 23:03:28,226 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-07 23:03:28,227 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-07 23:03:28,228 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(105), '17612': np.int64(49), '18675': np.int64(730), '17904': np.int64(62)}
2025-07-07 23:03:28,228 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-07 23:03:28,229 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(105), '17612': np.int64(49), '18675': np.int64(730), '17904': np.int64(62)}
2025-07-07 23:03:28,230 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 23:03:28,233 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-07 23:03:28,234 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-07 23:03:28,236 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-07 23:03:28,237 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-07 23:03:28,237 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(104), '17612': np.int64(568), '18675': np.int64(730), '17904': np.int64(61)}
2025-07-07 23:03:28,238 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-07 23:03:28,238 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(104), '17612': np.int64(568), '18675': np.int64(730), '17904': np.int64(61)}
2025-07-07 23:03:28,239 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 23:03:28,240 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-07 23:03:28,241 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-07 23:03:28,243 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-07 23:03:28,244 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-07 23:03:28,245 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(97), '17612': np.int64(521), '18675': np.int64(730), '17904': np.int64(59)}
2025-07-07 23:03:28,246 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-07 23:03:28,247 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(97), '17612': np.int64(521), '18675': np.int64(730), '17904': np.int64(59)}
2025-07-07 23:03:28,248 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 23:03:28,250 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-07 23:03:28,251 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-07 23:03:28,253 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-07 23:03:28,254 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-07 23:03:28,255 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-07 23:03:28,255 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-07 23:03:28,255 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-07 23:03:28,257 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:03:28,258 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-07 23:03:28,259 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:03:28,260 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-07 23:03:28,261 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-07 23:03:28,261 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-07 23:03:28,262 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-07 23:03:28,265 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:03:28,266 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-07 23:03:28,268 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:03:28,269 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-07 23:03:28,269 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-07 23:03:28,269 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-07 23:03:28,270 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-07 23:03:28,270 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 23:03:28,272 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:03:28,274 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-07 23:03:28,275 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:03:28,277 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-07 23:03:28,277 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(92), '17612': np.int64(800), '18675': np.int64(729), '17904': np.int64(52)}
2025-07-07 23:03:28,277 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-07 23:03:28,279 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(92), '17612': np.int64(800), '18675': np.int64(729), '17904': np.int64(52)}
2025-07-07 23:03:28,281 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 23:03:28,283 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-07 23:03:28,284 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-07 23:03:28,286 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:03:28,288 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-07 23:03:28,288 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(91), '17612': np.int64(758), '18675': np.int64(729), '17904': np.int64(51)}
2025-07-07 23:03:28,288 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-07 23:03:28,288 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(91), '17612': np.int64(758), '18675': np.int64(729), '17904': np.int64(51)}
2025-07-07 23:03:28,289 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 23:03:28,290 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-07 23:03:28,292 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-07 23:03:28,293 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:03:28,295 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-07 23:03:28,296 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(87), '17612': np.int64(585), '18675': np.int64(729), '17904': np.int64(50)}
2025-07-07 23:03:28,297 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-07 23:03:28,297 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(87), '17612': np.int64(585), '18675': np.int64(729), '17904': np.int64(50)}
2025-07-07 23:03:28,299 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 23:03:28,301 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-07 23:03:28,302 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-07 23:03:28,304 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:03:28,305 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-07 23:03:28,305 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(78), '17612': np.int64(525), '18675': np.int64(729), '17904': np.int64(48)}
2025-07-07 23:03:28,306 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-07 23:03:28,306 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(78), '17612': np.int64(525), '18675': np.int64(729), '17904': np.int64(48)}
2025-07-07 23:03:28,307 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 23:03:28,309 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-07 23:03:28,311 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-07 23:03:28,315 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:03:28,317 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-07 23:03:28,317 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-07 23:03:28,317 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-07 23:03:28,317 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-07 23:03:28,320 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-07 23:03:28,322 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-07 23:03:28,323 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:03:28,325 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-07 23:03:28,325 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-07 23:03:28,326 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-07 23:03:28,326 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-07 23:03:28,328 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-07 23:03:28,331 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-07 23:03:28,334 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:03:28,336 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-07 23:03:28,337 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-07 23:03:28,337 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-07 23:03:28,338 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-07 23:03:28,339 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 23:03:28,341 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-07 23:03:28,342 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-07 23:03:28,344 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:03:28,346 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-07 23:03:28,347 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(71), '17612': np.int64(390), '18675': np.int64(729), '17904': np.int64(42)}
2025-07-07 23:03:28,350 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
0  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-07 23:03:28,351 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
116  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-07 23:03:28,351 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-07 23:03:28,352 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 23:03:28,353 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
0  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-07 23:03:28,354 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
116  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-07 23:03:28,355 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-07 23:03:28,356 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-07 23:03:28,358 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01           1006
5    2025-06-02            935
9    2025-06-03            841
13   2025-06-04           1200
17   2025-06-05            904
21   2025-06-06            787
25   2025-06-07            787
29   2025-06-08            787
33   2025-06-09            740
37   2025-06-10            653
41   2025-06-11            586
45   2025-06-12            352
49   2025-06-13            269
53   2025-06-14            269
57   2025-06-15            269
61   2025-06-16            105
65   2025-06-17             49
69   2025-06-18            568
73   2025-06-19            521
77   2025-06-20            445
81   2025-06-21            445
85   2025-06-22            445
89   2025-06-23            800
93   2025-06-24            758
97   2025-06-25            585
101  2025-06-26            525
105  2025-06-27            474
109  2025-06-28            474
113  2025-06-29            474
117  2025-06-30            390
2025-07-07 23:03:28,359 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
3    2025-06-01            108
7    2025-06-02            106
11   2025-06-03             93
15   2025-06-04             86
19   2025-06-05             85
23   2025-06-06             83
27   2025-06-07             83
31   2025-06-08             83
35   2025-06-09             81
39   2025-06-10             81
43   2025-06-11             80
47   2025-06-12             66
51   2025-06-13             65
55   2025-06-14             65
59   2025-06-15             65
63   2025-06-16             63
67   2025-06-17             62
71   2025-06-18             61
75   2025-06-19             59
79   2025-06-20             58
83   2025-06-21             58
87   2025-06-22             58
91   2025-06-23             52
95   2025-06-24             51
99   2025-06-25             50
103  2025-06-26             48
107  2025-06-27             45
111  2025-06-28             45
115  2025-06-29             45
119  2025-06-30             42
2025-07-07 23:03:28,367 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-07 23:03:28,370 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 23:03:28,372 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-07 23:03:28,374 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           21
5    2025-06-02           20
9    2025-06-03           18
13   2025-06-04           25
17   2025-06-05           19
21   2025-06-06           17
25   2025-06-07           17
29   2025-06-08           17
33   2025-06-09           16
37   2025-06-10           14
41   2025-06-11           13
45   2025-06-12            8
49   2025-06-13            6
53   2025-06-14            6
57   2025-06-15            6
61   2025-06-16            3
65   2025-06-17            2
69   2025-06-18           12
73   2025-06-19           11
77   2025-06-20           10
81   2025-06-21           10
85   2025-06-22           10
89   2025-06-23           17
93   2025-06-24           16
97   2025-06-25           13
101  2025-06-26           11
105  2025-06-27           10
109  2025-06-28           10
113  2025-06-29           10
117  2025-06-30            9
2025-07-07 23:03:28,374 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-07 23:03:28,375 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-07 23:03:28,375 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 23:03:28,376 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 23:03:28,378 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 23:03:28,379 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-07 23:03:28,380 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-07 23:03:28,386 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 23:03:28,387 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 23:03:28,387 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:03:28,387 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:03:28,390 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:03:28,597 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:03:28,599 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:03:28,600 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:03:28,600 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 23:03:28,626 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:03:28,777 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:03:28,783 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:03:29,011 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:29,159 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:29,366 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 23:03:29,538 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 23:03:29,540 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-07 23:03:29,720 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 23:03:29,721 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-07 23:03:29,721 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 23:03:29,722 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 23:03:29,722 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 23:03:29,738 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 23:03:29,739 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 23:03:29,739 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 23:03:29,740 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 23:03:29,741 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 23:03:29,742 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 23:03:29,742 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 23:03:29,745 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 23:03:29,746 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 23:03:29,750 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:03:29,750 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:03:29,752 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:03:29,961 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:03:29,963 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:03:29,964 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:03:29,964 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 23:03:29,984 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:03:30,136 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:03:30,137 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:03:30,370 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:30,524 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:03:30,721 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 23:03:30,890 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 23:03:30,892 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 23:03:31,071 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 23:03:31,073 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 23:03:31,074 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 23:03:31,075 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 23:03:31,075 - __main__ - INFO - Script finished successfully.
2025-07-07 23:12:33,311 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 23:12:33,312 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 23:12:33,655 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 23:12:33,655 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 23:12:33,656 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:12:33,656 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:12:33,669 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:12:33,922 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:12:33,924 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:12:33,925 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:12:33,925 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:12:33,954 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:12:34,130 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:12:34,132 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:12:34,575 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:34,718 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:34,719 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 23:12:34,891 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 23:12:34,893 - src.services.google_sheets.api_client - INFO - Successfully fetched 22 rows from worksheet 'ORA_Configuration'.
2025-07-07 23:12:34,899 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 23:12:34,899 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 23:12:34,900 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:12:34,900 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:12:34,903 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:12:35,115 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:12:35,118 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:12:35,119 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:12:35,119 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:12:35,147 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:12:35,355 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:12:35,358 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:12:35,597 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:35,903 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:35,904 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 23:12:36,077 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 23:12:36,078 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 23:12:36,079 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 23:12:36,080 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 23:12:36,081 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:12:36,081 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:12:36,083 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:12:36,317 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:12:36,319 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:12:36,319 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:12:36,320 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:12:36,347 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:12:36,495 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:12:36,499 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:12:36,758 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:36,898 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:36,899 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 23:12:37,079 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 23:12:37,081 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 23:12:37,082 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 23:12:37,083 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 23:12:37,085 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 23:12:37,086 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 23:12:37,086 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 23:12:37,087 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:12:37,087 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:12:37,089 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:12:37,296 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:12:37,297 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:12:37,298 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:12:37,298 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:12:37,320 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:12:37,495 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:12:37,497 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:12:37,745 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:37,894 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:37,898 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 23:12:38,082 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 23:12:38,092 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 23:12:38,096 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 23:12:38,098 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 23:12:38,098 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 23:12:38,099 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:12:38,100 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:12:38,103 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:12:38,315 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:12:38,318 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:12:38,319 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:12:38,319 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:12:38,346 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:12:38,500 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:12:38,501 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:12:38,793 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:38,940 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:38,940 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 23:12:39,120 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 23:12:39,124 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 23:12:39,128 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 23:12:39,129 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 23:12:39,129 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:12:39,129 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:12:39,131 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:12:39,340 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:12:39,341 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:12:39,342 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:12:39,342 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:12:39,366 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:12:39,532 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:12:39,536 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:12:39,789 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:39,927 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:39,928 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 23:12:40,087 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 23:12:40,089 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 23:12:40,095 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 23:12:40,097 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 23:12:40,102 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 23:12:40,105 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 23:12:40,105 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 23:12:40,107 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 23:12:40,108 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 23:12:40,108 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 23:12:40,111 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 23:12:40,111 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-07 23:12:40,112 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 23:12:40,112 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 23:12:40,113 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 23:12:40,114 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 23:12:40,115 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'18675': 749, '17612': 1006, '17914': 175, '17904': 108}
2025-07-07 23:12:40,115 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-07 23:12:40,117 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'18675': 749, '17612': 1006, '17914': 175, '17904': 108}
2025-07-07 23:12:40,119 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 23:12:40,121 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-07 23:12:40,122 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-07 23:12:40,124 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-07 23:12:40,124 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'18675': np.int64(749), '17612': np.int64(1006), '17914': np.int64(175), '17904': np.int64(108)}
2025-07-07 23:12:40,125 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-07 23:12:40,125 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'18675': np.int64(749), '17612': np.int64(1006), '17914': np.int64(175), '17904': np.int64(108)}
2025-07-07 23:12:40,127 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 23:12:40,128 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-07 23:12:40,130 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-07 23:12:40,132 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-07 23:12:40,134 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-07 23:12:40,136 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'18675': np.int64(748), '17612': np.int64(935), '17914': np.int64(172), '17904': np.int64(106)}
2025-07-07 23:12:40,137 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-07 23:12:40,137 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'18675': np.int64(748), '17612': np.int64(935), '17914': np.int64(172), '17904': np.int64(106)}
2025-07-07 23:12:40,139 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 23:12:40,140 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:12:40,142 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-07 23:12:40,144 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-07 23:12:40,145 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-07 23:12:40,147 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'18675': np.int64(748), '17612': np.int64(841), '17914': np.int64(166), '17904': np.int64(93)}
2025-07-07 23:12:40,147 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-07 23:12:40,148 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'18675': np.int64(748), '17612': np.int64(841), '17914': np.int64(166), '17904': np.int64(93)}
2025-07-07 23:12:40,149 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 23:12:40,150 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:12:40,153 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-07 23:12:40,155 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-07 23:12:40,156 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-07 23:12:40,156 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'18675': np.int64(748), '17612': np.int64(1200), '17914': np.int64(159), '17904': np.int64(86)}
2025-07-07 23:12:40,157 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-07 23:12:40,157 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'18675': np.int64(748), '17612': np.int64(1200), '17914': np.int64(159), '17904': np.int64(86)}
2025-07-07 23:12:40,158 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 23:12:40,159 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:12:40,161 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-07 23:12:40,164 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-07 23:12:40,166 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-07 23:12:40,166 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'18675': np.int64(748), '17612': np.int64(904), '17914': np.int64(152), '17904': np.int64(85)}
2025-07-07 23:12:40,166 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-07 23:12:40,167 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'18675': np.int64(748), '17612': np.int64(904), '17914': np.int64(152), '17904': np.int64(85)}
2025-07-07 23:12:40,167 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 23:12:40,169 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-07 23:12:40,170 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-07 23:12:40,172 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-07 23:12:40,173 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-07 23:12:40,173 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'18675': np.int64(747), '17612': np.int64(787), '17914': np.int64(151), '17904': np.int64(83)}
2025-07-07 23:12:40,174 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-07 23:12:40,174 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'18675': np.int64(747), '17612': np.int64(787), '17914': np.int64(151), '17904': np.int64(83)}
2025-07-07 23:12:40,175 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-07 23:12:40,177 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-07 23:12:40,180 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 23:12:40,182 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-07 23:12:40,182 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'18675': np.int64(747), '17612': np.int64(787), '17914': np.int64(151), '17904': np.int64(83)}
2025-07-07 23:12:40,183 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-07 23:12:40,183 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'18675': np.int64(747), '17612': np.int64(787), '17914': np.int64(151), '17904': np.int64(83)}
2025-07-07 23:12:40,185 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-07 23:12:40,186 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-07 23:12:40,188 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 23:12:40,189 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-07 23:12:40,190 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'18675': np.int64(747), '17612': np.int64(787), '17914': np.int64(151), '17904': np.int64(83)}
2025-07-07 23:12:40,190 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-07 23:12:40,191 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'18675': np.int64(747), '17612': np.int64(787), '17914': np.int64(151), '17904': np.int64(83)}
2025-07-07 23:12:40,192 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 23:12:40,193 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-07 23:12:40,196 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-07 23:12:40,199 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-07 23:12:40,200 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-07 23:12:40,201 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'18675': np.int64(746), '17612': np.int64(740), '17914': np.int64(148), '17904': np.int64(81)}
2025-07-07 23:12:40,201 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-07 23:12:40,201 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'18675': np.int64(746), '17612': np.int64(740), '17914': np.int64(148), '17904': np.int64(81)}
2025-07-07 23:12:40,202 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 23:12:40,204 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-07 23:12:40,205 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-07 23:12:40,207 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-07 23:12:40,209 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-07 23:12:40,209 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'18675': np.int64(746), '17612': np.int64(653), '17914': np.int64(145), '17904': np.int64(81)}
2025-07-07 23:12:40,209 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-07 23:12:40,209 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'18675': np.int64(746), '17612': np.int64(653), '17914': np.int64(145), '17904': np.int64(81)}
2025-07-07 23:12:40,211 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 23:12:40,213 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-07 23:12:40,215 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-07 23:12:40,217 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-07 23:12:40,218 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-07 23:12:40,218 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'18675': np.int64(745), '17612': np.int64(586), '17914': np.int64(142), '17904': np.int64(80)}
2025-07-07 23:12:40,219 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-07 23:12:40,219 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'18675': np.int64(745), '17612': np.int64(586), '17914': np.int64(142), '17904': np.int64(80)}
2025-07-07 23:12:40,219 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 23:12:40,221 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:12:40,222 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-07 23:12:40,224 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-07 23:12:40,225 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-07 23:12:40,225 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'18675': np.int64(745), '17612': np.int64(352), '17914': np.int64(131), '17904': np.int64(66)}
2025-07-07 23:12:40,225 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-07 23:12:40,227 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'18675': np.int64(745), '17612': np.int64(352), '17914': np.int64(131), '17904': np.int64(66)}
2025-07-07 23:12:40,229 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 23:12:40,231 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:12:40,233 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-07 23:12:40,235 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-07 23:12:40,236 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-07 23:12:40,237 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'18675': np.int64(745), '17612': np.int64(269), '17914': np.int64(119), '17904': np.int64(65)}
2025-07-07 23:12:40,237 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-07 23:12:40,238 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'18675': np.int64(745), '17612': np.int64(269), '17914': np.int64(119), '17904': np.int64(65)}
2025-07-07 23:12:40,240 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:12:40,242 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-07 23:12:40,244 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-07 23:12:40,246 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-07 23:12:40,248 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'18675': np.int64(745), '17612': np.int64(269), '17914': np.int64(119), '17904': np.int64(65)}
2025-07-07 23:12:40,248 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-07 23:12:40,249 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'18675': np.int64(745), '17612': np.int64(269), '17914': np.int64(119), '17904': np.int64(65)}
2025-07-07 23:12:40,251 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:12:40,253 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-07 23:12:40,254 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-07 23:12:40,256 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-07 23:12:40,256 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'18675': np.int64(745), '17612': np.int64(269), '17914': np.int64(119), '17904': np.int64(65)}
2025-07-07 23:12:40,257 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-07 23:12:40,257 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'18675': np.int64(745), '17612': np.int64(269), '17914': np.int64(119), '17904': np.int64(65)}
2025-07-07 23:12:40,258 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 23:12:40,260 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-07 23:12:40,261 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-07 23:12:40,263 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-07 23:12:40,265 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-07 23:12:40,267 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'18675': np.int64(742), '17612': np.int64(105), '17914': np.int64(116), '17904': np.int64(63)}
2025-07-07 23:12:40,267 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-07 23:12:40,268 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'18675': np.int64(742), '17612': np.int64(105), '17914': np.int64(116), '17904': np.int64(63)}
2025-07-07 23:12:40,269 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 23:12:40,271 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-07 23:12:40,272 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-07 23:12:40,274 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-07 23:12:40,275 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-07 23:12:40,275 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'18675': np.int64(730), '17612': np.int64(49), '17914': np.int64(105), '17904': np.int64(62)}
2025-07-07 23:12:40,277 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-07 23:12:40,277 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'18675': np.int64(730), '17612': np.int64(49), '17914': np.int64(105), '17904': np.int64(62)}
2025-07-07 23:12:40,278 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 23:12:40,280 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-07 23:12:40,283 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-07 23:12:40,284 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-07 23:12:40,286 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-07 23:12:40,286 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'18675': np.int64(730), '17612': np.int64(568), '17914': np.int64(104), '17904': np.int64(61)}
2025-07-07 23:12:40,286 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-07 23:12:40,287 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'18675': np.int64(730), '17612': np.int64(568), '17914': np.int64(104), '17904': np.int64(61)}
2025-07-07 23:12:40,287 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 23:12:40,289 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-07 23:12:40,291 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-07 23:12:40,293 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-07 23:12:40,295 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-07 23:12:40,295 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'18675': np.int64(730), '17612': np.int64(521), '17914': np.int64(97), '17904': np.int64(59)}
2025-07-07 23:12:40,297 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-07 23:12:40,297 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'18675': np.int64(730), '17612': np.int64(521), '17914': np.int64(97), '17904': np.int64(59)}
2025-07-07 23:12:40,299 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 23:12:40,301 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-07 23:12:40,303 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-07 23:12:40,305 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-07 23:12:40,306 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-07 23:12:40,307 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'18675': np.int64(729), '17612': np.int64(445), '17914': np.int64(92), '17904': np.int64(58)}
2025-07-07 23:12:40,307 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-07 23:12:40,308 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'18675': np.int64(729), '17612': np.int64(445), '17914': np.int64(92), '17904': np.int64(58)}
2025-07-07 23:12:40,310 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:12:40,311 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-07 23:12:40,312 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:12:40,314 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-07 23:12:40,316 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'18675': np.int64(729), '17612': np.int64(445), '17914': np.int64(92), '17904': np.int64(58)}
2025-07-07 23:12:40,316 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-07 23:12:40,317 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'18675': np.int64(729), '17612': np.int64(445), '17914': np.int64(92), '17904': np.int64(58)}
2025-07-07 23:12:40,319 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:12:40,320 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-07 23:12:40,322 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:12:40,323 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-07 23:12:40,323 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'18675': np.int64(729), '17612': np.int64(445), '17914': np.int64(92), '17904': np.int64(58)}
2025-07-07 23:12:40,324 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-07 23:12:40,324 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'18675': np.int64(729), '17612': np.int64(445), '17914': np.int64(92), '17904': np.int64(58)}
2025-07-07 23:12:40,325 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 23:12:40,328 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:12:40,330 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-07 23:12:40,333 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:12:40,335 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-07 23:12:40,335 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'18675': np.int64(729), '17612': np.int64(800), '17914': np.int64(92), '17904': np.int64(52)}
2025-07-07 23:12:40,336 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-07 23:12:40,336 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'18675': np.int64(729), '17612': np.int64(800), '17914': np.int64(92), '17904': np.int64(52)}
2025-07-07 23:12:40,337 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 23:12:40,338 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:12:40,340 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-07 23:12:40,341 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-07 23:12:40,342 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-07 23:12:40,343 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'18675': np.int64(729), '17612': np.int64(758), '17914': np.int64(91), '17904': np.int64(51)}
2025-07-07 23:12:40,343 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-07 23:12:40,343 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'18675': np.int64(729), '17612': np.int64(758), '17914': np.int64(91), '17904': np.int64(51)}
2025-07-07 23:12:40,345 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 23:12:40,347 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:12:40,349 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-07 23:12:40,351 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-07 23:12:40,352 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-07 23:12:40,353 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'18675': np.int64(729), '17612': np.int64(585), '17914': np.int64(87), '17904': np.int64(50)}
2025-07-07 23:12:40,353 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-07 23:12:40,353 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'18675': np.int64(729), '17612': np.int64(585), '17914': np.int64(87), '17904': np.int64(50)}
2025-07-07 23:12:40,354 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 23:12:40,356 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:12:40,357 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-07 23:12:40,359 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-07 23:12:40,360 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-07 23:12:40,361 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'18675': np.int64(729), '17612': np.int64(525), '17914': np.int64(78), '17904': np.int64(48)}
2025-07-07 23:12:40,361 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-07 23:12:40,362 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'18675': np.int64(729), '17612': np.int64(525), '17914': np.int64(78), '17904': np.int64(48)}
2025-07-07 23:12:40,363 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 23:12:40,366 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:12:40,367 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-07 23:12:40,369 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-07 23:12:40,370 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-07 23:12:40,370 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'18675': np.int64(729), '17612': np.int64(474), '17914': np.int64(72), '17904': np.int64(45)}
2025-07-07 23:12:40,371 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-07 23:12:40,371 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'18675': np.int64(729), '17612': np.int64(474), '17914': np.int64(72), '17904': np.int64(45)}
2025-07-07 23:12:40,372 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:12:40,374 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-07 23:12:40,375 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-07 23:12:40,376 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-07 23:12:40,377 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'18675': np.int64(729), '17612': np.int64(474), '17914': np.int64(72), '17904': np.int64(45)}
2025-07-07 23:12:40,378 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-07 23:12:40,378 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'18675': np.int64(729), '17612': np.int64(474), '17914': np.int64(72), '17904': np.int64(45)}
2025-07-07 23:12:40,381 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:12:40,383 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-07 23:12:40,384 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-07 23:12:40,385 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-07 23:12:40,385 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'18675': np.int64(729), '17612': np.int64(474), '17914': np.int64(72), '17904': np.int64(45)}
2025-07-07 23:12:40,385 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-07 23:12:40,385 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'18675': np.int64(729), '17612': np.int64(474), '17914': np.int64(72), '17904': np.int64(45)}
2025-07-07 23:12:40,387 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 23:12:40,389 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:12:40,390 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-07 23:12:40,392 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-07 23:12:40,392 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-07 23:12:40,393 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'18675': np.int64(729), '17612': np.int64(390), '17914': np.int64(71), '17904': np.int64(42)}
2025-07-07 23:12:40,397 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
2  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-07 23:12:40,399 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
118  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-07 23:12:40,399 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-07 23:12:40,400 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 23:12:40,401 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
2  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-07 23:12:40,402 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
118  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-07 23:12:40,402 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-07 23:12:40,404 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-07 23:12:40,405 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01           1006
5    2025-06-02            935
9    2025-06-03            841
13   2025-06-04           1200
17   2025-06-05            904
21   2025-06-06            787
25   2025-06-07            787
29   2025-06-08            787
33   2025-06-09            740
37   2025-06-10            653
41   2025-06-11            586
45   2025-06-12            352
49   2025-06-13            269
53   2025-06-14            269
57   2025-06-15            269
61   2025-06-16            105
65   2025-06-17             49
69   2025-06-18            568
73   2025-06-19            521
77   2025-06-20            445
81   2025-06-21            445
85   2025-06-22            445
89   2025-06-23            800
93   2025-06-24            758
97   2025-06-25            585
101  2025-06-26            525
105  2025-06-27            474
109  2025-06-28            474
113  2025-06-29            474
117  2025-06-30            390
2025-07-07 23:12:40,407 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
3    2025-06-01            108
7    2025-06-02            106
11   2025-06-03             93
15   2025-06-04             86
19   2025-06-05             85
23   2025-06-06             83
27   2025-06-07             83
31   2025-06-08             83
35   2025-06-09             81
39   2025-06-10             81
43   2025-06-11             80
47   2025-06-12             66
51   2025-06-13             65
55   2025-06-14             65
59   2025-06-15             65
63   2025-06-16             63
67   2025-06-17             62
71   2025-06-18             61
75   2025-06-19             59
79   2025-06-20             58
83   2025-06-21             58
87   2025-06-22             58
91   2025-06-23             52
95   2025-06-24             51
99   2025-06-25             50
103  2025-06-26             48
107  2025-06-27             45
111  2025-06-28             45
115  2025-06-29             45
119  2025-06-30             42
2025-07-07 23:12:40,416 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-07 23:12:40,423 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 23:12:40,427 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-07 23:12:40,432 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           21
5    2025-06-02           20
9    2025-06-03           18
13   2025-06-04           25
17   2025-06-05           19
21   2025-06-06           17
25   2025-06-07           17
29   2025-06-08           17
33   2025-06-09           16
37   2025-06-10           14
41   2025-06-11           13
45   2025-06-12            8
49   2025-06-13            6
53   2025-06-14            6
57   2025-06-15            6
61   2025-06-16            3
65   2025-06-17            2
69   2025-06-18           12
73   2025-06-19           11
77   2025-06-20           10
81   2025-06-21           10
85   2025-06-22           10
89   2025-06-23           17
93   2025-06-24           16
97   2025-06-25           13
101  2025-06-26           11
105  2025-06-27           10
109  2025-06-28           10
113  2025-06-29           10
117  2025-06-30            9
2025-07-07 23:12:40,434 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-07 23:12:40,435 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-07 23:12:40,438 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 23:12:40,440 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 23:12:40,444 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 23:12:40,446 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-07 23:12:40,449 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-07 23:12:40,456 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 23:12:40,457 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 23:12:40,458 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:12:40,459 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:12:40,464 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:12:40,692 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:12:40,693 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:12:40,694 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:12:40,695 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 23:12:40,723 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:12:40,882 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:12:40,883 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:12:41,127 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:41,265 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:12:41,481 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 23:12:41,678 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 23:12:41,680 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-07 23:12:42,502 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 23:12:42,505 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-07 23:12:42,508 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 23:12:42,510 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 23:12:42,511 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 23:12:42,594 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 23:12:42,596 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-07 23:12:42,601 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-07
2025-07-07 23:12:42,603 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-07 23:12:42,607 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-07 23:12:42,608 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 23:14:53,160 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 23:14:53,160 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 23:14:53,528 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 23:14:53,528 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 23:14:53,529 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:14:53,529 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:14:53,540 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:14:53,748 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:14:53,750 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:14:53,750 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:14:53,751 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:14:53,773 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:14:53,948 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:14:53,952 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:14:54,241 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:14:54,378 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:14:54,380 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 23:14:54,536 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 23:14:54,539 - src.services.google_sheets.api_client - INFO - Successfully fetched 22 rows from worksheet 'ORA_Configuration'.
2025-07-07 23:14:54,545 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 23:14:54,545 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 23:14:54,546 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:14:54,546 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:14:54,549 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:14:54,752 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:14:54,755 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:14:54,755 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:14:54,757 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:14:54,780 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:14:54,951 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:14:54,955 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:14:55,169 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:14:55,387 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:14:55,388 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 23:14:55,560 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 23:14:55,562 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 23:14:55,563 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 23:14:55,564 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 23:14:55,565 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:14:55,565 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:14:55,570 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:14:55,778 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:14:55,779 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:14:55,780 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:14:55,780 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:14:55,803 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:14:55,968 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:14:55,970 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:14:56,197 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:14:56,356 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:14:56,356 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 23:14:56,506 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 23:14:56,507 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 23:14:56,508 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 23:14:56,509 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 23:14:56,512 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 23:14:56,513 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 23:14:56,513 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 23:14:56,513 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:14:56,514 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:14:56,516 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:14:56,710 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:14:56,712 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:14:56,713 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:14:56,713 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:14:56,734 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:14:56,895 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:14:56,897 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:14:57,133 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:14:57,284 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:14:57,285 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 23:14:57,462 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 23:14:57,468 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 23:14:57,474 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 23:14:57,478 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 23:14:57,479 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 23:14:57,480 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:14:57,480 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:14:57,485 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:14:57,695 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:14:57,696 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:14:57,697 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:14:57,697 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:14:57,725 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:14:57,869 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:14:57,871 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:14:58,106 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:14:58,249 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:14:58,250 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 23:14:58,416 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 23:14:58,420 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 23:14:58,423 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 23:14:58,423 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 23:14:58,424 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:14:58,424 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:14:58,426 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:14:58,635 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:14:58,636 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:14:58,637 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:14:58,638 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:14:58,658 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:14:58,796 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:14:58,799 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:14:59,028 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:14:59,166 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:14:59,167 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 23:14:59,325 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 23:14:59,329 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 23:14:59,340 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 23:14:59,341 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 23:14:59,355 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 23:14:59,358 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 23:14:59,359 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 23:14:59,364 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 23:14:59,369 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 23:14:59,369 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 23:14:59,373 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 23:14:59,373 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-07 23:14:59,374 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 23:14:59,374 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 23:14:59,375 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 23:14:59,379 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 23:14:59,380 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-07 23:14:59,382 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-07 23:14:59,382 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-07 23:14:59,385 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-07 23:14:59,387 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-07 23:14:59,389 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-07 23:14:59,390 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 23:14:59,391 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17612': np.int64(1006), '17904': np.int64(108), '17914': np.int64(175), '18675': np.int64(749)}
2025-07-07 23:14:59,391 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-07 23:14:59,392 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17612': np.int64(1006), '17904': np.int64(108), '17914': np.int64(175), '18675': np.int64(749)}
2025-07-07 23:14:59,395 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 23:14:59,397 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-07 23:14:59,399 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-07 23:14:59,401 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-07 23:14:59,403 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-07 23:14:59,404 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17612': np.int64(935), '17904': np.int64(106), '17914': np.int64(172), '18675': np.int64(748)}
2025-07-07 23:14:59,404 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-07 23:14:59,404 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17612': np.int64(935), '17904': np.int64(106), '17914': np.int64(172), '18675': np.int64(748)}
2025-07-07 23:14:59,406 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 23:14:59,408 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-07 23:14:59,414 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-07 23:14:59,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-07 23:14:59,419 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:14:59,420 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17612': np.int64(841), '17904': np.int64(93), '17914': np.int64(166), '18675': np.int64(748)}
2025-07-07 23:14:59,420 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-07 23:14:59,421 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17612': np.int64(841), '17904': np.int64(93), '17914': np.int64(166), '18675': np.int64(748)}
2025-07-07 23:14:59,422 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 23:14:59,424 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-07 23:14:59,426 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-07 23:14:59,431 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-07 23:14:59,433 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:14:59,434 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17612': np.int64(1200), '17904': np.int64(86), '17914': np.int64(159), '18675': np.int64(748)}
2025-07-07 23:14:59,434 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-07 23:14:59,435 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17612': np.int64(1200), '17904': np.int64(86), '17914': np.int64(159), '18675': np.int64(748)}
2025-07-07 23:14:59,436 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 23:14:59,438 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-07 23:14:59,439 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-07 23:14:59,441 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-07 23:14:59,444 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:14:59,445 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17612': np.int64(904), '17904': np.int64(85), '17914': np.int64(152), '18675': np.int64(748)}
2025-07-07 23:14:59,446 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-07 23:14:59,446 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17612': np.int64(904), '17904': np.int64(85), '17914': np.int64(152), '18675': np.int64(748)}
2025-07-07 23:14:59,448 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 23:14:59,450 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-07 23:14:59,452 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-07 23:14:59,454 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-07 23:14:59,455 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-07 23:14:59,455 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-07 23:14:59,455 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-07 23:14:59,456 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-07 23:14:59,458 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-07 23:14:59,460 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-07 23:14:59,464 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 23:14:59,465 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-07 23:14:59,465 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-07 23:14:59,466 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-07 23:14:59,466 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-07 23:14:59,468 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-07 23:14:59,469 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-07 23:14:59,470 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 23:14:59,471 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-07 23:14:59,472 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-07 23:14:59,472 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-07 23:14:59,472 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-07 23:14:59,473 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 23:14:59,475 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-07 23:14:59,479 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-07 23:14:59,481 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-07 23:14:59,483 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-07 23:14:59,483 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17612': np.int64(740), '17904': np.int64(81), '17914': np.int64(148), '18675': np.int64(746)}
2025-07-07 23:14:59,484 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-07 23:14:59,484 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17612': np.int64(740), '17904': np.int64(81), '17914': np.int64(148), '18675': np.int64(746)}
2025-07-07 23:14:59,485 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 23:14:59,486 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-07 23:14:59,488 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-07 23:14:59,489 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-07 23:14:59,491 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-07 23:14:59,491 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17612': np.int64(653), '17904': np.int64(81), '17914': np.int64(145), '18675': np.int64(746)}
2025-07-07 23:14:59,492 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-07 23:14:59,492 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17612': np.int64(653), '17904': np.int64(81), '17914': np.int64(145), '18675': np.int64(746)}
2025-07-07 23:14:59,495 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 23:14:59,497 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-07 23:14:59,499 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-07 23:14:59,500 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-07 23:14:59,502 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-07 23:14:59,503 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17612': np.int64(586), '17904': np.int64(80), '17914': np.int64(142), '18675': np.int64(745)}
2025-07-07 23:14:59,503 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-07 23:14:59,503 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17612': np.int64(586), '17904': np.int64(80), '17914': np.int64(142), '18675': np.int64(745)}
2025-07-07 23:14:59,504 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 23:14:59,506 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-07 23:14:59,508 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-07 23:14:59,509 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-07 23:14:59,514 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:14:59,515 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17612': np.int64(352), '17904': np.int64(66), '17914': np.int64(131), '18675': np.int64(745)}
2025-07-07 23:14:59,515 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-07 23:14:59,516 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17612': np.int64(352), '17904': np.int64(66), '17914': np.int64(131), '18675': np.int64(745)}
2025-07-07 23:14:59,518 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 23:14:59,520 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-07 23:14:59,522 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-07 23:14:59,524 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-07 23:14:59,525 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:14:59,526 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-07 23:14:59,528 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-07 23:14:59,528 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-07 23:14:59,531 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-07 23:14:59,533 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-07 23:14:59,535 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-07 23:14:59,537 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:14:59,537 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-07 23:14:59,537 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-07 23:14:59,538 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-07 23:14:59,540 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-07 23:14:59,541 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-07 23:14:59,543 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-07 23:14:59,546 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:14:59,546 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-07 23:14:59,547 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-07 23:14:59,547 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-07 23:14:59,548 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 23:14:59,551 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-07 23:14:59,553 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-07 23:14:59,554 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-07 23:14:59,556 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-07 23:14:59,556 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17612': np.int64(105), '17904': np.int64(63), '17914': np.int64(116), '18675': np.int64(742)}
2025-07-07 23:14:59,556 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-07 23:14:59,557 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17612': np.int64(105), '17904': np.int64(63), '17914': np.int64(116), '18675': np.int64(742)}
2025-07-07 23:14:59,558 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 23:14:59,561 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-07 23:14:59,564 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-07 23:14:59,566 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-07 23:14:59,567 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-07 23:14:59,568 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17612': np.int64(49), '17904': np.int64(62), '17914': np.int64(105), '18675': np.int64(730)}
2025-07-07 23:14:59,568 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-07 23:14:59,568 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17612': np.int64(49), '17904': np.int64(62), '17914': np.int64(105), '18675': np.int64(730)}
2025-07-07 23:14:59,569 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 23:14:59,571 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-07 23:14:59,572 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-07 23:14:59,573 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-07 23:14:59,578 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-07 23:14:59,578 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17612': np.int64(568), '17904': np.int64(61), '17914': np.int64(104), '18675': np.int64(730)}
2025-07-07 23:14:59,579 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-07 23:14:59,579 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17612': np.int64(568), '17904': np.int64(61), '17914': np.int64(104), '18675': np.int64(730)}
2025-07-07 23:14:59,581 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 23:14:59,583 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-07 23:14:59,584 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-07 23:14:59,586 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-07 23:14:59,588 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-07 23:14:59,588 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17612': np.int64(521), '17904': np.int64(59), '17914': np.int64(97), '18675': np.int64(730)}
2025-07-07 23:14:59,588 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-07 23:14:59,589 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17612': np.int64(521), '17904': np.int64(59), '17914': np.int64(97), '18675': np.int64(730)}
2025-07-07 23:14:59,590 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 23:14:59,591 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-07 23:14:59,596 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-07 23:14:59,598 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-07 23:14:59,600 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-07 23:14:59,600 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:14:59,601 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-07 23:14:59,601 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:14:59,603 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-07 23:14:59,604 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-07 23:14:59,606 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:14:59,607 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:14:59,608 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:14:59,608 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-07 23:14:59,608 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:14:59,612 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-07 23:14:59,615 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-07 23:14:59,616 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:14:59,617 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:14:59,617 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:14:59,618 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-07 23:14:59,618 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:14:59,619 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 23:14:59,620 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-07 23:14:59,622 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-07 23:14:59,623 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:14:59,625 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:14:59,625 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17612': np.int64(800), '17904': np.int64(52), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:14:59,626 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-07 23:14:59,628 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17612': np.int64(800), '17904': np.int64(52), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:14:59,630 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 23:14:59,632 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-07 23:14:59,633 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-07 23:14:59,634 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-07 23:14:59,635 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:14:59,636 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17612': np.int64(758), '17904': np.int64(51), '17914': np.int64(91), '18675': np.int64(729)}
2025-07-07 23:14:59,636 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-07 23:14:59,636 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17612': np.int64(758), '17904': np.int64(51), '17914': np.int64(91), '18675': np.int64(729)}
2025-07-07 23:14:59,637 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 23:14:59,639 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-07 23:14:59,645 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-07 23:14:59,653 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-07 23:14:59,660 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:14:59,663 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17612': np.int64(585), '17904': np.int64(50), '17914': np.int64(87), '18675': np.int64(729)}
2025-07-07 23:14:59,665 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-07 23:14:59,666 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17612': np.int64(585), '17904': np.int64(50), '17914': np.int64(87), '18675': np.int64(729)}
2025-07-07 23:14:59,668 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 23:14:59,672 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-07 23:14:59,677 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-07 23:14:59,680 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-07 23:14:59,683 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:14:59,684 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17612': np.int64(525), '17904': np.int64(48), '17914': np.int64(78), '18675': np.int64(729)}
2025-07-07 23:14:59,687 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-07 23:14:59,689 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17612': np.int64(525), '17904': np.int64(48), '17914': np.int64(78), '18675': np.int64(729)}
2025-07-07 23:14:59,691 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 23:14:59,696 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-07 23:14:59,698 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-07 23:14:59,699 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-07 23:14:59,701 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:14:59,701 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-07 23:14:59,702 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-07 23:14:59,702 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-07 23:14:59,704 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-07 23:14:59,706 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-07 23:14:59,707 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-07 23:14:59,708 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:14:59,709 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-07 23:14:59,710 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-07 23:14:59,711 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-07 23:14:59,713 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-07 23:14:59,715 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-07 23:14:59,716 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-07 23:14:59,718 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:14:59,718 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-07 23:14:59,719 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-07 23:14:59,719 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-07 23:14:59,720 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 23:14:59,721 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-07 23:14:59,723 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-07 23:14:59,724 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-07 23:14:59,726 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:14:59,727 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17612': np.int64(390), '17904': np.int64(42), '17914': np.int64(71), '18675': np.int64(729)}
2025-07-07 23:14:59,730 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612           1006           1006
1  2025-06-01  17904            108            108
2  2025-06-01  17914            175            175
3  2025-06-01  18675            749            749
4  2025-06-02  17612           1006            935
2025-07-07 23:14:59,731 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            729            729
116  2025-06-30  17612            474            390
117  2025-06-30  17904             45             42
118  2025-06-30  17914             72             71
119  2025-06-30  18675            729            729
2025-07-07 23:14:59,732 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-07 23:14:59,732 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 23:14:59,734 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612           1006           1006
1  2025-06-01  17904            108            108
2  2025-06-01  17914            175            175
3  2025-06-01  18675            749            749
4  2025-06-02  17612           1006            935
2025-07-07 23:14:59,735 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            729            729
116  2025-06-30  17612            474            390
117  2025-06-30  17904             45             42
118  2025-06-30  17914             72             71
119  2025-06-30  18675            729            729
2025-07-07 23:14:59,735 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-07 23:14:59,737 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-07 23:14:59,738 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
0    2025-06-01           1006
4    2025-06-02            935
8    2025-06-03            841
12   2025-06-04           1200
16   2025-06-05            904
20   2025-06-06            787
24   2025-06-07            787
28   2025-06-08            787
32   2025-06-09            740
36   2025-06-10            653
40   2025-06-11            586
44   2025-06-12            352
48   2025-06-13            269
52   2025-06-14            269
56   2025-06-15            269
60   2025-06-16            105
64   2025-06-17             49
68   2025-06-18            568
72   2025-06-19            521
76   2025-06-20            445
80   2025-06-21            445
84   2025-06-22            445
88   2025-06-23            800
92   2025-06-24            758
96   2025-06-25            585
100  2025-06-26            525
104  2025-06-27            474
108  2025-06-28            474
112  2025-06-29            474
116  2025-06-30            390
2025-07-07 23:14:59,740 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            108
5    2025-06-02            106
9    2025-06-03             93
13   2025-06-04             86
17   2025-06-05             85
21   2025-06-06             83
25   2025-06-07             83
29   2025-06-08             83
33   2025-06-09             81
37   2025-06-10             81
41   2025-06-11             80
45   2025-06-12             66
49   2025-06-13             65
53   2025-06-14             65
57   2025-06-15             65
61   2025-06-16             63
65   2025-06-17             62
69   2025-06-18             61
73   2025-06-19             59
77   2025-06-20             58
81   2025-06-21             58
85   2025-06-22             58
89   2025-06-23             52
93   2025-06-24             51
97   2025-06-25             50
101  2025-06-26             48
105  2025-06-27             45
109  2025-06-28             45
113  2025-06-29             45
117  2025-06-30             42
2025-07-07 23:14:59,748 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-07 23:14:59,751 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 23:14:59,753 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-07 23:14:59,754 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
0    2025-06-01           21
4    2025-06-02           20
8    2025-06-03           18
12   2025-06-04           25
16   2025-06-05           19
20   2025-06-06           17
24   2025-06-07           17
28   2025-06-08           17
32   2025-06-09           16
36   2025-06-10           14
40   2025-06-11           13
44   2025-06-12            8
48   2025-06-13            6
52   2025-06-14            6
56   2025-06-15            6
60   2025-06-16            3
64   2025-06-17            2
68   2025-06-18           12
72   2025-06-19           11
76   2025-06-20           10
80   2025-06-21           10
84   2025-06-22           10
88   2025-06-23           17
92   2025-06-24           16
96   2025-06-25           13
100  2025-06-26           11
104  2025-06-27           10
108  2025-06-28           10
112  2025-06-29           10
116  2025-06-30            9
2025-07-07 23:14:59,756 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-07 23:14:59,756 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-07 23:14:59,756 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 23:14:59,757 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 23:14:59,758 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 23:14:59,761 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-07 23:14:59,762 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-07 23:14:59,768 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 23:14:59,768 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 23:14:59,769 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:14:59,769 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:14:59,771 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:14:59,969 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:14:59,970 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:14:59,971 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:14:59,971 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 23:14:59,995 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:15:00,128 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:15:00,130 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:15:00,346 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:15:00,485 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:15:00,670 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 23:15:00,876 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 23:15:00,878 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-07 23:15:01,073 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 23:15:01,075 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-07 23:15:01,077 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 23:15:01,078 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 23:15:01,078 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 23:15:01,094 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 23:15:01,095 - src.services.reporting_logic.average_calculations - INFO - Calculating 12-Month Rolling Average...
2025-07-07 23:15:01,096 - src.services.reporting_logic.average_calculations - DEBUG - Input weekly history DataFrame shape: (240, 3)
2025-07-07 23:15:01,097 - src.services.reporting_logic.average_calculations - DEBUG - Data types of weekly history:
Date               datetime64[ns]
SKU                        object
ShippedQuantity             int64
dtype: object
2025-07-07 23:15:01,099 - src.services.reporting_logic.average_calculations - DEBUG - DataFrame shape after cleaning and type conversion: (240, 3)
2025-07-07 23:15:01,100 - src.services.reporting_logic.average_calculations - DEBUG - Calculating rolling average for 52 weeks prior to 2026-07-04 00:00:00
2025-07-07 23:15:01,101 - src.services.reporting_logic.average_calculations - DEBUG - Found 4 shipment records in the last 52 weeks.
2025-07-07 23:15:01,103 - src.services.reporting_logic.average_calculations - INFO - Successfully calculated 12-month rolling average.
2025-07-07 23:15:01,103 - src.services.reporting_logic.average_calculations - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 23:15:01,105 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:15:01,106 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:15:01,108 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:15:01,327 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:15:01,330 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:15:01,330 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:15:01,331 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 23:15:01,353 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:15:01,505 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:15:01,506 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:15:01,736 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:15:01,889 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:15:02,062 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 23:15:02,221 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 23:15:02,222 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 23:15:04,065 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 23:15:04,065 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 23:15:04,066 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 23:15:04,067 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 23:15:04,067 - __main__ - INFO - Script finished successfully.
2025-07-07 23:16:03,938 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 23:16:03,938 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 23:16:04,311 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 23:16:04,312 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 23:16:04,313 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:16:04,313 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:16:04,325 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:16:04,531 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:16:04,533 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:16:04,533 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:16:04,534 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:16:04,557 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:16:04,706 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:16:04,708 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:16:05,060 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:05,200 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:05,202 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 23:16:05,375 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 23:16:05,378 - src.services.google_sheets.api_client - INFO - Successfully fetched 22 rows from worksheet 'ORA_Configuration'.
2025-07-07 23:16:05,383 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 23:16:05,384 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 23:16:05,384 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:16:05,385 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:16:05,387 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:16:05,594 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:16:05,596 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:16:05,596 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:16:05,597 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:16:05,628 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:16:05,777 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:16:05,779 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:16:06,014 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:06,165 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:06,167 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 23:16:06,331 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 23:16:06,332 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 23:16:06,333 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 23:16:06,334 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 23:16:06,335 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:16:06,335 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:16:06,337 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:16:06,536 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:16:06,537 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:16:06,538 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:16:06,538 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:16:06,560 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:16:06,716 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:16:06,718 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:16:06,971 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:07,115 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:07,117 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 23:16:07,285 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 23:16:07,288 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 23:16:07,289 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 23:16:07,289 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 23:16:07,292 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 23:16:07,293 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 23:16:07,293 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 23:16:07,294 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:16:07,294 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:16:07,298 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:16:07,515 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:16:07,517 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:16:07,517 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:16:07,518 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:16:07,541 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:16:07,687 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:16:07,689 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:16:07,922 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:08,085 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:08,087 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 23:16:08,269 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 23:16:08,275 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 23:16:08,279 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 23:16:08,280 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 23:16:08,281 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 23:16:08,281 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:16:08,282 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:16:08,285 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:16:08,495 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:16:08,498 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:16:08,499 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:16:08,500 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:16:08,523 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:16:08,672 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:16:08,674 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:16:08,913 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:09,060 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:09,063 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 23:16:09,255 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 23:16:09,259 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 23:16:09,262 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 23:16:09,263 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 23:16:09,264 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:16:09,264 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:16:09,267 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:16:09,471 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:16:09,473 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:16:09,474 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:16:09,475 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:16:09,499 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:16:09,642 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:16:09,644 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:16:09,907 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:10,049 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:10,050 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 23:16:10,219 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 23:16:10,221 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 23:16:10,228 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 23:16:10,228 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 23:16:10,235 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 23:16:10,236 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 23:16:10,237 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 23:16:10,238 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 23:16:10,239 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 23:16:10,240 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 23:16:10,241 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 23:16:10,242 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-07 23:16:10,242 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 23:16:10,243 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 23:16:10,244 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 23:16:10,245 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 23:16:10,246 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17904': 108, '17612': 1006, '17914': 175, '18675': 749}
2025-07-07 23:16:10,246 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-07 23:16:10,247 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17904': 108, '17612': 1006, '17914': 175, '18675': 749}
2025-07-07 23:16:10,250 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-07 23:16:10,252 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-07 23:16:10,253 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-07 23:16:10,255 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 23:16:10,255 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17904': np.int64(108), '17612': np.int64(1006), '17914': np.int64(175), '18675': np.int64(749)}
2025-07-07 23:16:10,255 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-07 23:16:10,256 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17904': np.int64(108), '17612': np.int64(1006), '17914': np.int64(175), '18675': np.int64(749)}
2025-07-07 23:16:10,256 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 23:16:10,258 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-07 23:16:10,260 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-07 23:16:10,262 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-07 23:16:10,264 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-07 23:16:10,264 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17904': np.int64(106), '17612': np.int64(935), '17914': np.int64(172), '18675': np.int64(748)}
2025-07-07 23:16:10,264 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-07 23:16:10,265 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17904': np.int64(106), '17612': np.int64(935), '17914': np.int64(172), '18675': np.int64(748)}
2025-07-07 23:16:10,266 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 23:16:10,268 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-07 23:16:10,270 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-07 23:16:10,272 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-07 23:16:10,274 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:16:10,274 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17904': np.int64(93), '17612': np.int64(841), '17914': np.int64(166), '18675': np.int64(748)}
2025-07-07 23:16:10,275 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-07 23:16:10,275 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17904': np.int64(93), '17612': np.int64(841), '17914': np.int64(166), '18675': np.int64(748)}
2025-07-07 23:16:10,277 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 23:16:10,279 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-07 23:16:10,283 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-07 23:16:10,284 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-07 23:16:10,286 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:16:10,287 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17904': np.int64(86), '17612': np.int64(1200), '17914': np.int64(159), '18675': np.int64(748)}
2025-07-07 23:16:10,287 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-07 23:16:10,287 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17904': np.int64(86), '17612': np.int64(1200), '17914': np.int64(159), '18675': np.int64(748)}
2025-07-07 23:16:10,289 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 23:16:10,291 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-07 23:16:10,293 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-07 23:16:10,296 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-07 23:16:10,298 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:16:10,299 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17904': np.int64(85), '17612': np.int64(904), '17914': np.int64(152), '18675': np.int64(748)}
2025-07-07 23:16:10,299 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-07 23:16:10,299 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17904': np.int64(85), '17612': np.int64(904), '17914': np.int64(152), '18675': np.int64(748)}
2025-07-07 23:16:10,300 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 23:16:10,302 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-07 23:16:10,304 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-07 23:16:10,306 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-07 23:16:10,307 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-07 23:16:10,307 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17904': np.int64(83), '17612': np.int64(787), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-07 23:16:10,308 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-07 23:16:10,308 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17904': np.int64(83), '17612': np.int64(787), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-07 23:16:10,311 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-07 23:16:10,313 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-07 23:16:10,315 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 23:16:10,317 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-07 23:16:10,317 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17904': np.int64(83), '17612': np.int64(787), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-07 23:16:10,317 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-07 23:16:10,318 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17904': np.int64(83), '17612': np.int64(787), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-07 23:16:10,319 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-07 23:16:10,321 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-07 23:16:10,323 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 23:16:10,324 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-07 23:16:10,325 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17904': np.int64(83), '17612': np.int64(787), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-07 23:16:10,325 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-07 23:16:10,325 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17904': np.int64(83), '17612': np.int64(787), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-07 23:16:10,326 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 23:16:10,329 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-07 23:16:10,331 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-07 23:16:10,332 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-07 23:16:10,334 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-07 23:16:10,334 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17904': np.int64(81), '17612': np.int64(740), '17914': np.int64(148), '18675': np.int64(746)}
2025-07-07 23:16:10,334 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-07 23:16:10,334 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17904': np.int64(81), '17612': np.int64(740), '17914': np.int64(148), '18675': np.int64(746)}
2025-07-07 23:16:10,336 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 23:16:10,338 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-07 23:16:10,339 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-07 23:16:10,341 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-07 23:16:10,343 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-07 23:16:10,344 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17904': np.int64(81), '17612': np.int64(653), '17914': np.int64(145), '18675': np.int64(746)}
2025-07-07 23:16:10,345 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-07 23:16:10,345 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17904': np.int64(81), '17612': np.int64(653), '17914': np.int64(145), '18675': np.int64(746)}
2025-07-07 23:16:10,347 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 23:16:10,349 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-07 23:16:10,351 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-07 23:16:10,353 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-07 23:16:10,354 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-07 23:16:10,354 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17904': np.int64(80), '17612': np.int64(586), '17914': np.int64(142), '18675': np.int64(745)}
2025-07-07 23:16:10,355 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-07 23:16:10,356 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17904': np.int64(80), '17612': np.int64(586), '17914': np.int64(142), '18675': np.int64(745)}
2025-07-07 23:16:10,357 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 23:16:10,358 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-07 23:16:10,362 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-07 23:16:10,365 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-07 23:16:10,367 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:16:10,367 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17904': np.int64(66), '17612': np.int64(352), '17914': np.int64(131), '18675': np.int64(745)}
2025-07-07 23:16:10,367 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-07 23:16:10,368 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17904': np.int64(66), '17612': np.int64(352), '17914': np.int64(131), '18675': np.int64(745)}
2025-07-07 23:16:10,369 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 23:16:10,371 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-07 23:16:10,377 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-07 23:16:10,384 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-07 23:16:10,389 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:16:10,390 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17904': np.int64(65), '17612': np.int64(269), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-07 23:16:10,391 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-07 23:16:10,392 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17904': np.int64(65), '17612': np.int64(269), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-07 23:16:10,400 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-07 23:16:10,405 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-07 23:16:10,407 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-07 23:16:10,409 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:16:10,410 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17904': np.int64(65), '17612': np.int64(269), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-07 23:16:10,410 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-07 23:16:10,411 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17904': np.int64(65), '17612': np.int64(269), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-07 23:16:10,418 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-07 23:16:10,420 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-07 23:16:10,422 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-07 23:16:10,424 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:16:10,424 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17904': np.int64(65), '17612': np.int64(269), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-07 23:16:10,424 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-07 23:16:10,425 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17904': np.int64(65), '17612': np.int64(269), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-07 23:16:10,426 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 23:16:10,428 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-07 23:16:10,431 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-07 23:16:10,433 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-07 23:16:10,434 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-07 23:16:10,435 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17904': np.int64(63), '17612': np.int64(105), '17914': np.int64(116), '18675': np.int64(742)}
2025-07-07 23:16:10,435 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-07 23:16:10,435 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17904': np.int64(63), '17612': np.int64(105), '17914': np.int64(116), '18675': np.int64(742)}
2025-07-07 23:16:10,436 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 23:16:10,438 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-07 23:16:10,439 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-07 23:16:10,440 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-07 23:16:10,442 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-07 23:16:10,442 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17904': np.int64(62), '17612': np.int64(49), '17914': np.int64(105), '18675': np.int64(730)}
2025-07-07 23:16:10,442 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-07 23:16:10,443 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17904': np.int64(62), '17612': np.int64(49), '17914': np.int64(105), '18675': np.int64(730)}
2025-07-07 23:16:10,444 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 23:16:10,447 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-07 23:16:10,449 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-07 23:16:10,450 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-07 23:16:10,452 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-07 23:16:10,452 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17904': np.int64(61), '17612': np.int64(568), '17914': np.int64(104), '18675': np.int64(730)}
2025-07-07 23:16:10,452 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-07 23:16:10,452 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17904': np.int64(61), '17612': np.int64(568), '17914': np.int64(104), '18675': np.int64(730)}
2025-07-07 23:16:10,453 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 23:16:10,455 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-07 23:16:10,456 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-07 23:16:10,458 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-07 23:16:10,460 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-07 23:16:10,461 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17904': np.int64(59), '17612': np.int64(521), '17914': np.int64(97), '18675': np.int64(730)}
2025-07-07 23:16:10,461 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-07 23:16:10,462 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17904': np.int64(59), '17612': np.int64(521), '17914': np.int64(97), '18675': np.int64(730)}
2025-07-07 23:16:10,463 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 23:16:10,465 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-07 23:16:10,466 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-07 23:16:10,468 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-07 23:16:10,469 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-07 23:16:10,470 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17904': np.int64(58), '17612': np.int64(445), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:16:10,470 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-07 23:16:10,470 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17904': np.int64(58), '17612': np.int64(445), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:16:10,472 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-07 23:16:10,473 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-07 23:16:10,474 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:16:10,476 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:16:10,477 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17904': np.int64(58), '17612': np.int64(445), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:16:10,477 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-07 23:16:10,478 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17904': np.int64(58), '17612': np.int64(445), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:16:10,480 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-07 23:16:10,482 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-07 23:16:10,483 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:16:10,485 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:16:10,485 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17904': np.int64(58), '17612': np.int64(445), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:16:10,485 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-07 23:16:10,485 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17904': np.int64(58), '17612': np.int64(445), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:16:10,486 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 23:16:10,487 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-07 23:16:10,489 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-07 23:16:10,490 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:16:10,492 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:16:10,492 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17904': np.int64(52), '17612': np.int64(800), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:16:10,493 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-07 23:16:10,493 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17904': np.int64(52), '17612': np.int64(800), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-07 23:16:10,494 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 23:16:10,497 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-07 23:16:10,499 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-07 23:16:10,500 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-07 23:16:10,501 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:16:10,501 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17904': np.int64(51), '17612': np.int64(758), '17914': np.int64(91), '18675': np.int64(729)}
2025-07-07 23:16:10,502 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-07 23:16:10,502 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17904': np.int64(51), '17612': np.int64(758), '17914': np.int64(91), '18675': np.int64(729)}
2025-07-07 23:16:10,503 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 23:16:10,504 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-07 23:16:10,506 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-07 23:16:10,508 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-07 23:16:10,509 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:16:10,510 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17904': np.int64(50), '17612': np.int64(585), '17914': np.int64(87), '18675': np.int64(729)}
2025-07-07 23:16:10,510 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-07 23:16:10,511 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17904': np.int64(50), '17612': np.int64(585), '17914': np.int64(87), '18675': np.int64(729)}
2025-07-07 23:16:10,512 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 23:16:10,514 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-07 23:16:10,516 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-07 23:16:10,518 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-07 23:16:10,519 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:16:10,519 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17904': np.int64(48), '17612': np.int64(525), '17914': np.int64(78), '18675': np.int64(729)}
2025-07-07 23:16:10,520 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-07 23:16:10,520 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17904': np.int64(48), '17612': np.int64(525), '17914': np.int64(78), '18675': np.int64(729)}
2025-07-07 23:16:10,521 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 23:16:10,523 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-07 23:16:10,525 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-07 23:16:10,526 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-07 23:16:10,529 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:16:10,531 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17904': np.int64(45), '17612': np.int64(474), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-07 23:16:10,531 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-07 23:16:10,531 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17904': np.int64(45), '17612': np.int64(474), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-07 23:16:10,533 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-07 23:16:10,535 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-07 23:16:10,536 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-07 23:16:10,538 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:16:10,539 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17904': np.int64(45), '17612': np.int64(474), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-07 23:16:10,539 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-07 23:16:10,540 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17904': np.int64(45), '17612': np.int64(474), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-07 23:16:10,544 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-07 23:16:10,547 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-07 23:16:10,549 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-07 23:16:10,550 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:16:10,551 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17904': np.int64(45), '17612': np.int64(474), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-07 23:16:10,551 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-07 23:16:10,552 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17904': np.int64(45), '17612': np.int64(474), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-07 23:16:10,553 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 23:16:10,556 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-07 23:16:10,558 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-07 23:16:10,560 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-07 23:16:10,562 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:16:10,563 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17904': np.int64(42), '17612': np.int64(390), '17914': np.int64(71), '18675': np.int64(729)}
2025-07-07 23:16:10,566 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
0  2025-06-01  17904            108            108
2  2025-06-01  17914            175            175
3  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-07 23:16:10,567 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
116  2025-06-30  17904             45             42
118  2025-06-30  17914             72             71
119  2025-06-30  18675            729            729
2025-07-07 23:16:10,567 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-07 23:16:10,568 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 23:16:10,569 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
0  2025-06-01  17904            108            108
2  2025-06-01  17914            175            175
3  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-07 23:16:10,570 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
116  2025-06-30  17904             45             42
118  2025-06-30  17914             72             71
119  2025-06-30  18675            729            729
2025-07-07 23:16:10,570 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-07 23:16:10,572 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-07 23:16:10,574 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01           1006
5    2025-06-02            935
9    2025-06-03            841
13   2025-06-04           1200
17   2025-06-05            904
21   2025-06-06            787
25   2025-06-07            787
29   2025-06-08            787
33   2025-06-09            740
37   2025-06-10            653
41   2025-06-11            586
45   2025-06-12            352
49   2025-06-13            269
53   2025-06-14            269
57   2025-06-15            269
61   2025-06-16            105
65   2025-06-17             49
69   2025-06-18            568
73   2025-06-19            521
77   2025-06-20            445
81   2025-06-21            445
85   2025-06-22            445
89   2025-06-23            800
93   2025-06-24            758
97   2025-06-25            585
101  2025-06-26            525
105  2025-06-27            474
109  2025-06-28            474
113  2025-06-29            474
117  2025-06-30            390
2025-07-07 23:16:10,575 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
0    2025-06-01            108
4    2025-06-02            106
8    2025-06-03             93
12   2025-06-04             86
16   2025-06-05             85
20   2025-06-06             83
24   2025-06-07             83
28   2025-06-08             83
32   2025-06-09             81
36   2025-06-10             81
40   2025-06-11             80
44   2025-06-12             66
48   2025-06-13             65
52   2025-06-14             65
56   2025-06-15             65
60   2025-06-16             63
64   2025-06-17             62
68   2025-06-18             61
72   2025-06-19             59
76   2025-06-20             58
80   2025-06-21             58
84   2025-06-22             58
88   2025-06-23             52
92   2025-06-24             51
96   2025-06-25             50
100  2025-06-26             48
104  2025-06-27             45
108  2025-06-28             45
112  2025-06-29             45
116  2025-06-30             42
2025-07-07 23:16:10,585 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-07 23:16:10,589 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 23:16:10,591 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-07 23:16:10,594 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           21
5    2025-06-02           20
9    2025-06-03           18
13   2025-06-04           25
17   2025-06-05           19
21   2025-06-06           17
25   2025-06-07           17
29   2025-06-08           17
33   2025-06-09           16
37   2025-06-10           14
41   2025-06-11           13
45   2025-06-12            8
49   2025-06-13            6
53   2025-06-14            6
57   2025-06-15            6
61   2025-06-16            3
65   2025-06-17            2
69   2025-06-18           12
73   2025-06-19           11
77   2025-06-20           10
81   2025-06-21           10
85   2025-06-22           10
89   2025-06-23           17
93   2025-06-24           16
97   2025-06-25           13
101  2025-06-26           11
105  2025-06-27           10
109  2025-06-28           10
113  2025-06-29           10
117  2025-06-30            9
2025-07-07 23:16:10,597 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-07 23:16:10,598 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-07 23:16:10,599 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 23:16:10,599 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 23:16:10,601 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 23:16:10,602 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-07 23:16:10,603 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-07 23:16:10,607 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 23:16:10,608 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 23:16:10,608 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:16:10,609 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:16:10,613 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:16:10,796 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:16:10,797 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:16:10,797 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:16:10,798 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 23:16:10,820 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:16:10,974 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:16:10,977 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:16:11,212 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:11,360 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:11,608 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 23:16:11,783 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 23:16:11,785 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-07 23:16:11,973 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 23:16:11,975 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-07 23:16:11,976 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 23:16:11,978 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 23:16:11,979 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 23:16:11,994 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 23:16:11,995 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-07 23:16:11,998 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-07
2025-07-07 23:16:11,998 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-07 23:16:12,000 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-07 23:16:12,000 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 23:16:12,002 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:16:12,003 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:16:12,005 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:16:12,215 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:16:12,217 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:16:12,217 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:16:12,218 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 23:16:12,243 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:16:12,386 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:16:12,389 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:16:12,625 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:12,773 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:16:12,947 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 23:16:13,121 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 23:16:13,122 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 23:16:13,298 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 23:16:13,301 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 23:16:13,302 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 23:16:13,303 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 23:16:13,304 - __main__ - INFO - Script finished successfully.
2025-07-07 23:17:23,881 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-07 23:17:23,882 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-07 23:17:24,229 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-07 23:17:24,230 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-07 23:17:24,230 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:17:24,230 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:17:24,241 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:17:24,469 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:17:24,471 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:17:24,472 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:17:24,472 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:17:24,497 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:17:24,664 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:17:24,666 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:17:24,917 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:25,059 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:25,062 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-07 23:17:25,236 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-07 23:17:25,238 - src.services.google_sheets.api_client - INFO - Successfully fetched 22 rows from worksheet 'ORA_Configuration'.
2025-07-07 23:17:25,242 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-07 23:17:25,243 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-07 23:17:25,243 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:17:25,244 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:17:25,247 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:17:25,449 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:17:25,450 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:17:25,451 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:17:25,451 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:17:25,475 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:17:25,637 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:17:25,639 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:17:25,870 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:26,012 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:26,014 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-07 23:17:26,164 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-07 23:17:26,167 - src.services.google_sheets.api_client - INFO - Successfully fetched 6 rows from worksheet 'SKU_Lot'.
2025-07-07 23:17:26,168 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-07 23:17:26,170 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-07 23:17:26,170 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:17:26,171 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:17:26,173 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:17:26,390 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:17:26,394 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:17:26,395 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:17:26,395 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:17:26,419 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:17:26,580 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:17:26,584 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:17:26,821 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:26,963 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:26,963 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-07 23:17:27,125 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-07 23:17:27,126 - src.services.google_sheets.api_client - INFO - Successfully fetched 11 rows from worksheet 'Inventory_Transactions'.
2025-07-07 23:17:27,129 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-07 23:17:27,130 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-07 23:17:27,133 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-07 23:17:27,134 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 11 inventory transactions.
2025-07-07 23:17:27,134 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-07 23:17:27,134 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:17:27,134 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:17:27,138 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:17:27,345 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:17:27,347 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:17:27,347 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:17:27,348 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:17:27,369 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:17:27,513 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:17:27,516 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:17:27,752 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:27,890 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:27,891 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-07 23:17:28,070 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-07 23:17:28,077 - src.services.google_sheets.api_client - INFO - Successfully fetched 737 rows from worksheet 'Shipped_Items_Data'.
2025-07-07 23:17:28,082 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-07 23:17:28,083 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 737 shipped items.
2025-07-07 23:17:28,083 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-07 23:17:28,084 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:17:28,085 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:17:28,088 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:17:28,285 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:17:28,286 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:17:28,287 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:17:28,287 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:17:28,309 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:17:28,453 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:17:28,454 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:17:28,656 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:28,806 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:28,813 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-07 23:17:28,980 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-07 23:17:28,985 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-07 23:17:28,989 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-07 23:17:28,990 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-07 23:17:28,990 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:17:28,991 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:17:28,994 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:17:29,196 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:17:29,198 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:17:29,198 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:17:29,198 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-07 23:17:29,223 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:17:29,362 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:17:29,364 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:17:29,586 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:29,721 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:29,722 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-07 23:17:29,896 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-07 23:17:29,897 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-07 23:17:29,903 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-07 23:17:29,903 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-07 23:17:29,908 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-07 23:17:29,911 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-07 23:17:29,911 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-07 23:17:29,913 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-07 23:17:29,914 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-07 23:17:29,915 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-07 23:17:29,917 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-07 23:17:29,918 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-07 23:17:29,918 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-07 23:17:29,919 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-07 23:17:29,919 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (613, 5)
2025-07-07 23:17:29,920 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-07 23:17:29,921 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17612': 1006, '18675': 749, '17904': 108, '17914': 175}
2025-07-07 23:17:29,921 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-07 23:17:29,921 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17612': 1006, '18675': 749, '17904': 108, '17914': 175}
2025-07-07 23:17:29,923 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-07 23:17:29,925 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-07 23:17:29,928 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-07 23:17:29,929 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-07 23:17:29,931 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17612': np.int64(1006), '18675': np.int64(749), '17904': np.int64(108), '17914': np.int64(175)}
2025-07-07 23:17:29,931 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-07 23:17:29,932 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17612': np.int64(1006), '18675': np.int64(749), '17904': np.int64(108), '17914': np.int64(175)}
2025-07-07 23:17:29,933 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-07 23:17:29,934 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-07 23:17:29,936 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-07 23:17:29,938 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-07 23:17:29,939 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-07 23:17:29,940 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17612': np.int64(935), '18675': np.int64(748), '17904': np.int64(106), '17914': np.int64(172)}
2025-07-07 23:17:29,940 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-07 23:17:29,941 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17612': np.int64(935), '18675': np.int64(748), '17904': np.int64(106), '17914': np.int64(172)}
2025-07-07 23:17:29,941 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-07 23:17:29,944 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-07 23:17:29,946 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:17:29,948 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-07 23:17:29,950 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-07 23:17:29,950 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17612': np.int64(841), '18675': np.int64(748), '17904': np.int64(93), '17914': np.int64(166)}
2025-07-07 23:17:29,951 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-07 23:17:29,951 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17612': np.int64(841), '18675': np.int64(748), '17904': np.int64(93), '17914': np.int64(166)}
2025-07-07 23:17:29,952 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-07 23:17:29,954 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-07 23:17:29,955 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:17:29,957 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-07 23:17:29,958 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-07 23:17:29,959 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17612': np.int64(1200), '18675': np.int64(748), '17904': np.int64(86), '17914': np.int64(159)}
2025-07-07 23:17:29,959 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-07 23:17:29,960 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17612': np.int64(1200), '18675': np.int64(748), '17904': np.int64(86), '17914': np.int64(159)}
2025-07-07 23:17:29,961 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-07 23:17:29,963 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-07 23:17:29,966 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-07 23:17:29,968 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-07 23:17:29,970 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-07 23:17:29,970 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17612': np.int64(904), '18675': np.int64(748), '17904': np.int64(85), '17914': np.int64(152)}
2025-07-07 23:17:29,970 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-07 23:17:29,971 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17612': np.int64(904), '18675': np.int64(748), '17904': np.int64(85), '17914': np.int64(152)}
2025-07-07 23:17:29,972 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-07 23:17:29,974 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-07 23:17:29,974 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-07 23:17:29,977 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-07 23:17:29,980 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-07 23:17:29,981 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83), '17914': np.int64(151)}
2025-07-07 23:17:29,981 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-07 23:17:29,981 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83), '17914': np.int64(151)}
2025-07-07 23:17:29,983 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-07 23:17:29,985 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-07 23:17:29,986 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-07 23:17:29,988 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 23:17:29,988 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83), '17914': np.int64(151)}
2025-07-07 23:17:29,989 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-07 23:17:29,989 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83), '17914': np.int64(151)}
2025-07-07 23:17:29,991 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-07 23:17:29,992 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-07 23:17:29,995 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-07 23:17:29,998 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-07 23:17:29,998 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83), '17914': np.int64(151)}
2025-07-07 23:17:29,998 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-07 23:17:29,999 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83), '17914': np.int64(151)}
2025-07-07 23:17:30,000 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-07 23:17:30,001 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-07 23:17:30,003 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-07 23:17:30,004 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-07 23:17:30,006 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-07 23:17:30,006 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17612': np.int64(740), '18675': np.int64(746), '17904': np.int64(81), '17914': np.int64(148)}
2025-07-07 23:17:30,007 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-07 23:17:30,007 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17612': np.int64(740), '18675': np.int64(746), '17904': np.int64(81), '17914': np.int64(148)}
2025-07-07 23:17:30,008 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-07 23:17:30,009 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-07 23:17:30,012 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-07 23:17:30,015 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-07 23:17:30,016 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-07 23:17:30,017 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17612': np.int64(653), '18675': np.int64(746), '17904': np.int64(81), '17914': np.int64(145)}
2025-07-07 23:17:30,017 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-07 23:17:30,017 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17612': np.int64(653), '18675': np.int64(746), '17904': np.int64(81), '17914': np.int64(145)}
2025-07-07 23:17:30,018 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-07 23:17:30,020 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-07 23:17:30,021 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-07 23:17:30,023 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-07 23:17:30,024 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-07 23:17:30,025 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17612': np.int64(586), '18675': np.int64(745), '17904': np.int64(80), '17914': np.int64(142)}
2025-07-07 23:17:30,025 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-07 23:17:30,025 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17612': np.int64(586), '18675': np.int64(745), '17904': np.int64(80), '17914': np.int64(142)}
2025-07-07 23:17:30,027 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-07 23:17:30,030 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-07 23:17:30,032 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:17:30,034 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-07 23:17:30,036 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-07 23:17:30,036 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17612': np.int64(352), '18675': np.int64(745), '17904': np.int64(66), '17914': np.int64(131)}
2025-07-07 23:17:30,036 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-07 23:17:30,036 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17612': np.int64(352), '18675': np.int64(745), '17904': np.int64(66), '17914': np.int64(131)}
2025-07-07 23:17:30,037 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-07 23:17:30,039 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-07 23:17:30,041 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:17:30,042 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-07 23:17:30,045 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-07 23:17:30,045 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65), '17914': np.int64(119)}
2025-07-07 23:17:30,046 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-07 23:17:30,047 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65), '17914': np.int64(119)}
2025-07-07 23:17:30,051 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-07 23:17:30,052 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:17:30,054 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-07 23:17:30,055 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-07 23:17:30,055 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65), '17914': np.int64(119)}
2025-07-07 23:17:30,055 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-07 23:17:30,055 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65), '17914': np.int64(119)}
2025-07-07 23:17:30,057 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-07 23:17:30,059 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-07 23:17:30,061 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-07 23:17:30,064 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-07 23:17:30,064 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65), '17914': np.int64(119)}
2025-07-07 23:17:30,064 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-07 23:17:30,064 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65), '17914': np.int64(119)}
2025-07-07 23:17:30,066 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-07 23:17:30,068 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-07 23:17:30,069 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-07 23:17:30,070 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-07 23:17:30,072 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-07 23:17:30,072 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17612': np.int64(105), '18675': np.int64(742), '17904': np.int64(63), '17914': np.int64(116)}
2025-07-07 23:17:30,073 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-07 23:17:30,073 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17612': np.int64(105), '18675': np.int64(742), '17904': np.int64(63), '17914': np.int64(116)}
2025-07-07 23:17:30,074 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-07 23:17:30,077 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-07 23:17:30,080 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-07 23:17:30,082 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-07 23:17:30,083 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-07 23:17:30,084 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17612': np.int64(49), '18675': np.int64(730), '17904': np.int64(62), '17914': np.int64(105)}
2025-07-07 23:17:30,084 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-07 23:17:30,085 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17612': np.int64(49), '18675': np.int64(730), '17904': np.int64(62), '17914': np.int64(105)}
2025-07-07 23:17:30,085 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-07 23:17:30,087 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-07 23:17:30,089 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-07 23:17:30,091 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-07 23:17:30,093 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-07 23:17:30,093 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17612': np.int64(568), '18675': np.int64(730), '17904': np.int64(61), '17914': np.int64(104)}
2025-07-07 23:17:30,094 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-07 23:17:30,095 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17612': np.int64(568), '18675': np.int64(730), '17904': np.int64(61), '17914': np.int64(104)}
2025-07-07 23:17:30,096 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-07 23:17:30,098 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-07 23:17:30,100 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-07 23:17:30,101 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-07 23:17:30,103 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-07 23:17:30,103 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17612': np.int64(521), '18675': np.int64(730), '17904': np.int64(59), '17914': np.int64(97)}
2025-07-07 23:17:30,104 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-07 23:17:30,104 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17612': np.int64(521), '18675': np.int64(730), '17904': np.int64(59), '17914': np.int64(97)}
2025-07-07 23:17:30,105 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-07 23:17:30,106 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-07 23:17:30,108 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-07 23:17:30,111 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-07 23:17:30,113 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-07 23:17:30,114 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58), '17914': np.int64(92)}
2025-07-07 23:17:30,114 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-07 23:17:30,114 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58), '17914': np.int64(92)}
2025-07-07 23:17:30,116 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-07 23:17:30,118 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:17:30,119 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-07 23:17:30,121 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:17:30,121 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58), '17914': np.int64(92)}
2025-07-07 23:17:30,121 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-07 23:17:30,121 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58), '17914': np.int64(92)}
2025-07-07 23:17:30,124 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-07 23:17:30,127 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:17:30,130 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-07 23:17:30,133 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:17:30,133 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58), '17914': np.int64(92)}
2025-07-07 23:17:30,134 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-07 23:17:30,134 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58), '17914': np.int64(92)}
2025-07-07 23:17:30,136 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-07 23:17:30,137 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-07 23:17:30,139 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:17:30,141 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-07 23:17:30,144 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-07 23:17:30,146 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17612': np.int64(800), '18675': np.int64(729), '17904': np.int64(52), '17914': np.int64(92)}
2025-07-07 23:17:30,147 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-07 23:17:30,148 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17612': np.int64(800), '18675': np.int64(729), '17904': np.int64(52), '17914': np.int64(92)}
2025-07-07 23:17:30,149 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-07 23:17:30,151 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-07 23:17:30,152 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:17:30,155 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-07 23:17:30,157 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-07 23:17:30,157 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17612': np.int64(758), '18675': np.int64(729), '17904': np.int64(51), '17914': np.int64(91)}
2025-07-07 23:17:30,157 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-07 23:17:30,158 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17612': np.int64(758), '18675': np.int64(729), '17904': np.int64(51), '17914': np.int64(91)}
2025-07-07 23:17:30,159 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-07 23:17:30,162 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-07 23:17:30,164 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:17:30,165 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-07 23:17:30,167 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-07 23:17:30,167 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17612': np.int64(585), '18675': np.int64(729), '17904': np.int64(50), '17914': np.int64(87)}
2025-07-07 23:17:30,167 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-07 23:17:30,167 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17612': np.int64(585), '18675': np.int64(729), '17904': np.int64(50), '17914': np.int64(87)}
2025-07-07 23:17:30,169 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-07 23:17:30,170 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-07 23:17:30,172 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:17:30,173 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-07 23:17:30,175 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-07 23:17:30,176 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17612': np.int64(525), '18675': np.int64(729), '17904': np.int64(48), '17914': np.int64(78)}
2025-07-07 23:17:30,176 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-07 23:17:30,177 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17612': np.int64(525), '18675': np.int64(729), '17904': np.int64(48), '17914': np.int64(78)}
2025-07-07 23:17:30,178 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-07 23:17:30,181 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-07 23:17:30,182 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:17:30,184 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-07 23:17:30,186 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-07 23:17:30,186 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45), '17914': np.int64(72)}
2025-07-07 23:17:30,186 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-07 23:17:30,187 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45), '17914': np.int64(72)}
2025-07-07 23:17:30,188 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-07 23:17:30,190 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:17:30,191 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-07 23:17:30,193 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-07 23:17:30,194 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45), '17914': np.int64(72)}
2025-07-07 23:17:30,194 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-07 23:17:30,194 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45), '17914': np.int64(72)}
2025-07-07 23:17:30,198 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-07 23:17:30,200 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:17:30,201 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-07 23:17:30,202 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-07 23:17:30,202 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45), '17914': np.int64(72)}
2025-07-07 23:17:30,202 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-07 23:17:30,203 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45), '17914': np.int64(72)}
2025-07-07 23:17:30,204 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-07 23:17:30,206 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-07 23:17:30,207 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-07 23:17:30,209 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-07 23:17:30,211 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-07 23:17:30,212 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17612': np.int64(390), '18675': np.int64(729), '17904': np.int64(42), '17914': np.int64(71)}
2025-07-07 23:17:30,215 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612           1006           1006
2  2025-06-01  17904            108            108
3  2025-06-01  17914            175            175
1  2025-06-01  18675            749            749
4  2025-06-02  17612           1006            935
2025-07-07 23:17:30,217 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
113  2025-06-29  18675            729            729
116  2025-06-30  17612            474            390
118  2025-06-30  17904             45             42
119  2025-06-30  17914             72             71
117  2025-06-30  18675            729            729
2025-07-07 23:17:30,217 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-07 23:17:30,217 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-07 23:17:30,219 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612           1006           1006
2  2025-06-01  17904            108            108
3  2025-06-01  17914            175            175
1  2025-06-01  18675            749            749
4  2025-06-02  17612           1006            935
2025-07-07 23:17:30,220 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
113  2025-06-29  18675            729            729
116  2025-06-30  17612            474            390
118  2025-06-30  17904             45             42
119  2025-06-30  17914             72             71
117  2025-06-30  18675            729            729
2025-07-07 23:17:30,220 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-07 23:17:30,222 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-07 23:17:30,224 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
0    2025-06-01           1006
4    2025-06-02            935
8    2025-06-03            841
12   2025-06-04           1200
16   2025-06-05            904
20   2025-06-06            787
24   2025-06-07            787
28   2025-06-08            787
32   2025-06-09            740
36   2025-06-10            653
40   2025-06-11            586
44   2025-06-12            352
48   2025-06-13            269
52   2025-06-14            269
56   2025-06-15            269
60   2025-06-16            105
64   2025-06-17             49
68   2025-06-18            568
72   2025-06-19            521
76   2025-06-20            445
80   2025-06-21            445
84   2025-06-22            445
88   2025-06-23            800
92   2025-06-24            758
96   2025-06-25            585
100  2025-06-26            525
104  2025-06-27            474
108  2025-06-28            474
112  2025-06-29            474
116  2025-06-30            390
2025-07-07 23:17:30,225 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            108
6    2025-06-02            106
10   2025-06-03             93
14   2025-06-04             86
18   2025-06-05             85
22   2025-06-06             83
26   2025-06-07             83
30   2025-06-08             83
34   2025-06-09             81
38   2025-06-10             81
42   2025-06-11             80
46   2025-06-12             66
50   2025-06-13             65
54   2025-06-14             65
58   2025-06-15             65
62   2025-06-16             63
66   2025-06-17             62
70   2025-06-18             61
74   2025-06-19             59
78   2025-06-20             58
82   2025-06-21             58
86   2025-06-22             58
90   2025-06-23             52
94   2025-06-24             51
98   2025-06-25             50
102  2025-06-26             48
106  2025-06-27             45
110  2025-06-28             45
114  2025-06-29             45
118  2025-06-30             42
2025-07-07 23:17:30,234 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-07 23:17:30,237 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-07 23:17:30,239 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-07 23:17:30,240 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
0    2025-06-01           21
4    2025-06-02           20
8    2025-06-03           18
12   2025-06-04           25
16   2025-06-05           19
20   2025-06-06           17
24   2025-06-07           17
28   2025-06-08           17
32   2025-06-09           16
36   2025-06-10           14
40   2025-06-11           13
44   2025-06-12            8
48   2025-06-13            6
52   2025-06-14            6
56   2025-06-15            6
60   2025-06-16            3
64   2025-06-17            2
68   2025-06-18           12
72   2025-06-19           11
76   2025-06-20           10
80   2025-06-21           10
84   2025-06-22           10
88   2025-06-23           17
92   2025-06-24           16
96   2025-06-25           13
100  2025-06-26           11
104  2025-06-27           10
108  2025-06-28           10
112  2025-06-29           10
116  2025-06-30            9
2025-07-07 23:17:30,242 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-07 23:17:30,242 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-07 23:17:30,243 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-07 23:17:30,243 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-07 23:17:30,246 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-07 23:17:30,247 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-07 23:17:30,248 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-07 23:17:30,252 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-07 23:17:30,253 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-07 23:17:30,253 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:17:30,254 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:17:30,256 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:17:30,448 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:17:30,449 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:17:30,450 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:17:30,450 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-07 23:17:30,473 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:17:30,626 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:17:30,630 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:17:30,852 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:30,982 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:31,179 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 23:17:31,338 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 23:17:31,341 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-07 23:17:31,521 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 23:17:31,522 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-07 23:17:31,523 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-07 23:17:31,524 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-07 23:17:31,525 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-07 23:17:31,541 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-07 23:17:31,542 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-07 23:17:31,544 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-07
2025-07-07 23:17:31,545 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-07 23:17:31,547 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-07 23:17:31,547 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-07 23:17:31,550 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-07 23:17:31,551 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-07 23:17:31,553 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-07 23:17:31,757 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-07 23:17:31,759 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-07 23:17:31,759 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-07 23:17:31,760 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-07 23:17:31,784 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-07 23:17:31,944 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-07 23:17:31,946 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-07 23:17:32,178 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:32,307 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-07 23:17:32,470 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-07 23:17:32,622 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-07 23:17:32,624 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-07 23:17:32,784 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-07 23:17:32,786 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-07 23:17:32,786 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-07 23:17:32,787 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-07 23:17:32,788 - __main__ - INFO - Script finished successfully.
2025-07-09 15:13:18,856 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 15:13:18,856 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 15:13:19,757 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 15:13:19,758 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 15:13:19,758 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 15:13:19,758 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 15:13:19,799 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 15:13:20,249 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 15:13:20,251 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 15:13:20,251 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 15:13:20,253 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 15:13:20,279 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 15:13:20,456 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 15:13:20,462 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 15:13:20,816 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:20,940 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:20,942 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 15:13:21,139 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 15:13:21,150 - src.services.google_sheets.api_client - INFO - Successfully fetched 22 rows from worksheet 'ORA_Configuration'.
2025-07-09 15:13:21,164 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 15:13:21,165 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 15:13:21,166 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 15:13:21,166 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 15:13:21,168 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 15:13:21,472 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 15:13:21,474 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 15:13:21,474 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 15:13:21,475 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 15:13:21,495 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 15:13:21,660 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 15:13:21,664 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 15:13:21,896 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:22,043 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:22,046 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 15:13:22,200 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 15:13:22,202 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 15:13:22,204 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 15:13:22,206 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 15:13:22,206 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 15:13:22,207 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 15:13:22,209 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 15:13:22,671 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 15:13:22,675 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 15:13:22,677 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 15:13:22,677 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 15:13:22,700 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 15:13:22,838 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 15:13:22,842 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 15:13:23,093 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:23,225 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:23,227 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 15:13:23,384 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 15:13:23,389 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 15:13:23,392 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 15:13:23,393 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 15:13:23,413 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 15:13:23,417 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 15:13:23,418 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 15:13:23,418 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 15:13:23,418 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 15:13:23,421 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 15:13:23,686 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 15:13:23,689 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 15:13:23,690 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 15:13:23,691 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 15:13:23,715 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 15:13:23,869 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 15:13:23,870 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 15:13:24,071 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:24,195 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:24,197 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 15:13:24,520 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 15:13:24,532 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 15:13:24,541 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 15:13:24,543 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 15:13:24,545 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 15:13:24,545 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 15:13:24,546 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 15:13:24,548 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 15:13:24,870 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 15:13:24,873 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 15:13:24,874 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 15:13:24,874 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 15:13:24,899 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 15:13:25,056 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 15:13:25,059 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 15:13:25,278 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:25,430 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:25,432 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 15:13:25,740 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 15:13:25,742 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 15:13:25,745 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 15:13:25,746 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 15:13:25,746 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 15:13:25,746 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 15:13:25,748 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 15:13:26,174 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 15:13:26,177 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 15:13:26,178 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 15:13:26,179 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 15:13:26,202 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 15:13:26,417 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 15:13:26,420 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 15:13:26,643 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:26,831 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:26,834 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 15:13:26,981 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 15:13:26,984 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 15:13:27,007 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 15:13:27,007 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 15:13:27,018 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 15:13:27,019 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 15:13:27,019 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 15:13:27,020 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 15:13:27,021 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 15:13:27,023 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 15:13:27,025 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 15:13:27,025 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 15:13:27,026 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 15:13:27,027 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 15:13:27,027 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 15:13:27,028 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 15:13:27,029 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17612': 1006, '17914': 175, '18675': 749, '17904': 108}
2025-07-09 15:13:27,030 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 15:13:27,030 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17612': 1006, '17914': 175, '18675': 749, '17904': 108}
2025-07-09 15:13:27,033 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 15:13:27,035 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 15:13:27,037 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 15:13:27,038 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 15:13:27,039 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17612': np.int64(1006), '17914': np.int64(175), '18675': np.int64(749), '17904': np.int64(108)}
2025-07-09 15:13:27,039 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 15:13:27,039 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17612': np.int64(1006), '17914': np.int64(175), '18675': np.int64(749), '17904': np.int64(108)}
2025-07-09 15:13:27,040 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 15:13:27,041 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 15:13:27,043 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 15:13:27,044 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 15:13:27,045 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 15:13:27,046 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17612': np.int64(935), '17914': np.int64(172), '18675': np.int64(748), '17904': np.int64(106)}
2025-07-09 15:13:27,046 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 15:13:27,047 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17612': np.int64(935), '17914': np.int64(172), '18675': np.int64(748), '17904': np.int64(106)}
2025-07-09 15:13:27,048 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 15:13:27,051 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 15:13:27,052 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 15:13:27,053 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 15:13:27,055 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 15:13:27,055 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17612': np.int64(841), '17914': np.int64(166), '18675': np.int64(748), '17904': np.int64(93)}
2025-07-09 15:13:27,056 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 15:13:27,056 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17612': np.int64(841), '17914': np.int64(166), '18675': np.int64(748), '17904': np.int64(93)}
2025-07-09 15:13:27,057 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 15:13:27,058 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 15:13:27,060 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 15:13:27,061 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 15:13:27,063 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 15:13:27,063 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17612': np.int64(1200), '17914': np.int64(159), '18675': np.int64(748), '17904': np.int64(86)}
2025-07-09 15:13:27,064 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 15:13:27,064 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17612': np.int64(1200), '17914': np.int64(159), '18675': np.int64(748), '17904': np.int64(86)}
2025-07-09 15:13:27,065 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 15:13:27,068 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 15:13:27,070 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 15:13:27,071 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 15:13:27,072 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 15:13:27,073 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17612': np.int64(904), '17914': np.int64(152), '18675': np.int64(748), '17904': np.int64(85)}
2025-07-09 15:13:27,073 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 15:13:27,074 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17612': np.int64(904), '17914': np.int64(152), '18675': np.int64(748), '17904': np.int64(85)}
2025-07-09 15:13:27,074 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 15:13:27,076 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 15:13:27,077 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 15:13:27,079 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 15:13:27,081 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 15:13:27,082 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17612': np.int64(787), '17914': np.int64(151), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 15:13:27,083 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 15:13:27,084 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17612': np.int64(787), '17914': np.int64(151), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 15:13:27,086 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 15:13:27,088 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 15:13:27,089 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 15:13:27,090 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 15:13:27,091 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17612': np.int64(787), '17914': np.int64(151), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 15:13:27,091 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 15:13:27,091 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17612': np.int64(787), '17914': np.int64(151), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 15:13:27,093 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 15:13:27,094 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 15:13:27,095 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 15:13:27,097 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 15:13:27,098 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17612': np.int64(787), '17914': np.int64(151), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 15:13:27,098 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 15:13:27,099 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17612': np.int64(787), '17914': np.int64(151), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 15:13:27,100 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 15:13:27,101 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 15:13:27,104 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 15:13:27,106 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 15:13:27,107 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 15:13:27,107 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17612': np.int64(740), '17914': np.int64(148), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-09 15:13:27,108 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 15:13:27,108 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17612': np.int64(740), '17914': np.int64(148), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-09 15:13:27,109 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 15:13:27,110 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 15:13:27,112 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 15:13:27,113 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 15:13:27,115 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 15:13:27,116 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17612': np.int64(653), '17914': np.int64(145), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-09 15:13:27,116 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 15:13:27,117 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17612': np.int64(653), '17914': np.int64(145), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-09 15:13:27,118 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 15:13:27,119 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 15:13:27,121 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 15:13:27,122 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 15:13:27,124 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 15:13:27,124 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17612': np.int64(586), '17914': np.int64(142), '18675': np.int64(745), '17904': np.int64(80)}
2025-07-09 15:13:27,124 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 15:13:27,125 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17612': np.int64(586), '17914': np.int64(142), '18675': np.int64(745), '17904': np.int64(80)}
2025-07-09 15:13:27,125 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 15:13:27,127 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 15:13:27,128 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 15:13:27,130 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 15:13:27,132 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 15:13:27,133 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17612': np.int64(352), '17914': np.int64(131), '18675': np.int64(745), '17904': np.int64(66)}
2025-07-09 15:13:27,134 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 15:13:27,134 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17612': np.int64(352), '17914': np.int64(131), '18675': np.int64(745), '17904': np.int64(66)}
2025-07-09 15:13:27,135 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 15:13:27,137 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 15:13:27,138 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 15:13:27,139 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 15:13:27,141 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 15:13:27,141 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17612': np.int64(269), '17914': np.int64(119), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 15:13:27,142 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 15:13:27,142 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17612': np.int64(269), '17914': np.int64(119), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 15:13:27,143 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 15:13:27,145 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 15:13:27,146 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 15:13:27,148 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 15:13:27,149 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17612': np.int64(269), '17914': np.int64(119), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 15:13:27,149 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 15:13:27,149 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17612': np.int64(269), '17914': np.int64(119), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 15:13:27,152 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 15:13:27,153 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 15:13:27,155 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 15:13:27,156 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 15:13:27,157 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17612': np.int64(269), '17914': np.int64(119), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 15:13:27,157 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 15:13:27,157 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17612': np.int64(269), '17914': np.int64(119), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 15:13:27,158 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 15:13:27,160 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 15:13:27,161 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 15:13:27,163 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 15:13:27,164 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 15:13:27,165 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17612': np.int64(105), '17914': np.int64(116), '18675': np.int64(742), '17904': np.int64(63)}
2025-07-09 15:13:27,165 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 15:13:27,165 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17612': np.int64(105), '17914': np.int64(116), '18675': np.int64(742), '17904': np.int64(63)}
2025-07-09 15:13:27,167 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 15:13:27,169 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 15:13:27,170 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 15:13:27,172 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 15:13:27,173 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 15:13:27,173 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17612': np.int64(49), '17914': np.int64(105), '18675': np.int64(730), '17904': np.int64(62)}
2025-07-09 15:13:27,174 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 15:13:27,174 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17612': np.int64(49), '17914': np.int64(105), '18675': np.int64(730), '17904': np.int64(62)}
2025-07-09 15:13:27,174 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 15:13:27,176 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 15:13:27,178 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 15:13:27,180 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 15:13:27,181 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 15:13:27,182 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17612': np.int64(568), '17914': np.int64(104), '18675': np.int64(730), '17904': np.int64(61)}
2025-07-09 15:13:27,182 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 15:13:27,183 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17612': np.int64(568), '17914': np.int64(104), '18675': np.int64(730), '17904': np.int64(61)}
2025-07-09 15:13:27,184 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 15:13:27,186 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 15:13:27,187 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 15:13:27,188 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 15:13:27,190 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 15:13:27,190 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17612': np.int64(521), '17914': np.int64(97), '18675': np.int64(730), '17904': np.int64(59)}
2025-07-09 15:13:27,190 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 15:13:27,191 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17612': np.int64(521), '17914': np.int64(97), '18675': np.int64(730), '17904': np.int64(59)}
2025-07-09 15:13:27,192 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 15:13:27,194 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 15:13:27,195 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 15:13:27,197 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 15:13:27,199 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 15:13:27,199 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17612': np.int64(445), '17914': np.int64(92), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 15:13:27,200 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 15:13:27,200 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17612': np.int64(445), '17914': np.int64(92), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 15:13:27,202 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 15:13:27,204 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 15:13:27,205 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 15:13:27,206 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 15:13:27,207 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17612': np.int64(445), '17914': np.int64(92), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 15:13:27,207 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 15:13:27,207 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17612': np.int64(445), '17914': np.int64(92), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 15:13:27,209 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 15:13:27,210 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 15:13:27,212 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 15:13:27,213 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 15:13:27,214 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17612': np.int64(445), '17914': np.int64(92), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 15:13:27,214 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 15:13:27,215 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17612': np.int64(445), '17914': np.int64(92), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 15:13:27,216 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 15:13:27,218 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 15:13:27,219 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 15:13:27,221 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 15:13:27,223 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 15:13:27,223 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17612': np.int64(800), '17914': np.int64(92), '18675': np.int64(729), '17904': np.int64(52)}
2025-07-09 15:13:27,224 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 15:13:27,224 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17612': np.int64(800), '17914': np.int64(92), '18675': np.int64(729), '17904': np.int64(52)}
2025-07-09 15:13:27,225 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 15:13:27,226 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 15:13:27,228 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 15:13:27,229 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 15:13:27,231 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 15:13:27,232 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17612': np.int64(758), '17914': np.int64(91), '18675': np.int64(729), '17904': np.int64(51)}
2025-07-09 15:13:27,232 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 15:13:27,233 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17612': np.int64(758), '17914': np.int64(91), '18675': np.int64(729), '17904': np.int64(51)}
2025-07-09 15:13:27,236 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 15:13:27,241 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 15:13:27,244 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 15:13:27,248 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 15:13:27,251 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 15:13:27,253 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17612': np.int64(585), '17914': np.int64(87), '18675': np.int64(729), '17904': np.int64(50)}
2025-07-09 15:13:27,253 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 15:13:27,254 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17612': np.int64(585), '17914': np.int64(87), '18675': np.int64(729), '17904': np.int64(50)}
2025-07-09 15:13:27,256 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 15:13:27,259 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 15:13:27,263 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 15:13:27,266 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 15:13:27,269 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 15:13:27,270 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17612': np.int64(525), '17914': np.int64(78), '18675': np.int64(729), '17904': np.int64(48)}
2025-07-09 15:13:27,270 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 15:13:27,271 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17612': np.int64(525), '17914': np.int64(78), '18675': np.int64(729), '17904': np.int64(48)}
2025-07-09 15:13:27,272 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 15:13:27,275 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 15:13:27,278 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 15:13:27,282 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 15:13:27,284 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 15:13:27,285 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17612': np.int64(474), '17914': np.int64(72), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 15:13:27,285 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 15:13:27,285 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17612': np.int64(474), '17914': np.int64(72), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 15:13:27,287 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 15:13:27,288 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 15:13:27,290 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 15:13:27,291 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 15:13:27,292 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17612': np.int64(474), '17914': np.int64(72), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 15:13:27,292 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 15:13:27,292 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17612': np.int64(474), '17914': np.int64(72), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 15:13:27,294 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 15:13:27,296 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 15:13:27,297 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 15:13:27,300 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 15:13:27,300 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17612': np.int64(474), '17914': np.int64(72), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 15:13:27,301 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 15:13:27,301 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17612': np.int64(474), '17914': np.int64(72), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 15:13:27,301 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 15:13:27,304 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 15:13:27,305 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 15:13:27,307 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 15:13:27,308 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 15:13:27,308 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17612': np.int64(390), '17914': np.int64(71), '18675': np.int64(729), '17904': np.int64(42)}
2025-07-09 15:13:27,313 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
4  2025-06-02  17612           1006            935
2025-07-09 15:13:27,315 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
116  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-09 15:13:27,316 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 15:13:27,317 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 15:13:27,318 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
4  2025-06-02  17612           1006            935
2025-07-09 15:13:27,319 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
116  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-09 15:13:27,320 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 15:13:27,324 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 15:13:27,326 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
0    2025-06-01           1006
4    2025-06-02            935
8    2025-06-03            841
12   2025-06-04           1200
16   2025-06-05            904
20   2025-06-06            787
24   2025-06-07            787
28   2025-06-08            787
32   2025-06-09            740
36   2025-06-10            653
40   2025-06-11            586
44   2025-06-12            352
48   2025-06-13            269
52   2025-06-14            269
56   2025-06-15            269
60   2025-06-16            105
64   2025-06-17             49
68   2025-06-18            568
72   2025-06-19            521
76   2025-06-20            445
80   2025-06-21            445
84   2025-06-22            445
88   2025-06-23            800
92   2025-06-24            758
96   2025-06-25            585
100  2025-06-26            525
104  2025-06-27            474
108  2025-06-28            474
112  2025-06-29            474
116  2025-06-30            390
2025-07-09 15:13:27,327 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
3    2025-06-01            108
7    2025-06-02            106
11   2025-06-03             93
15   2025-06-04             86
19   2025-06-05             85
23   2025-06-06             83
27   2025-06-07             83
31   2025-06-08             83
35   2025-06-09             81
39   2025-06-10             81
43   2025-06-11             80
47   2025-06-12             66
51   2025-06-13             65
55   2025-06-14             65
59   2025-06-15             65
63   2025-06-16             63
67   2025-06-17             62
71   2025-06-18             61
75   2025-06-19             59
79   2025-06-20             58
83   2025-06-21             58
87   2025-06-22             58
91   2025-06-23             52
95   2025-06-24             51
99   2025-06-25             50
103  2025-06-26             48
107  2025-06-27             45
111  2025-06-28             45
115  2025-06-29             45
119  2025-06-30             42
2025-07-09 15:13:27,338 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 15:13:27,345 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 15:13:27,346 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 15:13:27,348 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
0    2025-06-01           21
4    2025-06-02           20
8    2025-06-03           18
12   2025-06-04           25
16   2025-06-05           19
20   2025-06-06           17
24   2025-06-07           17
28   2025-06-08           17
32   2025-06-09           16
36   2025-06-10           14
40   2025-06-11           13
44   2025-06-12            8
48   2025-06-13            6
52   2025-06-14            6
56   2025-06-15            6
60   2025-06-16            3
64   2025-06-17            2
68   2025-06-18           12
72   2025-06-19           11
76   2025-06-20           10
80   2025-06-21           10
84   2025-06-22           10
88   2025-06-23           17
92   2025-06-24           16
96   2025-06-25           13
100  2025-06-26           11
104  2025-06-27           10
108  2025-06-28           10
112  2025-06-29           10
116  2025-06-30            9
2025-07-09 15:13:27,349 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 15:13:27,350 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 15:13:27,351 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 15:13:27,351 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 15:13:27,353 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 15:13:27,354 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 15:13:27,355 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 15:13:27,360 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 15:13:27,361 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-09 15:13:27,361 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 15:13:27,361 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 15:13:27,365 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 15:13:27,660 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 15:13:27,664 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 15:13:27,665 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 15:13:27,666 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 15:13:27,687 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 15:13:27,926 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 15:13:27,928 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 15:13:28,269 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:28,408 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:28,614 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 15:13:28,811 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 15:13:28,815 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 15:13:29,018 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 15:13:29,020 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 15:13:29,021 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 15:13:29,024 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 15:13:29,025 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-09 15:13:29,048 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 15:13:29,049 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 15:13:29,050 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 15:13:29,051 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 15:13:29,053 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 15:13:29,053 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 15:13:29,056 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 15:13:29,056 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 15:13:29,058 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 15:13:29,340 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 15:13:29,342 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 15:13:29,343 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 15:13:29,343 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 15:13:29,365 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 15:13:29,545 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 15:13:29,547 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 15:13:29,790 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:29,974 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 15:13:30,138 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 15:13:30,310 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 15:13:30,311 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 15:13:30,468 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 15:13:30,469 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 15:13:30,470 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 15:13:30,471 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 15:13:30,471 - __main__ - INFO - Script finished successfully.
2025-07-09 16:11:18,626 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 16:11:18,627 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 16:11:18,988 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 16:11:18,988 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 16:11:18,988 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:11:18,990 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:11:19,001 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:11:19,384 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:11:19,386 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:11:19,387 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:11:19,387 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:11:19,418 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:11:19,613 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:11:19,616 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:11:20,033 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:20,164 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:20,166 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 16:11:20,329 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 16:11:20,338 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 16:11:20,365 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 16:11:41,636 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 16:11:41,637 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 16:11:41,988 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 16:11:41,989 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 16:11:41,990 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:11:41,990 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:11:42,004 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:11:42,408 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:11:42,411 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:11:42,411 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:11:42,412 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:11:42,435 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:11:42,588 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:11:42,590 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:11:42,844 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:42,972 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:42,973 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 16:11:43,139 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 16:11:43,142 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 16:11:43,146 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 16:11:43,146 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 16:11:43,146 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:11:43,147 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:11:43,148 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:11:43,473 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:11:43,476 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:11:43,477 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:11:43,478 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:11:43,501 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:11:43,651 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:11:43,652 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:11:43,924 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:44,074 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:44,075 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 16:11:44,256 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 16:11:44,258 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 16:11:44,261 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 16:11:44,263 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 16:11:44,263 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:11:44,264 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:11:44,266 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:11:44,599 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:11:44,601 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:11:44,602 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:11:44,602 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:11:44,625 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:11:44,767 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:11:44,769 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:11:45,088 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:45,288 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:45,290 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 16:11:45,474 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 16:11:45,480 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 16:11:45,482 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 16:11:45,483 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 16:11:45,489 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 16:11:45,492 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 16:11:45,493 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 16:11:45,493 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:11:45,493 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:11:45,495 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:11:45,738 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:11:45,742 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:11:45,743 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:11:45,744 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:11:45,770 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:11:45,925 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:11:45,927 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:11:46,140 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:46,268 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:46,269 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 16:11:46,481 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 16:11:46,491 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 16:11:46,501 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 16:11:46,504 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 16:11:46,505 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 16:11:46,505 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:11:46,506 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:11:46,507 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:11:46,747 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:11:46,749 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:11:46,750 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:11:46,750 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:11:46,773 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:11:46,926 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:11:46,928 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:11:47,151 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:47,336 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:47,337 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 16:11:47,745 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 16:11:47,748 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 16:11:47,753 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 16:11:47,754 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 16:11:47,754 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:11:47,755 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:11:47,760 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:11:47,978 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:11:47,979 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:11:47,979 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:11:47,979 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:11:48,004 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:11:48,155 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:11:48,157 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:11:48,368 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:48,497 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:48,498 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 16:11:48,642 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 16:11:48,643 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 16:11:48,655 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 16:11:48,656 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 16:11:48,672 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 16:11:48,673 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 16:11:48,674 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 16:11:48,675 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 16:11:48,676 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 16:11:48,676 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 16:11:48,678 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 16:11:48,678 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 16:11:48,680 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 16:11:48,680 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 16:11:48,681 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 16:11:48,682 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 16:11:48,682 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'18675': 749, '17914': 175, '17612': 1006, '17904': 108}
2025-07-09 16:11:48,683 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 16:11:48,683 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'18675': 749, '17914': 175, '17612': 1006, '17904': 108}
2025-07-09 16:11:48,685 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 16:11:48,687 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 16:11:48,689 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 16:11:48,690 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 16:11:48,690 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'18675': np.int64(749), '17914': np.int64(175), '17612': np.int64(1006), '17904': np.int64(108)}
2025-07-09 16:11:48,691 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 16:11:48,691 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'18675': np.int64(749), '17914': np.int64(175), '17612': np.int64(1006), '17904': np.int64(108)}
2025-07-09 16:11:48,692 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 16:11:48,694 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 16:11:48,696 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 16:11:48,697 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 16:11:48,699 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 16:11:48,699 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'18675': np.int64(748), '17914': np.int64(172), '17612': np.int64(935), '17904': np.int64(106)}
2025-07-09 16:11:48,700 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 16:11:48,700 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'18675': np.int64(748), '17914': np.int64(172), '17612': np.int64(935), '17904': np.int64(106)}
2025-07-09 16:11:48,701 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 16:11:48,703 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:11:48,705 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 16:11:48,707 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 16:11:48,709 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 16:11:48,710 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'18675': np.int64(748), '17914': np.int64(166), '17612': np.int64(841), '17904': np.int64(93)}
2025-07-09 16:11:48,710 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 16:11:48,710 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'18675': np.int64(748), '17914': np.int64(166), '17612': np.int64(841), '17904': np.int64(93)}
2025-07-09 16:11:48,712 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 16:11:48,714 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:11:48,715 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 16:11:48,716 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 16:11:48,717 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 16:11:48,718 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'18675': np.int64(748), '17914': np.int64(159), '17612': np.int64(1200), '17904': np.int64(86)}
2025-07-09 16:11:48,718 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 16:11:48,718 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'18675': np.int64(748), '17914': np.int64(159), '17612': np.int64(1200), '17904': np.int64(86)}
2025-07-09 16:11:48,721 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 16:11:48,722 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:11:48,725 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 16:11:48,728 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 16:11:48,729 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 16:11:48,729 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'18675': np.int64(748), '17914': np.int64(152), '17612': np.int64(904), '17904': np.int64(85)}
2025-07-09 16:11:48,729 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 16:11:48,729 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'18675': np.int64(748), '17914': np.int64(152), '17612': np.int64(904), '17904': np.int64(85)}
2025-07-09 16:11:48,730 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 16:11:48,733 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 16:11:48,733 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 16:11:48,735 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 16:11:48,737 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 16:11:48,737 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'18675': np.int64(747), '17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83)}
2025-07-09 16:11:48,738 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 16:11:48,738 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'18675': np.int64(747), '17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83)}
2025-07-09 16:11:48,743 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:11:48,743 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:11:48,746 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:11:48,747 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:11:48,747 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'18675': np.int64(747), '17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83)}
2025-07-09 16:11:48,747 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 16:11:48,747 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'18675': np.int64(747), '17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83)}
2025-07-09 16:11:48,750 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:11:48,750 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:11:48,752 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:11:48,754 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:11:48,754 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'18675': np.int64(747), '17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83)}
2025-07-09 16:11:48,756 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 16:11:48,756 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'18675': np.int64(747), '17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83)}
2025-07-09 16:11:48,757 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 16:11:48,760 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 16:11:48,761 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 16:11:48,762 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 16:11:48,764 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 16:11:48,764 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'18675': np.int64(746), '17914': np.int64(148), '17612': np.int64(740), '17904': np.int64(81)}
2025-07-09 16:11:48,764 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 16:11:48,765 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'18675': np.int64(746), '17914': np.int64(148), '17612': np.int64(740), '17904': np.int64(81)}
2025-07-09 16:11:48,766 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 16:11:48,767 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 16:11:48,768 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 16:11:48,771 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 16:11:48,773 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 16:11:48,773 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'18675': np.int64(746), '17914': np.int64(145), '17612': np.int64(653), '17904': np.int64(81)}
2025-07-09 16:11:48,773 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 16:11:48,774 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'18675': np.int64(746), '17914': np.int64(145), '17612': np.int64(653), '17904': np.int64(81)}
2025-07-09 16:11:48,775 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 16:11:48,777 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 16:11:48,778 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 16:11:48,780 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 16:11:48,781 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 16:11:48,782 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'18675': np.int64(745), '17914': np.int64(142), '17612': np.int64(586), '17904': np.int64(80)}
2025-07-09 16:11:48,782 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 16:11:48,782 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'18675': np.int64(745), '17914': np.int64(142), '17612': np.int64(586), '17904': np.int64(80)}
2025-07-09 16:11:48,783 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 16:11:48,785 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:11:48,786 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 16:11:48,788 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 16:11:48,791 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 16:11:48,791 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'18675': np.int64(745), '17914': np.int64(131), '17612': np.int64(352), '17904': np.int64(66)}
2025-07-09 16:11:48,792 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 16:11:48,792 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'18675': np.int64(745), '17914': np.int64(131), '17612': np.int64(352), '17904': np.int64(66)}
2025-07-09 16:11:48,793 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 16:11:48,794 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:11:48,796 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 16:11:48,797 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 16:11:48,798 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 16:11:48,798 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'18675': np.int64(745), '17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65)}
2025-07-09 16:11:48,799 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 16:11:48,799 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'18675': np.int64(745), '17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65)}
2025-07-09 16:11:48,801 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:11:48,803 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:11:48,805 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:11:48,807 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:11:48,808 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'18675': np.int64(745), '17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65)}
2025-07-09 16:11:48,808 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 16:11:48,808 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'18675': np.int64(745), '17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65)}
2025-07-09 16:11:48,810 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:11:48,812 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:11:48,813 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:11:48,814 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:11:48,814 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'18675': np.int64(745), '17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65)}
2025-07-09 16:11:48,815 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 16:11:48,815 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'18675': np.int64(745), '17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65)}
2025-07-09 16:11:48,816 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 16:11:48,818 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 16:11:48,820 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 16:11:48,822 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 16:11:48,823 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 16:11:48,824 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'18675': np.int64(742), '17914': np.int64(116), '17612': np.int64(105), '17904': np.int64(63)}
2025-07-09 16:11:48,824 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 16:11:48,825 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'18675': np.int64(742), '17914': np.int64(116), '17612': np.int64(105), '17904': np.int64(63)}
2025-07-09 16:11:48,826 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 16:11:48,827 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 16:11:48,829 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 16:11:48,830 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 16:11:48,831 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 16:11:48,832 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'18675': np.int64(730), '17914': np.int64(105), '17612': np.int64(49), '17904': np.int64(62)}
2025-07-09 16:11:48,832 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 16:11:48,833 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'18675': np.int64(730), '17914': np.int64(105), '17612': np.int64(49), '17904': np.int64(62)}
2025-07-09 16:11:48,834 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 16:11:48,836 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:11:48,838 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 16:11:48,840 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 16:11:48,842 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 16:11:48,842 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'18675': np.int64(730), '17914': np.int64(104), '17612': np.int64(568), '17904': np.int64(61)}
2025-07-09 16:11:48,842 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 16:11:48,843 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'18675': np.int64(730), '17914': np.int64(104), '17612': np.int64(568), '17904': np.int64(61)}
2025-07-09 16:11:48,843 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 16:11:48,845 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:11:48,846 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 16:11:48,847 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 16:11:48,849 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 16:11:48,849 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'18675': np.int64(730), '17914': np.int64(97), '17612': np.int64(521), '17904': np.int64(59)}
2025-07-09 16:11:48,849 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 16:11:48,850 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'18675': np.int64(730), '17914': np.int64(97), '17612': np.int64(521), '17904': np.int64(59)}
2025-07-09 16:11:48,851 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 16:11:48,852 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 16:11:48,854 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 16:11:48,855 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 16:11:48,858 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 16:11:48,858 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58)}
2025-07-09 16:11:48,858 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 16:11:48,859 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58)}
2025-07-09 16:11:48,861 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:11:48,862 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:11:48,864 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:11:48,865 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:11:48,866 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58)}
2025-07-09 16:11:48,866 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 16:11:48,867 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58)}
2025-07-09 16:11:48,868 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:11:48,871 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:11:48,872 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:11:48,872 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:11:48,874 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58)}
2025-07-09 16:11:48,875 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 16:11:48,875 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58)}
2025-07-09 16:11:48,876 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 16:11:48,878 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:11:48,878 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:11:48,881 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 16:11:48,882 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 16:11:48,883 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(800), '17904': np.int64(52)}
2025-07-09 16:11:48,883 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 16:11:48,883 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(800), '17904': np.int64(52)}
2025-07-09 16:11:48,883 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 16:11:48,886 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:11:48,889 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 16:11:48,891 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 16:11:48,895 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 16:11:48,895 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'18675': np.int64(729), '17914': np.int64(91), '17612': np.int64(758), '17904': np.int64(51)}
2025-07-09 16:11:48,896 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 16:11:48,896 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'18675': np.int64(729), '17914': np.int64(91), '17612': np.int64(758), '17904': np.int64(51)}
2025-07-09 16:11:48,898 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 16:11:48,899 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:11:48,901 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 16:11:48,902 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 16:11:48,905 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 16:11:48,906 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'18675': np.int64(729), '17914': np.int64(87), '17612': np.int64(585), '17904': np.int64(50)}
2025-07-09 16:11:48,906 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 16:11:48,906 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'18675': np.int64(729), '17914': np.int64(87), '17612': np.int64(585), '17904': np.int64(50)}
2025-07-09 16:11:48,908 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 16:11:48,911 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:11:48,913 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 16:11:48,914 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 16:11:48,915 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 16:11:48,915 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'18675': np.int64(729), '17914': np.int64(78), '17612': np.int64(525), '17904': np.int64(48)}
2025-07-09 16:11:48,916 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 16:11:48,916 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'18675': np.int64(729), '17914': np.int64(78), '17612': np.int64(525), '17904': np.int64(48)}
2025-07-09 16:11:48,917 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 16:11:48,918 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:11:48,920 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 16:11:48,922 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 16:11:48,924 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 16:11:48,924 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'18675': np.int64(729), '17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45)}
2025-07-09 16:11:48,925 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 16:11:48,926 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'18675': np.int64(729), '17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45)}
2025-07-09 16:11:48,928 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:11:48,930 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:11:48,931 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:11:48,932 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:11:48,933 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'18675': np.int64(729), '17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45)}
2025-07-09 16:11:48,933 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 16:11:48,933 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'18675': np.int64(729), '17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45)}
2025-07-09 16:11:48,935 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:11:48,936 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:11:48,938 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:11:48,941 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:11:48,941 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'18675': np.int64(729), '17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45)}
2025-07-09 16:11:48,942 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 16:11:48,942 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'18675': np.int64(729), '17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45)}
2025-07-09 16:11:48,943 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 16:11:48,944 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:11:48,946 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 16:11:48,947 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 16:11:48,948 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 16:11:48,948 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'18675': np.int64(729), '17914': np.int64(71), '17612': np.int64(390), '17904': np.int64(42)}
2025-07-09 16:11:48,957 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
6  2025-06-02  17612           1006            935
2025-07-09 16:11:48,958 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
118  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-09 16:11:48,959 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 16:11:48,959 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 16:11:48,960 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
6  2025-06-02  17612           1006            935
2025-07-09 16:11:48,961 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
118  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-09 16:11:48,962 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 16:11:48,965 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 16:11:48,967 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
2    2025-06-01           1006
6    2025-06-02            935
10   2025-06-03            841
14   2025-06-04           1200
18   2025-06-05            904
22   2025-06-06            787
26   2025-06-07            787
30   2025-06-08            787
34   2025-06-09            740
38   2025-06-10            653
42   2025-06-11            586
46   2025-06-12            352
50   2025-06-13            269
54   2025-06-14            269
58   2025-06-15            269
62   2025-06-16            105
66   2025-06-17             49
70   2025-06-18            568
74   2025-06-19            521
78   2025-06-20            445
82   2025-06-21            445
86   2025-06-22            445
90   2025-06-23            800
94   2025-06-24            758
98   2025-06-25            585
102  2025-06-26            525
106  2025-06-27            474
110  2025-06-28            474
114  2025-06-29            474
118  2025-06-30            390
2025-07-09 16:11:48,970 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
3    2025-06-01            108
7    2025-06-02            106
11   2025-06-03             93
15   2025-06-04             86
19   2025-06-05             85
23   2025-06-06             83
27   2025-06-07             83
31   2025-06-08             83
35   2025-06-09             81
39   2025-06-10             81
43   2025-06-11             80
47   2025-06-12             66
51   2025-06-13             65
55   2025-06-14             65
59   2025-06-15             65
63   2025-06-16             63
67   2025-06-17             62
71   2025-06-18             61
75   2025-06-19             59
79   2025-06-20             58
83   2025-06-21             58
87   2025-06-22             58
91   2025-06-23             52
95   2025-06-24             51
99   2025-06-25             50
103  2025-06-26             48
107  2025-06-27             45
111  2025-06-28             45
115  2025-06-29             45
119  2025-06-30             42
2025-07-09 16:11:48,982 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 16:11:48,990 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 16:11:48,992 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 16:11:48,994 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
2    2025-06-01           21
6    2025-06-02           20
10   2025-06-03           18
14   2025-06-04           25
18   2025-06-05           19
22   2025-06-06           17
26   2025-06-07           17
30   2025-06-08           17
34   2025-06-09           16
38   2025-06-10           14
42   2025-06-11           13
46   2025-06-12            8
50   2025-06-13            6
54   2025-06-14            6
58   2025-06-15            6
62   2025-06-16            3
66   2025-06-17            2
70   2025-06-18           12
74   2025-06-19           11
78   2025-06-20           10
82   2025-06-21           10
86   2025-06-22           10
90   2025-06-23           17
94   2025-06-24           16
98   2025-06-25           13
102  2025-06-26           11
106  2025-06-27           10
110  2025-06-28           10
114  2025-06-29           10
118  2025-06-30            9
2025-07-09 16:11:48,995 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 16:11:48,995 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 16:11:48,996 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 16:11:48,996 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 16:11:48,997 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 16:11:48,998 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 16:11:48,999 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 16:11:49,006 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 16:11:49,007 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-09 16:11:49,007 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:11:49,007 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:11:49,009 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:11:49,317 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:11:49,319 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:11:49,320 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:11:49,321 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 16:11:49,372 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:11:49,546 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:11:49,552 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:11:49,747 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:49,917 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:50,093 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 16:11:50,305 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 16:11:50,314 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 16:11:50,495 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 16:11:50,497 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 16:11:50,498 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 16:11:50,499 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 16:11:50,500 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-09 16:11:50,583 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 16:11:50,585 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 16:11:50,590 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 16:11:50,592 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 16:11:50,597 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 16:11:50,597 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 16:11:50,607 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:11:50,608 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:11:50,617 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:11:50,990 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:11:50,995 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:11:50,996 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:11:50,997 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 16:11:51,067 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:11:51,239 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:11:51,244 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:11:51,456 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:51,573 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:11:51,744 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 16:11:51,915 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 16:11:51,918 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 16:11:52,072 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 16:11:52,074 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 16:11:52,075 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 16:11:52,077 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 16:11:52,077 - __main__ - INFO - Script finished successfully.
2025-07-09 16:17:18,024 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 16:17:18,027 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 16:17:18,395 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 16:17:18,395 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 16:17:18,396 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:17:18,396 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:17:18,413 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:17:18,725 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:17:18,728 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:17:18,729 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:17:18,729 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:17:18,756 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:17:18,921 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:17:18,922 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:17:19,332 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:17:19,479 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:17:19,480 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 16:17:19,641 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 16:17:19,644 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 16:17:19,650 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 16:17:19,651 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 16:17:19,652 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:17:19,654 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:17:19,658 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:17:19,912 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:17:19,914 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:17:19,914 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:17:19,915 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:17:19,936 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:17:20,101 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:17:20,104 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:17:20,342 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:17:20,464 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:17:20,466 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 16:17:20,640 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 16:17:20,641 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 16:17:20,643 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 16:17:20,644 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 16:17:20,646 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 16:17:20,647 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 16:17:20,647 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 16:17:20,648 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:17:20,649 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:17:20,652 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:17:20,917 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:17:20,921 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:17:20,921 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:17:20,922 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:17:20,945 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:17:21,095 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:17:21,099 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:17:21,463 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:17:21,673 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:17:21,674 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 16:17:21,905 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 16:17:21,911 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 16:17:21,915 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 16:17:21,916 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 16:17:21,916 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 16:17:21,917 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:17:21,917 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:17:21,920 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:17:22,290 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:17:22,291 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:17:22,292 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:17:22,294 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:17:22,316 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:17:22,468 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:17:22,471 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:17:22,765 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:17:22,975 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:17:22,976 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 16:17:23,188 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 16:17:23,192 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 16:17:23,194 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 16:17:23,195 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 16:17:23,195 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:17:23,196 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:17:23,198 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:17:23,463 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:17:23,465 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:17:23,466 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:17:23,466 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:17:23,489 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:17:23,647 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:17:23,649 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:17:23,920 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:17:24,130 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:17:24,131 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 16:17:24,481 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 16:17:24,483 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 16:17:24,493 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 16:17:24,493 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 16:17:24,494 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:17:24,494 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:17:24,497 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:17:24,752 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:17:24,755 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:17:24,756 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:17:24,758 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:17:24,779 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:17:24,938 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:17:24,940 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:17:25,360 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:17:25,710 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:17:25,712 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 16:17:25,862 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 16:17:25,863 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 16:17:25,864 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 16:17:25,865 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 16:17:25,865 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 16:17:25,871 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 16:17:25,873 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 16:17:25,874 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 16:17:25,875 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 16:17:25,877 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 16:17:25,879 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 16:17:25,881 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 16:17:25,881 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 16:17:25,882 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 16:17:25,882 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 16:17:25,882 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 16:17:25,884 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 16:17:25,885 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'18675': 749, '17914': 175, '17904': 108, '17612': 1006}
2025-07-09 16:17:25,886 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 16:17:25,886 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'18675': 749, '17914': 175, '17904': 108, '17612': 1006}
2025-07-09 16:17:25,889 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 16:17:25,892 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 16:17:25,894 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 16:17:25,895 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 16:17:25,896 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'18675': np.int64(749), '17914': np.int64(175), '17904': np.int64(108), '17612': np.int64(1006)}
2025-07-09 16:17:25,896 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 16:17:25,896 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'18675': np.int64(749), '17914': np.int64(175), '17904': np.int64(108), '17612': np.int64(1006)}
2025-07-09 16:17:25,898 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 16:17:25,899 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 16:17:25,901 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 16:17:25,903 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 16:17:25,905 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 16:17:25,905 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'18675': np.int64(748), '17914': np.int64(172), '17904': np.int64(106), '17612': np.int64(935)}
2025-07-09 16:17:25,905 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 16:17:25,906 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'18675': np.int64(748), '17914': np.int64(172), '17904': np.int64(106), '17612': np.int64(935)}
2025-07-09 16:17:25,909 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 16:17:25,911 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:17:25,912 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 16:17:25,914 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 16:17:25,915 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 16:17:25,916 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'18675': np.int64(748), '17914': np.int64(166), '17904': np.int64(93), '17612': np.int64(841)}
2025-07-09 16:17:25,916 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 16:17:25,916 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'18675': np.int64(748), '17914': np.int64(166), '17904': np.int64(93), '17612': np.int64(841)}
2025-07-09 16:17:25,917 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 16:17:25,920 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:17:25,924 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 16:17:25,925 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 16:17:25,927 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 16:17:25,927 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'18675': np.int64(748), '17914': np.int64(159), '17904': np.int64(86), '17612': np.int64(1200)}
2025-07-09 16:17:25,927 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 16:17:25,928 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'18675': np.int64(748), '17914': np.int64(159), '17904': np.int64(86), '17612': np.int64(1200)}
2025-07-09 16:17:25,929 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 16:17:25,930 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:17:25,932 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 16:17:25,934 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 16:17:25,936 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 16:17:25,938 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'18675': np.int64(748), '17914': np.int64(152), '17904': np.int64(85), '17612': np.int64(904)}
2025-07-09 16:17:25,938 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 16:17:25,938 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'18675': np.int64(748), '17914': np.int64(152), '17904': np.int64(85), '17612': np.int64(904)}
2025-07-09 16:17:25,939 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 16:17:25,941 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 16:17:25,943 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 16:17:25,944 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 16:17:25,946 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 16:17:25,946 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'18675': np.int64(747), '17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787)}
2025-07-09 16:17:25,946 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 16:17:25,947 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'18675': np.int64(747), '17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787)}
2025-07-09 16:17:25,949 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:17:25,950 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:17:25,953 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:17:25,956 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:17:25,957 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'18675': np.int64(747), '17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787)}
2025-07-09 16:17:25,957 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 16:17:25,957 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'18675': np.int64(747), '17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787)}
2025-07-09 16:17:25,959 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:17:25,960 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:17:25,961 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:17:25,963 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:17:25,963 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'18675': np.int64(747), '17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787)}
2025-07-09 16:17:25,964 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 16:17:25,964 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'18675': np.int64(747), '17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787)}
2025-07-09 16:17:25,965 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 16:17:25,966 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 16:17:25,970 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 16:17:25,972 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 16:17:25,974 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 16:17:25,974 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'18675': np.int64(746), '17914': np.int64(148), '17904': np.int64(81), '17612': np.int64(740)}
2025-07-09 16:17:25,974 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 16:17:25,975 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'18675': np.int64(746), '17914': np.int64(148), '17904': np.int64(81), '17612': np.int64(740)}
2025-07-09 16:17:25,975 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 16:17:25,977 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 16:17:25,979 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 16:17:25,980 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 16:17:25,982 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 16:17:25,982 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'18675': np.int64(746), '17914': np.int64(145), '17904': np.int64(81), '17612': np.int64(653)}
2025-07-09 16:17:25,982 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 16:17:25,983 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'18675': np.int64(746), '17914': np.int64(145), '17904': np.int64(81), '17612': np.int64(653)}
2025-07-09 16:17:25,983 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 16:17:25,986 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 16:17:25,989 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 16:17:25,990 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 16:17:25,992 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 16:17:25,992 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'18675': np.int64(745), '17914': np.int64(142), '17904': np.int64(80), '17612': np.int64(586)}
2025-07-09 16:17:25,993 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 16:17:25,993 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'18675': np.int64(745), '17914': np.int64(142), '17904': np.int64(80), '17612': np.int64(586)}
2025-07-09 16:17:25,994 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 16:17:25,995 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:17:25,997 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 16:17:25,998 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 16:17:26,002 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 16:17:26,002 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'18675': np.int64(745), '17914': np.int64(131), '17904': np.int64(66), '17612': np.int64(352)}
2025-07-09 16:17:26,003 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 16:17:26,003 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'18675': np.int64(745), '17914': np.int64(131), '17904': np.int64(66), '17612': np.int64(352)}
2025-07-09 16:17:26,005 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 16:17:26,007 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:17:26,008 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 16:17:26,010 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 16:17:26,012 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 16:17:26,012 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'18675': np.int64(745), '17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269)}
2025-07-09 16:17:26,012 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 16:17:26,013 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'18675': np.int64(745), '17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269)}
2025-07-09 16:17:26,014 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:17:26,016 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:17:26,017 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:17:26,019 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:17:26,020 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'18675': np.int64(745), '17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269)}
2025-07-09 16:17:26,021 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 16:17:26,021 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'18675': np.int64(745), '17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269)}
2025-07-09 16:17:26,023 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:17:26,024 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:17:26,026 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:17:26,027 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:17:26,028 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'18675': np.int64(745), '17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269)}
2025-07-09 16:17:26,028 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 16:17:26,028 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'18675': np.int64(745), '17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269)}
2025-07-09 16:17:26,029 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 16:17:26,031 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 16:17:26,033 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 16:17:26,035 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 16:17:26,037 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 16:17:26,038 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'18675': np.int64(742), '17914': np.int64(116), '17904': np.int64(63), '17612': np.int64(105)}
2025-07-09 16:17:26,038 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 16:17:26,039 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'18675': np.int64(742), '17914': np.int64(116), '17904': np.int64(63), '17612': np.int64(105)}
2025-07-09 16:17:26,039 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 16:17:26,041 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 16:17:26,043 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 16:17:26,044 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 16:17:26,046 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 16:17:26,046 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'18675': np.int64(730), '17914': np.int64(105), '17904': np.int64(62), '17612': np.int64(49)}
2025-07-09 16:17:26,046 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 16:17:26,047 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'18675': np.int64(730), '17914': np.int64(105), '17904': np.int64(62), '17612': np.int64(49)}
2025-07-09 16:17:26,048 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 16:17:26,049 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:17:26,051 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 16:17:26,053 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 16:17:26,056 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 16:17:26,056 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'18675': np.int64(730), '17914': np.int64(104), '17904': np.int64(61), '17612': np.int64(568)}
2025-07-09 16:17:26,057 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 16:17:26,057 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'18675': np.int64(730), '17914': np.int64(104), '17904': np.int64(61), '17612': np.int64(568)}
2025-07-09 16:17:26,057 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 16:17:26,059 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:17:26,060 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 16:17:26,062 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 16:17:26,064 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 16:17:26,064 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'18675': np.int64(730), '17914': np.int64(97), '17904': np.int64(59), '17612': np.int64(521)}
2025-07-09 16:17:26,064 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 16:17:26,065 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'18675': np.int64(730), '17914': np.int64(97), '17904': np.int64(59), '17612': np.int64(521)}
2025-07-09 16:17:26,066 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 16:17:26,067 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 16:17:26,070 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 16:17:26,072 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 16:17:26,074 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 16:17:26,074 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445)}
2025-07-09 16:17:26,075 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 16:17:26,075 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445)}
2025-07-09 16:17:26,077 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:17:26,079 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:17:26,080 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:17:26,081 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:17:26,082 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445)}
2025-07-09 16:17:26,082 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 16:17:26,082 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445)}
2025-07-09 16:17:26,084 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:17:26,086 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:17:26,089 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:17:26,090 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:17:26,091 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445)}
2025-07-09 16:17:26,091 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 16:17:26,091 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445)}
2025-07-09 16:17:26,092 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 16:17:26,094 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:17:26,096 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:17:26,098 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 16:17:26,100 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 16:17:26,101 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(52), '17612': np.int64(800)}
2025-07-09 16:17:26,101 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 16:17:26,102 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(52), '17612': np.int64(800)}
2025-07-09 16:17:26,104 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 16:17:26,114 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:17:26,122 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 16:17:26,127 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 16:17:26,131 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 16:17:26,131 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'18675': np.int64(729), '17914': np.int64(91), '17904': np.int64(51), '17612': np.int64(758)}
2025-07-09 16:17:26,132 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 16:17:26,133 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'18675': np.int64(729), '17914': np.int64(91), '17904': np.int64(51), '17612': np.int64(758)}
2025-07-09 16:17:26,136 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 16:17:26,142 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:17:26,145 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 16:17:26,148 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 16:17:26,152 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 16:17:26,153 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'18675': np.int64(729), '17914': np.int64(87), '17904': np.int64(50), '17612': np.int64(585)}
2025-07-09 16:17:26,155 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 16:17:26,158 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'18675': np.int64(729), '17914': np.int64(87), '17904': np.int64(50), '17612': np.int64(585)}
2025-07-09 16:17:26,160 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 16:17:26,163 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:17:26,164 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 16:17:26,166 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 16:17:26,167 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 16:17:26,168 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'18675': np.int64(729), '17914': np.int64(78), '17904': np.int64(48), '17612': np.int64(525)}
2025-07-09 16:17:26,168 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 16:17:26,169 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'18675': np.int64(729), '17914': np.int64(78), '17904': np.int64(48), '17612': np.int64(525)}
2025-07-09 16:17:26,171 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 16:17:26,173 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:17:26,174 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 16:17:26,176 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 16:17:26,177 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 16:17:26,178 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'18675': np.int64(729), '17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474)}
2025-07-09 16:17:26,178 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 16:17:26,178 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'18675': np.int64(729), '17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474)}
2025-07-09 16:17:26,180 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:17:26,182 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:17:26,183 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:17:26,185 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:17:26,186 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'18675': np.int64(729), '17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474)}
2025-07-09 16:17:26,186 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 16:17:26,187 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'18675': np.int64(729), '17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474)}
2025-07-09 16:17:26,191 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:17:26,193 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:17:26,194 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:17:26,196 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:17:26,196 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'18675': np.int64(729), '17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474)}
2025-07-09 16:17:26,196 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 16:17:26,197 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'18675': np.int64(729), '17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474)}
2025-07-09 16:17:26,197 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 16:17:26,199 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:17:26,201 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 16:17:26,203 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 16:17:26,205 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 16:17:26,206 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'18675': np.int64(729), '17914': np.int64(71), '17904': np.int64(42), '17612': np.int64(390)}
2025-07-09 16:17:26,208 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612           1006           1006
2  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
7  2025-06-02  17612           1006            935
2025-07-09 16:17:26,210 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
119  2025-06-30  17612            474            390
118  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-09 16:17:26,210 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 16:17:26,210 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 16:17:26,211 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612           1006           1006
2  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
7  2025-06-02  17612           1006            935
2025-07-09 16:17:26,212 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
119  2025-06-30  17612            474            390
118  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-09 16:17:26,213 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 16:17:26,215 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 16:17:26,216 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01           1006
7    2025-06-02            935
11   2025-06-03            841
15   2025-06-04           1200
19   2025-06-05            904
23   2025-06-06            787
27   2025-06-07            787
31   2025-06-08            787
35   2025-06-09            740
39   2025-06-10            653
43   2025-06-11            586
47   2025-06-12            352
51   2025-06-13            269
55   2025-06-14            269
59   2025-06-15            269
63   2025-06-16            105
67   2025-06-17             49
71   2025-06-18            568
75   2025-06-19            521
79   2025-06-20            445
83   2025-06-21            445
87   2025-06-22            445
91   2025-06-23            800
95   2025-06-24            758
99   2025-06-25            585
103  2025-06-26            525
107  2025-06-27            474
111  2025-06-28            474
115  2025-06-29            474
119  2025-06-30            390
2025-07-09 16:17:26,218 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            108
6    2025-06-02            106
10   2025-06-03             93
14   2025-06-04             86
18   2025-06-05             85
22   2025-06-06             83
26   2025-06-07             83
30   2025-06-08             83
34   2025-06-09             81
38   2025-06-10             81
42   2025-06-11             80
46   2025-06-12             66
50   2025-06-13             65
54   2025-06-14             65
58   2025-06-15             65
62   2025-06-16             63
66   2025-06-17             62
70   2025-06-18             61
74   2025-06-19             59
78   2025-06-20             58
82   2025-06-21             58
86   2025-06-22             58
90   2025-06-23             52
94   2025-06-24             51
98   2025-06-25             50
102  2025-06-26             48
106  2025-06-27             45
110  2025-06-28             45
114  2025-06-29             45
118  2025-06-30             42
2025-07-09 16:17:26,226 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 16:17:26,230 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 16:17:26,231 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 16:17:26,233 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           21
7    2025-06-02           20
11   2025-06-03           18
15   2025-06-04           25
19   2025-06-05           19
23   2025-06-06           17
27   2025-06-07           17
31   2025-06-08           17
35   2025-06-09           16
39   2025-06-10           14
43   2025-06-11           13
47   2025-06-12            8
51   2025-06-13            6
55   2025-06-14            6
59   2025-06-15            6
63   2025-06-16            3
67   2025-06-17            2
71   2025-06-18           12
75   2025-06-19           11
79   2025-06-20           10
83   2025-06-21           10
87   2025-06-22           10
91   2025-06-23           17
95   2025-06-24           16
99   2025-06-25           13
103  2025-06-26           11
107  2025-06-27           10
111  2025-06-28           10
115  2025-06-29           10
119  2025-06-30            9
2025-07-09 16:17:26,234 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 16:17:26,235 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 16:17:26,236 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 16:17:26,237 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 16:17:26,239 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 16:17:26,240 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 16:17:26,241 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 16:17:26,246 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 16:17:26,246 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 16:18:18,681 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 16:18:18,681 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 16:18:19,028 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 16:18:19,029 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 16:18:19,029 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:18:19,029 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:18:19,041 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:18:19,326 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:18:19,328 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:18:19,329 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:18:19,329 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:18:19,354 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:18:19,498 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:18:19,500 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:18:19,769 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:18:19,886 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:18:19,888 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 16:18:20,028 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 16:18:20,030 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 16:18:20,037 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 16:18:20,037 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 16:18:20,038 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:18:20,038 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:18:20,040 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:18:20,342 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:18:20,343 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:18:20,343 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:18:20,344 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:18:20,366 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:18:20,515 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:18:20,516 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:18:20,733 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:18:20,843 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:18:20,844 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 16:18:20,975 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 16:18:20,977 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 16:18:20,977 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 16:18:20,978 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 16:18:20,981 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 16:18:20,981 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 16:18:20,982 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 16:18:20,982 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:18:20,982 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:18:20,985 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:18:21,271 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:18:21,274 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:18:21,274 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:18:21,276 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:18:21,298 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:18:21,449 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:18:21,451 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:18:21,641 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:18:21,752 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:18:21,753 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 16:18:21,896 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 16:18:21,902 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 16:18:21,905 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 16:18:21,906 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 16:18:21,907 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 16:18:21,907 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:18:21,908 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:18:21,910 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:18:22,137 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:18:22,138 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:18:22,139 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:18:22,140 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:18:22,161 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:18:22,313 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:18:22,315 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:18:22,505 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:18:22,615 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:18:22,616 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 16:18:22,757 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 16:18:22,759 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 16:18:22,763 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 16:18:22,763 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 16:18:22,764 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:18:22,764 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:18:22,766 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:18:23,020 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:18:23,021 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:18:23,022 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:18:23,022 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:18:23,044 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:18:23,192 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:18:23,193 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:18:23,389 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:18:23,504 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:18:23,505 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 16:18:23,640 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 16:18:23,641 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 16:18:23,647 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 16:18:23,647 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 16:18:23,647 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:18:23,648 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:18:23,650 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:18:23,897 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:18:23,899 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:18:23,900 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:18:23,900 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:18:23,923 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:18:24,097 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:18:24,100 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:18:24,302 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:18:24,426 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:18:24,428 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 16:18:24,567 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 16:18:24,568 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 16:18:24,570 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 16:18:24,571 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 16:18:24,571 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 16:18:24,576 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 16:18:24,577 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 16:18:24,578 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 16:18:24,579 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 16:18:24,580 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 16:18:24,581 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 16:18:24,583 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 16:18:24,584 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 16:18:24,585 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 16:18:24,585 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 16:18:24,586 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 16:18:24,588 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 16:18:24,590 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 175, '17904': 108, '17612': 1006, '18675': 749}
2025-07-09 16:18:24,590 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 16:18:24,592 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 175, '17904': 108, '17612': 1006, '18675': 749}
2025-07-09 16:18:24,596 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 16:18:24,598 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 16:18:24,600 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 16:18:24,602 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 16:18:24,603 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(175), '17904': np.int64(108), '17612': np.int64(1006), '18675': np.int64(749)}
2025-07-09 16:18:24,604 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 16:18:24,604 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(175), '17904': np.int64(108), '17612': np.int64(1006), '18675': np.int64(749)}
2025-07-09 16:18:24,606 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 16:18:24,610 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 16:18:24,612 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 16:18:24,614 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 16:18:24,616 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 16:18:24,617 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(172), '17904': np.int64(106), '17612': np.int64(935), '18675': np.int64(748)}
2025-07-09 16:18:24,618 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 16:18:24,619 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(172), '17904': np.int64(106), '17612': np.int64(935), '18675': np.int64(748)}
2025-07-09 16:18:24,620 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 16:18:24,623 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 16:18:24,629 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 16:18:24,631 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 16:18:24,632 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:18:24,633 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(166), '17904': np.int64(93), '17612': np.int64(841), '18675': np.int64(748)}
2025-07-09 16:18:24,633 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 16:18:24,633 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(166), '17904': np.int64(93), '17612': np.int64(841), '18675': np.int64(748)}
2025-07-09 16:18:24,635 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 16:18:24,637 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 16:18:24,639 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 16:18:24,643 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 16:18:24,645 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:18:24,646 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(159), '17904': np.int64(86), '17612': np.int64(1200), '18675': np.int64(748)}
2025-07-09 16:18:24,646 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 16:18:24,647 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(159), '17904': np.int64(86), '17612': np.int64(1200), '18675': np.int64(748)}
2025-07-09 16:18:24,648 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 16:18:24,650 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 16:18:24,652 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 16:18:24,655 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 16:18:24,657 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:18:24,658 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(152), '17904': np.int64(85), '17612': np.int64(904), '18675': np.int64(748)}
2025-07-09 16:18:24,659 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 16:18:24,659 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(152), '17904': np.int64(85), '17612': np.int64(904), '18675': np.int64(748)}
2025-07-09 16:18:24,660 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 16:18:24,662 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 16:18:24,664 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 16:18:24,665 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 16:18:24,667 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 16:18:24,668 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787), '18675': np.int64(747)}
2025-07-09 16:18:24,668 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 16:18:24,669 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787), '18675': np.int64(747)}
2025-07-09 16:18:24,671 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:18:24,672 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:18:24,677 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:18:24,679 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:18:24,680 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787), '18675': np.int64(747)}
2025-07-09 16:18:24,680 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 16:18:24,680 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787), '18675': np.int64(747)}
2025-07-09 16:18:24,682 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:18:24,684 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:18:24,686 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:18:24,687 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:18:24,688 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787), '18675': np.int64(747)}
2025-07-09 16:18:24,688 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 16:18:24,689 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787), '18675': np.int64(747)}
2025-07-09 16:18:24,690 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 16:18:24,694 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 16:18:24,695 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 16:18:24,697 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 16:18:24,698 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 16:18:24,698 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(148), '17904': np.int64(81), '17612': np.int64(740), '18675': np.int64(746)}
2025-07-09 16:18:24,698 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 16:18:24,699 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(148), '17904': np.int64(81), '17612': np.int64(740), '18675': np.int64(746)}
2025-07-09 16:18:24,699 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 16:18:24,702 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 16:18:24,704 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 16:18:24,706 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 16:18:24,709 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 16:18:24,710 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(145), '17904': np.int64(81), '17612': np.int64(653), '18675': np.int64(746)}
2025-07-09 16:18:24,710 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 16:18:24,711 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(145), '17904': np.int64(81), '17612': np.int64(653), '18675': np.int64(746)}
2025-07-09 16:18:24,712 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 16:18:24,714 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 16:18:24,715 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 16:18:24,717 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 16:18:24,718 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 16:18:24,719 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(142), '17904': np.int64(80), '17612': np.int64(586), '18675': np.int64(745)}
2025-07-09 16:18:24,720 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 16:18:24,720 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(142), '17904': np.int64(80), '17612': np.int64(586), '18675': np.int64(745)}
2025-07-09 16:18:24,722 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 16:18:24,725 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 16:18:24,728 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 16:18:24,730 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 16:18:24,732 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:18:24,732 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(131), '17904': np.int64(66), '17612': np.int64(352), '18675': np.int64(745)}
2025-07-09 16:18:24,732 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 16:18:24,732 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(131), '17904': np.int64(66), '17612': np.int64(352), '18675': np.int64(745)}
2025-07-09 16:18:24,733 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 16:18:24,736 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 16:18:24,738 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 16:18:24,740 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 16:18:24,743 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:18:24,744 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269), '18675': np.int64(745)}
2025-07-09 16:18:24,744 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 16:18:24,744 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269), '18675': np.int64(745)}
2025-07-09 16:18:24,746 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:18:24,748 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:18:24,749 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:18:24,751 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:18:24,752 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269), '18675': np.int64(745)}
2025-07-09 16:18:24,752 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 16:18:24,753 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269), '18675': np.int64(745)}
2025-07-09 16:18:24,755 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:18:24,756 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:18:24,760 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:18:24,761 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:18:24,762 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269), '18675': np.int64(745)}
2025-07-09 16:18:24,762 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 16:18:24,762 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269), '18675': np.int64(745)}
2025-07-09 16:18:24,763 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 16:18:24,765 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 16:18:24,767 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 16:18:24,769 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 16:18:24,771 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 16:18:24,772 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(116), '17904': np.int64(63), '17612': np.int64(105), '18675': np.int64(742)}
2025-07-09 16:18:24,772 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 16:18:24,772 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(116), '17904': np.int64(63), '17612': np.int64(105), '18675': np.int64(742)}
2025-07-09 16:18:24,774 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 16:18:24,778 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 16:18:24,779 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 16:18:24,781 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 16:18:24,782 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 16:18:24,783 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(105), '17904': np.int64(62), '17612': np.int64(49), '18675': np.int64(730)}
2025-07-09 16:18:24,783 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 16:18:24,783 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(105), '17904': np.int64(62), '17612': np.int64(49), '18675': np.int64(730)}
2025-07-09 16:18:24,784 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 16:18:24,787 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 16:18:24,788 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 16:18:24,792 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 16:18:24,794 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:18:24,794 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(104), '17904': np.int64(61), '17612': np.int64(568), '18675': np.int64(730)}
2025-07-09 16:18:24,795 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 16:18:24,795 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(104), '17904': np.int64(61), '17612': np.int64(568), '18675': np.int64(730)}
2025-07-09 16:18:24,796 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 16:18:24,797 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 16:18:24,799 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 16:18:24,800 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 16:18:24,803 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:18:24,804 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(97), '17904': np.int64(59), '17612': np.int64(521), '18675': np.int64(730)}
2025-07-09 16:18:24,804 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 16:18:24,804 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(97), '17904': np.int64(59), '17612': np.int64(521), '18675': np.int64(730)}
2025-07-09 16:18:24,806 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 16:18:24,809 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 16:18:24,811 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 16:18:24,812 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 16:18:24,814 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 16:18:24,815 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445), '18675': np.int64(729)}
2025-07-09 16:18:24,815 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 16:18:24,815 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445), '18675': np.int64(729)}
2025-07-09 16:18:24,818 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:18:24,820 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:18:24,821 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:18:24,824 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:18:24,825 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445), '18675': np.int64(729)}
2025-07-09 16:18:24,825 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 16:18:24,826 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445), '18675': np.int64(729)}
2025-07-09 16:18:24,828 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:18:24,829 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:18:24,831 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:18:24,832 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:18:24,833 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445), '18675': np.int64(729)}
2025-07-09 16:18:24,833 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 16:18:24,833 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445), '18675': np.int64(729)}
2025-07-09 16:18:24,834 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 16:18:24,836 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:18:24,838 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 16:18:24,842 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 16:18:24,844 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:18:24,844 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(92), '17904': np.int64(52), '17612': np.int64(800), '18675': np.int64(729)}
2025-07-09 16:18:24,845 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 16:18:24,845 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(92), '17904': np.int64(52), '17612': np.int64(800), '18675': np.int64(729)}
2025-07-09 16:18:24,846 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 16:18:24,848 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 16:18:24,850 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 16:18:24,852 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 16:18:24,854 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:18:24,855 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(91), '17904': np.int64(51), '17612': np.int64(758), '18675': np.int64(729)}
2025-07-09 16:18:24,855 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 16:18:24,856 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(91), '17904': np.int64(51), '17612': np.int64(758), '18675': np.int64(729)}
2025-07-09 16:18:24,857 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 16:18:24,860 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 16:18:24,862 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 16:18:24,864 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 16:18:24,865 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:18:24,866 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(87), '17904': np.int64(50), '17612': np.int64(585), '18675': np.int64(729)}
2025-07-09 16:18:24,866 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 16:18:24,866 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(87), '17904': np.int64(50), '17612': np.int64(585), '18675': np.int64(729)}
2025-07-09 16:18:24,867 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 16:18:24,870 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 16:18:24,872 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 16:18:24,876 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 16:18:24,878 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:18:24,878 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(78), '17904': np.int64(48), '17612': np.int64(525), '18675': np.int64(729)}
2025-07-09 16:18:24,879 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 16:18:24,879 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(78), '17904': np.int64(48), '17612': np.int64(525), '18675': np.int64(729)}
2025-07-09 16:18:24,880 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 16:18:24,881 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 16:18:24,883 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 16:18:24,885 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 16:18:24,887 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:18:24,887 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474), '18675': np.int64(729)}
2025-07-09 16:18:24,888 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 16:18:24,888 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474), '18675': np.int64(729)}
2025-07-09 16:18:24,893 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:18:24,894 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:18:24,896 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:18:24,897 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:18:24,897 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474), '18675': np.int64(729)}
2025-07-09 16:18:24,897 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 16:18:24,898 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474), '18675': np.int64(729)}
2025-07-09 16:18:24,900 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:18:24,902 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:18:24,904 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:18:24,907 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:18:24,908 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474), '18675': np.int64(729)}
2025-07-09 16:18:24,909 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 16:18:24,909 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474), '18675': np.int64(729)}
2025-07-09 16:18:24,910 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 16:18:24,912 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 16:18:24,914 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 16:18:24,916 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 16:18:24,919 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:18:24,920 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(71), '17904': np.int64(42), '17612': np.int64(390), '18675': np.int64(729)}
2025-07-09 16:18:24,926 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612           1006           1006
1  2025-06-01  17904            108            108
0  2025-06-01  17914            175            175
3  2025-06-01  18675            749            749
6  2025-06-02  17612           1006            935
2025-07-09 16:18:24,927 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            729            729
118  2025-06-30  17612            474            390
117  2025-06-30  17904             45             42
116  2025-06-30  17914             72             71
119  2025-06-30  18675            729            729
2025-07-09 16:18:24,928 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 16:18:24,929 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 16:18:24,931 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612           1006           1006
1  2025-06-01  17904            108            108
0  2025-06-01  17914            175            175
3  2025-06-01  18675            749            749
6  2025-06-02  17612           1006            935
2025-07-09 16:18:24,932 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            729            729
118  2025-06-30  17612            474            390
117  2025-06-30  17904             45             42
116  2025-06-30  17914             72             71
119  2025-06-30  18675            729            729
2025-07-09 16:18:24,932 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 16:18:24,935 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 16:18:24,939 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
2    2025-06-01           1006
6    2025-06-02            935
10   2025-06-03            841
14   2025-06-04           1200
18   2025-06-05            904
22   2025-06-06            787
26   2025-06-07            787
30   2025-06-08            787
34   2025-06-09            740
38   2025-06-10            653
42   2025-06-11            586
46   2025-06-12            352
50   2025-06-13            269
54   2025-06-14            269
58   2025-06-15            269
62   2025-06-16            105
66   2025-06-17             49
70   2025-06-18            568
74   2025-06-19            521
78   2025-06-20            445
82   2025-06-21            445
86   2025-06-22            445
90   2025-06-23            800
94   2025-06-24            758
98   2025-06-25            585
102  2025-06-26            525
106  2025-06-27            474
110  2025-06-28            474
114  2025-06-29            474
118  2025-06-30            390
2025-07-09 16:18:24,943 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            108
5    2025-06-02            106
9    2025-06-03             93
13   2025-06-04             86
17   2025-06-05             85
21   2025-06-06             83
25   2025-06-07             83
29   2025-06-08             83
33   2025-06-09             81
37   2025-06-10             81
41   2025-06-11             80
45   2025-06-12             66
49   2025-06-13             65
53   2025-06-14             65
57   2025-06-15             65
61   2025-06-16             63
65   2025-06-17             62
69   2025-06-18             61
73   2025-06-19             59
77   2025-06-20             58
81   2025-06-21             58
85   2025-06-22             58
89   2025-06-23             52
93   2025-06-24             51
97   2025-06-25             50
101  2025-06-26             48
105  2025-06-27             45
109  2025-06-28             45
113  2025-06-29             45
117  2025-06-30             42
2025-07-09 16:18:24,950 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 16:18:24,955 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 16:18:24,959 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 16:18:24,961 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
2    2025-06-01           21
6    2025-06-02           20
10   2025-06-03           18
14   2025-06-04           25
18   2025-06-05           19
22   2025-06-06           17
26   2025-06-07           17
30   2025-06-08           17
34   2025-06-09           16
38   2025-06-10           14
42   2025-06-11           13
46   2025-06-12            8
50   2025-06-13            6
54   2025-06-14            6
58   2025-06-15            6
62   2025-06-16            3
66   2025-06-17            2
70   2025-06-18           12
74   2025-06-19           11
78   2025-06-20           10
82   2025-06-21           10
86   2025-06-22           10
90   2025-06-23           17
94   2025-06-24           16
98   2025-06-25           13
102  2025-06-26           11
106  2025-06-27           10
110  2025-06-28           10
114  2025-06-29           10
118  2025-06-30            9
2025-07-09 16:18:24,962 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 16:18:24,963 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 16:18:24,963 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 16:18:24,963 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 16:18:24,965 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 16:18:24,966 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 16:18:24,967 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 16:18:24,974 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 16:18:24,975 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 16:19:31,094 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 16:19:31,094 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 16:19:31,460 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 16:19:31,460 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 16:19:31,460 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:19:31,461 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:19:31,471 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:19:31,758 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:19:31,759 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:19:31,760 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:19:31,760 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:19:31,784 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:19:31,964 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:19:31,969 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:19:32,276 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:19:32,394 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:19:32,394 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 16:19:32,527 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 16:19:32,529 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 16:19:32,537 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 16:19:32,538 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 16:19:32,538 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:19:32,539 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:19:32,541 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:19:32,798 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:19:32,799 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:19:32,800 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:19:32,800 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:19:32,824 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:19:32,967 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:19:32,970 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:19:33,166 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:19:33,288 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:19:33,289 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 16:19:33,424 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 16:19:33,426 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 16:19:33,427 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 16:19:33,429 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 16:19:33,433 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 16:19:33,435 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 16:19:33,436 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 16:19:33,437 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:19:33,438 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:19:33,442 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:19:33,771 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:19:33,772 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:19:33,772 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:19:33,773 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:19:33,796 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:19:33,942 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:19:33,945 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:19:34,137 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:19:34,253 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:19:34,255 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 16:19:34,487 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 16:19:34,495 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 16:19:34,499 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 16:19:34,502 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 16:19:34,502 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 16:19:34,503 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:19:34,504 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:19:34,507 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:19:34,761 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:19:34,763 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:19:34,763 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:19:34,764 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:19:34,788 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:19:34,971 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:19:34,973 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:19:35,203 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:19:35,328 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:19:35,329 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 16:19:35,510 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 16:19:35,513 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 16:19:35,516 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 16:19:35,516 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 16:19:35,518 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:19:35,518 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:19:35,520 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:19:35,766 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:19:35,767 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:19:35,767 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:19:35,767 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:19:35,791 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:19:35,973 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:19:35,974 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:19:36,334 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:19:36,452 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:19:36,455 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 16:19:36,636 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 16:19:36,638 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 16:19:36,644 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 16:19:36,644 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 16:19:36,645 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:19:36,645 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:19:36,648 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:19:36,878 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:19:36,880 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:19:36,880 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:19:36,880 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:19:36,904 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:19:37,047 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:19:37,049 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:19:37,354 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:19:37,493 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:19:37,494 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 16:19:37,662 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 16:19:37,663 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 16:19:37,664 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 16:19:37,664 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 16:19:37,665 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 16:19:37,670 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 16:19:37,671 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 16:19:37,672 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 16:19:37,673 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 16:19:37,674 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 16:19:37,675 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 16:19:37,677 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 16:19:37,678 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 16:19:37,678 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 16:19:37,678 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 16:19:37,678 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 16:19:37,679 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 16:19:37,680 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 175, '17612': 1006, '17904': 108, '18675': 749}
2025-07-09 16:19:37,680 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 16:19:37,680 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 175, '17612': 1006, '17904': 108, '18675': 749}
2025-07-09 16:19:37,682 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 16:19:37,683 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 16:19:37,685 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 16:19:37,688 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 16:19:37,689 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(175), '17612': np.int64(1006), '17904': np.int64(108), '18675': np.int64(749)}
2025-07-09 16:19:37,689 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 16:19:37,690 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(175), '17612': np.int64(1006), '17904': np.int64(108), '18675': np.int64(749)}
2025-07-09 16:19:37,691 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 16:19:37,693 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 16:19:37,694 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 16:19:37,696 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 16:19:37,697 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 16:19:37,697 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(172), '17612': np.int64(935), '17904': np.int64(106), '18675': np.int64(748)}
2025-07-09 16:19:37,698 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 16:19:37,698 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(172), '17612': np.int64(935), '17904': np.int64(106), '18675': np.int64(748)}
2025-07-09 16:19:37,699 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 16:19:37,700 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 16:19:37,703 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 16:19:37,705 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 16:19:37,707 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:19:37,707 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(166), '17612': np.int64(841), '17904': np.int64(93), '18675': np.int64(748)}
2025-07-09 16:19:37,708 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 16:19:37,708 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(166), '17612': np.int64(841), '17904': np.int64(93), '18675': np.int64(748)}
2025-07-09 16:19:37,709 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 16:19:37,711 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 16:19:37,712 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 16:19:37,713 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 16:19:37,715 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:19:37,715 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(159), '17612': np.int64(1200), '17904': np.int64(86), '18675': np.int64(748)}
2025-07-09 16:19:37,715 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 16:19:37,716 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(159), '17612': np.int64(1200), '17904': np.int64(86), '18675': np.int64(748)}
2025-07-09 16:19:37,716 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 16:19:37,719 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 16:19:37,722 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 16:19:37,723 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 16:19:37,725 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:19:37,725 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(152), '17612': np.int64(904), '17904': np.int64(85), '18675': np.int64(748)}
2025-07-09 16:19:37,726 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 16:19:37,726 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(152), '17612': np.int64(904), '17904': np.int64(85), '18675': np.int64(748)}
2025-07-09 16:19:37,727 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 16:19:37,728 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 16:19:37,730 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 16:19:37,732 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 16:19:37,733 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 16:19:37,733 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83), '18675': np.int64(747)}
2025-07-09 16:19:37,735 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 16:19:37,736 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83), '18675': np.int64(747)}
2025-07-09 16:19:37,740 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:19:37,741 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:19:37,743 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:19:37,744 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:19:37,745 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83), '18675': np.int64(747)}
2025-07-09 16:19:37,745 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 16:19:37,745 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83), '18675': np.int64(747)}
2025-07-09 16:19:37,747 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:19:37,749 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:19:37,750 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:19:37,753 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:19:37,754 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83), '18675': np.int64(747)}
2025-07-09 16:19:37,755 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 16:19:37,756 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83), '18675': np.int64(747)}
2025-07-09 16:19:37,758 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 16:19:37,762 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 16:19:37,764 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 16:19:37,765 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 16:19:37,767 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 16:19:37,768 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(148), '17612': np.int64(740), '17904': np.int64(81), '18675': np.int64(746)}
2025-07-09 16:19:37,769 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 16:19:37,769 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(148), '17612': np.int64(740), '17904': np.int64(81), '18675': np.int64(746)}
2025-07-09 16:19:37,771 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 16:19:37,774 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 16:19:37,778 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 16:19:37,780 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 16:19:37,782 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 16:19:37,783 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(145), '17612': np.int64(653), '17904': np.int64(81), '18675': np.int64(746)}
2025-07-09 16:19:37,783 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 16:19:37,783 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(145), '17612': np.int64(653), '17904': np.int64(81), '18675': np.int64(746)}
2025-07-09 16:19:37,785 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 16:19:37,789 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 16:19:37,793 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 16:19:37,796 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 16:19:37,798 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 16:19:37,798 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(142), '17612': np.int64(586), '17904': np.int64(80), '18675': np.int64(745)}
2025-07-09 16:19:37,799 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 16:19:37,799 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(142), '17612': np.int64(586), '17904': np.int64(80), '18675': np.int64(745)}
2025-07-09 16:19:37,800 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 16:19:37,802 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 16:19:37,806 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 16:19:37,809 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 16:19:37,812 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:19:37,813 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(131), '17612': np.int64(352), '17904': np.int64(66), '18675': np.int64(745)}
2025-07-09 16:19:37,813 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 16:19:37,813 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(131), '17612': np.int64(352), '17904': np.int64(66), '18675': np.int64(745)}
2025-07-09 16:19:37,814 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 16:19:37,816 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 16:19:37,818 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 16:19:37,820 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 16:19:37,823 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:19:37,824 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65), '18675': np.int64(745)}
2025-07-09 16:19:37,824 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 16:19:37,824 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65), '18675': np.int64(745)}
2025-07-09 16:19:37,826 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:19:37,828 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:19:37,830 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:19:37,831 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:19:37,832 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65), '18675': np.int64(745)}
2025-07-09 16:19:37,832 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 16:19:37,832 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65), '18675': np.int64(745)}
2025-07-09 16:19:37,834 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:19:37,838 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:19:37,841 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:19:37,845 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:19:37,845 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65), '18675': np.int64(745)}
2025-07-09 16:19:37,846 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 16:19:37,846 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65), '18675': np.int64(745)}
2025-07-09 16:19:37,847 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 16:19:37,849 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 16:19:37,850 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 16:19:37,852 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 16:19:37,855 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 16:19:37,856 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(116), '17612': np.int64(105), '17904': np.int64(63), '18675': np.int64(742)}
2025-07-09 16:19:37,856 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 16:19:37,856 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(116), '17612': np.int64(105), '17904': np.int64(63), '18675': np.int64(742)}
2025-07-09 16:19:37,858 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 16:19:37,860 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 16:19:37,861 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 16:19:37,863 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 16:19:37,865 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 16:19:37,865 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(105), '17612': np.int64(49), '17904': np.int64(62), '18675': np.int64(730)}
2025-07-09 16:19:37,865 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 16:19:37,866 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(105), '17612': np.int64(49), '17904': np.int64(62), '18675': np.int64(730)}
2025-07-09 16:19:37,867 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 16:19:37,868 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 16:19:37,871 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 16:19:37,873 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 16:19:37,875 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:19:37,875 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(104), '17612': np.int64(568), '17904': np.int64(61), '18675': np.int64(730)}
2025-07-09 16:19:37,875 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 16:19:37,876 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(104), '17612': np.int64(568), '17904': np.int64(61), '18675': np.int64(730)}
2025-07-09 16:19:37,876 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 16:19:37,879 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 16:19:37,880 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 16:19:37,882 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 16:19:37,883 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:19:37,884 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(97), '17612': np.int64(521), '17904': np.int64(59), '18675': np.int64(730)}
2025-07-09 16:19:37,884 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 16:19:37,885 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(97), '17612': np.int64(521), '17904': np.int64(59), '18675': np.int64(730)}
2025-07-09 16:19:37,886 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 16:19:37,890 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 16:19:37,891 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 16:19:37,893 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 16:19:37,895 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 16:19:37,895 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58), '18675': np.int64(729)}
2025-07-09 16:19:37,895 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 16:19:37,896 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58), '18675': np.int64(729)}
2025-07-09 16:19:37,898 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:19:37,899 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:19:37,901 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:19:37,904 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:19:37,906 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58), '18675': np.int64(729)}
2025-07-09 16:19:37,906 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 16:19:37,906 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58), '18675': np.int64(729)}
2025-07-09 16:19:37,908 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:19:37,910 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:19:37,911 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:19:37,913 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:19:37,913 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58), '18675': np.int64(729)}
2025-07-09 16:19:37,913 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 16:19:37,913 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58), '18675': np.int64(729)}
2025-07-09 16:19:37,914 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 16:19:37,916 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:19:37,918 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 16:19:37,923 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 16:19:37,924 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:19:37,925 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(92), '17612': np.int64(800), '17904': np.int64(52), '18675': np.int64(729)}
2025-07-09 16:19:37,925 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 16:19:37,926 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(92), '17612': np.int64(800), '17904': np.int64(52), '18675': np.int64(729)}
2025-07-09 16:19:37,927 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 16:19:37,928 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 16:19:37,930 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 16:19:37,931 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 16:19:37,933 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:19:37,933 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(91), '17612': np.int64(758), '17904': np.int64(51), '18675': np.int64(729)}
2025-07-09 16:19:37,934 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 16:19:37,934 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(91), '17612': np.int64(758), '17904': np.int64(51), '18675': np.int64(729)}
2025-07-09 16:19:37,936 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 16:19:37,940 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 16:19:37,942 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 16:19:37,943 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 16:19:37,945 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:19:37,945 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(87), '17612': np.int64(585), '17904': np.int64(50), '18675': np.int64(729)}
2025-07-09 16:19:37,945 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 16:19:37,946 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(87), '17612': np.int64(585), '17904': np.int64(50), '18675': np.int64(729)}
2025-07-09 16:19:37,947 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 16:19:37,948 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 16:19:37,950 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 16:19:37,952 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 16:19:37,954 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:19:37,955 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(78), '17612': np.int64(525), '17904': np.int64(48), '18675': np.int64(729)}
2025-07-09 16:19:37,955 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 16:19:37,955 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(78), '17612': np.int64(525), '17904': np.int64(48), '18675': np.int64(729)}
2025-07-09 16:19:37,956 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 16:19:37,959 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 16:19:37,960 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 16:19:37,962 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 16:19:37,963 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:19:37,963 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45), '18675': np.int64(729)}
2025-07-09 16:19:37,964 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 16:19:37,964 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45), '18675': np.int64(729)}
2025-07-09 16:19:37,966 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:19:37,968 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:19:37,971 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:19:37,973 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:19:37,974 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45), '18675': np.int64(729)}
2025-07-09 16:19:37,974 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 16:19:37,974 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45), '18675': np.int64(729)}
2025-07-09 16:19:37,976 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:19:37,978 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:19:37,979 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:19:37,980 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:19:37,981 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45), '18675': np.int64(729)}
2025-07-09 16:19:37,981 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 16:19:37,981 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45), '18675': np.int64(729)}
2025-07-09 16:19:37,982 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 16:19:37,985 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 16:19:37,987 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 16:19:37,990 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 16:19:37,992 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:19:37,992 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(71), '17612': np.int64(390), '17904': np.int64(42), '18675': np.int64(729)}
2025-07-09 16:19:37,995 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
2  2025-06-01  17904            108            108
0  2025-06-01  17914            175            175
3  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-09 16:19:37,996 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
118  2025-06-30  17904             45             42
116  2025-06-30  17914             72             71
119  2025-06-30  18675            729            729
2025-07-09 16:19:37,996 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 16:19:37,997 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 16:19:37,998 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
2  2025-06-01  17904            108            108
0  2025-06-01  17914            175            175
3  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-09 16:19:37,999 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
118  2025-06-30  17904             45             42
116  2025-06-30  17914             72             71
119  2025-06-30  18675            729            729
2025-07-09 16:19:38,000 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 16:19:38,002 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 16:19:38,006 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01           1006
5    2025-06-02            935
9    2025-06-03            841
13   2025-06-04           1200
17   2025-06-05            904
21   2025-06-06            787
25   2025-06-07            787
29   2025-06-08            787
33   2025-06-09            740
37   2025-06-10            653
41   2025-06-11            586
45   2025-06-12            352
49   2025-06-13            269
53   2025-06-14            269
57   2025-06-15            269
61   2025-06-16            105
65   2025-06-17             49
69   2025-06-18            568
73   2025-06-19            521
77   2025-06-20            445
81   2025-06-21            445
85   2025-06-22            445
89   2025-06-23            800
93   2025-06-24            758
97   2025-06-25            585
101  2025-06-26            525
105  2025-06-27            474
109  2025-06-28            474
113  2025-06-29            474
117  2025-06-30            390
2025-07-09 16:19:38,008 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            108
6    2025-06-02            106
10   2025-06-03             93
14   2025-06-04             86
18   2025-06-05             85
22   2025-06-06             83
26   2025-06-07             83
30   2025-06-08             83
34   2025-06-09             81
38   2025-06-10             81
42   2025-06-11             80
46   2025-06-12             66
50   2025-06-13             65
54   2025-06-14             65
58   2025-06-15             65
62   2025-06-16             63
66   2025-06-17             62
70   2025-06-18             61
74   2025-06-19             59
78   2025-06-20             58
82   2025-06-21             58
86   2025-06-22             58
90   2025-06-23             52
94   2025-06-24             51
98   2025-06-25             50
102  2025-06-26             48
106  2025-06-27             45
110  2025-06-28             45
114  2025-06-29             45
118  2025-06-30             42
2025-07-09 16:19:38,021 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 16:19:38,030 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 16:19:38,033 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 16:19:38,036 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           21
5    2025-06-02           20
9    2025-06-03           18
13   2025-06-04           25
17   2025-06-05           19
21   2025-06-06           17
25   2025-06-07           17
29   2025-06-08           17
33   2025-06-09           16
37   2025-06-10           14
41   2025-06-11           13
45   2025-06-12            8
49   2025-06-13            6
53   2025-06-14            6
57   2025-06-15            6
61   2025-06-16            3
65   2025-06-17            2
69   2025-06-18           12
73   2025-06-19           11
77   2025-06-20           10
81   2025-06-21           10
85   2025-06-22           10
89   2025-06-23           17
93   2025-06-24           16
97   2025-06-25           13
101  2025-06-26           11
105  2025-06-27           10
109  2025-06-28           10
113  2025-06-29           10
117  2025-06-30            9
2025-07-09 16:19:38,040 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 16:19:38,042 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 16:19:38,042 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 16:19:38,044 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 16:19:38,048 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 16:19:38,050 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 16:19:38,051 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 16:19:38,064 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 16:19:38,065 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 16:21:09,626 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 16:21:09,628 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 16:21:10,043 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 16:21:10,043 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 16:21:10,043 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:21:10,044 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:21:10,057 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:21:10,290 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:21:10,291 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:21:10,293 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:21:10,293 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:21:10,316 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:21:10,492 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:21:10,496 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:21:10,848 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:10,991 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:10,993 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 16:21:11,257 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 16:21:11,259 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 16:21:11,262 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 16:21:11,262 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 16:21:11,263 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:21:11,263 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:21:11,265 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:21:11,528 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:21:11,530 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:21:11,531 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:21:11,531 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:21:11,555 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:21:11,699 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:21:11,702 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:21:11,973 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:12,098 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:12,100 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 16:21:12,382 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 16:21:12,383 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 16:21:12,385 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 16:21:12,386 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 16:21:12,386 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:21:12,387 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:21:12,389 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:21:12,691 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:21:12,693 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:21:12,694 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:21:12,695 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:21:12,717 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:21:12,869 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:21:12,870 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:21:13,202 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:13,333 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:13,336 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 16:21:13,611 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 16:21:13,613 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 16:21:13,616 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 16:21:13,616 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 16:21:13,619 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 16:21:13,620 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 16:21:13,621 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 16:21:13,621 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:21:13,621 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:21:13,624 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:21:13,871 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:21:13,874 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:21:13,875 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:21:13,876 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:21:13,900 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:21:14,069 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:21:14,072 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:21:14,268 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:14,396 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:14,399 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 16:21:14,561 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 16:21:14,566 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 16:21:14,571 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 16:21:14,573 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 16:21:14,578 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 16:21:14,579 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:21:14,580 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:21:14,584 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:21:14,839 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:21:14,842 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:21:14,843 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:21:14,844 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:21:14,866 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:21:15,011 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:21:15,014 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:21:15,225 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:15,342 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:15,343 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 16:21:15,488 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 16:21:15,493 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 16:21:15,496 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 16:21:15,496 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 16:21:15,498 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:21:15,499 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:21:15,502 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:21:15,736 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:21:15,738 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:21:15,739 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:21:15,740 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:21:15,760 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:21:15,918 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:21:15,920 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:21:16,160 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:16,275 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:16,278 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 16:21:16,481 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 16:21:16,485 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 16:21:16,491 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 16:21:16,492 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 16:21:16,497 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 16:21:16,499 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 16:21:16,499 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 16:21:16,501 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 16:21:16,504 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 16:21:16,505 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 16:21:16,507 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 16:21:16,507 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 16:21:16,508 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 16:21:16,509 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 16:21:16,509 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 16:21:16,511 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 16:21:16,513 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 16:21:16,514 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 16:21:16,515 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 16:21:16,518 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 16:21:16,520 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 16:21:16,521 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 16:21:16,523 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 16:21:16,523 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17612': np.int64(1006), '17904': np.int64(108), '17914': np.int64(175), '18675': np.int64(749)}
2025-07-09 16:21:16,524 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 16:21:16,526 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17612': np.int64(1006), '17904': np.int64(108), '17914': np.int64(175), '18675': np.int64(749)}
2025-07-09 16:21:16,527 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 16:21:16,529 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 16:21:16,532 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 16:21:16,533 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 16:21:16,536 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 16:21:16,536 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17612': np.int64(935), '17904': np.int64(106), '17914': np.int64(172), '18675': np.int64(748)}
2025-07-09 16:21:16,537 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 16:21:16,537 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17612': np.int64(935), '17904': np.int64(106), '17914': np.int64(172), '18675': np.int64(748)}
2025-07-09 16:21:16,539 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 16:21:16,541 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 16:21:16,542 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 16:21:16,544 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 16:21:16,546 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:21:16,547 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17612': np.int64(841), '17904': np.int64(93), '17914': np.int64(166), '18675': np.int64(748)}
2025-07-09 16:21:16,548 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 16:21:16,549 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17612': np.int64(841), '17904': np.int64(93), '17914': np.int64(166), '18675': np.int64(748)}
2025-07-09 16:21:16,550 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 16:21:16,553 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 16:21:16,554 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 16:21:16,556 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 16:21:16,558 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:21:16,558 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17612': np.int64(1200), '17904': np.int64(86), '17914': np.int64(159), '18675': np.int64(748)}
2025-07-09 16:21:16,559 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 16:21:16,560 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17612': np.int64(1200), '17904': np.int64(86), '17914': np.int64(159), '18675': np.int64(748)}
2025-07-09 16:21:16,563 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 16:21:16,564 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 16:21:16,566 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 16:21:16,570 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 16:21:16,573 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:21:16,573 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17612': np.int64(904), '17904': np.int64(85), '17914': np.int64(152), '18675': np.int64(748)}
2025-07-09 16:21:16,574 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 16:21:16,575 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17612': np.int64(904), '17904': np.int64(85), '17914': np.int64(152), '18675': np.int64(748)}
2025-07-09 16:21:16,577 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 16:21:16,580 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 16:21:16,582 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 16:21:16,586 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 16:21:16,589 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 16:21:16,590 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-09 16:21:16,590 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 16:21:16,591 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-09 16:21:16,594 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:21:16,597 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:21:16,599 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:21:16,601 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:21:16,602 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-09 16:21:16,603 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 16:21:16,603 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-09 16:21:16,606 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:21:16,607 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:21:16,610 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:21:16,612 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:21:16,612 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-09 16:21:16,612 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 16:21:16,613 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747)}
2025-07-09 16:21:16,613 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 16:21:16,615 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 16:21:16,616 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 16:21:16,620 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 16:21:16,622 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 16:21:16,623 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17612': np.int64(740), '17904': np.int64(81), '17914': np.int64(148), '18675': np.int64(746)}
2025-07-09 16:21:16,624 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 16:21:16,624 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17612': np.int64(740), '17904': np.int64(81), '17914': np.int64(148), '18675': np.int64(746)}
2025-07-09 16:21:16,626 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 16:21:16,629 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 16:21:16,630 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 16:21:16,631 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 16:21:16,633 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 16:21:16,633 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17612': np.int64(653), '17904': np.int64(81), '17914': np.int64(145), '18675': np.int64(746)}
2025-07-09 16:21:16,635 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 16:21:16,635 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17612': np.int64(653), '17904': np.int64(81), '17914': np.int64(145), '18675': np.int64(746)}
2025-07-09 16:21:16,636 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 16:21:16,638 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 16:21:16,639 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 16:21:16,642 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 16:21:16,646 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 16:21:16,646 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17612': np.int64(586), '17904': np.int64(80), '17914': np.int64(142), '18675': np.int64(745)}
2025-07-09 16:21:16,647 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 16:21:16,647 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17612': np.int64(586), '17904': np.int64(80), '17914': np.int64(142), '18675': np.int64(745)}
2025-07-09 16:21:16,648 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 16:21:16,651 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 16:21:16,654 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 16:21:16,655 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 16:21:16,658 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:21:16,658 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17612': np.int64(352), '17904': np.int64(66), '17914': np.int64(131), '18675': np.int64(745)}
2025-07-09 16:21:16,658 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 16:21:16,659 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17612': np.int64(352), '17904': np.int64(66), '17914': np.int64(131), '18675': np.int64(745)}
2025-07-09 16:21:16,661 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 16:21:16,663 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 16:21:16,665 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 16:21:16,666 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 16:21:16,669 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:21:16,670 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-09 16:21:16,670 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 16:21:16,671 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-09 16:21:16,673 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:21:16,675 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:21:16,678 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:21:16,679 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:21:16,680 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-09 16:21:16,680 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 16:21:16,680 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-09 16:21:16,683 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:21:16,686 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:21:16,688 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:21:16,689 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:21:16,689 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-09 16:21:16,689 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 16:21:16,690 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745)}
2025-07-09 16:21:16,691 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 16:21:16,693 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 16:21:16,695 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 16:21:16,696 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 16:21:16,699 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 16:21:16,699 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17612': np.int64(105), '17904': np.int64(63), '17914': np.int64(116), '18675': np.int64(742)}
2025-07-09 16:21:16,700 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 16:21:16,700 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17612': np.int64(105), '17904': np.int64(63), '17914': np.int64(116), '18675': np.int64(742)}
2025-07-09 16:21:16,701 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 16:21:16,703 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 16:21:16,705 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 16:21:16,706 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 16:21:16,708 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 16:21:16,708 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17612': np.int64(49), '17904': np.int64(62), '17914': np.int64(105), '18675': np.int64(730)}
2025-07-09 16:21:16,708 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 16:21:16,709 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17612': np.int64(49), '17904': np.int64(62), '17914': np.int64(105), '18675': np.int64(730)}
2025-07-09 16:21:16,710 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 16:21:16,712 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 16:21:16,714 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 16:21:16,716 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 16:21:16,719 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:21:16,720 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17612': np.int64(568), '17904': np.int64(61), '17914': np.int64(104), '18675': np.int64(730)}
2025-07-09 16:21:16,720 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 16:21:16,720 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17612': np.int64(568), '17904': np.int64(61), '17914': np.int64(104), '18675': np.int64(730)}
2025-07-09 16:21:16,721 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 16:21:16,722 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 16:21:16,724 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 16:21:16,725 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 16:21:16,728 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:21:16,728 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17612': np.int64(521), '17904': np.int64(59), '17914': np.int64(97), '18675': np.int64(730)}
2025-07-09 16:21:16,729 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 16:21:16,729 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17612': np.int64(521), '17904': np.int64(59), '17914': np.int64(97), '18675': np.int64(730)}
2025-07-09 16:21:16,730 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 16:21:16,731 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 16:21:16,733 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 16:21:16,735 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 16:21:16,736 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 16:21:16,737 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-09 16:21:16,737 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 16:21:16,737 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-09 16:21:16,739 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:21:16,740 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:21:16,742 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:21:16,743 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:21:16,745 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-09 16:21:16,745 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 16:21:16,745 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-09 16:21:16,747 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:21:16,749 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:21:16,750 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:21:16,752 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:21:16,753 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-09 16:21:16,753 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 16:21:16,753 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-09 16:21:16,754 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 16:21:16,756 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 16:21:16,758 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 16:21:16,761 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:21:16,762 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:21:16,762 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17612': np.int64(800), '17904': np.int64(52), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-09 16:21:16,763 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 16:21:16,763 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17612': np.int64(800), '17904': np.int64(52), '17914': np.int64(92), '18675': np.int64(729)}
2025-07-09 16:21:16,764 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 16:21:16,765 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 16:21:16,767 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 16:21:16,769 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 16:21:16,771 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:21:16,771 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17612': np.int64(758), '17904': np.int64(51), '17914': np.int64(91), '18675': np.int64(729)}
2025-07-09 16:21:16,771 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 16:21:16,771 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17612': np.int64(758), '17904': np.int64(51), '17914': np.int64(91), '18675': np.int64(729)}
2025-07-09 16:21:16,772 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 16:21:16,774 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 16:21:16,775 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 16:21:16,776 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 16:21:16,778 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:21:16,779 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17612': np.int64(585), '17904': np.int64(50), '17914': np.int64(87), '18675': np.int64(729)}
2025-07-09 16:21:16,780 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 16:21:16,780 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17612': np.int64(585), '17904': np.int64(50), '17914': np.int64(87), '18675': np.int64(729)}
2025-07-09 16:21:16,781 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 16:21:16,783 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 16:21:16,785 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 16:21:16,786 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 16:21:16,788 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:21:16,789 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17612': np.int64(525), '17904': np.int64(48), '17914': np.int64(78), '18675': np.int64(729)}
2025-07-09 16:21:16,789 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 16:21:16,790 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17612': np.int64(525), '17904': np.int64(48), '17914': np.int64(78), '18675': np.int64(729)}
2025-07-09 16:21:16,791 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 16:21:16,793 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 16:21:16,794 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 16:21:16,795 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 16:21:16,797 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:21:16,798 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-09 16:21:16,799 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 16:21:16,799 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-09 16:21:16,801 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:21:16,803 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:21:16,804 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:21:16,805 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:21:16,806 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-09 16:21:16,806 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 16:21:16,806 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-09 16:21:16,808 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:21:16,810 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:21:16,812 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:21:16,814 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:21:16,815 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-09 16:21:16,815 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 16:21:16,815 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729)}
2025-07-09 16:21:16,816 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 16:21:16,818 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 16:21:16,820 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 16:21:16,821 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 16:21:16,823 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:21:16,823 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17612': np.int64(390), '17904': np.int64(42), '17914': np.int64(71), '18675': np.int64(729)}
2025-07-09 16:21:16,825 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612           1006           1006
1  2025-06-01  17904            108            108
2  2025-06-01  17914            175            175
3  2025-06-01  18675            749            749
4  2025-06-02  17612           1006            935
2025-07-09 16:21:16,827 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            729            729
116  2025-06-30  17612            474            390
117  2025-06-30  17904             45             42
118  2025-06-30  17914             72             71
119  2025-06-30  18675            729            729
2025-07-09 16:21:16,827 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 16:21:16,828 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 16:21:16,829 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612           1006           1006
1  2025-06-01  17904            108            108
2  2025-06-01  17914            175            175
3  2025-06-01  18675            749            749
4  2025-06-02  17612           1006            935
2025-07-09 16:21:16,831 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
115  2025-06-29  18675            729            729
116  2025-06-30  17612            474            390
117  2025-06-30  17904             45             42
118  2025-06-30  17914             72             71
119  2025-06-30  18675            729            729
2025-07-09 16:21:16,831 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 16:21:16,832 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 16:21:16,834 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
0    2025-06-01           1006
4    2025-06-02            935
8    2025-06-03            841
12   2025-06-04           1200
16   2025-06-05            904
20   2025-06-06            787
24   2025-06-07            787
28   2025-06-08            787
32   2025-06-09            740
36   2025-06-10            653
40   2025-06-11            586
44   2025-06-12            352
48   2025-06-13            269
52   2025-06-14            269
56   2025-06-15            269
60   2025-06-16            105
64   2025-06-17             49
68   2025-06-18            568
72   2025-06-19            521
76   2025-06-20            445
80   2025-06-21            445
84   2025-06-22            445
88   2025-06-23            800
92   2025-06-24            758
96   2025-06-25            585
100  2025-06-26            525
104  2025-06-27            474
108  2025-06-28            474
112  2025-06-29            474
116  2025-06-30            390
2025-07-09 16:21:16,836 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            108
5    2025-06-02            106
9    2025-06-03             93
13   2025-06-04             86
17   2025-06-05             85
21   2025-06-06             83
25   2025-06-07             83
29   2025-06-08             83
33   2025-06-09             81
37   2025-06-10             81
41   2025-06-11             80
45   2025-06-12             66
49   2025-06-13             65
53   2025-06-14             65
57   2025-06-15             65
61   2025-06-16             63
65   2025-06-17             62
69   2025-06-18             61
73   2025-06-19             59
77   2025-06-20             58
81   2025-06-21             58
85   2025-06-22             58
89   2025-06-23             52
93   2025-06-24             51
97   2025-06-25             50
101  2025-06-26             48
105  2025-06-27             45
109  2025-06-28             45
113  2025-06-29             45
117  2025-06-30             42
2025-07-09 16:21:16,843 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 16:21:16,848 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 16:21:16,850 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 16:21:16,852 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
0    2025-06-01           21
4    2025-06-02           20
8    2025-06-03           18
12   2025-06-04           25
16   2025-06-05           19
20   2025-06-06           17
24   2025-06-07           17
28   2025-06-08           17
32   2025-06-09           16
36   2025-06-10           14
40   2025-06-11           13
44   2025-06-12            8
48   2025-06-13            6
52   2025-06-14            6
56   2025-06-15            6
60   2025-06-16            3
64   2025-06-17            2
68   2025-06-18           12
72   2025-06-19           11
76   2025-06-20           10
80   2025-06-21           10
84   2025-06-22           10
88   2025-06-23           17
92   2025-06-24           16
96   2025-06-25           13
100  2025-06-26           11
104  2025-06-27           10
108  2025-06-28           10
112  2025-06-29           10
116  2025-06-30            9
2025-07-09 16:21:16,853 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 16:21:16,854 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 16:21:16,854 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 16:21:16,854 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 16:21:16,856 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 16:21:16,856 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 16:21:16,858 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 16:21:16,862 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 16:21:16,862 - __main__ - WARNING - monthly_totals_df was None. Skipping concatenation of monthly totals in shipstation_reporter.py.
2025-07-09 16:21:16,863 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:21:16,864 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:21:16,866 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:21:17,115 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:21:17,117 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:21:17,118 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:21:17,120 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 16:21:17,143 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:21:17,288 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:21:17,292 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:21:17,514 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:17,636 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:17,821 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 16:21:17,993 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 16:21:17,998 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 16:21:18,163 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 16:21:18,166 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 16:21:18,168 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 16:21:18,171 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 16:21:18,173 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory...
2025-07-09 16:21:18,259 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 16:21:18,260 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 16:21:18,264 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 16:21:18,267 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 16:21:18,270 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 16:21:18,271 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 16:21:18,279 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:21:18,280 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:21:18,284 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:21:18,531 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:21:18,534 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:21:18,534 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:21:18,536 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 16:21:18,598 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:21:18,766 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:21:18,770 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:21:19,040 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:19,243 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:21:19,469 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 16:21:19,653 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 16:21:19,654 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 16:21:19,830 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 16:21:19,831 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 16:21:19,831 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 16:21:19,832 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 16:21:19,833 - __main__ - INFO - Script finished successfully.
2025-07-09 16:27:48,802 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 16:27:48,803 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 16:27:49,431 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 16:27:49,434 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 16:27:49,436 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:27:49,436 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:27:49,454 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:27:49,800 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:27:49,803 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:27:49,805 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:27:49,805 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:27:49,828 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:27:50,013 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:27:50,015 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:27:50,401 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:50,562 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:50,564 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 16:27:50,713 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 16:27:50,715 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 16:27:50,721 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 16:27:50,722 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 16:27:50,723 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:27:50,723 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:27:50,726 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:27:50,984 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:27:50,985 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:27:50,985 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:27:50,986 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:27:51,008 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:27:51,188 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:27:51,191 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:27:51,424 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:51,551 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:51,554 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 16:27:51,745 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 16:27:51,748 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 16:27:51,752 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 16:27:51,753 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 16:27:51,757 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 16:27:51,758 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 16:27:51,759 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 16:27:51,760 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:27:51,760 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:27:51,764 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:27:51,989 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:27:51,994 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:27:51,994 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:27:51,995 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:27:52,020 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:27:52,174 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:27:52,177 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:27:52,386 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:52,506 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:52,507 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 16:27:52,667 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 16:27:52,673 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 16:27:52,677 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 16:27:52,678 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 16:27:52,678 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 16:27:52,679 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:27:52,679 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:27:52,682 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:27:52,927 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:27:52,928 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:27:52,929 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:27:52,929 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:27:52,951 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:27:53,113 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:27:53,115 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:27:53,367 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:53,494 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:53,495 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 16:27:53,691 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 16:27:53,697 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 16:27:53,702 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 16:27:53,702 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 16:27:53,703 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:27:53,703 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:27:53,706 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:27:53,937 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:27:53,939 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:27:53,940 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:27:53,940 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:27:53,960 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:27:54,104 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:27:54,106 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:27:54,408 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:54,531 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:54,532 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 16:27:54,715 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 16:27:54,719 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 16:27:54,729 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 16:27:54,730 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 16:27:54,730 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:27:54,731 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:27:54,733 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:27:55,024 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:27:55,027 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:27:55,028 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:27:55,029 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:27:55,051 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:27:55,206 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:27:55,209 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:27:55,501 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:55,632 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:55,633 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 16:27:55,782 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 16:27:55,785 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 16:27:55,787 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 16:27:55,788 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 16:27:55,789 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 16:27:55,796 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 16:27:55,798 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 16:27:55,798 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 16:27:55,799 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 16:27:55,801 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 16:27:55,802 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 16:27:55,807 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 16:27:55,807 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 16:27:55,808 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 16:27:55,808 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 16:27:55,809 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 16:27:55,811 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 16:27:55,812 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17904': 108, '17914': 175, '18675': 749, '17612': 1006}
2025-07-09 16:27:55,812 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 16:27:55,812 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17904': 108, '17914': 175, '18675': 749, '17612': 1006}
2025-07-09 16:27:55,815 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 16:27:55,817 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 16:27:55,819 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 16:27:55,823 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 16:27:55,823 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17904': np.int64(108), '17914': np.int64(175), '18675': np.int64(749), '17612': np.int64(1006)}
2025-07-09 16:27:55,823 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 16:27:55,824 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17904': np.int64(108), '17914': np.int64(175), '18675': np.int64(749), '17612': np.int64(1006)}
2025-07-09 16:27:55,826 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 16:27:55,828 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 16:27:55,831 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 16:27:55,833 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 16:27:55,835 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 16:27:55,835 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17904': np.int64(106), '17914': np.int64(172), '18675': np.int64(748), '17612': np.int64(935)}
2025-07-09 16:27:55,836 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 16:27:55,836 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17904': np.int64(106), '17914': np.int64(172), '18675': np.int64(748), '17612': np.int64(935)}
2025-07-09 16:27:55,837 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 16:27:55,840 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 16:27:55,842 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 16:27:55,843 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:27:55,845 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 16:27:55,846 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17904': np.int64(93), '17914': np.int64(166), '18675': np.int64(748), '17612': np.int64(841)}
2025-07-09 16:27:55,846 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 16:27:55,846 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17904': np.int64(93), '17914': np.int64(166), '18675': np.int64(748), '17612': np.int64(841)}
2025-07-09 16:27:55,847 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 16:27:55,849 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 16:27:55,852 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 16:27:55,854 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:27:55,855 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 16:27:55,856 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17904': np.int64(86), '17914': np.int64(159), '18675': np.int64(748), '17612': np.int64(1200)}
2025-07-09 16:27:55,856 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 16:27:55,857 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17904': np.int64(86), '17914': np.int64(159), '18675': np.int64(748), '17612': np.int64(1200)}
2025-07-09 16:27:55,858 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 16:27:55,859 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 16:27:55,861 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 16:27:55,862 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:27:55,864 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 16:27:55,864 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17904': np.int64(85), '17914': np.int64(152), '18675': np.int64(748), '17612': np.int64(904)}
2025-07-09 16:27:55,864 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 16:27:55,865 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17904': np.int64(85), '17914': np.int64(152), '18675': np.int64(748), '17612': np.int64(904)}
2025-07-09 16:27:55,866 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 16:27:55,868 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 16:27:55,870 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 16:27:55,872 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 16:27:55,873 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 16:27:55,874 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 16:27:55,874 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 16:27:55,874 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 16:27:55,877 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:27:55,878 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:27:55,880 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:27:55,881 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:27:55,882 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 16:27:55,882 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 16:27:55,883 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 16:27:55,885 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:27:55,887 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:27:55,889 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:27:55,890 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:27:55,891 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 16:27:55,891 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 16:27:55,891 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 16:27:55,892 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 16:27:55,894 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 16:27:55,896 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 16:27:55,897 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 16:27:55,899 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 16:27:55,900 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17904': np.int64(81), '17914': np.int64(148), '18675': np.int64(746), '17612': np.int64(740)}
2025-07-09 16:27:55,900 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 16:27:55,900 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17904': np.int64(81), '17914': np.int64(148), '18675': np.int64(746), '17612': np.int64(740)}
2025-07-09 16:27:55,902 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 16:27:55,904 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 16:27:55,906 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 16:27:55,908 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 16:27:55,909 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 16:27:55,910 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17904': np.int64(81), '17914': np.int64(145), '18675': np.int64(746), '17612': np.int64(653)}
2025-07-09 16:27:55,910 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 16:27:55,911 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17904': np.int64(81), '17914': np.int64(145), '18675': np.int64(746), '17612': np.int64(653)}
2025-07-09 16:27:55,912 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 16:27:55,913 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 16:27:55,915 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 16:27:55,916 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 16:27:55,918 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 16:27:55,919 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17904': np.int64(80), '17914': np.int64(142), '18675': np.int64(745), '17612': np.int64(586)}
2025-07-09 16:27:55,919 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 16:27:55,920 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17904': np.int64(80), '17914': np.int64(142), '18675': np.int64(745), '17612': np.int64(586)}
2025-07-09 16:27:55,921 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 16:27:55,923 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 16:27:55,925 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 16:27:55,926 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:27:55,927 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 16:27:55,928 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17904': np.int64(66), '17914': np.int64(131), '18675': np.int64(745), '17612': np.int64(352)}
2025-07-09 16:27:55,929 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 16:27:55,929 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17904': np.int64(66), '17914': np.int64(131), '18675': np.int64(745), '17612': np.int64(352)}
2025-07-09 16:27:55,930 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 16:27:55,932 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 16:27:55,934 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 16:27:55,937 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:27:55,939 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 16:27:55,939 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 16:27:55,939 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 16:27:55,940 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 16:27:55,941 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:27:55,943 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:27:55,945 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:27:55,946 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:27:55,947 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 16:27:55,947 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 16:27:55,947 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 16:27:55,950 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:27:55,952 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:27:55,954 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:27:55,956 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:27:55,956 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 16:27:55,957 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 16:27:55,957 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 16:27:55,958 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 16:27:55,960 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 16:27:55,962 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 16:27:55,963 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 16:27:55,965 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 16:27:55,965 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17904': np.int64(63), '17914': np.int64(116), '18675': np.int64(742), '17612': np.int64(105)}
2025-07-09 16:27:55,966 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 16:27:55,966 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17904': np.int64(63), '17914': np.int64(116), '18675': np.int64(742), '17612': np.int64(105)}
2025-07-09 16:27:55,968 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 16:27:55,971 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 16:27:55,973 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 16:27:55,974 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 16:27:55,976 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 16:27:55,976 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17904': np.int64(62), '17914': np.int64(105), '18675': np.int64(730), '17612': np.int64(49)}
2025-07-09 16:27:55,977 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 16:27:55,977 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17904': np.int64(62), '17914': np.int64(105), '18675': np.int64(730), '17612': np.int64(49)}
2025-07-09 16:27:55,978 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 16:27:55,980 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 16:27:55,981 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 16:27:55,983 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:27:55,985 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 16:27:55,986 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17904': np.int64(61), '17914': np.int64(104), '18675': np.int64(730), '17612': np.int64(568)}
2025-07-09 16:27:55,987 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 16:27:55,987 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17904': np.int64(61), '17914': np.int64(104), '18675': np.int64(730), '17612': np.int64(568)}
2025-07-09 16:27:55,988 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 16:27:55,989 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 16:27:55,991 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 16:27:55,992 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:27:55,994 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 16:27:55,994 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17904': np.int64(59), '17914': np.int64(97), '18675': np.int64(730), '17612': np.int64(521)}
2025-07-09 16:27:55,995 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 16:27:55,995 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17904': np.int64(59), '17914': np.int64(97), '18675': np.int64(730), '17612': np.int64(521)}
2025-07-09 16:27:55,996 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 16:27:55,998 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 16:27:56,000 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 16:27:56,002 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 16:27:56,005 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 16:27:56,005 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 16:27:56,006 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 16:27:56,006 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 16:27:56,008 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:27:56,009 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:27:56,011 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:27:56,012 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:27:56,012 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 16:27:56,012 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 16:27:56,013 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 16:27:56,015 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:27:56,017 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:27:56,019 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:27:56,021 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:27:56,021 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 16:27:56,021 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 16:27:56,022 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 16:27:56,022 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 16:27:56,024 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 16:27:56,026 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:27:56,027 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:27:56,028 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 16:27:56,029 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17904': np.int64(52), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(800)}
2025-07-09 16:27:56,029 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 16:27:56,030 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17904': np.int64(52), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(800)}
2025-07-09 16:27:56,031 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 16:27:56,033 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 16:27:56,034 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 16:27:56,038 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:27:56,040 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 16:27:56,041 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17904': np.int64(51), '17914': np.int64(91), '18675': np.int64(729), '17612': np.int64(758)}
2025-07-09 16:27:56,041 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 16:27:56,042 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17904': np.int64(51), '17914': np.int64(91), '18675': np.int64(729), '17612': np.int64(758)}
2025-07-09 16:27:56,043 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 16:27:56,045 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 16:27:56,046 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 16:27:56,048 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:27:56,050 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 16:27:56,051 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17904': np.int64(50), '17914': np.int64(87), '18675': np.int64(729), '17612': np.int64(585)}
2025-07-09 16:27:56,051 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 16:27:56,052 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17904': np.int64(50), '17914': np.int64(87), '18675': np.int64(729), '17612': np.int64(585)}
2025-07-09 16:27:56,053 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 16:27:56,055 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 16:27:56,057 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 16:27:56,058 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:27:56,060 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 16:27:56,061 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17904': np.int64(48), '17914': np.int64(78), '18675': np.int64(729), '17612': np.int64(525)}
2025-07-09 16:27:56,061 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 16:27:56,061 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17904': np.int64(48), '17914': np.int64(78), '18675': np.int64(729), '17612': np.int64(525)}
2025-07-09 16:27:56,063 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 16:27:56,065 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 16:27:56,072 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 16:27:56,076 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:27:56,079 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 16:27:56,080 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 16:27:56,080 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 16:27:56,081 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 16:27:56,086 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:27:56,089 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:27:56,092 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:27:56,095 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:27:56,096 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 16:27:56,096 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 16:27:56,097 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 16:27:56,100 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:27:56,102 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:27:56,104 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:27:56,107 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:27:56,108 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 16:27:56,108 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 16:27:56,113 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 16:27:56,115 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 16:27:56,119 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 16:27:56,123 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 16:27:56,125 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:27:56,127 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 16:27:56,128 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17904': np.int64(42), '17914': np.int64(71), '18675': np.int64(729), '17612': np.int64(390)}
2025-07-09 16:27:56,131 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612           1006           1006
0  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
7  2025-06-02  17612           1006            935
2025-07-09 16:27:56,133 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
119  2025-06-30  17612            474            390
116  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-09 16:27:56,134 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 16:27:56,135 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 16:27:56,137 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612           1006           1006
0  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
7  2025-06-02  17612           1006            935
2025-07-09 16:27:56,138 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
119  2025-06-30  17612            474            390
116  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-09 16:27:56,139 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 16:27:56,141 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 16:27:56,144 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01           1006
7    2025-06-02            935
11   2025-06-03            841
15   2025-06-04           1200
19   2025-06-05            904
23   2025-06-06            787
27   2025-06-07            787
31   2025-06-08            787
35   2025-06-09            740
39   2025-06-10            653
43   2025-06-11            586
47   2025-06-12            352
51   2025-06-13            269
55   2025-06-14            269
59   2025-06-15            269
63   2025-06-16            105
67   2025-06-17             49
71   2025-06-18            568
75   2025-06-19            521
79   2025-06-20            445
83   2025-06-21            445
87   2025-06-22            445
91   2025-06-23            800
95   2025-06-24            758
99   2025-06-25            585
103  2025-06-26            525
107  2025-06-27            474
111  2025-06-28            474
115  2025-06-29            474
119  2025-06-30            390
2025-07-09 16:27:56,146 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
0    2025-06-01            108
4    2025-06-02            106
8    2025-06-03             93
12   2025-06-04             86
16   2025-06-05             85
20   2025-06-06             83
24   2025-06-07             83
28   2025-06-08             83
32   2025-06-09             81
36   2025-06-10             81
40   2025-06-11             80
44   2025-06-12             66
48   2025-06-13             65
52   2025-06-14             65
56   2025-06-15             65
60   2025-06-16             63
64   2025-06-17             62
68   2025-06-18             61
72   2025-06-19             59
76   2025-06-20             58
80   2025-06-21             58
84   2025-06-22             58
88   2025-06-23             52
92   2025-06-24             51
96   2025-06-25             50
100  2025-06-26             48
104  2025-06-27             45
108  2025-06-28             45
112  2025-06-29             45
116  2025-06-30             42
2025-07-09 16:27:56,153 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 16:27:56,158 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 16:27:56,160 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 16:27:56,162 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           21
7    2025-06-02           20
11   2025-06-03           18
15   2025-06-04           25
19   2025-06-05           19
23   2025-06-06           17
27   2025-06-07           17
31   2025-06-08           17
35   2025-06-09           16
39   2025-06-10           14
43   2025-06-11           13
47   2025-06-12            8
51   2025-06-13            6
55   2025-06-14            6
59   2025-06-15            6
63   2025-06-16            3
67   2025-06-17            2
71   2025-06-18           12
75   2025-06-19           11
79   2025-06-20           10
83   2025-06-21           10
87   2025-06-22           10
91   2025-06-23           17
95   2025-06-24           16
99   2025-06-25           13
103  2025-06-26           11
107  2025-06-27           10
111  2025-06-28           10
115  2025-06-29           10
119  2025-06-30            9
2025-07-09 16:27:56,163 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 16:27:56,164 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 16:27:56,164 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 16:27:56,165 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 16:27:56,166 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 16:27:56,167 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 16:27:56,168 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 16:27:56,174 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 16:27:56,175 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 16:27:56,175 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:27:56,175 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:27:56,177 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:27:56,471 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:27:56,474 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:27:56,476 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:27:56,476 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 16:27:56,499 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:27:56,663 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:27:56,666 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:27:56,865 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:56,995 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:27:57,147 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 16:27:57,329 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 16:27:57,332 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 16:27:57,496 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 16:27:57,499 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 16:27:57,501 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 16:27:57,503 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 16:27:57,503 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 16:34:55,204 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 16:34:55,205 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 16:34:55,681 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 16:34:55,681 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 16:34:55,682 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:34:55,682 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:34:55,695 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:34:55,985 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:34:55,986 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:34:55,986 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:34:55,987 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:34:56,010 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:34:56,178 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:34:56,180 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:34:56,605 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:34:56,721 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:34:56,722 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 16:34:56,879 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 16:34:56,884 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 16:34:56,891 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 16:34:56,891 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 16:34:56,892 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:34:56,893 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:34:56,896 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:34:57,157 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:34:57,158 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:34:57,159 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:34:57,160 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:34:57,189 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:34:57,342 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:34:57,346 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:34:57,539 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:34:57,650 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:34:57,652 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 16:34:57,833 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 16:34:57,835 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 16:34:57,837 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 16:34:57,837 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 16:34:57,839 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 16:34:57,840 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 16:34:57,841 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 16:34:57,841 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:34:57,842 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:34:57,845 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:34:58,095 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:34:58,099 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:34:58,101 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:34:58,102 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:34:58,125 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:34:58,285 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:34:58,288 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:34:58,501 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:34:58,610 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:34:58,613 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 16:34:58,765 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 16:34:58,770 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 16:34:58,773 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 16:34:58,775 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 16:34:58,775 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 16:34:58,775 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:34:58,776 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:34:58,779 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:34:59,011 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:34:59,013 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:34:59,014 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:34:59,015 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:34:59,038 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:34:59,200 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:34:59,202 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:34:59,472 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:34:59,590 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:34:59,591 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 16:34:59,762 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 16:34:59,768 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 16:34:59,771 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 16:34:59,771 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 16:34:59,772 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:34:59,772 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:34:59,776 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:35:00,004 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:35:00,006 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:35:00,007 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:35:00,009 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:35:00,035 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:35:00,186 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:35:00,188 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:35:00,422 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:35:00,551 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:35:00,552 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 16:35:00,717 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 16:35:00,718 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 16:35:00,726 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 16:35:00,726 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 16:35:00,727 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:35:00,727 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:35:00,730 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:35:00,972 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:35:00,974 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:35:00,974 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:35:00,975 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:35:00,998 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:35:01,161 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:35:01,163 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:35:01,417 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:35:01,690 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:35:01,691 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 16:35:01,838 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 16:35:01,841 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 16:35:01,842 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 16:35:01,844 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 16:35:01,845 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 16:35:01,853 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 16:35:01,855 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 16:35:01,856 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 16:35:01,859 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 16:35:01,859 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 16:35:01,861 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 16:35:01,863 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 16:35:01,863 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 16:35:01,863 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 16:35:01,865 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 16:35:01,866 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 16:35:01,869 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 16:35:01,870 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'18675': 749, '17904': 108, '17612': 1006, '17914': 175}
2025-07-09 16:35:01,871 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 16:35:01,872 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'18675': 749, '17904': 108, '17612': 1006, '17914': 175}
2025-07-09 16:35:01,874 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 16:35:01,876 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 16:35:01,878 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 16:35:01,879 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 16:35:01,880 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'18675': np.int64(749), '17904': np.int64(108), '17612': np.int64(1006), '17914': np.int64(175)}
2025-07-09 16:35:01,881 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 16:35:01,881 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'18675': np.int64(749), '17904': np.int64(108), '17612': np.int64(1006), '17914': np.int64(175)}
2025-07-09 16:35:01,883 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 16:35:01,886 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 16:35:01,888 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 16:35:01,891 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 16:35:01,892 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 16:35:01,893 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'18675': np.int64(748), '17904': np.int64(106), '17612': np.int64(935), '17914': np.int64(172)}
2025-07-09 16:35:01,894 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 16:35:01,895 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'18675': np.int64(748), '17904': np.int64(106), '17612': np.int64(935), '17914': np.int64(172)}
2025-07-09 16:35:01,896 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 16:35:01,898 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:35:01,901 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 16:35:01,903 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 16:35:01,906 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 16:35:01,907 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'18675': np.int64(748), '17904': np.int64(93), '17612': np.int64(841), '17914': np.int64(166)}
2025-07-09 16:35:01,908 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 16:35:01,908 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'18675': np.int64(748), '17904': np.int64(93), '17612': np.int64(841), '17914': np.int64(166)}
2025-07-09 16:35:01,909 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 16:35:01,912 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:35:01,913 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 16:35:01,917 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 16:35:01,921 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 16:35:01,922 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'18675': np.int64(748), '17904': np.int64(86), '17612': np.int64(1200), '17914': np.int64(159)}
2025-07-09 16:35:01,922 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 16:35:01,923 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'18675': np.int64(748), '17904': np.int64(86), '17612': np.int64(1200), '17914': np.int64(159)}
2025-07-09 16:35:01,924 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 16:35:01,926 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:35:01,927 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 16:35:01,929 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 16:35:01,930 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 16:35:01,931 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'18675': np.int64(748), '17904': np.int64(85), '17612': np.int64(904), '17914': np.int64(152)}
2025-07-09 16:35:01,931 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 16:35:01,932 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'18675': np.int64(748), '17904': np.int64(85), '17612': np.int64(904), '17914': np.int64(152)}
2025-07-09 16:35:01,936 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 16:35:01,938 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 16:35:01,939 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 16:35:01,941 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 16:35:01,942 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 16:35:01,942 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'18675': np.int64(747), '17904': np.int64(83), '17612': np.int64(787), '17914': np.int64(151)}
2025-07-09 16:35:01,943 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 16:35:01,943 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'18675': np.int64(747), '17904': np.int64(83), '17612': np.int64(787), '17914': np.int64(151)}
2025-07-09 16:35:01,945 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:35:01,946 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:35:01,947 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:35:01,949 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:35:01,950 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'18675': np.int64(747), '17904': np.int64(83), '17612': np.int64(787), '17914': np.int64(151)}
2025-07-09 16:35:01,950 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 16:35:01,951 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'18675': np.int64(747), '17904': np.int64(83), '17612': np.int64(787), '17914': np.int64(151)}
2025-07-09 16:35:01,955 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:35:01,956 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:35:01,958 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:35:01,960 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:35:01,961 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'18675': np.int64(747), '17904': np.int64(83), '17612': np.int64(787), '17914': np.int64(151)}
2025-07-09 16:35:01,961 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 16:35:01,962 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'18675': np.int64(747), '17904': np.int64(83), '17612': np.int64(787), '17914': np.int64(151)}
2025-07-09 16:35:01,963 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 16:35:01,966 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 16:35:01,968 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 16:35:01,970 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 16:35:01,971 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 16:35:01,971 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'18675': np.int64(746), '17904': np.int64(81), '17612': np.int64(740), '17914': np.int64(148)}
2025-07-09 16:35:01,972 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 16:35:01,972 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'18675': np.int64(746), '17904': np.int64(81), '17612': np.int64(740), '17914': np.int64(148)}
2025-07-09 16:35:01,973 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 16:35:01,975 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 16:35:01,976 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 16:35:01,977 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 16:35:01,979 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 16:35:01,979 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'18675': np.int64(746), '17904': np.int64(81), '17612': np.int64(653), '17914': np.int64(145)}
2025-07-09 16:35:01,980 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 16:35:01,980 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'18675': np.int64(746), '17904': np.int64(81), '17612': np.int64(653), '17914': np.int64(145)}
2025-07-09 16:35:01,981 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 16:35:01,982 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 16:35:01,985 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 16:35:01,987 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 16:35:01,988 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 16:35:01,989 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'18675': np.int64(745), '17904': np.int64(80), '17612': np.int64(586), '17914': np.int64(142)}
2025-07-09 16:35:01,989 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 16:35:01,989 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'18675': np.int64(745), '17904': np.int64(80), '17612': np.int64(586), '17914': np.int64(142)}
2025-07-09 16:35:01,990 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 16:35:01,991 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:35:01,993 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 16:35:01,994 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 16:35:01,995 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 16:35:01,996 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'18675': np.int64(745), '17904': np.int64(66), '17612': np.int64(352), '17914': np.int64(131)}
2025-07-09 16:35:01,996 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 16:35:01,996 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'18675': np.int64(745), '17904': np.int64(66), '17612': np.int64(352), '17914': np.int64(131)}
2025-07-09 16:35:01,998 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 16:35:02,000 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:35:02,003 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 16:35:02,005 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 16:35:02,007 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 16:35:02,007 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'18675': np.int64(745), '17904': np.int64(65), '17612': np.int64(269), '17914': np.int64(119)}
2025-07-09 16:35:02,007 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 16:35:02,008 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'18675': np.int64(745), '17904': np.int64(65), '17612': np.int64(269), '17914': np.int64(119)}
2025-07-09 16:35:02,010 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:35:02,011 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:35:02,013 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:35:02,014 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:35:02,015 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'18675': np.int64(745), '17904': np.int64(65), '17612': np.int64(269), '17914': np.int64(119)}
2025-07-09 16:35:02,015 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 16:35:02,016 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'18675': np.int64(745), '17904': np.int64(65), '17612': np.int64(269), '17914': np.int64(119)}
2025-07-09 16:35:02,019 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:35:02,021 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:35:02,022 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:35:02,024 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:35:02,024 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'18675': np.int64(745), '17904': np.int64(65), '17612': np.int64(269), '17914': np.int64(119)}
2025-07-09 16:35:02,025 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 16:35:02,025 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'18675': np.int64(745), '17904': np.int64(65), '17612': np.int64(269), '17914': np.int64(119)}
2025-07-09 16:35:02,026 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 16:35:02,027 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 16:35:02,029 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 16:35:02,030 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 16:35:02,032 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 16:35:02,032 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'18675': np.int64(742), '17904': np.int64(63), '17612': np.int64(105), '17914': np.int64(116)}
2025-07-09 16:35:02,033 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 16:35:02,033 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'18675': np.int64(742), '17904': np.int64(63), '17612': np.int64(105), '17914': np.int64(116)}
2025-07-09 16:35:02,036 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 16:35:02,038 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 16:35:02,040 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 16:35:02,041 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 16:35:02,042 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 16:35:02,043 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'18675': np.int64(730), '17904': np.int64(62), '17612': np.int64(49), '17914': np.int64(105)}
2025-07-09 16:35:02,043 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 16:35:02,044 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'18675': np.int64(730), '17904': np.int64(62), '17612': np.int64(49), '17914': np.int64(105)}
2025-07-09 16:35:02,045 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 16:35:02,046 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:35:02,048 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 16:35:02,050 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 16:35:02,052 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 16:35:02,054 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'18675': np.int64(730), '17904': np.int64(61), '17612': np.int64(568), '17914': np.int64(104)}
2025-07-09 16:35:02,054 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 16:35:02,054 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'18675': np.int64(730), '17904': np.int64(61), '17612': np.int64(568), '17914': np.int64(104)}
2025-07-09 16:35:02,055 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 16:35:02,057 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:35:02,058 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 16:35:02,060 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 16:35:02,062 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 16:35:02,062 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'18675': np.int64(730), '17904': np.int64(59), '17612': np.int64(521), '17914': np.int64(97)}
2025-07-09 16:35:02,062 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 16:35:02,063 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'18675': np.int64(730), '17904': np.int64(59), '17612': np.int64(521), '17914': np.int64(97)}
2025-07-09 16:35:02,063 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 16:35:02,064 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 16:35:02,067 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 16:35:02,071 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 16:35:02,071 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 16:35:02,071 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'18675': np.int64(729), '17904': np.int64(58), '17612': np.int64(445), '17914': np.int64(92)}
2025-07-09 16:35:02,072 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 16:35:02,072 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'18675': np.int64(729), '17904': np.int64(58), '17612': np.int64(445), '17914': np.int64(92)}
2025-07-09 16:35:02,075 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:35:02,076 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:35:02,077 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:35:02,079 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:35:02,079 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'18675': np.int64(729), '17904': np.int64(58), '17612': np.int64(445), '17914': np.int64(92)}
2025-07-09 16:35:02,079 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 16:35:02,080 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'18675': np.int64(729), '17904': np.int64(58), '17612': np.int64(445), '17914': np.int64(92)}
2025-07-09 16:35:02,081 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:35:02,083 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:35:02,086 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:35:02,088 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:35:02,088 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'18675': np.int64(729), '17904': np.int64(58), '17612': np.int64(445), '17914': np.int64(92)}
2025-07-09 16:35:02,089 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 16:35:02,089 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'18675': np.int64(729), '17904': np.int64(58), '17612': np.int64(445), '17914': np.int64(92)}
2025-07-09 16:35:02,091 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 16:35:02,092 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:35:02,093 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 16:35:02,094 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 16:35:02,095 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:35:02,096 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'18675': np.int64(729), '17904': np.int64(52), '17612': np.int64(800), '17914': np.int64(92)}
2025-07-09 16:35:02,096 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 16:35:02,096 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'18675': np.int64(729), '17904': np.int64(52), '17612': np.int64(800), '17914': np.int64(92)}
2025-07-09 16:35:02,097 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 16:35:02,100 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:35:02,103 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 16:35:02,105 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 16:35:02,106 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 16:35:02,107 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'18675': np.int64(729), '17904': np.int64(51), '17612': np.int64(758), '17914': np.int64(91)}
2025-07-09 16:35:02,107 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 16:35:02,107 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'18675': np.int64(729), '17904': np.int64(51), '17612': np.int64(758), '17914': np.int64(91)}
2025-07-09 16:35:02,108 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 16:35:02,109 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:35:02,111 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 16:35:02,112 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 16:35:02,114 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 16:35:02,114 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'18675': np.int64(729), '17904': np.int64(50), '17612': np.int64(585), '17914': np.int64(87)}
2025-07-09 16:35:02,114 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 16:35:02,115 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'18675': np.int64(729), '17904': np.int64(50), '17612': np.int64(585), '17914': np.int64(87)}
2025-07-09 16:35:02,117 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 16:35:02,119 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:35:02,121 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 16:35:02,122 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 16:35:02,123 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 16:35:02,124 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'18675': np.int64(729), '17904': np.int64(48), '17612': np.int64(525), '17914': np.int64(78)}
2025-07-09 16:35:02,124 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 16:35:02,124 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'18675': np.int64(729), '17904': np.int64(48), '17612': np.int64(525), '17914': np.int64(78)}
2025-07-09 16:35:02,125 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 16:35:02,126 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:35:02,128 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 16:35:02,129 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 16:35:02,130 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 16:35:02,131 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'18675': np.int64(729), '17904': np.int64(45), '17612': np.int64(474), '17914': np.int64(72)}
2025-07-09 16:35:02,131 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 16:35:02,131 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'18675': np.int64(729), '17904': np.int64(45), '17612': np.int64(474), '17914': np.int64(72)}
2025-07-09 16:35:02,134 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:35:02,136 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:35:02,138 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:35:02,139 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:35:02,139 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'18675': np.int64(729), '17904': np.int64(45), '17612': np.int64(474), '17914': np.int64(72)}
2025-07-09 16:35:02,140 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 16:35:02,140 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'18675': np.int64(729), '17904': np.int64(45), '17612': np.int64(474), '17914': np.int64(72)}
2025-07-09 16:35:02,143 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:35:02,143 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:35:02,144 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:35:02,146 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:35:02,150 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'18675': np.int64(729), '17904': np.int64(45), '17612': np.int64(474), '17914': np.int64(72)}
2025-07-09 16:35:02,150 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 16:35:02,151 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'18675': np.int64(729), '17904': np.int64(45), '17612': np.int64(474), '17914': np.int64(72)}
2025-07-09 16:35:02,153 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 16:35:02,155 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:35:02,156 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 16:35:02,157 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 16:35:02,159 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 16:35:02,159 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'18675': np.int64(729), '17904': np.int64(42), '17612': np.int64(390), '17914': np.int64(71)}
2025-07-09 16:35:02,160 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612           1006           1006
1  2025-06-01  17904            108            108
3  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
6  2025-06-02  17612           1006            935
2025-07-09 16:35:02,162 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
118  2025-06-30  17612            474            390
117  2025-06-30  17904             45             42
119  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-09 16:35:02,162 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 16:35:02,162 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 16:35:02,163 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612           1006           1006
1  2025-06-01  17904            108            108
3  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
6  2025-06-02  17612           1006            935
2025-07-09 16:35:02,166 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
118  2025-06-30  17612            474            390
117  2025-06-30  17904             45             42
119  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-09 16:35:02,166 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 16:35:02,168 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 16:35:02,171 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
2    2025-06-01           1006
6    2025-06-02            935
10   2025-06-03            841
14   2025-06-04           1200
18   2025-06-05            904
22   2025-06-06            787
26   2025-06-07            787
30   2025-06-08            787
34   2025-06-09            740
38   2025-06-10            653
42   2025-06-11            586
46   2025-06-12            352
50   2025-06-13            269
54   2025-06-14            269
58   2025-06-15            269
62   2025-06-16            105
66   2025-06-17             49
70   2025-06-18            568
74   2025-06-19            521
78   2025-06-20            445
82   2025-06-21            445
86   2025-06-22            445
90   2025-06-23            800
94   2025-06-24            758
98   2025-06-25            585
102  2025-06-26            525
106  2025-06-27            474
110  2025-06-28            474
114  2025-06-29            474
118  2025-06-30            390
2025-07-09 16:35:02,173 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            108
5    2025-06-02            106
9    2025-06-03             93
13   2025-06-04             86
17   2025-06-05             85
21   2025-06-06             83
25   2025-06-07             83
29   2025-06-08             83
33   2025-06-09             81
37   2025-06-10             81
41   2025-06-11             80
45   2025-06-12             66
49   2025-06-13             65
53   2025-06-14             65
57   2025-06-15             65
61   2025-06-16             63
65   2025-06-17             62
69   2025-06-18             61
73   2025-06-19             59
77   2025-06-20             58
81   2025-06-21             58
85   2025-06-22             58
89   2025-06-23             52
93   2025-06-24             51
97   2025-06-25             50
101  2025-06-26             48
105  2025-06-27             45
109  2025-06-28             45
113  2025-06-29             45
117  2025-06-30             42
2025-07-09 16:35:02,179 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 16:35:02,183 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 16:35:02,187 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 16:35:02,189 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
2    2025-06-01           21
6    2025-06-02           20
10   2025-06-03           18
14   2025-06-04           25
18   2025-06-05           19
22   2025-06-06           17
26   2025-06-07           17
30   2025-06-08           17
34   2025-06-09           16
38   2025-06-10           14
42   2025-06-11           13
46   2025-06-12            8
50   2025-06-13            6
54   2025-06-14            6
58   2025-06-15            6
62   2025-06-16            3
66   2025-06-17            2
70   2025-06-18           12
74   2025-06-19           11
78   2025-06-20           10
82   2025-06-21           10
86   2025-06-22           10
90   2025-06-23           17
94   2025-06-24           16
98   2025-06-25           13
102  2025-06-26           11
106  2025-06-27           10
110  2025-06-28           10
114  2025-06-29           10
118  2025-06-30            9
2025-07-09 16:35:02,190 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 16:35:02,191 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 16:35:02,191 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 16:35:02,191 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 16:35:02,194 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 16:35:02,194 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 16:35:02,195 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 16:35:02,202 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 16:35:02,203 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 16:35:02,203 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:35:02,203 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:35:02,205 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:35:02,432 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:35:02,434 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:35:02,434 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:35:02,435 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 16:35:02,456 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:35:02,617 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:35:02,620 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:35:02,820 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:35:02,935 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:35:03,118 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 16:35:03,289 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 16:35:03,295 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 16:35:03,459 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 16:35:03,461 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 16:35:03,462 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 16:35:03,465 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 16:35:03,465 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 16:35:03,466 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 16:35:03,469 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 16:35:03,471 - src.services.reporting_logic.inventory_calculations - ERROR - Error calculating current inventory: name 'shpped_items_df' is not defined
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\inventory_calculations.py", line 136, in calculate_current_inventory
    (shpped_items_df['Date'] <= current_week_end_date)
     ^^^^^^^^^^^^^^^
NameError: name 'shpped_items_df' is not defined
2025-07-09 16:35:03,476 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 16:35:03,484 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 16:35:03,488 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 16:35:03,494 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 16:35:03,498 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 16:35:03,499 - __main__ - ERROR - Weekly Inventory Report generation failed. Missing current inventory data or product names map.
2025-07-09 16:35:03,501 - __main__ - INFO - Script finished successfully.
2025-07-09 16:36:44,148 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 16:36:44,149 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 16:36:44,534 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 16:36:44,535 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 16:36:44,535 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:36:44,535 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:36:44,547 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:36:44,796 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:36:44,797 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:36:44,798 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:36:44,798 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:36:44,822 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:36:45,007 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:36:45,009 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:36:45,319 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:45,490 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:45,491 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 16:36:45,725 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 16:36:45,727 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 16:36:45,733 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 16:36:45,733 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 16:36:45,734 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:36:45,734 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:36:45,736 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:36:45,970 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:36:45,973 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:36:45,973 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:36:45,974 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:36:45,995 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:36:46,152 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:36:46,155 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:36:46,482 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:46,611 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:46,612 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 16:36:46,787 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 16:36:46,789 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 16:36:46,790 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 16:36:46,791 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 16:36:46,793 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 16:36:46,794 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 16:36:46,795 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 16:36:46,795 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:36:46,795 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:36:46,798 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:36:47,058 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:36:47,060 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:36:47,061 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:36:47,062 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:36:47,084 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:36:47,235 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:36:47,237 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:36:47,505 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:47,624 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:47,627 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 16:36:47,812 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 16:36:47,821 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 16:36:47,824 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 16:36:47,826 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 16:36:47,826 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 16:36:47,826 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:36:47,828 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:36:47,831 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:36:48,051 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:36:48,052 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:36:48,052 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:36:48,053 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:36:48,074 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:36:48,247 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:36:48,271 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:36:48,516 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:48,734 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:48,736 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 16:36:48,966 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 16:36:48,969 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 16:36:48,972 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 16:36:48,973 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 16:36:48,973 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:36:48,974 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:36:48,976 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:36:49,216 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:36:49,218 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:36:49,219 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:36:49,219 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:36:49,240 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:36:49,408 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:36:49,413 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:36:49,656 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:49,862 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:49,863 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 16:36:50,012 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 16:36:50,014 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 16:36:50,021 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 16:36:50,022 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 16:36:50,022 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:36:50,022 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:36:50,025 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:36:50,271 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:36:50,276 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:36:50,277 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:36:50,278 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:36:50,302 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:36:50,466 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:36:50,469 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:36:50,741 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:50,972 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:50,973 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 16:36:51,192 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 16:36:51,193 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 16:36:51,194 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 16:36:51,195 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 16:36:51,195 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 16:36:51,201 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 16:36:51,202 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 16:36:51,203 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 16:36:51,204 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 16:36:51,205 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 16:36:51,206 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 16:36:51,208 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 16:36:51,209 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 16:36:51,210 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 16:36:51,211 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 16:36:51,211 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 16:36:51,212 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 16:36:51,213 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'18675': 749, '17612': 1006, '17904': 108, '17914': 175}
2025-07-09 16:36:51,213 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 16:36:51,213 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'18675': 749, '17612': 1006, '17904': 108, '17914': 175}
2025-07-09 16:36:51,216 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 16:36:51,219 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 16:36:51,222 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 16:36:51,225 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 16:36:51,225 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'18675': np.int64(749), '17612': np.int64(1006), '17904': np.int64(108), '17914': np.int64(175)}
2025-07-09 16:36:51,226 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 16:36:51,226 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'18675': np.int64(749), '17612': np.int64(1006), '17904': np.int64(108), '17914': np.int64(175)}
2025-07-09 16:36:51,227 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 16:36:51,229 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 16:36:51,231 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 16:36:51,233 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 16:36:51,234 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 16:36:51,235 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'18675': np.int64(748), '17612': np.int64(935), '17904': np.int64(106), '17914': np.int64(172)}
2025-07-09 16:36:51,235 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 16:36:51,236 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'18675': np.int64(748), '17612': np.int64(935), '17904': np.int64(106), '17914': np.int64(172)}
2025-07-09 16:36:51,238 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 16:36:51,240 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:36:51,241 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 16:36:51,243 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 16:36:51,244 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 16:36:51,244 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'18675': np.int64(748), '17612': np.int64(841), '17904': np.int64(93), '17914': np.int64(166)}
2025-07-09 16:36:51,245 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 16:36:51,245 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'18675': np.int64(748), '17612': np.int64(841), '17904': np.int64(93), '17914': np.int64(166)}
2025-07-09 16:36:51,246 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 16:36:51,247 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:36:51,249 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 16:36:51,252 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 16:36:51,254 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 16:36:51,255 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'18675': np.int64(748), '17612': np.int64(1200), '17904': np.int64(86), '17914': np.int64(159)}
2025-07-09 16:36:51,255 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 16:36:51,256 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'18675': np.int64(748), '17612': np.int64(1200), '17904': np.int64(86), '17914': np.int64(159)}
2025-07-09 16:36:51,257 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 16:36:51,258 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:36:51,260 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 16:36:51,261 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 16:36:51,263 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 16:36:51,263 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'18675': np.int64(748), '17612': np.int64(904), '17904': np.int64(85), '17914': np.int64(152)}
2025-07-09 16:36:51,263 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 16:36:51,263 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'18675': np.int64(748), '17612': np.int64(904), '17904': np.int64(85), '17914': np.int64(152)}
2025-07-09 16:36:51,265 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 16:36:51,267 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 16:36:51,269 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 16:36:51,272 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 16:36:51,274 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 16:36:51,274 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'18675': np.int64(747), '17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151)}
2025-07-09 16:36:51,274 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 16:36:51,275 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'18675': np.int64(747), '17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151)}
2025-07-09 16:36:51,276 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:36:51,278 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:36:51,279 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:36:51,281 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:36:51,281 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'18675': np.int64(747), '17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151)}
2025-07-09 16:36:51,282 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 16:36:51,283 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'18675': np.int64(747), '17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151)}
2025-07-09 16:36:51,285 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:36:51,289 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:36:51,290 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:36:51,292 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:36:51,292 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'18675': np.int64(747), '17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151)}
2025-07-09 16:36:51,292 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 16:36:51,293 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'18675': np.int64(747), '17612': np.int64(787), '17904': np.int64(83), '17914': np.int64(151)}
2025-07-09 16:36:51,294 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 16:36:51,295 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 16:36:51,296 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 16:36:51,299 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 16:36:51,301 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 16:36:51,302 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'18675': np.int64(746), '17612': np.int64(740), '17904': np.int64(81), '17914': np.int64(148)}
2025-07-09 16:36:51,302 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 16:36:51,303 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'18675': np.int64(746), '17612': np.int64(740), '17904': np.int64(81), '17914': np.int64(148)}
2025-07-09 16:36:51,305 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 16:36:51,307 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 16:36:51,308 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 16:36:51,310 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 16:36:51,311 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 16:36:51,312 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'18675': np.int64(746), '17612': np.int64(653), '17904': np.int64(81), '17914': np.int64(145)}
2025-07-09 16:36:51,312 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 16:36:51,313 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'18675': np.int64(746), '17612': np.int64(653), '17904': np.int64(81), '17914': np.int64(145)}
2025-07-09 16:36:51,313 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 16:36:51,315 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 16:36:51,317 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 16:36:51,319 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 16:36:51,322 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 16:36:51,322 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'18675': np.int64(745), '17612': np.int64(586), '17904': np.int64(80), '17914': np.int64(142)}
2025-07-09 16:36:51,322 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 16:36:51,323 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'18675': np.int64(745), '17612': np.int64(586), '17904': np.int64(80), '17914': np.int64(142)}
2025-07-09 16:36:51,323 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 16:36:51,325 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:36:51,326 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 16:36:51,328 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 16:36:51,329 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 16:36:51,330 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'18675': np.int64(745), '17612': np.int64(352), '17904': np.int64(66), '17914': np.int64(131)}
2025-07-09 16:36:51,330 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 16:36:51,331 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'18675': np.int64(745), '17612': np.int64(352), '17904': np.int64(66), '17914': np.int64(131)}
2025-07-09 16:36:51,332 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 16:36:51,334 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:36:51,337 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 16:36:51,338 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 16:36:51,340 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 16:36:51,340 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'18675': np.int64(745), '17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119)}
2025-07-09 16:36:51,341 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 16:36:51,341 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'18675': np.int64(745), '17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119)}
2025-07-09 16:36:51,342 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:36:51,344 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:36:51,345 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:36:51,346 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:36:51,347 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'18675': np.int64(745), '17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119)}
2025-07-09 16:36:51,347 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 16:36:51,347 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'18675': np.int64(745), '17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119)}
2025-07-09 16:36:51,350 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:36:51,353 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:36:51,355 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:36:51,356 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:36:51,357 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'18675': np.int64(745), '17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119)}
2025-07-09 16:36:51,357 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 16:36:51,357 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'18675': np.int64(745), '17612': np.int64(269), '17904': np.int64(65), '17914': np.int64(119)}
2025-07-09 16:36:51,358 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 16:36:51,360 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 16:36:51,362 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 16:36:51,364 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 16:36:51,367 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 16:36:51,368 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'18675': np.int64(742), '17612': np.int64(105), '17904': np.int64(63), '17914': np.int64(116)}
2025-07-09 16:36:51,368 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 16:36:51,369 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'18675': np.int64(742), '17612': np.int64(105), '17904': np.int64(63), '17914': np.int64(116)}
2025-07-09 16:36:51,370 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 16:36:51,373 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 16:36:51,375 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 16:36:51,378 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 16:36:51,380 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 16:36:51,380 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'18675': np.int64(730), '17612': np.int64(49), '17904': np.int64(62), '17914': np.int64(105)}
2025-07-09 16:36:51,381 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 16:36:51,381 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'18675': np.int64(730), '17612': np.int64(49), '17904': np.int64(62), '17914': np.int64(105)}
2025-07-09 16:36:51,383 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 16:36:51,385 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:36:51,389 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 16:36:51,391 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 16:36:51,393 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 16:36:51,393 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'18675': np.int64(730), '17612': np.int64(568), '17904': np.int64(61), '17914': np.int64(104)}
2025-07-09 16:36:51,393 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 16:36:51,394 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'18675': np.int64(730), '17612': np.int64(568), '17904': np.int64(61), '17914': np.int64(104)}
2025-07-09 16:36:51,395 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 16:36:51,396 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:36:51,399 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 16:36:51,400 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 16:36:51,402 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 16:36:51,405 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'18675': np.int64(730), '17612': np.int64(521), '17904': np.int64(59), '17914': np.int64(97)}
2025-07-09 16:36:51,405 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 16:36:51,405 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'18675': np.int64(730), '17612': np.int64(521), '17904': np.int64(59), '17914': np.int64(97)}
2025-07-09 16:36:51,406 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 16:36:51,408 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 16:36:51,409 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 16:36:51,411 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 16:36:51,412 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 16:36:51,413 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'18675': np.int64(729), '17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92)}
2025-07-09 16:36:51,413 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 16:36:51,413 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'18675': np.int64(729), '17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92)}
2025-07-09 16:36:51,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:36:51,418 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:36:51,421 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:36:51,423 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:36:51,423 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'18675': np.int64(729), '17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92)}
2025-07-09 16:36:51,423 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 16:36:51,424 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'18675': np.int64(729), '17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92)}
2025-07-09 16:36:51,426 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:36:51,427 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:36:51,429 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:36:51,430 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:36:51,431 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'18675': np.int64(729), '17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92)}
2025-07-09 16:36:51,431 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 16:36:51,431 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'18675': np.int64(729), '17612': np.int64(445), '17904': np.int64(58), '17914': np.int64(92)}
2025-07-09 16:36:51,433 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 16:36:51,434 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:36:51,438 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 16:36:51,439 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 16:36:51,441 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:36:51,441 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'18675': np.int64(729), '17612': np.int64(800), '17904': np.int64(52), '17914': np.int64(92)}
2025-07-09 16:36:51,441 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 16:36:51,442 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'18675': np.int64(729), '17612': np.int64(800), '17904': np.int64(52), '17914': np.int64(92)}
2025-07-09 16:36:51,442 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 16:36:51,444 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:36:51,445 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 16:36:51,447 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 16:36:51,449 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 16:36:51,450 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'18675': np.int64(729), '17612': np.int64(758), '17904': np.int64(51), '17914': np.int64(91)}
2025-07-09 16:36:51,450 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 16:36:51,450 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'18675': np.int64(729), '17612': np.int64(758), '17904': np.int64(51), '17914': np.int64(91)}
2025-07-09 16:36:51,452 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 16:36:51,455 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:36:51,457 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 16:36:51,459 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 16:36:51,460 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 16:36:51,461 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'18675': np.int64(729), '17612': np.int64(585), '17904': np.int64(50), '17914': np.int64(87)}
2025-07-09 16:36:51,461 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 16:36:51,462 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'18675': np.int64(729), '17612': np.int64(585), '17904': np.int64(50), '17914': np.int64(87)}
2025-07-09 16:36:51,463 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 16:36:51,464 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:36:51,466 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 16:36:51,468 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 16:36:51,472 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 16:36:51,472 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'18675': np.int64(729), '17612': np.int64(525), '17904': np.int64(48), '17914': np.int64(78)}
2025-07-09 16:36:51,473 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 16:36:51,474 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'18675': np.int64(729), '17612': np.int64(525), '17904': np.int64(48), '17914': np.int64(78)}
2025-07-09 16:36:51,475 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 16:36:51,476 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:36:51,478 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 16:36:51,479 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 16:36:51,481 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 16:36:51,481 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'18675': np.int64(729), '17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72)}
2025-07-09 16:36:51,481 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 16:36:51,481 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'18675': np.int64(729), '17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72)}
2025-07-09 16:36:51,484 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:36:51,487 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:36:51,489 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:36:51,490 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:36:51,491 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'18675': np.int64(729), '17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72)}
2025-07-09 16:36:51,491 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 16:36:51,491 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'18675': np.int64(729), '17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72)}
2025-07-09 16:36:51,493 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:36:51,494 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:36:51,496 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:36:51,497 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:36:51,498 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'18675': np.int64(729), '17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72)}
2025-07-09 16:36:51,498 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 16:36:51,499 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'18675': np.int64(729), '17612': np.int64(474), '17904': np.int64(45), '17914': np.int64(72)}
2025-07-09 16:36:51,499 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 16:36:51,502 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:36:51,504 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 16:36:51,506 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 16:36:51,507 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 16:36:51,508 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'18675': np.int64(729), '17612': np.int64(390), '17904': np.int64(42), '17914': np.int64(71)}
2025-07-09 16:36:51,510 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
2  2025-06-01  17904            108            108
3  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-09 16:36:51,511 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
118  2025-06-30  17904             45             42
119  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-09 16:36:51,511 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 16:36:51,512 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 16:36:51,512 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
2  2025-06-01  17904            108            108
3  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-09 16:36:51,513 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
118  2025-06-30  17904             45             42
119  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-09 16:36:51,514 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 16:36:51,516 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 16:36:51,519 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01           1006
5    2025-06-02            935
9    2025-06-03            841
13   2025-06-04           1200
17   2025-06-05            904
21   2025-06-06            787
25   2025-06-07            787
29   2025-06-08            787
33   2025-06-09            740
37   2025-06-10            653
41   2025-06-11            586
45   2025-06-12            352
49   2025-06-13            269
53   2025-06-14            269
57   2025-06-15            269
61   2025-06-16            105
65   2025-06-17             49
69   2025-06-18            568
73   2025-06-19            521
77   2025-06-20            445
81   2025-06-21            445
85   2025-06-22            445
89   2025-06-23            800
93   2025-06-24            758
97   2025-06-25            585
101  2025-06-26            525
105  2025-06-27            474
109  2025-06-28            474
113  2025-06-29            474
117  2025-06-30            390
2025-07-09 16:36:51,522 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            108
6    2025-06-02            106
10   2025-06-03             93
14   2025-06-04             86
18   2025-06-05             85
22   2025-06-06             83
26   2025-06-07             83
30   2025-06-08             83
34   2025-06-09             81
38   2025-06-10             81
42   2025-06-11             80
46   2025-06-12             66
50   2025-06-13             65
54   2025-06-14             65
58   2025-06-15             65
62   2025-06-16             63
66   2025-06-17             62
70   2025-06-18             61
74   2025-06-19             59
78   2025-06-20             58
82   2025-06-21             58
86   2025-06-22             58
90   2025-06-23             52
94   2025-06-24             51
98   2025-06-25             50
102  2025-06-26             48
106  2025-06-27             45
110  2025-06-28             45
114  2025-06-29             45
118  2025-06-30             42
2025-07-09 16:36:51,528 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 16:36:51,531 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 16:36:51,533 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 16:36:51,535 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           21
5    2025-06-02           20
9    2025-06-03           18
13   2025-06-04           25
17   2025-06-05           19
21   2025-06-06           17
25   2025-06-07           17
29   2025-06-08           17
33   2025-06-09           16
37   2025-06-10           14
41   2025-06-11           13
45   2025-06-12            8
49   2025-06-13            6
53   2025-06-14            6
57   2025-06-15            6
61   2025-06-16            3
65   2025-06-17            2
69   2025-06-18           12
73   2025-06-19           11
77   2025-06-20           10
81   2025-06-21           10
85   2025-06-22           10
89   2025-06-23           17
93   2025-06-24           16
97   2025-06-25           13
101  2025-06-26           11
105  2025-06-27           10
109  2025-06-28           10
113  2025-06-29           10
117  2025-06-30            9
2025-07-09 16:36:51,538 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 16:36:51,539 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 16:36:51,539 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 16:36:51,539 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 16:36:51,541 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 16:36:51,542 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 16:36:51,542 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 16:36:51,549 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 16:36:51,549 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 16:36:51,550 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:36:51,550 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:36:51,553 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:36:51,790 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:36:51,792 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:36:51,793 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:36:51,793 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 16:36:51,816 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:36:51,981 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:36:51,983 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:36:52,198 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:52,421 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:36:52,598 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 16:36:52,835 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 16:36:52,838 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 16:36:53,005 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 16:36:53,007 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 16:36:53,008 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 16:36:53,009 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 16:36:53,009 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 16:36:53,010 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 16:36:53,010 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 16:36:53,011 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 16:36:53,012 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 16:36:53,013 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1                2            Ship
2                6            Ship
3                1            Ship
4                1            Ship
2025-07-09 16:36:53,016 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
   SKU  Quantity TransactionType
58             1            Ship
59             1            Ship
60             1            Ship
61             1            Ship
62             2            Ship
2025-07-09 16:36:53,017 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 16:36:53,021 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 16:36:53,022 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 16:36:53,024 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 16:36:53,025 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 16:36:53,026 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 16:36:53,027 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 16:39:47,939 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 16:39:47,940 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 16:39:48,263 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 16:39:48,264 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 16:39:48,264 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:39:48,265 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:39:48,276 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:39:48,556 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:39:48,559 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:39:48,560 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:39:48,560 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:39:48,585 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:39:48,767 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:39:48,769 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:39:49,163 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:49,304 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:49,306 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 16:39:49,471 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 16:39:49,472 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 16:39:49,480 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 16:39:49,480 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 16:39:49,481 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:39:49,481 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:39:49,483 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:39:49,712 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:39:49,714 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:39:49,715 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:39:49,716 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:39:49,738 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:39:49,885 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:39:49,888 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:39:50,103 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:50,252 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:50,254 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 16:39:50,431 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 16:39:50,434 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 16:39:50,436 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 16:39:50,437 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 16:39:50,439 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 16:39:50,439 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 16:39:50,440 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 16:39:50,440 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:39:50,440 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:39:50,444 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:39:50,669 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:39:50,671 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:39:50,672 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:39:50,672 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:39:50,694 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:39:50,843 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:39:50,847 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:39:51,214 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:51,363 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:51,365 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 16:39:51,519 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 16:39:51,527 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 16:39:51,531 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 16:39:51,533 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 16:39:51,533 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 16:39:51,534 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:39:51,534 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:39:51,536 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:39:51,771 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:39:51,773 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:39:51,773 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:39:51,774 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:39:51,795 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:39:51,944 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:39:51,948 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:39:52,236 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:52,444 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:52,447 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 16:39:52,645 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 16:39:52,650 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 16:39:52,654 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 16:39:52,655 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 16:39:52,655 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:39:52,656 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:39:52,660 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:39:52,895 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:39:52,897 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:39:52,898 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:39:52,900 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:39:52,922 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:39:53,080 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:39:53,083 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:39:53,362 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:53,490 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:53,491 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 16:39:53,653 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 16:39:53,656 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 16:39:53,661 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 16:39:53,661 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 16:39:53,662 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:39:53,662 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:39:53,666 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:39:53,898 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:39:53,900 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:39:53,900 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:39:53,901 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:39:53,923 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:39:54,074 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:39:54,078 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:39:54,386 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:54,590 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:54,592 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 16:39:54,899 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 16:39:54,901 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 16:39:54,903 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 16:39:54,904 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 16:39:54,905 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 16:39:54,910 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 16:39:54,911 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 16:39:54,912 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 16:39:54,913 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 16:39:54,914 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 16:39:54,914 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 16:39:54,917 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 16:39:54,917 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 16:39:54,918 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 16:39:54,919 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 16:39:54,920 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 16:39:54,923 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 16:39:54,924 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 175, '17612': 1006, '18675': 749, '17904': 108}
2025-07-09 16:39:54,924 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 16:39:54,924 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 175, '17612': 1006, '18675': 749, '17904': 108}
2025-07-09 16:39:54,926 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 16:39:54,928 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 16:39:54,929 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 16:39:54,931 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 16:39:54,932 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(175), '17612': np.int64(1006), '18675': np.int64(749), '17904': np.int64(108)}
2025-07-09 16:39:54,933 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 16:39:54,933 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(175), '17612': np.int64(1006), '18675': np.int64(749), '17904': np.int64(108)}
2025-07-09 16:39:54,935 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 16:39:54,937 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 16:39:54,939 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 16:39:54,941 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 16:39:54,942 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 16:39:54,943 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(172), '17612': np.int64(935), '18675': np.int64(748), '17904': np.int64(106)}
2025-07-09 16:39:54,943 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 16:39:54,943 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(172), '17612': np.int64(935), '18675': np.int64(748), '17904': np.int64(106)}
2025-07-09 16:39:54,944 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 16:39:54,946 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 16:39:54,947 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 16:39:54,950 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:39:54,952 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 16:39:54,953 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(166), '17612': np.int64(841), '18675': np.int64(748), '17904': np.int64(93)}
2025-07-09 16:39:54,954 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 16:39:54,955 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(166), '17612': np.int64(841), '18675': np.int64(748), '17904': np.int64(93)}
2025-07-09 16:39:54,955 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 16:39:54,957 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 16:39:54,959 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 16:39:54,960 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:39:54,962 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 16:39:54,962 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(159), '17612': np.int64(1200), '18675': np.int64(748), '17904': np.int64(86)}
2025-07-09 16:39:54,963 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 16:39:54,963 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(159), '17612': np.int64(1200), '18675': np.int64(748), '17904': np.int64(86)}
2025-07-09 16:39:54,964 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 16:39:54,967 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 16:39:54,975 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 16:39:54,979 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:39:54,982 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 16:39:54,984 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(152), '17612': np.int64(904), '18675': np.int64(748), '17904': np.int64(85)}
2025-07-09 16:39:54,985 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 16:39:54,985 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(152), '17612': np.int64(904), '18675': np.int64(748), '17904': np.int64(85)}
2025-07-09 16:39:54,988 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 16:39:54,994 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 16:39:54,997 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 16:39:55,002 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 16:39:55,007 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 16:39:55,008 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 16:39:55,009 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 16:39:55,009 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 16:39:55,011 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:39:55,014 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:39:55,017 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:39:55,018 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:39:55,019 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 16:39:55,020 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 16:39:55,021 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 16:39:55,029 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:39:55,031 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:39:55,034 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:39:55,036 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:39:55,038 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 16:39:55,039 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 16:39:55,040 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 16:39:55,041 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 16:39:55,042 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 16:39:55,044 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 16:39:55,045 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 16:39:55,047 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 16:39:55,047 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(148), '17612': np.int64(740), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-09 16:39:55,048 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 16:39:55,048 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(148), '17612': np.int64(740), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-09 16:39:55,050 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 16:39:55,052 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 16:39:55,055 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 16:39:55,057 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 16:39:55,058 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 16:39:55,059 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(145), '17612': np.int64(653), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-09 16:39:55,059 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 16:39:55,059 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(145), '17612': np.int64(653), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-09 16:39:55,060 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 16:39:55,061 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 16:39:55,063 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 16:39:55,064 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 16:39:55,066 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 16:39:55,067 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(142), '17612': np.int64(586), '18675': np.int64(745), '17904': np.int64(80)}
2025-07-09 16:39:55,067 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 16:39:55,068 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(142), '17612': np.int64(586), '18675': np.int64(745), '17904': np.int64(80)}
2025-07-09 16:39:55,070 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 16:39:55,072 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 16:39:55,073 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 16:39:55,075 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:39:55,076 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 16:39:55,077 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(131), '17612': np.int64(352), '18675': np.int64(745), '17904': np.int64(66)}
2025-07-09 16:39:55,077 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 16:39:55,078 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(131), '17612': np.int64(352), '18675': np.int64(745), '17904': np.int64(66)}
2025-07-09 16:39:55,078 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 16:39:55,080 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 16:39:55,086 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 16:39:55,090 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:39:55,092 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 16:39:55,093 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 16:39:55,093 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 16:39:55,093 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 16:39:55,096 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:39:55,098 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:39:55,102 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:39:55,105 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:39:55,106 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 16:39:55,106 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 16:39:55,106 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 16:39:55,108 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:39:55,109 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:39:55,111 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:39:55,112 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:39:55,113 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 16:39:55,113 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 16:39:55,113 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 16:39:55,114 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 16:39:55,118 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 16:39:55,120 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 16:39:55,121 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 16:39:55,123 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 16:39:55,123 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(116), '17612': np.int64(105), '18675': np.int64(742), '17904': np.int64(63)}
2025-07-09 16:39:55,123 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 16:39:55,123 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(116), '17612': np.int64(105), '18675': np.int64(742), '17904': np.int64(63)}
2025-07-09 16:39:55,124 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 16:39:55,126 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 16:39:55,127 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 16:39:55,129 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 16:39:55,130 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 16:39:55,131 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(105), '17612': np.int64(49), '18675': np.int64(730), '17904': np.int64(62)}
2025-07-09 16:39:55,132 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 16:39:55,134 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(105), '17612': np.int64(49), '18675': np.int64(730), '17904': np.int64(62)}
2025-07-09 16:39:55,135 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 16:39:55,137 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 16:39:55,138 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 16:39:55,140 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:39:55,141 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 16:39:55,142 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(104), '17612': np.int64(568), '18675': np.int64(730), '17904': np.int64(61)}
2025-07-09 16:39:55,142 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 16:39:55,142 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(104), '17612': np.int64(568), '18675': np.int64(730), '17904': np.int64(61)}
2025-07-09 16:39:55,142 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 16:39:55,144 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 16:39:55,145 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 16:39:55,147 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:39:55,151 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 16:39:55,152 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(97), '17612': np.int64(521), '18675': np.int64(730), '17904': np.int64(59)}
2025-07-09 16:39:55,153 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 16:39:55,153 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(97), '17612': np.int64(521), '18675': np.int64(730), '17904': np.int64(59)}
2025-07-09 16:39:55,154 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 16:39:55,156 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 16:39:55,157 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 16:39:55,159 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 16:39:55,160 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 16:39:55,161 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 16:39:55,161 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 16:39:55,161 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 16:39:55,163 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:39:55,165 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:39:55,168 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:39:55,170 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:39:55,170 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 16:39:55,170 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 16:39:55,171 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 16:39:55,172 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:39:55,174 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:39:55,176 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:39:55,177 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:39:55,177 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 16:39:55,178 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 16:39:55,178 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 16:39:55,179 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 16:39:55,184 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:39:55,185 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 16:39:55,188 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:39:55,189 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 16:39:55,189 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(92), '17612': np.int64(800), '18675': np.int64(729), '17904': np.int64(52)}
2025-07-09 16:39:55,190 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 16:39:55,190 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(92), '17612': np.int64(800), '18675': np.int64(729), '17904': np.int64(52)}
2025-07-09 16:39:55,191 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 16:39:55,193 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 16:39:55,194 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 16:39:55,195 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:39:55,197 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 16:39:55,198 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(91), '17612': np.int64(758), '18675': np.int64(729), '17904': np.int64(51)}
2025-07-09 16:39:55,199 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 16:39:55,199 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(91), '17612': np.int64(758), '18675': np.int64(729), '17904': np.int64(51)}
2025-07-09 16:39:55,201 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 16:39:55,203 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 16:39:55,205 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 16:39:55,206 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:39:55,208 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 16:39:55,209 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(87), '17612': np.int64(585), '18675': np.int64(729), '17904': np.int64(50)}
2025-07-09 16:39:55,209 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 16:39:55,209 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(87), '17612': np.int64(585), '18675': np.int64(729), '17904': np.int64(50)}
2025-07-09 16:39:55,210 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 16:39:55,211 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 16:39:55,213 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 16:39:55,216 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:39:55,219 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 16:39:55,219 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(78), '17612': np.int64(525), '18675': np.int64(729), '17904': np.int64(48)}
2025-07-09 16:39:55,220 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 16:39:55,220 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(78), '17612': np.int64(525), '18675': np.int64(729), '17904': np.int64(48)}
2025-07-09 16:39:55,221 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 16:39:55,222 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 16:39:55,225 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 16:39:55,226 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:39:55,228 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 16:39:55,228 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 16:39:55,229 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 16:39:55,229 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 16:39:55,231 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:39:55,235 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:39:55,237 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:39:55,239 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:39:55,239 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 16:39:55,240 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 16:39:55,240 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 16:39:55,241 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:39:55,243 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:39:55,244 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:39:55,246 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:39:55,246 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 16:39:55,246 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 16:39:55,247 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 16:39:55,249 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 16:39:55,253 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 16:39:55,255 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 16:39:55,257 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:39:55,258 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 16:39:55,258 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(71), '17612': np.int64(390), '18675': np.int64(729), '17904': np.int64(42)}
2025-07-09 16:39:55,261 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
0  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-09 16:39:55,262 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
116  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-09 16:39:55,262 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 16:39:55,262 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 16:39:55,265 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
0  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-09 16:39:55,267 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
116  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-09 16:39:55,268 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 16:39:55,270 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 16:39:55,272 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01           1006
5    2025-06-02            935
9    2025-06-03            841
13   2025-06-04           1200
17   2025-06-05            904
21   2025-06-06            787
25   2025-06-07            787
29   2025-06-08            787
33   2025-06-09            740
37   2025-06-10            653
41   2025-06-11            586
45   2025-06-12            352
49   2025-06-13            269
53   2025-06-14            269
57   2025-06-15            269
61   2025-06-16            105
65   2025-06-17             49
69   2025-06-18            568
73   2025-06-19            521
77   2025-06-20            445
81   2025-06-21            445
85   2025-06-22            445
89   2025-06-23            800
93   2025-06-24            758
97   2025-06-25            585
101  2025-06-26            525
105  2025-06-27            474
109  2025-06-28            474
113  2025-06-29            474
117  2025-06-30            390
2025-07-09 16:39:55,273 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
3    2025-06-01            108
7    2025-06-02            106
11   2025-06-03             93
15   2025-06-04             86
19   2025-06-05             85
23   2025-06-06             83
27   2025-06-07             83
31   2025-06-08             83
35   2025-06-09             81
39   2025-06-10             81
43   2025-06-11             80
47   2025-06-12             66
51   2025-06-13             65
55   2025-06-14             65
59   2025-06-15             65
63   2025-06-16             63
67   2025-06-17             62
71   2025-06-18             61
75   2025-06-19             59
79   2025-06-20             58
83   2025-06-21             58
87   2025-06-22             58
91   2025-06-23             52
95   2025-06-24             51
99   2025-06-25             50
103  2025-06-26             48
107  2025-06-27             45
111  2025-06-28             45
115  2025-06-29             45
119  2025-06-30             42
2025-07-09 16:39:55,279 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 16:39:55,286 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 16:39:55,287 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 16:39:55,289 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           21
5    2025-06-02           20
9    2025-06-03           18
13   2025-06-04           25
17   2025-06-05           19
21   2025-06-06           17
25   2025-06-07           17
29   2025-06-08           17
33   2025-06-09           16
37   2025-06-10           14
41   2025-06-11           13
45   2025-06-12            8
49   2025-06-13            6
53   2025-06-14            6
57   2025-06-15            6
61   2025-06-16            3
65   2025-06-17            2
69   2025-06-18           12
73   2025-06-19           11
77   2025-06-20           10
81   2025-06-21           10
85   2025-06-22           10
89   2025-06-23           17
93   2025-06-24           16
97   2025-06-25           13
101  2025-06-26           11
105  2025-06-27           10
109  2025-06-28           10
113  2025-06-29           10
117  2025-06-30            9
2025-07-09 16:39:55,290 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 16:39:55,291 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 16:39:55,291 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 16:39:55,291 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 16:39:55,292 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 16:39:55,293 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 16:39:55,293 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 16:39:55,301 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 16:39:55,302 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 16:39:55,302 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:39:55,303 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:39:55,305 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:39:55,550 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:39:55,551 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:39:55,551 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:39:55,552 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 16:39:55,575 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:39:55,719 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:39:55,721 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:39:55,910 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:56,024 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:39:56,229 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 16:39:56,436 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 16:39:56,438 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 16:39:56,599 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 16:39:56,602 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 16:39:56,603 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 16:39:56,604 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 16:39:56,605 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 16:39:56,605 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 16:39:56,607 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 16:39:56,608 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 16:39:56,609 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 16:39:56,611 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1                2            Ship
2                6            Ship
3                1            Ship
4                1            Ship
2025-07-09 16:39:56,613 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
   SKU  Quantity TransactionType
58             1            Ship
59             1            Ship
60             1            Ship
61             1            Ship
62             2            Ship
2025-07-09 16:39:56,615 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 16:39:56,619 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 16:39:56,619 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 16:39:56,621 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 16:39:56,621 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 16:39:56,623 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 16:39:56,623 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 16:45:17,778 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 16:45:17,779 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 16:45:18,124 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 16:45:18,124 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 16:45:18,125 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:45:18,125 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:45:18,139 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:45:18,492 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:45:18,496 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:45:18,497 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:45:18,497 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:45:18,525 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:45:18,727 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:45:18,733 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:45:19,111 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:19,236 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:19,239 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 16:45:19,391 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 16:45:19,402 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 16:45:19,431 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 16:45:19,433 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 16:45:19,434 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:45:19,434 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:45:19,438 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:45:19,671 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:45:19,674 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:45:19,675 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:45:19,676 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:45:19,701 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:45:19,853 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:45:19,856 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:45:20,049 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:20,165 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:20,167 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 16:45:20,305 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 16:45:20,313 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 16:45:20,317 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 16:45:20,320 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 16:45:20,336 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 16:45:20,340 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 16:45:20,340 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 16:45:20,341 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:45:20,341 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:45:20,343 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:45:20,635 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:45:20,638 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:45:20,639 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:45:20,640 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:45:20,662 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:45:20,823 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:45:20,828 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:45:21,045 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:21,157 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:21,159 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 16:45:21,303 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 16:45:21,309 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 16:45:21,319 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 16:45:21,320 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 16:45:21,321 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 16:45:21,321 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:45:21,322 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:45:21,324 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:45:21,575 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:45:21,582 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:45:21,582 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:45:21,583 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:45:21,605 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:45:21,749 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:45:21,751 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:45:21,966 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:22,078 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:22,081 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 16:45:22,225 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 16:45:22,234 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 16:45:22,237 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 16:45:22,237 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 16:45:22,238 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:45:22,238 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:45:22,241 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:45:22,481 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:45:22,486 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:45:22,487 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:45:22,488 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:45:22,512 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:45:22,673 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:45:22,674 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:45:22,868 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:22,996 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:22,997 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 16:45:23,135 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 16:45:23,140 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 16:45:23,154 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 16:45:23,155 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 16:45:23,155 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:45:23,156 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:45:23,159 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:45:23,502 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:45:23,505 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:45:23,505 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:45:23,506 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:45:23,531 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:45:23,680 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:45:23,683 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:45:23,904 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:24,014 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:24,017 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 16:45:24,161 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 16:45:24,163 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 16:45:24,165 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 16:45:24,166 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 16:45:24,167 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 16:45:24,184 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 16:45:24,187 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 16:45:24,189 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 16:45:24,190 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 16:45:24,191 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 16:45:24,192 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 16:45:24,194 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 16:45:24,195 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 16:45:24,195 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 16:45:24,196 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 16:45:24,197 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 16:45:24,199 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 16:45:24,200 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'18675': 749, '17914': 175, '17612': 1006, '17904': 108}
2025-07-09 16:45:24,201 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 16:45:24,202 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'18675': 749, '17914': 175, '17612': 1006, '17904': 108}
2025-07-09 16:45:24,205 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 16:45:24,207 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 16:45:24,209 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 16:45:24,211 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 16:45:24,211 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'18675': np.int64(749), '17914': np.int64(175), '17612': np.int64(1006), '17904': np.int64(108)}
2025-07-09 16:45:24,212 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 16:45:24,212 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'18675': np.int64(749), '17914': np.int64(175), '17612': np.int64(1006), '17904': np.int64(108)}
2025-07-09 16:45:24,214 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 16:45:24,216 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 16:45:24,220 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 16:45:24,221 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 16:45:24,223 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 16:45:24,223 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'18675': np.int64(748), '17914': np.int64(172), '17612': np.int64(935), '17904': np.int64(106)}
2025-07-09 16:45:24,224 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 16:45:24,224 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'18675': np.int64(748), '17914': np.int64(172), '17612': np.int64(935), '17904': np.int64(106)}
2025-07-09 16:45:24,225 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 16:45:24,227 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:45:24,229 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 16:45:24,231 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 16:45:24,232 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 16:45:24,233 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'18675': np.int64(748), '17914': np.int64(166), '17612': np.int64(841), '17904': np.int64(93)}
2025-07-09 16:45:24,234 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 16:45:24,235 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'18675': np.int64(748), '17914': np.int64(166), '17612': np.int64(841), '17904': np.int64(93)}
2025-07-09 16:45:24,236 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 16:45:24,238 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:45:24,240 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 16:45:24,241 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 16:45:24,243 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 16:45:24,243 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'18675': np.int64(748), '17914': np.int64(159), '17612': np.int64(1200), '17904': np.int64(86)}
2025-07-09 16:45:24,244 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 16:45:24,244 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'18675': np.int64(748), '17914': np.int64(159), '17612': np.int64(1200), '17904': np.int64(86)}
2025-07-09 16:45:24,245 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 16:45:24,247 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:45:24,249 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 16:45:24,251 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 16:45:24,253 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 16:45:24,254 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'18675': np.int64(748), '17914': np.int64(152), '17612': np.int64(904), '17904': np.int64(85)}
2025-07-09 16:45:24,254 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 16:45:24,254 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'18675': np.int64(748), '17914': np.int64(152), '17612': np.int64(904), '17904': np.int64(85)}
2025-07-09 16:45:24,255 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 16:45:24,257 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 16:45:24,259 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 16:45:24,260 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 16:45:24,261 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 16:45:24,262 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'18675': np.int64(747), '17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83)}
2025-07-09 16:45:24,262 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 16:45:24,263 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'18675': np.int64(747), '17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83)}
2025-07-09 16:45:24,265 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:45:24,267 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:45:24,270 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:45:24,272 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:45:24,272 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'18675': np.int64(747), '17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83)}
2025-07-09 16:45:24,272 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 16:45:24,273 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'18675': np.int64(747), '17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83)}
2025-07-09 16:45:24,274 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:45:24,276 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:45:24,277 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:45:24,278 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:45:24,279 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'18675': np.int64(747), '17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83)}
2025-07-09 16:45:24,279 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 16:45:24,280 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'18675': np.int64(747), '17914': np.int64(151), '17612': np.int64(787), '17904': np.int64(83)}
2025-07-09 16:45:24,281 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 16:45:24,283 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 16:45:24,292 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 16:45:24,296 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 16:45:24,301 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 16:45:24,302 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'18675': np.int64(746), '17914': np.int64(148), '17612': np.int64(740), '17904': np.int64(81)}
2025-07-09 16:45:24,304 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 16:45:24,305 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'18675': np.int64(746), '17914': np.int64(148), '17612': np.int64(740), '17904': np.int64(81)}
2025-07-09 16:45:24,307 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 16:45:24,310 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 16:45:24,314 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 16:45:24,318 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 16:45:24,324 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 16:45:24,325 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'18675': np.int64(746), '17914': np.int64(145), '17612': np.int64(653), '17904': np.int64(81)}
2025-07-09 16:45:24,325 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 16:45:24,326 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'18675': np.int64(746), '17914': np.int64(145), '17612': np.int64(653), '17904': np.int64(81)}
2025-07-09 16:45:24,327 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 16:45:24,329 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 16:45:24,333 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 16:45:24,336 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 16:45:24,342 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 16:45:24,342 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'18675': np.int64(745), '17914': np.int64(142), '17612': np.int64(586), '17904': np.int64(80)}
2025-07-09 16:45:24,343 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 16:45:24,343 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'18675': np.int64(745), '17914': np.int64(142), '17612': np.int64(586), '17904': np.int64(80)}
2025-07-09 16:45:24,344 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 16:45:24,346 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:45:24,348 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 16:45:24,350 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 16:45:24,353 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 16:45:24,354 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'18675': np.int64(745), '17914': np.int64(131), '17612': np.int64(352), '17904': np.int64(66)}
2025-07-09 16:45:24,354 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 16:45:24,355 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'18675': np.int64(745), '17914': np.int64(131), '17612': np.int64(352), '17904': np.int64(66)}
2025-07-09 16:45:24,356 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 16:45:24,358 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:45:24,359 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 16:45:24,361 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 16:45:24,365 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 16:45:24,366 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'18675': np.int64(745), '17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65)}
2025-07-09 16:45:24,366 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 16:45:24,367 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'18675': np.int64(745), '17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65)}
2025-07-09 16:45:24,370 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:45:24,375 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:45:24,377 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:45:24,378 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:45:24,379 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'18675': np.int64(745), '17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65)}
2025-07-09 16:45:24,379 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 16:45:24,379 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'18675': np.int64(745), '17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65)}
2025-07-09 16:45:24,382 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:45:24,384 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:45:24,387 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:45:24,388 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:45:24,389 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'18675': np.int64(745), '17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65)}
2025-07-09 16:45:24,389 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 16:45:24,389 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'18675': np.int64(745), '17914': np.int64(119), '17612': np.int64(269), '17904': np.int64(65)}
2025-07-09 16:45:24,390 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 16:45:24,391 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 16:45:24,393 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 16:45:24,394 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 16:45:24,396 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 16:45:24,396 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'18675': np.int64(742), '17914': np.int64(116), '17612': np.int64(105), '17904': np.int64(63)}
2025-07-09 16:45:24,397 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 16:45:24,397 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'18675': np.int64(742), '17914': np.int64(116), '17612': np.int64(105), '17904': np.int64(63)}
2025-07-09 16:45:24,398 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 16:45:24,401 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 16:45:24,404 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 16:45:24,406 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 16:45:24,408 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 16:45:24,408 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'18675': np.int64(730), '17914': np.int64(105), '17612': np.int64(49), '17904': np.int64(62)}
2025-07-09 16:45:24,408 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 16:45:24,409 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'18675': np.int64(730), '17914': np.int64(105), '17612': np.int64(49), '17904': np.int64(62)}
2025-07-09 16:45:24,411 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 16:45:24,413 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:45:24,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 16:45:24,418 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 16:45:24,422 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 16:45:24,422 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'18675': np.int64(730), '17914': np.int64(104), '17612': np.int64(568), '17904': np.int64(61)}
2025-07-09 16:45:24,422 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 16:45:24,423 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'18675': np.int64(730), '17914': np.int64(104), '17612': np.int64(568), '17904': np.int64(61)}
2025-07-09 16:45:24,424 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 16:45:24,425 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:45:24,427 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 16:45:24,428 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 16:45:24,430 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 16:45:24,431 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'18675': np.int64(730), '17914': np.int64(97), '17612': np.int64(521), '17904': np.int64(59)}
2025-07-09 16:45:24,431 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 16:45:24,431 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'18675': np.int64(730), '17914': np.int64(97), '17612': np.int64(521), '17904': np.int64(59)}
2025-07-09 16:45:24,432 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 16:45:24,435 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 16:45:24,437 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 16:45:24,438 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 16:45:24,440 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 16:45:24,440 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58)}
2025-07-09 16:45:24,440 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 16:45:24,440 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58)}
2025-07-09 16:45:24,442 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:45:24,444 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:45:24,445 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:45:24,446 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:45:24,447 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58)}
2025-07-09 16:45:24,447 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 16:45:24,447 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58)}
2025-07-09 16:45:24,449 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:45:24,452 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:45:24,454 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:45:24,455 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:45:24,456 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58)}
2025-07-09 16:45:24,456 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 16:45:24,457 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(445), '17904': np.int64(58)}
2025-07-09 16:45:24,458 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 16:45:24,459 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:45:24,461 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:45:24,463 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 16:45:24,465 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 16:45:24,465 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(800), '17904': np.int64(52)}
2025-07-09 16:45:24,466 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 16:45:24,466 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'18675': np.int64(729), '17914': np.int64(92), '17612': np.int64(800), '17904': np.int64(52)}
2025-07-09 16:45:24,467 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 16:45:24,471 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:45:24,473 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 16:45:24,474 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 16:45:24,475 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 16:45:24,476 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'18675': np.int64(729), '17914': np.int64(91), '17612': np.int64(758), '17904': np.int64(51)}
2025-07-09 16:45:24,476 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 16:45:24,476 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'18675': np.int64(729), '17914': np.int64(91), '17612': np.int64(758), '17904': np.int64(51)}
2025-07-09 16:45:24,477 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 16:45:24,479 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:45:24,481 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 16:45:24,483 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 16:45:24,485 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 16:45:24,486 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'18675': np.int64(729), '17914': np.int64(87), '17612': np.int64(585), '17904': np.int64(50)}
2025-07-09 16:45:24,487 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 16:45:24,487 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'18675': np.int64(729), '17914': np.int64(87), '17612': np.int64(585), '17904': np.int64(50)}
2025-07-09 16:45:24,488 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 16:45:24,490 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:45:24,491 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 16:45:24,493 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 16:45:24,494 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 16:45:24,495 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'18675': np.int64(729), '17914': np.int64(78), '17612': np.int64(525), '17904': np.int64(48)}
2025-07-09 16:45:24,495 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 16:45:24,495 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'18675': np.int64(729), '17914': np.int64(78), '17612': np.int64(525), '17904': np.int64(48)}
2025-07-09 16:45:24,496 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 16:45:24,498 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:45:24,500 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 16:45:24,504 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 16:45:24,505 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 16:45:24,506 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'18675': np.int64(729), '17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45)}
2025-07-09 16:45:24,506 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 16:45:24,506 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'18675': np.int64(729), '17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45)}
2025-07-09 16:45:24,508 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:45:24,509 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:45:24,511 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:45:24,513 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:45:24,513 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'18675': np.int64(729), '17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45)}
2025-07-09 16:45:24,514 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 16:45:24,514 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'18675': np.int64(729), '17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45)}
2025-07-09 16:45:24,516 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:45:24,519 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:45:24,521 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:45:24,522 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:45:24,522 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'18675': np.int64(729), '17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45)}
2025-07-09 16:45:24,522 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 16:45:24,523 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'18675': np.int64(729), '17914': np.int64(72), '17612': np.int64(474), '17904': np.int64(45)}
2025-07-09 16:45:24,523 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 16:45:24,525 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:45:24,526 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 16:45:24,528 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 16:45:24,529 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 16:45:24,530 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'18675': np.int64(729), '17914': np.int64(71), '17612': np.int64(390), '17904': np.int64(42)}
2025-07-09 16:45:24,536 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
6  2025-06-02  17612           1006            935
2025-07-09 16:45:24,538 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
118  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-09 16:45:24,538 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 16:45:24,539 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 16:45:24,540 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
2  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
6  2025-06-02  17612           1006            935
2025-07-09 16:45:24,541 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
118  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-09 16:45:24,541 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 16:45:24,545 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 16:45:24,548 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
2    2025-06-01           1006
6    2025-06-02            935
10   2025-06-03            841
14   2025-06-04           1200
18   2025-06-05            904
22   2025-06-06            787
26   2025-06-07            787
30   2025-06-08            787
34   2025-06-09            740
38   2025-06-10            653
42   2025-06-11            586
46   2025-06-12            352
50   2025-06-13            269
54   2025-06-14            269
58   2025-06-15            269
62   2025-06-16            105
66   2025-06-17             49
70   2025-06-18            568
74   2025-06-19            521
78   2025-06-20            445
82   2025-06-21            445
86   2025-06-22            445
90   2025-06-23            800
94   2025-06-24            758
98   2025-06-25            585
102  2025-06-26            525
106  2025-06-27            474
110  2025-06-28            474
114  2025-06-29            474
118  2025-06-30            390
2025-07-09 16:45:24,550 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
3    2025-06-01            108
7    2025-06-02            106
11   2025-06-03             93
15   2025-06-04             86
19   2025-06-05             85
23   2025-06-06             83
27   2025-06-07             83
31   2025-06-08             83
35   2025-06-09             81
39   2025-06-10             81
43   2025-06-11             80
47   2025-06-12             66
51   2025-06-13             65
55   2025-06-14             65
59   2025-06-15             65
63   2025-06-16             63
67   2025-06-17             62
71   2025-06-18             61
75   2025-06-19             59
79   2025-06-20             58
83   2025-06-21             58
87   2025-06-22             58
91   2025-06-23             52
95   2025-06-24             51
99   2025-06-25             50
103  2025-06-26             48
107  2025-06-27             45
111  2025-06-28             45
115  2025-06-29             45
119  2025-06-30             42
2025-07-09 16:45:24,561 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 16:45:24,571 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 16:45:24,573 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 16:45:24,575 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
2    2025-06-01           21
6    2025-06-02           20
10   2025-06-03           18
14   2025-06-04           25
18   2025-06-05           19
22   2025-06-06           17
26   2025-06-07           17
30   2025-06-08           17
34   2025-06-09           16
38   2025-06-10           14
42   2025-06-11           13
46   2025-06-12            8
50   2025-06-13            6
54   2025-06-14            6
58   2025-06-15            6
62   2025-06-16            3
66   2025-06-17            2
70   2025-06-18           12
74   2025-06-19           11
78   2025-06-20           10
82   2025-06-21           10
86   2025-06-22           10
90   2025-06-23           17
94   2025-06-24           16
98   2025-06-25           13
102  2025-06-26           11
106  2025-06-27           10
110  2025-06-28           10
114  2025-06-29           10
118  2025-06-30            9
2025-07-09 16:45:24,576 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 16:45:24,577 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 16:45:24,577 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 16:45:24,577 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 16:45:24,579 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 16:45:24,580 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 16:45:24,581 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 16:45:24,589 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 16:45:24,589 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 16:45:24,590 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:45:24,590 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:45:24,592 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:45:24,936 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:45:24,938 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:45:24,939 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:45:24,939 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 16:45:24,962 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:45:25,106 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:45:25,111 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:45:25,348 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:25,465 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:45:25,652 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 16:45:25,856 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 16:45:25,859 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 16:45:27,499 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 16:45:27,500 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 16:45:27,501 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 16:45:27,502 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 16:45:27,502 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 16:45:27,503 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 16:45:27,503 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 16:45:27,504 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 16:45:27,505 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 16:45:27,508 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1                2            Ship
2                6            Ship
3                1            Ship
4                1            Ship
2025-07-09 16:45:27,509 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
   SKU  Quantity TransactionType
58             1            Ship
59             1            Ship
60             1            Ship
61             1            Ship
62             2            Ship
2025-07-09 16:45:27,510 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 16:45:27,517 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 16:45:27,517 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 16:45:27,521 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 16:45:27,522 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 16:45:27,524 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 16:45:27,524 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 16:47:50,945 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 16:47:50,949 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 16:47:51,272 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 16:47:51,272 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 16:47:51,272 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:47:51,272 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:47:51,285 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:47:51,552 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:47:51,554 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:47:51,555 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:47:51,555 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:47:51,583 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:47:51,761 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:47:51,763 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:47:52,188 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:52,304 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:52,306 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 16:47:52,442 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 16:47:52,449 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 16:47:52,474 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 16:47:52,475 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 16:47:52,476 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:47:52,476 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:47:52,478 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:47:52,735 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:47:52,738 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:47:52,739 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:47:52,739 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:47:52,761 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:47:52,905 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:47:52,910 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:47:53,115 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:53,229 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:53,233 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 16:47:53,416 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 16:47:53,423 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 16:47:53,425 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 16:47:53,427 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 16:47:53,436 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 16:47:53,437 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 16:47:53,438 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 16:47:53,438 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:47:53,439 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:47:53,440 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:47:53,726 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:47:53,729 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:47:53,730 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:47:53,731 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:47:53,756 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:47:53,918 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:47:53,921 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:47:54,116 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:54,235 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:54,237 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 16:47:54,441 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 16:47:54,448 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 16:47:54,458 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 16:47:54,458 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 16:47:54,459 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 16:47:54,459 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:47:54,460 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:47:54,463 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:47:54,714 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:47:54,717 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:47:54,718 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:47:54,719 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:47:54,742 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:47:54,896 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:47:54,898 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:47:55,157 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:55,280 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:55,282 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 16:47:55,464 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 16:47:55,469 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 16:47:55,472 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 16:47:55,473 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 16:47:55,473 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:47:55,474 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:47:55,476 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:47:55,736 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:47:55,738 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:47:55,739 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:47:55,740 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:47:55,762 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:47:55,931 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:47:55,932 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:47:56,142 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:56,265 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:56,267 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 16:47:56,414 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 16:47:56,416 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 16:47:56,425 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 16:47:56,425 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 16:47:56,426 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:47:56,426 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:47:56,430 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:47:56,653 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:47:56,656 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:47:56,657 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:47:56,658 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 16:47:56,680 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:47:56,843 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:47:56,845 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:47:57,102 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:57,221 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:57,224 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 16:47:57,409 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 16:47:57,411 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 16:47:57,412 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 16:47:57,413 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 16:47:57,413 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 16:47:57,425 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 16:47:57,427 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 16:47:57,428 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 16:47:57,430 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 16:47:57,431 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 16:47:57,432 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 16:47:57,435 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 16:47:57,435 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 16:47:57,436 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 16:47:57,438 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 16:47:57,439 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 16:47:57,440 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 16:47:57,441 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 175, '17904': 108, '18675': 749, '17612': 1006}
2025-07-09 16:47:57,441 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 16:47:57,442 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 175, '17904': 108, '18675': 749, '17612': 1006}
2025-07-09 16:47:57,445 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 16:47:57,448 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 16:47:57,449 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 16:47:57,450 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 16:47:57,451 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(175), '17904': np.int64(108), '18675': np.int64(749), '17612': np.int64(1006)}
2025-07-09 16:47:57,451 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 16:47:57,451 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(175), '17904': np.int64(108), '18675': np.int64(749), '17612': np.int64(1006)}
2025-07-09 16:47:57,452 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 16:47:57,454 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 16:47:57,456 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 16:47:57,457 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 16:47:57,459 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 16:47:57,459 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(172), '17904': np.int64(106), '18675': np.int64(748), '17612': np.int64(935)}
2025-07-09 16:47:57,460 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 16:47:57,460 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(172), '17904': np.int64(106), '18675': np.int64(748), '17612': np.int64(935)}
2025-07-09 16:47:57,461 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 16:47:57,466 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 16:47:57,468 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 16:47:57,470 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:47:57,472 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 16:47:57,472 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(166), '17904': np.int64(93), '18675': np.int64(748), '17612': np.int64(841)}
2025-07-09 16:47:57,472 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 16:47:57,473 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(166), '17904': np.int64(93), '18675': np.int64(748), '17612': np.int64(841)}
2025-07-09 16:47:57,474 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 16:47:57,476 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 16:47:57,478 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 16:47:57,479 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:47:57,483 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 16:47:57,484 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(159), '17904': np.int64(86), '18675': np.int64(748), '17612': np.int64(1200)}
2025-07-09 16:47:57,484 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 16:47:57,484 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(159), '17904': np.int64(86), '18675': np.int64(748), '17612': np.int64(1200)}
2025-07-09 16:47:57,485 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 16:47:57,487 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 16:47:57,488 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 16:47:57,490 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 16:47:57,493 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 16:47:57,494 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(152), '17904': np.int64(85), '18675': np.int64(748), '17612': np.int64(904)}
2025-07-09 16:47:57,494 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 16:47:57,495 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(152), '17904': np.int64(85), '18675': np.int64(748), '17612': np.int64(904)}
2025-07-09 16:47:57,496 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 16:47:57,500 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 16:47:57,502 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 16:47:57,504 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 16:47:57,506 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 16:47:57,506 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(151), '17904': np.int64(83), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 16:47:57,507 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 16:47:57,508 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(151), '17904': np.int64(83), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 16:47:57,510 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:47:57,512 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:47:57,514 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:47:57,517 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:47:57,518 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(151), '17904': np.int64(83), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 16:47:57,518 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 16:47:57,518 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(151), '17904': np.int64(83), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 16:47:57,521 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 16:47:57,522 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 16:47:57,524 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 16:47:57,525 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 16:47:57,525 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(151), '17904': np.int64(83), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 16:47:57,525 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 16:47:57,526 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(151), '17904': np.int64(83), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 16:47:57,527 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 16:47:57,528 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 16:47:57,530 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 16:47:57,534 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 16:47:57,535 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 16:47:57,536 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(148), '17904': np.int64(81), '18675': np.int64(746), '17612': np.int64(740)}
2025-07-09 16:47:57,536 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 16:47:57,536 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(148), '17904': np.int64(81), '18675': np.int64(746), '17612': np.int64(740)}
2025-07-09 16:47:57,537 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 16:47:57,539 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 16:47:57,540 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 16:47:57,541 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 16:47:57,543 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 16:47:57,544 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(145), '17904': np.int64(81), '18675': np.int64(746), '17612': np.int64(653)}
2025-07-09 16:47:57,545 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 16:47:57,545 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(145), '17904': np.int64(81), '18675': np.int64(746), '17612': np.int64(653)}
2025-07-09 16:47:57,547 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 16:47:57,549 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 16:47:57,552 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 16:47:57,554 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 16:47:57,555 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 16:47:57,555 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(142), '17904': np.int64(80), '18675': np.int64(745), '17612': np.int64(586)}
2025-07-09 16:47:57,556 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 16:47:57,556 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(142), '17904': np.int64(80), '18675': np.int64(745), '17612': np.int64(586)}
2025-07-09 16:47:57,557 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 16:47:57,559 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 16:47:57,563 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 16:47:57,569 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:47:57,571 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 16:47:57,572 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(131), '17904': np.int64(66), '18675': np.int64(745), '17612': np.int64(352)}
2025-07-09 16:47:57,572 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 16:47:57,573 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(131), '17904': np.int64(66), '18675': np.int64(745), '17612': np.int64(352)}
2025-07-09 16:47:57,574 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 16:47:57,578 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 16:47:57,580 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 16:47:57,583 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:47:57,589 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 16:47:57,591 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(119), '17904': np.int64(65), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 16:47:57,592 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 16:47:57,592 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(119), '17904': np.int64(65), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 16:47:57,594 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:47:57,596 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:47:57,599 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:47:57,604 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:47:57,606 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(119), '17904': np.int64(65), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 16:47:57,608 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 16:47:57,610 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(119), '17904': np.int64(65), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 16:47:57,614 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 16:47:57,616 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 16:47:57,618 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 16:47:57,622 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 16:47:57,623 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(119), '17904': np.int64(65), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 16:47:57,625 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 16:47:57,627 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(119), '17904': np.int64(65), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 16:47:57,629 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 16:47:57,633 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 16:47:57,638 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 16:47:57,640 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 16:47:57,641 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 16:47:57,644 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(116), '17904': np.int64(63), '18675': np.int64(742), '17612': np.int64(105)}
2025-07-09 16:47:57,646 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 16:47:57,649 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(116), '17904': np.int64(63), '18675': np.int64(742), '17612': np.int64(105)}
2025-07-09 16:47:57,655 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 16:47:57,658 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 16:47:57,660 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 16:47:57,662 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 16:47:57,667 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 16:47:57,668 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(105), '17904': np.int64(62), '18675': np.int64(730), '17612': np.int64(49)}
2025-07-09 16:47:57,671 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 16:47:57,675 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(105), '17904': np.int64(62), '18675': np.int64(730), '17612': np.int64(49)}
2025-07-09 16:47:57,678 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 16:47:57,682 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 16:47:57,686 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 16:47:57,689 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:47:57,692 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 16:47:57,692 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(104), '17904': np.int64(61), '18675': np.int64(730), '17612': np.int64(568)}
2025-07-09 16:47:57,693 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 16:47:57,693 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(104), '17904': np.int64(61), '18675': np.int64(730), '17612': np.int64(568)}
2025-07-09 16:47:57,697 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 16:47:57,704 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 16:47:57,707 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 16:47:57,710 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 16:47:57,713 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 16:47:57,714 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(97), '17904': np.int64(59), '18675': np.int64(730), '17612': np.int64(521)}
2025-07-09 16:47:57,715 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 16:47:57,715 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(97), '17904': np.int64(59), '18675': np.int64(730), '17612': np.int64(521)}
2025-07-09 16:47:57,718 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 16:47:57,720 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 16:47:57,721 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 16:47:57,722 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 16:47:57,724 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 16:47:57,724 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(92), '17904': np.int64(58), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 16:47:57,724 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 16:47:57,725 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(92), '17904': np.int64(58), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 16:47:57,727 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:47:57,728 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:47:57,730 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:47:57,731 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:47:57,733 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(92), '17904': np.int64(58), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 16:47:57,734 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 16:47:57,734 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(92), '17904': np.int64(58), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 16:47:57,736 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:47:57,737 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 16:47:57,740 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:47:57,742 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 16:47:57,744 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(92), '17904': np.int64(58), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 16:47:57,746 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 16:47:57,749 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(92), '17904': np.int64(58), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 16:47:57,751 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 16:47:57,752 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 16:47:57,754 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 16:47:57,756 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:47:57,757 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 16:47:57,758 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(92), '17904': np.int64(52), '18675': np.int64(729), '17612': np.int64(800)}
2025-07-09 16:47:57,758 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 16:47:57,758 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(92), '17904': np.int64(52), '18675': np.int64(729), '17612': np.int64(800)}
2025-07-09 16:47:57,760 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 16:47:57,761 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 16:47:57,763 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 16:47:57,765 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:47:57,768 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 16:47:57,768 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(91), '17904': np.int64(51), '18675': np.int64(729), '17612': np.int64(758)}
2025-07-09 16:47:57,768 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 16:47:57,768 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(91), '17904': np.int64(51), '18675': np.int64(729), '17612': np.int64(758)}
2025-07-09 16:47:57,769 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 16:47:57,770 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 16:47:57,773 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 16:47:57,774 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:47:57,776 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 16:47:57,776 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(87), '17904': np.int64(50), '18675': np.int64(729), '17612': np.int64(585)}
2025-07-09 16:47:57,776 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 16:47:57,776 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(87), '17904': np.int64(50), '18675': np.int64(729), '17612': np.int64(585)}
2025-07-09 16:47:57,777 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 16:47:57,779 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 16:47:57,781 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 16:47:57,785 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:47:57,787 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 16:47:57,787 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(78), '17904': np.int64(48), '18675': np.int64(729), '17612': np.int64(525)}
2025-07-09 16:47:57,787 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 16:47:57,787 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(78), '17904': np.int64(48), '18675': np.int64(729), '17612': np.int64(525)}
2025-07-09 16:47:57,788 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 16:47:57,790 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 16:47:57,792 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 16:47:57,793 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:47:57,795 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 16:47:57,795 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(72), '17904': np.int64(45), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 16:47:57,796 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 16:47:57,796 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(72), '17904': np.int64(45), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 16:47:57,800 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:47:57,802 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:47:57,804 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:47:57,805 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:47:57,806 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(72), '17904': np.int64(45), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 16:47:57,806 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 16:47:57,806 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(72), '17904': np.int64(45), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 16:47:57,808 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 16:47:57,809 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 16:47:57,810 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:47:57,812 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 16:47:57,812 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(72), '17904': np.int64(45), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 16:47:57,813 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 16:47:57,813 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(72), '17904': np.int64(45), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 16:47:57,815 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 16:47:57,817 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 16:47:57,819 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 16:47:57,821 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 16:47:57,823 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 16:47:57,823 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(71), '17904': np.int64(42), '18675': np.int64(729), '17612': np.int64(390)}
2025-07-09 16:47:57,830 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612           1006           1006
1  2025-06-01  17904            108            108
0  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
7  2025-06-02  17612           1006            935
2025-07-09 16:47:57,832 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
119  2025-06-30  17612            474            390
117  2025-06-30  17904             45             42
116  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-09 16:47:57,832 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 16:47:57,833 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 16:47:57,835 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612           1006           1006
1  2025-06-01  17904            108            108
0  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
7  2025-06-02  17612           1006            935
2025-07-09 16:47:57,837 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
119  2025-06-30  17612            474            390
117  2025-06-30  17904             45             42
116  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-09 16:47:57,837 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 16:47:57,842 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 16:47:57,843 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01           1006
7    2025-06-02            935
11   2025-06-03            841
15   2025-06-04           1200
19   2025-06-05            904
23   2025-06-06            787
27   2025-06-07            787
31   2025-06-08            787
35   2025-06-09            740
39   2025-06-10            653
43   2025-06-11            586
47   2025-06-12            352
51   2025-06-13            269
55   2025-06-14            269
59   2025-06-15            269
63   2025-06-16            105
67   2025-06-17             49
71   2025-06-18            568
75   2025-06-19            521
79   2025-06-20            445
83   2025-06-21            445
87   2025-06-22            445
91   2025-06-23            800
95   2025-06-24            758
99   2025-06-25            585
103  2025-06-26            525
107  2025-06-27            474
111  2025-06-28            474
115  2025-06-29            474
119  2025-06-30            390
2025-07-09 16:47:57,846 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            108
5    2025-06-02            106
9    2025-06-03             93
13   2025-06-04             86
17   2025-06-05             85
21   2025-06-06             83
25   2025-06-07             83
29   2025-06-08             83
33   2025-06-09             81
37   2025-06-10             81
41   2025-06-11             80
45   2025-06-12             66
49   2025-06-13             65
53   2025-06-14             65
57   2025-06-15             65
61   2025-06-16             63
65   2025-06-17             62
69   2025-06-18             61
73   2025-06-19             59
77   2025-06-20             58
81   2025-06-21             58
85   2025-06-22             58
89   2025-06-23             52
93   2025-06-24             51
97   2025-06-25             50
101  2025-06-26             48
105  2025-06-27             45
109  2025-06-28             45
113  2025-06-29             45
117  2025-06-30             42
2025-07-09 16:47:57,859 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 16:47:57,870 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 16:47:57,872 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 16:47:57,874 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           21
7    2025-06-02           20
11   2025-06-03           18
15   2025-06-04           25
19   2025-06-05           19
23   2025-06-06           17
27   2025-06-07           17
31   2025-06-08           17
35   2025-06-09           16
39   2025-06-10           14
43   2025-06-11           13
47   2025-06-12            8
51   2025-06-13            6
55   2025-06-14            6
59   2025-06-15            6
63   2025-06-16            3
67   2025-06-17            2
71   2025-06-18           12
75   2025-06-19           11
79   2025-06-20           10
83   2025-06-21           10
87   2025-06-22           10
91   2025-06-23           17
95   2025-06-24           16
99   2025-06-25           13
103  2025-06-26           11
107  2025-06-27           10
111  2025-06-28           10
115  2025-06-29           10
119  2025-06-30            9
2025-07-09 16:47:57,875 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 16:47:57,876 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 16:47:57,876 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 16:47:57,876 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 16:47:57,878 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 16:47:57,879 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 16:47:57,880 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 16:47:57,888 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 16:47:57,889 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 16:47:57,889 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 16:47:57,890 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 16:47:57,892 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 16:47:58,119 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 16:47:58,120 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 16:47:58,122 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 16:47:58,122 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 16:47:58,146 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 16:47:58,292 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 16:47:58,295 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 16:47:58,481 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:58,614 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 16:47:58,766 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 16:47:58,946 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 16:47:58,952 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 16:47:59,110 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 16:47:59,114 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 16:47:59,115 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 16:47:59,118 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 16:47:59,119 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 16:47:59,120 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 16:47:59,121 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 16:47:59,127 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 16:47:59,129 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 16:47:59,141 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1                2            Ship
2                6            Ship
3                1            Ship
4                1            Ship
2025-07-09 16:47:59,144 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
   SKU  Quantity TransactionType
58             1            Ship
59             1            Ship
60             1            Ship
61             1            Ship
62             2            Ship
2025-07-09 16:47:59,145 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 16:47:59,163 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 16:47:59,165 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 16:47:59,173 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 16:47:59,176 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 16:47:59,180 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 16:47:59,182 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 17:07:30,437 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 17:07:30,437 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 17:07:30,755 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 17:07:30,756 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 17:07:30,756 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:07:30,756 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:07:30,768 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:07:31,088 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:07:31,090 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:07:31,090 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:07:31,090 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:07:31,115 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:07:31,309 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:07:31,312 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:07:31,784 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:31,909 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:31,911 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 17:07:32,067 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 17:07:32,068 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 17:07:32,073 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 17:07:32,074 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 17:07:32,074 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:07:32,076 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:07:32,078 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:07:32,331 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:07:32,333 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:07:32,334 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:07:32,336 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:07:32,365 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:07:32,509 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:07:32,512 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:07:32,806 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:32,948 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:32,950 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 17:07:33,173 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 17:07:33,175 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 17:07:33,177 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 17:07:33,178 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 17:07:33,181 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 17:07:33,182 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 17:07:33,182 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 17:07:33,182 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:07:33,183 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:07:33,188 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:07:33,447 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:07:33,448 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:07:33,449 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:07:33,449 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:07:33,473 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:07:33,616 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:07:33,618 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:07:33,827 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:33,952 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:33,953 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 17:07:34,129 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 17:07:34,135 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 17:07:34,139 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 17:07:34,140 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 17:07:34,141 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 17:07:34,141 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:07:34,142 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:07:34,147 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:07:34,377 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:07:34,379 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:07:34,380 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:07:34,381 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:07:34,406 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:07:34,562 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:07:34,564 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:07:34,769 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:34,897 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:34,899 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 17:07:35,044 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 17:07:35,047 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 17:07:35,050 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 17:07:35,051 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 17:07:35,051 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:07:35,051 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:07:35,053 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:07:35,286 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:07:35,287 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:07:35,287 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:07:35,287 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:07:35,312 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:07:35,461 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:07:35,464 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:07:35,682 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:35,797 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:35,800 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 17:07:35,953 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 17:07:35,955 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 17:07:35,962 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 17:07:35,963 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 17:07:35,963 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:07:35,964 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:07:35,969 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:07:36,190 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:07:36,192 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:07:36,193 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:07:36,194 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:07:36,217 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:07:36,362 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:07:36,364 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:07:36,605 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:36,734 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:36,737 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 17:07:36,962 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 17:07:36,963 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 17:07:36,964 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 17:07:36,965 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 17:07:36,965 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 17:07:36,971 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 17:07:36,972 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 17:07:36,973 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 17:07:36,975 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 17:07:36,977 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 17:07:36,978 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 17:07:36,982 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 17:07:36,983 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 17:07:36,984 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 17:07:36,984 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 17:07:36,984 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 17:07:36,986 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 17:07:36,987 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 175, '17612': 1006, '18675': 749, '17904': 108}
2025-07-09 17:07:36,987 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 17:07:36,987 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 175, '17612': 1006, '18675': 749, '17904': 108}
2025-07-09 17:07:36,990 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 17:07:36,993 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 17:07:36,996 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 17:07:36,999 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 17:07:36,999 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(175), '17612': np.int64(1006), '18675': np.int64(749), '17904': np.int64(108)}
2025-07-09 17:07:37,000 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 17:07:37,000 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(175), '17612': np.int64(1006), '18675': np.int64(749), '17904': np.int64(108)}
2025-07-09 17:07:37,002 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 17:07:37,003 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 17:07:37,005 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 17:07:37,008 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 17:07:37,013 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 17:07:37,014 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(172), '17612': np.int64(935), '18675': np.int64(748), '17904': np.int64(106)}
2025-07-09 17:07:37,014 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 17:07:37,014 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(172), '17612': np.int64(935), '18675': np.int64(748), '17904': np.int64(106)}
2025-07-09 17:07:37,016 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 17:07:37,017 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 17:07:37,019 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 17:07:37,021 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 17:07:37,022 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 17:07:37,023 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(166), '17612': np.int64(841), '18675': np.int64(748), '17904': np.int64(93)}
2025-07-09 17:07:37,023 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 17:07:37,023 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(166), '17612': np.int64(841), '18675': np.int64(748), '17904': np.int64(93)}
2025-07-09 17:07:37,024 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 17:07:37,028 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 17:07:37,032 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 17:07:37,034 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 17:07:37,036 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 17:07:37,037 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(159), '17612': np.int64(1200), '18675': np.int64(748), '17904': np.int64(86)}
2025-07-09 17:07:37,037 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 17:07:37,038 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(159), '17612': np.int64(1200), '18675': np.int64(748), '17904': np.int64(86)}
2025-07-09 17:07:37,039 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 17:07:37,041 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 17:07:37,044 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 17:07:37,049 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 17:07:37,051 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 17:07:37,051 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(152), '17612': np.int64(904), '18675': np.int64(748), '17904': np.int64(85)}
2025-07-09 17:07:37,052 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 17:07:37,052 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(152), '17612': np.int64(904), '18675': np.int64(748), '17904': np.int64(85)}
2025-07-09 17:07:37,053 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 17:07:37,055 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 17:07:37,057 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 17:07:37,060 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 17:07:37,063 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 17:07:37,064 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 17:07:37,064 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 17:07:37,065 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 17:07:37,067 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 17:07:37,068 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 17:07:37,070 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 17:07:37,071 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 17:07:37,072 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 17:07:37,072 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 17:07:37,072 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 17:07:37,075 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 17:07:37,079 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 17:07:37,082 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 17:07:37,084 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 17:07:37,085 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 17:07:37,085 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 17:07:37,085 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(151), '17612': np.int64(787), '18675': np.int64(747), '17904': np.int64(83)}
2025-07-09 17:07:37,086 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 17:07:37,087 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 17:07:37,089 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 17:07:37,091 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 17:07:37,095 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 17:07:37,097 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(148), '17612': np.int64(740), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-09 17:07:37,098 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 17:07:37,098 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(148), '17612': np.int64(740), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-09 17:07:37,100 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 17:07:37,101 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 17:07:37,103 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 17:07:37,105 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 17:07:37,107 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 17:07:37,107 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(145), '17612': np.int64(653), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-09 17:07:37,107 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 17:07:37,108 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(145), '17612': np.int64(653), '18675': np.int64(746), '17904': np.int64(81)}
2025-07-09 17:07:37,110 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 17:07:37,115 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 17:07:37,117 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 17:07:37,119 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 17:07:37,121 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 17:07:37,121 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(142), '17612': np.int64(586), '18675': np.int64(745), '17904': np.int64(80)}
2025-07-09 17:07:37,122 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 17:07:37,122 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(142), '17612': np.int64(586), '18675': np.int64(745), '17904': np.int64(80)}
2025-07-09 17:07:37,123 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 17:07:37,125 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 17:07:37,129 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 17:07:37,132 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 17:07:37,134 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 17:07:37,134 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(131), '17612': np.int64(352), '18675': np.int64(745), '17904': np.int64(66)}
2025-07-09 17:07:37,135 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 17:07:37,135 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(131), '17612': np.int64(352), '18675': np.int64(745), '17904': np.int64(66)}
2025-07-09 17:07:37,136 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 17:07:37,138 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 17:07:37,139 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 17:07:37,141 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 17:07:37,147 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 17:07:37,148 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 17:07:37,148 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 17:07:37,149 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 17:07:37,151 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 17:07:37,152 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 17:07:37,153 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 17:07:37,154 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 17:07:37,155 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 17:07:37,155 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 17:07:37,155 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 17:07:37,157 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 17:07:37,159 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 17:07:37,161 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 17:07:37,164 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 17:07:37,164 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 17:07:37,165 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 17:07:37,165 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(119), '17612': np.int64(269), '18675': np.int64(745), '17904': np.int64(65)}
2025-07-09 17:07:37,166 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 17:07:37,168 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 17:07:37,169 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 17:07:37,171 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 17:07:37,173 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 17:07:37,173 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(116), '17612': np.int64(105), '18675': np.int64(742), '17904': np.int64(63)}
2025-07-09 17:07:37,173 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 17:07:37,173 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(116), '17612': np.int64(105), '18675': np.int64(742), '17904': np.int64(63)}
2025-07-09 17:07:37,174 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 17:07:37,177 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 17:07:37,180 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 17:07:37,182 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 17:07:37,184 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 17:07:37,184 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(105), '17612': np.int64(49), '18675': np.int64(730), '17904': np.int64(62)}
2025-07-09 17:07:37,185 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 17:07:37,185 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(105), '17612': np.int64(49), '18675': np.int64(730), '17904': np.int64(62)}
2025-07-09 17:07:37,186 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 17:07:37,187 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 17:07:37,189 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 17:07:37,190 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 17:07:37,195 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 17:07:37,196 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(104), '17612': np.int64(568), '18675': np.int64(730), '17904': np.int64(61)}
2025-07-09 17:07:37,197 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 17:07:37,197 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(104), '17612': np.int64(568), '18675': np.int64(730), '17904': np.int64(61)}
2025-07-09 17:07:37,199 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 17:07:37,200 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 17:07:37,202 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 17:07:37,204 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 17:07:37,205 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 17:07:37,206 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(97), '17612': np.int64(521), '18675': np.int64(730), '17904': np.int64(59)}
2025-07-09 17:07:37,206 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 17:07:37,207 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(97), '17612': np.int64(521), '18675': np.int64(730), '17904': np.int64(59)}
2025-07-09 17:07:37,208 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 17:07:37,213 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 17:07:37,215 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 17:07:37,218 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 17:07:37,220 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 17:07:37,221 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 17:07:37,221 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 17:07:37,223 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 17:07:37,225 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 17:07:37,230 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 17:07:37,232 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:07:37,233 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 17:07:37,234 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 17:07:37,234 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 17:07:37,234 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 17:07:37,236 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 17:07:37,238 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 17:07:37,240 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:07:37,240 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 17:07:37,240 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 17:07:37,241 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 17:07:37,241 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(92), '17612': np.int64(445), '18675': np.int64(729), '17904': np.int64(58)}
2025-07-09 17:07:37,243 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 17:07:37,245 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 17:07:37,247 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 17:07:37,250 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:07:37,251 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 17:07:37,252 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(92), '17612': np.int64(800), '18675': np.int64(729), '17904': np.int64(52)}
2025-07-09 17:07:37,252 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 17:07:37,252 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(92), '17612': np.int64(800), '18675': np.int64(729), '17904': np.int64(52)}
2025-07-09 17:07:37,253 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 17:07:37,255 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 17:07:37,256 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 17:07:37,258 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:07:37,261 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 17:07:37,263 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(91), '17612': np.int64(758), '18675': np.int64(729), '17904': np.int64(51)}
2025-07-09 17:07:37,263 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 17:07:37,264 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(91), '17612': np.int64(758), '18675': np.int64(729), '17904': np.int64(51)}
2025-07-09 17:07:37,265 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 17:07:37,266 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 17:07:37,268 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 17:07:37,270 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:07:37,271 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 17:07:37,272 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(87), '17612': np.int64(585), '18675': np.int64(729), '17904': np.int64(50)}
2025-07-09 17:07:37,272 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 17:07:37,272 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(87), '17612': np.int64(585), '18675': np.int64(729), '17904': np.int64(50)}
2025-07-09 17:07:37,273 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 17:07:37,274 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 17:07:37,279 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 17:07:37,281 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:07:37,282 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 17:07:37,283 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(78), '17612': np.int64(525), '18675': np.int64(729), '17904': np.int64(48)}
2025-07-09 17:07:37,283 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 17:07:37,283 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(78), '17612': np.int64(525), '18675': np.int64(729), '17904': np.int64(48)}
2025-07-09 17:07:37,284 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 17:07:37,286 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 17:07:37,287 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 17:07:37,289 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:07:37,290 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 17:07:37,291 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 17:07:37,291 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 17:07:37,292 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 17:07:37,296 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 17:07:37,298 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 17:07:37,299 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:07:37,300 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 17:07:37,301 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 17:07:37,301 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 17:07:37,301 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 17:07:37,303 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 17:07:37,304 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 17:07:37,306 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:07:37,307 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 17:07:37,308 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 17:07:37,308 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 17:07:37,308 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(72), '17612': np.int64(474), '18675': np.int64(729), '17904': np.int64(45)}
2025-07-09 17:07:37,311 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 17:07:37,313 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 17:07:37,315 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 17:07:37,317 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:07:37,318 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 17:07:37,319 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(71), '17612': np.int64(390), '18675': np.int64(729), '17904': np.int64(42)}
2025-07-09 17:07:37,321 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
0  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-09 17:07:37,323 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
116  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-09 17:07:37,323 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 17:07:37,324 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 17:07:37,325 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
1  2025-06-01  17612           1006           1006
3  2025-06-01  17904            108            108
0  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
5  2025-06-02  17612           1006            935
2025-07-09 17:07:37,327 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
117  2025-06-30  17612            474            390
119  2025-06-30  17904             45             42
116  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-09 17:07:37,329 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 17:07:37,331 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 17:07:37,334 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
1    2025-06-01           1006
5    2025-06-02            935
9    2025-06-03            841
13   2025-06-04           1200
17   2025-06-05            904
21   2025-06-06            787
25   2025-06-07            787
29   2025-06-08            787
33   2025-06-09            740
37   2025-06-10            653
41   2025-06-11            586
45   2025-06-12            352
49   2025-06-13            269
53   2025-06-14            269
57   2025-06-15            269
61   2025-06-16            105
65   2025-06-17             49
69   2025-06-18            568
73   2025-06-19            521
77   2025-06-20            445
81   2025-06-21            445
85   2025-06-22            445
89   2025-06-23            800
93   2025-06-24            758
97   2025-06-25            585
101  2025-06-26            525
105  2025-06-27            474
109  2025-06-28            474
113  2025-06-29            474
117  2025-06-30            390
2025-07-09 17:07:37,335 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
3    2025-06-01            108
7    2025-06-02            106
11   2025-06-03             93
15   2025-06-04             86
19   2025-06-05             85
23   2025-06-06             83
27   2025-06-07             83
31   2025-06-08             83
35   2025-06-09             81
39   2025-06-10             81
43   2025-06-11             80
47   2025-06-12             66
51   2025-06-13             65
55   2025-06-14             65
59   2025-06-15             65
63   2025-06-16             63
67   2025-06-17             62
71   2025-06-18             61
75   2025-06-19             59
79   2025-06-20             58
83   2025-06-21             58
87   2025-06-22             58
91   2025-06-23             52
95   2025-06-24             51
99   2025-06-25             50
103  2025-06-26             48
107  2025-06-27             45
111  2025-06-28             45
115  2025-06-29             45
119  2025-06-30             42
2025-07-09 17:07:37,341 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 17:07:37,348 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 17:07:37,349 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 17:07:37,351 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
1    2025-06-01           21
5    2025-06-02           20
9    2025-06-03           18
13   2025-06-04           25
17   2025-06-05           19
21   2025-06-06           17
25   2025-06-07           17
29   2025-06-08           17
33   2025-06-09           16
37   2025-06-10           14
41   2025-06-11           13
45   2025-06-12            8
49   2025-06-13            6
53   2025-06-14            6
57   2025-06-15            6
61   2025-06-16            3
65   2025-06-17            2
69   2025-06-18           12
73   2025-06-19           11
77   2025-06-20           10
81   2025-06-21           10
85   2025-06-22           10
89   2025-06-23           17
93   2025-06-24           16
97   2025-06-25           13
101  2025-06-26           11
105  2025-06-27           10
109  2025-06-28           10
113  2025-06-29           10
117  2025-06-30            9
2025-07-09 17:07:37,352 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 17:07:37,353 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 17:07:37,353 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 17:07:37,354 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 17:07:37,355 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 17:07:37,355 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 17:07:37,357 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 17:07:37,365 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 17:07:37,366 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 17:07:37,366 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:07:37,366 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:07:37,369 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:07:37,604 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:07:37,606 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:07:37,606 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:07:37,606 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 17:07:37,632 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:07:37,771 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:07:37,773 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:07:37,974 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:38,086 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:07:38,259 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 17:07:38,397 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 17:07:38,400 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 17:07:39,140 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 17:07:39,143 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 17:07:39,145 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 17:07:39,146 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 17:07:39,149 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 17:07:39,150 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 17:07:39,151 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 17:07:39,155 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 17:07:39,156 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 17:07:39,166 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1                2            Ship
2                6            Ship
3                1            Ship
4                1            Ship
2025-07-09 17:07:39,173 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
   SKU  Quantity TransactionType
58             1            Ship
59             1            Ship
60             1            Ship
61             1            Ship
62             2            Ship
2025-07-09 17:07:39,176 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 17:07:39,188 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 17:07:39,190 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 17:07:39,197 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 17:07:39,201 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 17:07:39,206 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 17:07:39,208 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 17:07:39,210 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 17:07:39,210 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 17:13:58,508 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 17:13:58,508 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 17:13:58,832 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 17:13:58,832 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 17:13:58,833 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:13:58,833 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:13:58,844 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:13:59,151 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:13:59,153 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:13:59,154 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:13:59,154 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:13:59,178 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:13:59,358 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:13:59,360 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:13:59,941 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:00,069 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:00,071 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 17:14:00,249 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 17:14:00,253 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 17:14:00,260 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 17:14:00,260 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 17:14:00,260 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:14:00,261 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:14:00,263 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:14:00,533 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:14:00,537 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:14:00,538 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:14:00,538 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:14:00,562 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:14:00,716 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:14:00,720 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:14:01,020 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:01,136 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:01,137 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 17:14:01,282 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 17:14:01,284 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 17:14:01,285 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 17:14:01,286 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 17:14:01,288 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 17:14:01,289 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 17:14:01,290 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 17:14:01,290 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:14:01,290 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:14:01,293 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:14:01,535 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:14:01,538 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:14:01,538 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:14:01,538 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:14:01,561 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:14:01,721 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:14:01,726 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:14:01,924 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:02,053 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:02,055 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 17:14:02,210 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 17:14:02,216 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 17:14:02,220 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 17:14:02,221 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 17:14:02,222 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 17:14:02,222 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:14:02,222 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:14:02,227 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:14:02,450 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:14:02,453 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:14:02,455 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:14:02,455 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:14:02,480 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:14:02,630 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:14:02,633 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:14:02,815 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:02,923 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:02,926 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 17:14:03,115 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 17:14:03,118 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 17:14:03,121 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 17:14:03,121 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 17:14:03,122 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:14:03,122 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:14:03,124 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:14:03,350 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:14:03,352 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:14:03,352 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:14:03,352 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:14:03,374 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:14:03,520 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:14:03,524 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:14:03,724 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:03,839 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:03,842 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 17:14:03,986 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 17:14:03,990 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 17:14:03,997 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 17:14:03,998 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 17:14:03,998 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:14:03,999 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:14:04,002 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:14:04,226 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:14:04,227 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:14:04,228 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:14:04,229 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:14:04,250 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:14:04,404 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:14:04,407 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:14:04,651 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:04,770 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:04,773 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 17:14:04,946 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 17:14:04,948 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 17:14:04,950 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 17:14:04,952 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 17:14:04,952 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 17:14:04,959 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 17:14:04,963 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 17:14:04,963 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 17:14:04,965 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 17:14:04,966 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 17:14:04,966 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 17:14:04,968 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 17:14:04,969 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 17:14:04,969 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 17:14:04,969 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 17:14:04,970 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 17:14:04,971 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 17:14:04,972 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17904': 108, '17914': 175, '18675': 749, '17612': 1006}
2025-07-09 17:14:04,972 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 17:14:04,973 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17904': 108, '17914': 175, '18675': 749, '17612': 1006}
2025-07-09 17:14:04,975 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 17:14:04,978 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 17:14:04,979 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 17:14:04,981 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 17:14:04,981 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17904': np.int64(108), '17914': np.int64(175), '18675': np.int64(749), '17612': np.int64(1006)}
2025-07-09 17:14:04,981 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 17:14:04,981 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17904': np.int64(108), '17914': np.int64(175), '18675': np.int64(749), '17612': np.int64(1006)}
2025-07-09 17:14:04,982 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 17:14:04,983 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 17:14:04,984 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 17:14:04,987 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 17:14:04,988 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 17:14:04,989 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17904': np.int64(106), '17914': np.int64(172), '18675': np.int64(748), '17612': np.int64(935)}
2025-07-09 17:14:04,989 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 17:14:04,989 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17904': np.int64(106), '17914': np.int64(172), '18675': np.int64(748), '17612': np.int64(935)}
2025-07-09 17:14:04,990 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 17:14:04,992 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 17:14:04,995 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 17:14:04,997 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 17:14:04,999 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 17:14:04,999 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17904': np.int64(93), '17914': np.int64(166), '18675': np.int64(748), '17612': np.int64(841)}
2025-07-09 17:14:05,000 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 17:14:05,000 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17904': np.int64(93), '17914': np.int64(166), '18675': np.int64(748), '17612': np.int64(841)}
2025-07-09 17:14:05,001 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 17:14:05,003 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 17:14:05,004 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 17:14:05,006 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 17:14:05,009 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 17:14:05,010 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17904': np.int64(86), '17914': np.int64(159), '18675': np.int64(748), '17612': np.int64(1200)}
2025-07-09 17:14:05,011 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 17:14:05,012 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17904': np.int64(86), '17914': np.int64(159), '18675': np.int64(748), '17612': np.int64(1200)}
2025-07-09 17:14:05,013 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 17:14:05,015 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 17:14:05,016 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 17:14:05,018 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 17:14:05,019 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 17:14:05,020 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17904': np.int64(85), '17914': np.int64(152), '18675': np.int64(748), '17612': np.int64(904)}
2025-07-09 17:14:05,020 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 17:14:05,020 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17904': np.int64(85), '17914': np.int64(152), '18675': np.int64(748), '17612': np.int64(904)}
2025-07-09 17:14:05,021 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 17:14:05,023 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 17:14:05,025 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 17:14:05,029 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 17:14:05,031 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 17:14:05,031 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 17:14:05,031 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 17:14:05,031 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 17:14:05,033 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 17:14:05,034 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 17:14:05,036 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 17:14:05,037 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 17:14:05,038 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 17:14:05,038 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 17:14:05,038 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 17:14:05,039 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 17:14:05,042 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 17:14:05,046 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 17:14:05,047 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 17:14:05,048 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 17:14:05,048 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 17:14:05,049 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17904': np.int64(83), '17914': np.int64(151), '18675': np.int64(747), '17612': np.int64(787)}
2025-07-09 17:14:05,050 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 17:14:05,051 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 17:14:05,053 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 17:14:05,055 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 17:14:05,057 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 17:14:05,058 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17904': np.int64(81), '17914': np.int64(148), '18675': np.int64(746), '17612': np.int64(740)}
2025-07-09 17:14:05,059 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 17:14:05,059 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17904': np.int64(81), '17914': np.int64(148), '18675': np.int64(746), '17612': np.int64(740)}
2025-07-09 17:14:05,061 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 17:14:05,063 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 17:14:05,064 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 17:14:05,067 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 17:14:05,069 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 17:14:05,069 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17904': np.int64(81), '17914': np.int64(145), '18675': np.int64(746), '17612': np.int64(653)}
2025-07-09 17:14:05,070 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 17:14:05,070 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17904': np.int64(81), '17914': np.int64(145), '18675': np.int64(746), '17612': np.int64(653)}
2025-07-09 17:14:05,071 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 17:14:05,072 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 17:14:05,074 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 17:14:05,077 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 17:14:05,080 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 17:14:05,080 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17904': np.int64(80), '17914': np.int64(142), '18675': np.int64(745), '17612': np.int64(586)}
2025-07-09 17:14:05,081 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 17:14:05,081 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17904': np.int64(80), '17914': np.int64(142), '18675': np.int64(745), '17612': np.int64(586)}
2025-07-09 17:14:05,082 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 17:14:05,083 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 17:14:05,085 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 17:14:05,086 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 17:14:05,088 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 17:14:05,088 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17904': np.int64(66), '17914': np.int64(131), '18675': np.int64(745), '17612': np.int64(352)}
2025-07-09 17:14:05,088 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 17:14:05,088 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17904': np.int64(66), '17914': np.int64(131), '18675': np.int64(745), '17612': np.int64(352)}
2025-07-09 17:14:05,089 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 17:14:05,092 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 17:14:05,096 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 17:14:05,098 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 17:14:05,100 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 17:14:05,100 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 17:14:05,100 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 17:14:05,101 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 17:14:05,102 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 17:14:05,104 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 17:14:05,105 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 17:14:05,106 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 17:14:05,107 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 17:14:05,107 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 17:14:05,107 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 17:14:05,112 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 17:14:05,114 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 17:14:05,115 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 17:14:05,117 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 17:14:05,117 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 17:14:05,117 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 17:14:05,118 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17904': np.int64(65), '17914': np.int64(119), '18675': np.int64(745), '17612': np.int64(269)}
2025-07-09 17:14:05,119 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 17:14:05,120 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 17:14:05,122 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 17:14:05,123 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 17:14:05,126 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 17:14:05,128 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17904': np.int64(63), '17914': np.int64(116), '18675': np.int64(742), '17612': np.int64(105)}
2025-07-09 17:14:05,128 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 17:14:05,128 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17904': np.int64(63), '17914': np.int64(116), '18675': np.int64(742), '17612': np.int64(105)}
2025-07-09 17:14:05,130 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 17:14:05,131 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 17:14:05,133 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 17:14:05,134 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 17:14:05,136 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 17:14:05,136 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17904': np.int64(62), '17914': np.int64(105), '18675': np.int64(730), '17612': np.int64(49)}
2025-07-09 17:14:05,136 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 17:14:05,136 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17904': np.int64(62), '17914': np.int64(105), '18675': np.int64(730), '17612': np.int64(49)}
2025-07-09 17:14:05,137 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 17:14:05,139 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 17:14:05,140 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 17:14:05,143 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 17:14:05,146 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 17:14:05,146 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17904': np.int64(61), '17914': np.int64(104), '18675': np.int64(730), '17612': np.int64(568)}
2025-07-09 17:14:05,146 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 17:14:05,147 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17904': np.int64(61), '17914': np.int64(104), '18675': np.int64(730), '17612': np.int64(568)}
2025-07-09 17:14:05,148 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 17:14:05,149 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 17:14:05,151 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 17:14:05,152 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 17:14:05,153 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 17:14:05,154 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17904': np.int64(59), '17914': np.int64(97), '18675': np.int64(730), '17612': np.int64(521)}
2025-07-09 17:14:05,154 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 17:14:05,154 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17904': np.int64(59), '17914': np.int64(97), '18675': np.int64(730), '17612': np.int64(521)}
2025-07-09 17:14:05,156 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 17:14:05,157 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 17:14:05,161 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 17:14:05,163 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 17:14:05,165 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 17:14:05,165 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 17:14:05,165 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 17:14:05,166 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 17:14:05,168 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 17:14:05,170 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 17:14:05,171 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:14:05,171 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 17:14:05,171 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 17:14:05,172 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 17:14:05,172 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 17:14:05,174 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 17:14:05,178 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 17:14:05,179 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:14:05,182 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 17:14:05,182 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 17:14:05,182 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 17:14:05,182 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17904': np.int64(58), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(445)}
2025-07-09 17:14:05,182 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 17:14:05,185 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 17:14:05,186 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 17:14:05,188 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:14:05,189 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 17:14:05,189 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17904': np.int64(52), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(800)}
2025-07-09 17:14:05,190 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 17:14:05,190 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17904': np.int64(52), '17914': np.int64(92), '18675': np.int64(729), '17612': np.int64(800)}
2025-07-09 17:14:05,191 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 17:14:05,196 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 17:14:05,198 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 17:14:05,200 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:14:05,202 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 17:14:05,202 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17904': np.int64(51), '17914': np.int64(91), '18675': np.int64(729), '17612': np.int64(758)}
2025-07-09 17:14:05,203 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 17:14:05,203 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17904': np.int64(51), '17914': np.int64(91), '18675': np.int64(729), '17612': np.int64(758)}
2025-07-09 17:14:05,204 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 17:14:05,206 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 17:14:05,210 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 17:14:05,213 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:14:05,214 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 17:14:05,216 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17904': np.int64(50), '17914': np.int64(87), '18675': np.int64(729), '17612': np.int64(585)}
2025-07-09 17:14:05,216 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 17:14:05,216 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17904': np.int64(50), '17914': np.int64(87), '18675': np.int64(729), '17612': np.int64(585)}
2025-07-09 17:14:05,218 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 17:14:05,219 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 17:14:05,222 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 17:14:05,223 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:14:05,228 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 17:14:05,228 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17904': np.int64(48), '17914': np.int64(78), '18675': np.int64(729), '17612': np.int64(525)}
2025-07-09 17:14:05,229 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 17:14:05,229 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17904': np.int64(48), '17914': np.int64(78), '18675': np.int64(729), '17612': np.int64(525)}
2025-07-09 17:14:05,230 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 17:14:05,232 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 17:14:05,233 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 17:14:05,235 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:14:05,236 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 17:14:05,237 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 17:14:05,238 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 17:14:05,238 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 17:14:05,240 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 17:14:05,244 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 17:14:05,246 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:14:05,247 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 17:14:05,247 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 17:14:05,247 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 17:14:05,248 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 17:14:05,249 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 17:14:05,251 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 17:14:05,252 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:14:05,254 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 17:14:05,255 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 17:14:05,255 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 17:14:05,255 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17904': np.int64(45), '17914': np.int64(72), '18675': np.int64(729), '17612': np.int64(474)}
2025-07-09 17:14:05,256 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 17:14:05,258 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 17:14:05,262 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 17:14:05,264 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:14:05,266 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 17:14:05,266 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17904': np.int64(42), '17914': np.int64(71), '18675': np.int64(729), '17612': np.int64(390)}
2025-07-09 17:14:05,268 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612           1006           1006
0  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
7  2025-06-02  17612           1006            935
2025-07-09 17:14:05,269 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
119  2025-06-30  17612            474            390
116  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-09 17:14:05,270 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 17:14:05,270 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 17:14:05,271 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612           1006           1006
0  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
2  2025-06-01  18675            749            749
7  2025-06-02  17612           1006            935
2025-07-09 17:14:05,272 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            729            729
119  2025-06-30  17612            474            390
116  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
118  2025-06-30  18675            729            729
2025-07-09 17:14:05,273 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 17:14:05,275 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 17:14:05,279 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01           1006
7    2025-06-02            935
11   2025-06-03            841
15   2025-06-04           1200
19   2025-06-05            904
23   2025-06-06            787
27   2025-06-07            787
31   2025-06-08            787
35   2025-06-09            740
39   2025-06-10            653
43   2025-06-11            586
47   2025-06-12            352
51   2025-06-13            269
55   2025-06-14            269
59   2025-06-15            269
63   2025-06-16            105
67   2025-06-17             49
71   2025-06-18            568
75   2025-06-19            521
79   2025-06-20            445
83   2025-06-21            445
87   2025-06-22            445
91   2025-06-23            800
95   2025-06-24            758
99   2025-06-25            585
103  2025-06-26            525
107  2025-06-27            474
111  2025-06-28            474
115  2025-06-29            474
119  2025-06-30            390
2025-07-09 17:14:05,281 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
0    2025-06-01            108
4    2025-06-02            106
8    2025-06-03             93
12   2025-06-04             86
16   2025-06-05             85
20   2025-06-06             83
24   2025-06-07             83
28   2025-06-08             83
32   2025-06-09             81
36   2025-06-10             81
40   2025-06-11             80
44   2025-06-12             66
48   2025-06-13             65
52   2025-06-14             65
56   2025-06-15             65
60   2025-06-16             63
64   2025-06-17             62
68   2025-06-18             61
72   2025-06-19             59
76   2025-06-20             58
80   2025-06-21             58
84   2025-06-22             58
88   2025-06-23             52
92   2025-06-24             51
96   2025-06-25             50
100  2025-06-26             48
104  2025-06-27             45
108  2025-06-28             45
112  2025-06-29             45
116  2025-06-30             42
2025-07-09 17:14:05,287 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 17:14:05,291 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 17:14:05,295 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 17:14:05,297 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           21
7    2025-06-02           20
11   2025-06-03           18
15   2025-06-04           25
19   2025-06-05           19
23   2025-06-06           17
27   2025-06-07           17
31   2025-06-08           17
35   2025-06-09           16
39   2025-06-10           14
43   2025-06-11           13
47   2025-06-12            8
51   2025-06-13            6
55   2025-06-14            6
59   2025-06-15            6
63   2025-06-16            3
67   2025-06-17            2
71   2025-06-18           12
75   2025-06-19           11
79   2025-06-20           10
83   2025-06-21           10
87   2025-06-22           10
91   2025-06-23           17
95   2025-06-24           16
99   2025-06-25           13
103  2025-06-26           11
107  2025-06-27           10
111  2025-06-28           10
115  2025-06-29           10
119  2025-06-30            9
2025-07-09 17:14:05,299 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 17:14:05,299 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 17:14:05,300 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 17:14:05,300 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 17:14:05,302 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 17:14:05,303 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 17:14:05,304 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 17:14:05,310 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 17:14:05,311 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 17:14:05,312 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:14:05,312 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:14:05,314 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:14:05,674 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:14:05,679 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:14:05,680 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:14:05,681 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 17:14:05,705 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:14:05,857 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:14:05,861 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:14:06,049 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:06,215 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:06,496 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 17:14:06,650 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 17:14:06,652 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 17:14:07,228 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 17:14:07,230 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 17:14:07,231 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 17:14:07,232 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 17:14:07,233 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 17:14:07,234 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 17:14:07,234 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 17:14:07,236 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 17:14:07,237 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 17:14:07,240 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1                2            Ship
2                6            Ship
3                1            Ship
4                1            Ship
2025-07-09 17:14:07,244 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
   SKU  Quantity TransactionType
58             1            Ship
59             1            Ship
60             1            Ship
61             1            Ship
62             2            Ship
2025-07-09 17:14:07,245 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 17:14:07,247 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 17:14:07,248 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 17:14:07,250 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 17:14:07,250 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 17:14:07,252 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 17:14:07,252 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 17:14:07,252 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 17:14:07,253 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 17:14:07,254 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:14:07,256 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:14:07,258 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:14:07,487 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:14:07,490 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:14:07,492 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:14:07,493 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 17:14:07,515 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:14:07,661 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:14:07,663 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:14:07,850 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:07,981 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:14:08,133 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 17:14:08,276 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 17:14:08,279 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 17:14:08,431 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 17:14:08,432 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 17:14:08,433 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 17:14:08,434 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 17:14:08,434 - __main__ - INFO - Script finished successfully.
2025-07-09 17:24:40,626 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 17:24:40,627 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 17:24:40,983 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 17:24:40,983 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 17:24:40,983 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:24:40,984 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:24:40,995 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:24:41,304 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:24:41,307 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:24:41,308 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:24:41,309 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:24:41,332 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:24:41,526 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:24:41,530 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:24:41,950 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:42,082 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:42,083 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 17:24:42,233 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 17:24:42,235 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 17:24:42,243 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 17:24:42,244 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 17:24:42,244 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:24:42,245 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:24:42,248 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:24:42,511 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:24:42,513 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:24:42,514 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:24:42,514 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:24:42,538 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:24:42,695 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:24:42,697 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:24:42,914 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:43,025 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:43,026 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 17:24:43,222 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 17:24:43,225 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 17:24:43,227 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 17:24:43,229 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 17:24:43,232 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 17:24:43,232 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 17:24:43,232 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 17:24:43,233 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:24:43,233 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:24:43,237 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:24:43,490 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:24:43,494 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:24:43,495 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:24:43,496 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:24:43,525 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:24:43,687 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:24:43,690 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:24:43,903 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:44,027 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:44,028 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 17:24:44,178 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 17:24:44,187 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 17:24:44,195 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 17:24:44,198 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 17:24:44,199 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 17:24:44,201 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:24:44,203 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:24:44,208 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:24:44,454 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:24:44,456 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:24:44,457 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:24:44,457 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:24:44,481 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:24:44,632 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:24:44,634 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:24:44,847 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:44,967 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:44,969 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 17:24:45,158 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 17:24:45,163 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 17:24:45,167 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 17:24:45,168 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 17:24:45,168 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:24:45,169 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:24:45,171 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:24:45,459 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:24:45,460 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:24:45,461 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:24:45,461 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:24:45,482 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:24:45,643 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:24:45,644 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:24:45,874 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:45,991 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:45,992 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 17:24:46,134 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 17:24:46,136 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 17:24:46,142 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 17:24:46,143 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 17:24:46,143 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:24:46,143 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:24:46,147 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:24:46,379 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:24:46,381 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:24:46,382 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:24:46,383 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 17:24:46,403 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:24:46,559 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:24:46,561 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:24:46,807 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:46,924 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:46,925 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 17:24:47,068 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 17:24:47,070 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 17:24:47,071 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 17:24:47,073 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 17:24:47,074 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 17:24:47,079 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 17:24:47,081 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 17:24:47,082 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 17:24:47,085 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 17:24:47,087 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 17:24:47,088 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 17:24:47,091 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 17:24:47,092 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 1006), ('17904', 108), ('17914', 175), ('18675', 749)]...
2025-07-09 17:24:47,093 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 17:24:47,093 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 17:24:47,094 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 17:24:47,095 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 17:24:47,096 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'18675': 749, '17914': 175, '17904': 108, '17612': 1006}
2025-07-09 17:24:47,097 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 17:24:47,097 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'18675': 749, '17914': 175, '17904': 108, '17612': 1006}
2025-07-09 17:24:47,101 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 17:24:47,103 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 175, Received: 0, Shipped: 0, Repack: 0, EOD: 175
2025-07-09 17:24:47,105 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 108, Received: 0, Shipped: 0, Repack: 0, EOD: 108
2025-07-09 17:24:47,108 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 1006, Received: 0, Shipped: 0, Repack: 0, EOD: 1006
2025-07-09 17:24:47,108 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'18675': np.int64(749), '17914': np.int64(175), '17904': np.int64(108), '17612': np.int64(1006)}
2025-07-09 17:24:47,109 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 17:24:47,109 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'18675': np.int64(749), '17914': np.int64(175), '17904': np.int64(108), '17612': np.int64(1006)}
2025-07-09 17:24:47,110 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 17:24:47,113 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 749, Received: 0, Shipped: 1, Repack: 0, EOD: 748
2025-07-09 17:24:47,115 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 175, Received: 0, Shipped: 3, Repack: 0, EOD: 172
2025-07-09 17:24:47,116 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 108, Received: 0, Shipped: 2, Repack: 0, EOD: 106
2025-07-09 17:24:47,120 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 1006, Received: 0, Shipped: 71, Repack: 0, EOD: 935
2025-07-09 17:24:47,120 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'18675': np.int64(748), '17914': np.int64(172), '17904': np.int64(106), '17612': np.int64(935)}
2025-07-09 17:24:47,120 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 17:24:47,121 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'18675': np.int64(748), '17914': np.int64(172), '17904': np.int64(106), '17612': np.int64(935)}
2025-07-09 17:24:47,124 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 17:24:47,125 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 17:24:47,127 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 172, Received: 0, Shipped: 6, Repack: 0, EOD: 166
2025-07-09 17:24:47,129 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 106, Received: 0, Shipped: 13, Repack: 0, EOD: 93
2025-07-09 17:24:47,130 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 935, Received: 0, Shipped: 94, Repack: 0, EOD: 841
2025-07-09 17:24:47,131 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'18675': np.int64(748), '17914': np.int64(166), '17904': np.int64(93), '17612': np.int64(841)}
2025-07-09 17:24:47,132 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 17:24:47,132 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'18675': np.int64(748), '17914': np.int64(166), '17904': np.int64(93), '17612': np.int64(841)}
2025-07-09 17:24:47,134 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 17:24:47,137 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 17:24:47,139 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 166, Received: 0, Shipped: 7, Repack: 0, EOD: 159
2025-07-09 17:24:47,140 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 93, Received: 0, Shipped: 7, Repack: 0, EOD: 86
2025-07-09 17:24:47,142 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 841, Received: 478, Shipped: 119, Repack: 0, EOD: 1200
2025-07-09 17:24:47,143 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'18675': np.int64(748), '17914': np.int64(159), '17904': np.int64(86), '17612': np.int64(1200)}
2025-07-09 17:24:47,144 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 17:24:47,144 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'18675': np.int64(748), '17914': np.int64(159), '17904': np.int64(86), '17612': np.int64(1200)}
2025-07-09 17:24:47,145 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 17:24:47,147 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 748, Received: 0, Shipped: 0, Repack: 0, EOD: 748
2025-07-09 17:24:47,149 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 159, Received: 0, Shipped: 7, Repack: 0, EOD: 152
2025-07-09 17:24:47,151 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 86, Received: 0, Shipped: 1, Repack: 0, EOD: 85
2025-07-09 17:24:47,154 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1200, Received: 0, Shipped: 296, Repack: 0, EOD: 904
2025-07-09 17:24:47,155 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'18675': np.int64(748), '17914': np.int64(152), '17904': np.int64(85), '17612': np.int64(904)}
2025-07-09 17:24:47,155 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 17:24:47,156 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'18675': np.int64(748), '17914': np.int64(152), '17904': np.int64(85), '17612': np.int64(904)}
2025-07-09 17:24:47,157 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 17:24:47,159 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 748, Received: 0, Shipped: 1, Repack: 0, EOD: 747
2025-07-09 17:24:47,161 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 152, Received: 0, Shipped: 1, Repack: 0, EOD: 151
2025-07-09 17:24:47,163 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 85, Received: 0, Shipped: 2, Repack: 0, EOD: 83
2025-07-09 17:24:47,166 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 904, Received: 0, Shipped: 117, Repack: 0, EOD: 787
2025-07-09 17:24:47,166 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'18675': np.int64(747), '17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787)}
2025-07-09 17:24:47,167 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 17:24:47,167 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'18675': np.int64(747), '17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787)}
2025-07-09 17:24:47,169 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 17:24:47,172 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 17:24:47,172 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 17:24:47,174 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 17:24:47,175 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'18675': np.int64(747), '17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787)}
2025-07-09 17:24:47,176 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 17:24:47,177 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'18675': np.int64(747), '17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787)}
2025-07-09 17:24:47,179 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 747, Received: 0, Shipped: 0, Repack: 0, EOD: 747
2025-07-09 17:24:47,181 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 17:24:47,184 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 83, Received: 0, Shipped: 0, Repack: 0, EOD: 83
2025-07-09 17:24:47,186 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 787, Received: 0, Shipped: 0, Repack: 0, EOD: 787
2025-07-09 17:24:47,187 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'18675': np.int64(747), '17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787)}
2025-07-09 17:24:47,187 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 17:24:47,188 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'18675': np.int64(747), '17914': np.int64(151), '17904': np.int64(83), '17612': np.int64(787)}
2025-07-09 17:24:47,190 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 17:24:47,192 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 747, Received: 0, Shipped: 1, Repack: 0, EOD: 746
2025-07-09 17:24:47,194 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 151, Received: 0, Shipped: 3, Repack: 0, EOD: 148
2025-07-09 17:24:47,196 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 83, Received: 0, Shipped: 2, Repack: 0, EOD: 81
2025-07-09 17:24:47,198 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 787, Received: 0, Shipped: 47, Repack: 0, EOD: 740
2025-07-09 17:24:47,202 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'18675': np.int64(746), '17914': np.int64(148), '17904': np.int64(81), '17612': np.int64(740)}
2025-07-09 17:24:47,204 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 17:24:47,208 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'18675': np.int64(746), '17914': np.int64(148), '17904': np.int64(81), '17612': np.int64(740)}
2025-07-09 17:24:47,210 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 17:24:47,213 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 746, Received: 0, Shipped: 0, Repack: 0, EOD: 746
2025-07-09 17:24:47,216 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 148, Received: 0, Shipped: 3, Repack: 0, EOD: 145
2025-07-09 17:24:47,220 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 81, Received: 0, Shipped: 0, Repack: 0, EOD: 81
2025-07-09 17:24:47,228 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 740, Received: 0, Shipped: 87, Repack: 0, EOD: 653
2025-07-09 17:24:47,229 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'18675': np.int64(746), '17914': np.int64(145), '17904': np.int64(81), '17612': np.int64(653)}
2025-07-09 17:24:47,231 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 17:24:47,232 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'18675': np.int64(746), '17914': np.int64(145), '17904': np.int64(81), '17612': np.int64(653)}
2025-07-09 17:24:47,234 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 17:24:47,238 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 746, Received: 0, Shipped: 1, Repack: 0, EOD: 745
2025-07-09 17:24:47,242 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 145, Received: 0, Shipped: 3, Repack: 0, EOD: 142
2025-07-09 17:24:47,245 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 81, Received: 0, Shipped: 1, Repack: 0, EOD: 80
2025-07-09 17:24:47,245 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 653, Received: 0, Shipped: 67, Repack: 0, EOD: 586
2025-07-09 17:24:47,248 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'18675': np.int64(745), '17914': np.int64(142), '17904': np.int64(80), '17612': np.int64(586)}
2025-07-09 17:24:47,250 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 17:24:47,252 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'18675': np.int64(745), '17914': np.int64(142), '17904': np.int64(80), '17612': np.int64(586)}
2025-07-09 17:24:47,253 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 17:24:47,257 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 17:24:47,263 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 142, Received: 0, Shipped: 11, Repack: 0, EOD: 131
2025-07-09 17:24:47,265 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 80, Received: 0, Shipped: 14, Repack: 0, EOD: 66
2025-07-09 17:24:47,268 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 586, Received: 0, Shipped: 234, Repack: 0, EOD: 352
2025-07-09 17:24:47,270 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'18675': np.int64(745), '17914': np.int64(131), '17904': np.int64(66), '17612': np.int64(352)}
2025-07-09 17:24:47,276 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 17:24:47,280 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'18675': np.int64(745), '17914': np.int64(131), '17904': np.int64(66), '17612': np.int64(352)}
2025-07-09 17:24:47,282 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 17:24:47,285 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 17:24:47,289 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 131, Received: 0, Shipped: 12, Repack: 0, EOD: 119
2025-07-09 17:24:47,292 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 66, Received: 0, Shipped: 1, Repack: 0, EOD: 65
2025-07-09 17:24:47,296 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 352, Received: 0, Shipped: 83, Repack: 0, EOD: 269
2025-07-09 17:24:47,296 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'18675': np.int64(745), '17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269)}
2025-07-09 17:24:47,296 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 17:24:47,297 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'18675': np.int64(745), '17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269)}
2025-07-09 17:24:47,299 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 17:24:47,301 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 17:24:47,303 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 17:24:47,306 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 17:24:47,306 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'18675': np.int64(745), '17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269)}
2025-07-09 17:24:47,309 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 17:24:47,311 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'18675': np.int64(745), '17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269)}
2025-07-09 17:24:47,314 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 745, Received: 0, Shipped: 0, Repack: 0, EOD: 745
2025-07-09 17:24:47,318 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 119, Received: 0, Shipped: 0, Repack: 0, EOD: 119
2025-07-09 17:24:47,319 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 65, Received: 0, Shipped: 0, Repack: 0, EOD: 65
2025-07-09 17:24:47,320 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 269, Received: 0, Shipped: 0, Repack: 0, EOD: 269
2025-07-09 17:24:47,321 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'18675': np.int64(745), '17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269)}
2025-07-09 17:24:47,322 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 17:24:47,322 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'18675': np.int64(745), '17914': np.int64(119), '17904': np.int64(65), '17612': np.int64(269)}
2025-07-09 17:24:47,324 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 17:24:47,328 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 745, Received: 0, Shipped: 3, Repack: 0, EOD: 742
2025-07-09 17:24:47,330 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 119, Received: 0, Shipped: 3, Repack: 0, EOD: 116
2025-07-09 17:24:47,333 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 65, Received: 0, Shipped: 2, Repack: 0, EOD: 63
2025-07-09 17:24:47,338 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 269, Received: 0, Shipped: 164, Repack: 0, EOD: 105
2025-07-09 17:24:47,338 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'18675': np.int64(742), '17914': np.int64(116), '17904': np.int64(63), '17612': np.int64(105)}
2025-07-09 17:24:47,340 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 17:24:47,341 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'18675': np.int64(742), '17914': np.int64(116), '17904': np.int64(63), '17612': np.int64(105)}
2025-07-09 17:24:47,345 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 17:24:47,347 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 742, Received: 0, Shipped: 12, Repack: 0, EOD: 730
2025-07-09 17:24:47,349 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 116, Received: 0, Shipped: 11, Repack: 0, EOD: 105
2025-07-09 17:24:47,350 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 63, Received: 0, Shipped: 1, Repack: 0, EOD: 62
2025-07-09 17:24:47,351 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 105, Received: 0, Shipped: 56, Repack: 0, EOD: 49
2025-07-09 17:24:47,352 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'18675': np.int64(730), '17914': np.int64(105), '17904': np.int64(62), '17612': np.int64(49)}
2025-07-09 17:24:47,352 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 17:24:47,352 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'18675': np.int64(730), '17914': np.int64(105), '17904': np.int64(62), '17612': np.int64(49)}
2025-07-09 17:24:47,353 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 17:24:47,354 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 17:24:47,357 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 105, Received: 0, Shipped: 1, Repack: 0, EOD: 104
2025-07-09 17:24:47,361 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 62, Received: 0, Shipped: 1, Repack: 0, EOD: 61
2025-07-09 17:24:47,363 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: 49, Received: 576, Shipped: 57, Repack: 0, EOD: 568
2025-07-09 17:24:47,364 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'18675': np.int64(730), '17914': np.int64(104), '17904': np.int64(61), '17612': np.int64(568)}
2025-07-09 17:24:47,364 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 17:24:47,364 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'18675': np.int64(730), '17914': np.int64(104), '17904': np.int64(61), '17612': np.int64(568)}
2025-07-09 17:24:47,365 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 17:24:47,367 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 730, Received: 0, Shipped: 0, Repack: 0, EOD: 730
2025-07-09 17:24:47,368 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 104, Received: 0, Shipped: 7, Repack: 0, EOD: 97
2025-07-09 17:24:47,369 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 61, Received: 0, Shipped: 2, Repack: 0, EOD: 59
2025-07-09 17:24:47,372 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 568, Received: 0, Shipped: 47, Repack: 0, EOD: 521
2025-07-09 17:24:47,372 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'18675': np.int64(730), '17914': np.int64(97), '17904': np.int64(59), '17612': np.int64(521)}
2025-07-09 17:24:47,372 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 17:24:47,372 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'18675': np.int64(730), '17914': np.int64(97), '17904': np.int64(59), '17612': np.int64(521)}
2025-07-09 17:24:47,375 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 17:24:47,379 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 730, Received: 0, Shipped: 1, Repack: 0, EOD: 729
2025-07-09 17:24:47,380 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 97, Received: 0, Shipped: 5, Repack: 0, EOD: 92
2025-07-09 17:24:47,382 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 59, Received: 0, Shipped: 1, Repack: 0, EOD: 58
2025-07-09 17:24:47,384 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 521, Received: 0, Shipped: 76, Repack: 0, EOD: 445
2025-07-09 17:24:47,384 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445)}
2025-07-09 17:24:47,385 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 17:24:47,385 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445)}
2025-07-09 17:24:47,386 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:24:47,388 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 17:24:47,389 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 17:24:47,393 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 17:24:47,393 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445)}
2025-07-09 17:24:47,394 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 17:24:47,394 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445)}
2025-07-09 17:24:47,396 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:24:47,398 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 17:24:47,399 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 58, Received: 0, Shipped: 0, Repack: 0, EOD: 58
2025-07-09 17:24:47,400 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 445, Received: 0, Shipped: 0, Repack: 0, EOD: 445
2025-07-09 17:24:47,401 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445)}
2025-07-09 17:24:47,401 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 17:24:47,401 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(58), '17612': np.int64(445)}
2025-07-09 17:24:47,402 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 17:24:47,403 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:24:47,405 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 92, Received: 0, Shipped: 0, Repack: 0, EOD: 92
2025-07-09 17:24:47,409 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 58, Received: 0, Shipped: 6, Repack: 0, EOD: 52
2025-07-09 17:24:47,411 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 445, Received: 376, Shipped: 21, Repack: 0, EOD: 800
2025-07-09 17:24:47,411 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(52), '17612': np.int64(800)}
2025-07-09 17:24:47,412 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 17:24:47,412 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'18675': np.int64(729), '17914': np.int64(92), '17904': np.int64(52), '17612': np.int64(800)}
2025-07-09 17:24:47,413 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 17:24:47,414 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:24:47,416 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 92, Received: 0, Shipped: 1, Repack: 0, EOD: 91
2025-07-09 17:24:47,417 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 52, Received: 0, Shipped: 1, Repack: 0, EOD: 51
2025-07-09 17:24:47,418 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 800, Received: 0, Shipped: 42, Repack: 0, EOD: 758
2025-07-09 17:24:47,419 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'18675': np.int64(729), '17914': np.int64(91), '17904': np.int64(51), '17612': np.int64(758)}
2025-07-09 17:24:47,419 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 17:24:47,419 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'18675': np.int64(729), '17914': np.int64(91), '17904': np.int64(51), '17612': np.int64(758)}
2025-07-09 17:24:47,420 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 17:24:47,423 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:24:47,429 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 91, Received: 0, Shipped: 4, Repack: 0, EOD: 87
2025-07-09 17:24:47,431 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 51, Received: 0, Shipped: 1, Repack: 0, EOD: 50
2025-07-09 17:24:47,432 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 758, Received: 0, Shipped: 173, Repack: 0, EOD: 585
2025-07-09 17:24:47,432 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'18675': np.int64(729), '17914': np.int64(87), '17904': np.int64(50), '17612': np.int64(585)}
2025-07-09 17:24:47,432 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 17:24:47,432 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'18675': np.int64(729), '17914': np.int64(87), '17904': np.int64(50), '17612': np.int64(585)}
2025-07-09 17:24:47,433 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 17:24:47,435 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:24:47,436 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 87, Received: 0, Shipped: 9, Repack: 0, EOD: 78
2025-07-09 17:24:47,438 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 50, Received: 0, Shipped: 2, Repack: 0, EOD: 48
2025-07-09 17:24:47,442 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 585, Received: 0, Shipped: 60, Repack: 0, EOD: 525
2025-07-09 17:24:47,444 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'18675': np.int64(729), '17914': np.int64(78), '17904': np.int64(48), '17612': np.int64(525)}
2025-07-09 17:24:47,444 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 17:24:47,445 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'18675': np.int64(729), '17914': np.int64(78), '17904': np.int64(48), '17612': np.int64(525)}
2025-07-09 17:24:47,446 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 17:24:47,447 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:24:47,449 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 78, Received: 0, Shipped: 6, Repack: 0, EOD: 72
2025-07-09 17:24:47,450 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 48, Received: 0, Shipped: 3, Repack: 0, EOD: 45
2025-07-09 17:24:47,452 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 525, Received: 0, Shipped: 51, Repack: 0, EOD: 474
2025-07-09 17:24:47,452 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'18675': np.int64(729), '17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474)}
2025-07-09 17:24:47,452 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 17:24:47,453 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'18675': np.int64(729), '17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474)}
2025-07-09 17:24:47,454 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:24:47,456 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 17:24:47,459 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 17:24:47,462 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 17:24:47,462 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'18675': np.int64(729), '17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474)}
2025-07-09 17:24:47,462 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 17:24:47,462 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'18675': np.int64(729), '17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474)}
2025-07-09 17:24:47,464 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:24:47,466 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 72, Received: 0, Shipped: 0, Repack: 0, EOD: 72
2025-07-09 17:24:47,467 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 45, Received: 0, Shipped: 0, Repack: 0, EOD: 45
2025-07-09 17:24:47,468 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 474, Received: 0, Shipped: 0, Repack: 0, EOD: 474
2025-07-09 17:24:47,468 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'18675': np.int64(729), '17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474)}
2025-07-09 17:24:47,468 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 17:24:47,469 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'18675': np.int64(729), '17914': np.int64(72), '17904': np.int64(45), '17612': np.int64(474)}
2025-07-09 17:24:47,470 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 17:24:47,472 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 729, Received: 0, Shipped: 0, Repack: 0, EOD: 729
2025-07-09 17:24:47,476 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 72, Received: 0, Shipped: 1, Repack: 0, EOD: 71
2025-07-09 17:24:47,478 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 45, Received: 0, Shipped: 3, Repack: 0, EOD: 42
2025-07-09 17:24:47,479 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 474, Received: 0, Shipped: 84, Repack: 0, EOD: 390
2025-07-09 17:24:47,479 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'18675': np.int64(729), '17914': np.int64(71), '17904': np.int64(42), '17612': np.int64(390)}
2025-07-09 17:24:47,482 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612           1006           1006
2  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
7  2025-06-02  17612           1006            935
2025-07-09 17:24:47,482 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
119  2025-06-30  17612            474            390
118  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-09 17:24:47,484 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 17:24:47,484 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 17:24:47,485 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612           1006           1006
2  2025-06-01  17904            108            108
1  2025-06-01  17914            175            175
0  2025-06-01  18675            749            749
7  2025-06-02  17612           1006            935
2025-07-09 17:24:47,486 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
112  2025-06-29  18675            729            729
119  2025-06-30  17612            474            390
118  2025-06-30  17904             45             42
117  2025-06-30  17914             72             71
116  2025-06-30  18675            729            729
2025-07-09 17:24:47,486 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 17:24:47,488 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      376.275000
std       320.038862
min        42.000000
25%        83.000000
50%       169.000000
75%       729.250000
max      1200.000000
2025-07-09 17:24:47,491 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01           1006
7    2025-06-02            935
11   2025-06-03            841
15   2025-06-04           1200
19   2025-06-05            904
23   2025-06-06            787
27   2025-06-07            787
31   2025-06-08            787
35   2025-06-09            740
39   2025-06-10            653
43   2025-06-11            586
47   2025-06-12            352
51   2025-06-13            269
55   2025-06-14            269
59   2025-06-15            269
63   2025-06-16            105
67   2025-06-17             49
71   2025-06-18            568
75   2025-06-19            521
79   2025-06-20            445
83   2025-06-21            445
87   2025-06-22            445
91   2025-06-23            800
95   2025-06-24            758
99   2025-06-25            585
103  2025-06-26            525
107  2025-06-27            474
111  2025-06-28            474
115  2025-06-29            474
119  2025-06-30            390
2025-07-09 17:24:47,495 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            108
6    2025-06-02            106
10   2025-06-03             93
14   2025-06-04             86
18   2025-06-05             85
22   2025-06-06             83
26   2025-06-07             83
30   2025-06-08             83
34   2025-06-09             81
38   2025-06-10             81
42   2025-06-11             80
46   2025-06-12             66
50   2025-06-13             65
54   2025-06-14             65
58   2025-06-15             65
62   2025-06-16             63
66   2025-06-17             62
70   2025-06-18             61
74   2025-06-19             59
78   2025-06-20             58
82   2025-06-21             58
86   2025-06-22             58
90   2025-06-23             52
94   2025-06-24             51
98   2025-06-25             50
102  2025-06-26             48
106  2025-06-27             45
110  2025-06-28             45
114  2025-06-29             45
118  2025-06-30             42
2025-07-09 17:24:47,502 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 17:24:47,505 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 17:24:47,507 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.000000
std        6.981368
min        1.000000
25%        2.000000
50%        3.000000
75%       16.000000
max       25.000000
2025-07-09 17:24:47,511 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           21
7    2025-06-02           20
11   2025-06-03           18
15   2025-06-04           25
19   2025-06-05           19
23   2025-06-06           17
27   2025-06-07           17
31   2025-06-08           17
35   2025-06-09           16
39   2025-06-10           14
43   2025-06-11           13
47   2025-06-12            8
51   2025-06-13            6
55   2025-06-14            6
59   2025-06-15            6
63   2025-06-16            3
67   2025-06-17            2
71   2025-06-18           12
75   2025-06-19           11
79   2025-06-20           10
83   2025-06-21           10
87   2025-06-22           10
91   2025-06-23           17
95   2025-06-24           16
99   2025-06-25           13
103  2025-06-26           11
107  2025-06-27           10
111  2025-06-28           10
115  2025-06-29           10
119  2025-06-30            9
2025-07-09 17:24:47,512 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    42
2025-06-02    41
2025-06-03    39
2025-06-04    45
2025-06-05    39
2025-07-09 17:24:47,513 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    29
2025-06-27    28
2025-06-28    28
2025-06-29    28
2025-06-30    27
2025-07-09 17:24:47,513 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 17:24:47,513 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 17:24:47,516 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 17:24:47,516 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    18.90
2025-06-02    18.45
2025-06-03    17.55
2025-06-04    20.25
2025-06-05    17.55
2025-07-09 17:24:47,517 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.05
2025-06-27    12.60
2025-06-28    12.60
2025-06-29    12.60
2025-06-30    12.15
2025-07-09 17:24:47,522 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 17:24:47,522 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 17:24:47,523 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:24:47,525 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:24:47,528 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:24:47,752 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:24:47,754 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:24:47,754 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:24:47,755 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 17:24:47,779 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:24:47,921 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:24:47,923 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:24:48,170 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:48,278 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:48,436 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 17:24:48,584 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 17:24:48,588 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 17:24:48,738 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 17:24:48,740 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 17:24:48,742 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 17:24:48,743 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 17:24:48,745 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 17:24:48,746 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 17:24:48,747 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 17:24:48,752 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 17:24:48,754 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 17:24:48,767 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 17:24:48,775 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 17:24:48,776 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 17:24:48,790 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 17:24:48,791 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 17:24:48,795 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 17:24:48,799 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 17:24:48,804 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 17:24:48,805 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 17:24:48,806 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 17:24:48,807 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 17:24:48,817 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 17:24:48,818 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 17:24:48,824 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 17:24:49,075 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 17:24:49,078 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 17:24:49,079 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 17:24:49,081 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 17:24:49,156 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 17:24:49,317 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 17:24:49,322 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 17:24:49,539 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:49,659 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 17:24:49,815 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 17:24:50,059 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 17:24:50,062 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 17:24:50,287 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 17:24:50,288 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 17:24:50,289 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 17:24:50,290 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 17:24:50,291 - __main__ - INFO - Script finished successfully.
2025-07-09 18:00:40,636 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:00:40,637 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 18:00:41,402 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:00:41,402 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:00:41,402 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:00:41,403 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:00:41,448 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:00:41,754 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:00:41,755 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:00:41,756 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:00:41,756 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:00:41,782 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:00:41,980 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:00:41,985 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:00:42,410 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:00:42,531 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:00:42,533 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:00:42,748 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:00:42,754 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:00:42,771 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:00:42,772 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:00:42,772 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:00:42,772 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:00:42,775 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:00:43,057 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:00:43,060 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:00:43,061 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:00:43,061 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:00:43,084 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:00:43,247 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:00:43,249 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:00:43,570 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:00:43,700 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:00:43,702 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:00:43,878 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:00:43,883 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:00:43,885 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:00:43,887 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:00:43,898 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:00:43,902 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:00:43,903 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:00:43,903 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:00:43,904 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:00:43,906 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:00:44,146 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:00:44,148 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:00:44,149 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:00:44,150 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:00:44,172 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:00:44,318 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:00:44,320 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:00:44,592 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:00:44,714 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:00:44,716 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:00:44,867 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:00:44,873 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:00:44,881 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:00:44,883 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:00:44,884 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:00:44,885 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:00:44,885 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:00:44,887 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:00:45,207 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:00:45,210 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:00:45,211 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:00:45,212 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:00:45,245 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:00:45,394 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:00:45,396 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:00:45,718 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:00:45,846 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:00:45,849 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:00:45,995 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:00:46,001 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:01:23,495 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:01:23,495 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 18:01:23,988 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:01:23,988 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:01:23,988 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:01:23,988 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:01:23,999 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:01:24,405 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:01:24,408 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:01:24,408 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:01:24,410 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:01:24,440 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:01:24,672 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:01:24,675 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:01:25,013 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:25,245 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:25,248 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:01:25,825 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:01:25,830 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:01:25,836 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:01:25,836 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:01:25,837 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:01:25,837 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:01:25,840 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:01:26,145 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:01:26,148 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:01:26,150 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:01:26,150 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:01:26,172 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:01:26,314 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:01:26,316 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:01:26,679 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:26,884 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:26,884 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:01:27,088 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:01:27,092 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:01:27,094 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:01:27,096 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:01:27,100 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:01:27,101 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:01:27,102 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:01:27,102 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:01:27,103 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:01:27,106 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:01:27,346 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:01:27,350 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:01:27,351 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:01:27,352 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:01:27,375 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:01:27,529 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:01:27,531 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:01:27,908 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:28,112 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:28,115 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:01:28,417 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:01:28,424 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:01:28,428 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:01:28,429 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:01:28,430 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:01:28,430 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:01:28,431 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:01:28,436 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:01:28,728 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:01:28,731 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:01:28,732 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:01:28,734 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:01:28,755 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:01:28,969 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:01:28,972 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:01:29,342 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:29,543 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:29,545 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:01:29,853 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:01:29,858 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:01:29,861 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 18:01:29,862 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 18:01:29,862 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:01:29,863 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:01:29,865 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:01:30,163 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:01:30,165 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:01:30,166 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:01:30,166 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:01:30,189 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:01:30,334 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:01:30,338 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:01:30,599 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:30,876 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:30,879 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 18:01:31,491 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 18:01:31,495 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 18:01:31,509 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 18:01:31,509 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 18:01:31,510 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:01:31,510 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:01:31,512 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:01:31,735 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:01:31,737 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:01:31,738 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:01:31,738 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:01:31,759 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:01:31,904 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:01:31,906 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:01:32,159 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:32,413 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:32,414 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 18:01:32,720 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 18:01:32,724 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 18:01:32,726 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 18:01:32,726 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 18:01:32,727 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 18:01:32,744 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 18:01:32,745 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 18:01:32,745 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 18:01:32,746 - src.services.reporting_logic.monthly_report_generator - ERROR - Error generating monthly charge report: name 'shpped_orders_df_filtered' is not defined
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\monthly_report_generator.py", line 49, in generate_monthly_charge_report
    logger.debug(f"shipped_orders_df_filtered head: \n{shpped_orders_df_filtered.head().to_string()}") # Fixed typo from shpped_orders_df_filtered
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'shpped_orders_df_filtered' is not defined
2025-07-09 18:01:32,748 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-09 18:01:32,748 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 18:01:32,748 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 18:01:32,749 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 18:01:32,751 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 18:01:32,752 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 18:01:32,757 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 18:01:32,758 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 18:01:32,759 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 18:01:32,763 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 18:01:32,763 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 18:01:32,765 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 18:01:32,768 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 18:01:32,775 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 18:01:32,776 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:01:32,776 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:01:32,776 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 18:01:32,780 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:01:32,780 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:01:32,784 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:01:33,132 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:01:33,135 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:01:33,136 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:01:33,137 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 18:01:33,160 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:01:33,324 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:01:33,326 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:01:34,053 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:34,355 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:01:34,665 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:01:34,881 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:01:34,883 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 18:01:35,055 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:01:35,056 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 18:01:35,056 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 18:01:35,057 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 18:01:35,057 - __main__ - INFO - Script finished successfully.
2025-07-09 18:02:05,377 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:02:05,377 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 18:02:05,691 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:02:05,692 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:02:05,692 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:02:05,692 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:02:05,707 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:02:05,962 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:02:05,965 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:02:05,966 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:02:05,966 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:02:05,989 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:02:06,155 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:02:06,159 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:02:11,029 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:11,940 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:11,941 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:02:12,349 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:02:12,353 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:02:12,359 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:02:12,360 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:02:12,360 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:02:12,361 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:02:12,366 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:02:12,637 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:02:12,639 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:02:12,640 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:02:12,640 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:02:12,663 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:02:12,821 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:02:12,823 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:02:13,067 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:13,272 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:13,274 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:02:13,539 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:02:13,541 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:02:13,544 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:02:13,545 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:02:13,552 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:02:13,555 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:02:13,556 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:02:13,557 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:02:13,558 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:02:13,564 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:02:13,887 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:02:13,891 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:02:13,892 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:02:13,894 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:02:13,966 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:02:14,124 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:02:14,128 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:02:14,364 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:14,496 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:14,499 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:02:14,703 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:02:14,720 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:02:14,729 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:02:14,734 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:02:14,736 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:02:14,737 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:02:14,739 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:02:14,747 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:02:15,014 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:02:15,018 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:02:15,020 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:02:15,022 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:02:15,095 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:02:15,256 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:02:15,260 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:02:15,524 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:15,729 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:15,730 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:02:15,934 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:02:15,943 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:02:15,952 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 18:02:15,953 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 18:02:15,954 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:02:15,955 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:02:15,964 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:02:16,291 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:02:16,295 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:02:16,297 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:02:16,299 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:02:16,364 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:02:16,542 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:02:16,546 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:02:16,758 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:16,957 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:16,962 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 18:02:17,110 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 18:02:17,115 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 18:02:17,137 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 18:02:17,139 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 18:02:17,141 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:02:17,142 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:02:17,152 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:02:17,428 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:02:17,432 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:02:17,433 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:02:17,434 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:02:17,493 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:02:17,641 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:02:17,644 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:02:18,084 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:18,288 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:18,290 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 18:02:18,494 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 18:02:18,495 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 18:02:18,498 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 18:02:18,500 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 18:02:18,502 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 18:02:18,519 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 18:02:18,524 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 18:02:18,525 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 18:02:18,527 - src.services.reporting_logic.monthly_report_generator - ERROR - Error generating monthly charge report: name 'shpped_orders_df_filtered' is not defined
Traceback (most recent call last):
  File "C:\Users\NathanNeely\Projects\ORA_Automation\src\services\reporting_logic\monthly_report_generator.py", line 49, in generate_monthly_charge_report
    logger.debug(f"shipped_orders_df_filtered head: \n{shpped_orders_df_filtered.head().to_string()}") # Fixed typo from shpped_orders_df_filtered
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'shpped_orders_df_filtered' is not defined
2025-07-09 18:02:18,531 - __main__ - ERROR - Monthly Charge Report generation failed.
2025-07-09 18:02:18,534 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 18:02:18,535 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 18:02:18,537 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 18:02:18,540 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 18:02:18,541 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 18:02:18,554 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 18:02:18,560 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 18:02:18,562 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 18:02:18,574 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 18:02:18,576 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 18:02:18,581 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 18:02:18,587 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 18:02:18,594 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 18:02:18,595 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:02:18,596 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:02:18,597 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 18:02:18,608 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:02:18,610 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:02:18,622 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:02:18,885 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:02:18,888 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:02:18,889 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:02:18,891 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 18:02:18,967 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:02:19,126 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:02:19,128 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:02:19,381 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:19,530 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:02:19,723 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:02:19,927 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:02:19,929 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 18:02:20,090 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:02:20,092 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 18:02:20,092 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 18:02:20,094 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 18:02:20,095 - __main__ - INFO - Script finished successfully.
2025-07-09 18:03:08,302 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:03:08,303 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 18:03:08,646 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:03:08,647 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:03:08,647 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:03:08,647 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:03:08,659 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:03:08,977 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:03:08,979 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:03:08,979 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:03:08,979 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:03:09,003 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:03:09,148 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:03:09,150 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:03:09,740 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:10,334 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:10,336 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:03:11,037 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:03:11,040 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:03:11,047 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:03:11,047 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:03:11,048 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:03:11,050 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:03:11,054 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:03:11,299 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:03:11,301 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:03:11,302 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:03:11,303 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:03:11,326 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:03:11,479 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:03:11,481 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:03:12,050 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:12,459 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:12,462 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:03:12,933 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:03:12,936 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:03:12,939 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:03:12,940 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:03:12,942 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:03:12,943 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:03:12,945 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:03:12,945 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:03:12,946 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:03:12,949 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:03:13,182 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:03:13,185 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:03:13,186 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:03:13,186 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:03:13,208 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:03:13,347 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:03:13,349 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:03:14,302 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:15,019 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:15,021 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:03:16,044 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:03:16,062 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:03:16,072 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:03:16,076 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:03:16,078 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:03:16,080 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:03:16,082 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:03:16,091 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:03:16,345 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:03:16,347 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:03:16,349 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:03:16,350 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:03:16,388 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:03:16,531 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:03:16,535 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:03:17,170 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:18,194 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:18,197 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:03:19,030 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:03:19,041 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:03:19,052 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 18:03:19,054 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 18:03:19,055 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:03:19,056 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:03:19,067 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:03:19,366 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:03:19,370 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:03:19,372 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:03:19,375 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:03:19,441 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:03:19,592 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:03:19,596 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:03:20,343 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:21,060 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:21,063 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 18:03:22,393 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 18:03:22,397 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 18:03:22,404 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 18:03:22,405 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 18:03:22,405 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:03:22,405 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:03:22,407 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:03:22,644 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:03:22,647 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:03:22,648 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:03:22,649 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:03:22,671 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:03:22,813 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:03:22,817 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:03:23,619 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:24,310 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:24,312 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 18:03:24,762 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 18:03:24,764 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 18:03:24,766 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 18:03:24,767 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 18:03:24,768 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 18:03:24,782 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 18:03:24,783 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 18:03:24,785 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 18:03:24,786 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 18:03:24,787 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 18:03:24,788 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 18:03:24,790 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 18:03:24,790 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 18:03:24,790 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 18:03:24,791 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 18:03:24,791 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 18:03:24,793 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 18:03:24,793 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17612': 955, '18675': 769, '17904': 178, '17914': 326}
2025-07-09 18:03:24,793 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 18:03:24,793 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17612': 955, '18675': 769, '17904': 178, '17914': 326}
2025-07-09 18:03:24,797 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 18:03:24,800 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 18:03:24,802 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 18:03:24,804 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 18:03:24,804 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17612': np.int64(955), '18675': np.int64(769), '17904': np.int64(178), '17914': np.int64(326)}
2025-07-09 18:03:24,806 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 18:03:24,806 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17612': np.int64(955), '18675': np.int64(769), '17904': np.int64(178), '17914': np.int64(326)}
2025-07-09 18:03:24,807 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 18:03:24,809 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 18:03:24,810 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 18:03:24,812 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 18:03:24,813 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 18:03:24,814 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17612': np.int64(884), '18675': np.int64(768), '17904': np.int64(176), '17914': np.int64(323)}
2025-07-09 18:03:24,815 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 18:03:24,817 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17612': np.int64(884), '18675': np.int64(768), '17904': np.int64(176), '17914': np.int64(323)}
2025-07-09 18:03:24,819 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 18:03:24,822 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 18:03:24,823 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:03:24,825 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 18:03:24,827 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 18:03:24,827 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17612': np.int64(790), '18675': np.int64(768), '17904': np.int64(163), '17914': np.int64(317)}
2025-07-09 18:03:24,828 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 18:03:24,828 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17612': np.int64(790), '18675': np.int64(768), '17904': np.int64(163), '17914': np.int64(317)}
2025-07-09 18:03:24,829 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 18:03:24,831 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 18:03:24,836 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:03:24,839 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 18:03:24,841 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 18:03:24,842 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17612': np.int64(1149), '18675': np.int64(768), '17904': np.int64(156), '17914': np.int64(310)}
2025-07-09 18:03:24,842 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 18:03:24,843 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17612': np.int64(1149), '18675': np.int64(768), '17904': np.int64(156), '17914': np.int64(310)}
2025-07-09 18:03:24,844 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 18:03:24,846 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 18:03:24,850 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:03:24,852 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 18:03:24,854 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 18:03:24,855 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17612': np.int64(853), '18675': np.int64(768), '17904': np.int64(155), '17914': np.int64(303)}
2025-07-09 18:03:24,855 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 18:03:24,856 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17612': np.int64(853), '18675': np.int64(768), '17904': np.int64(155), '17914': np.int64(303)}
2025-07-09 18:03:24,857 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 18:03:24,859 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 18:03:24,860 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 18:03:24,862 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 18:03:24,863 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 18:03:24,864 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17612': np.int64(736), '18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 18:03:24,865 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 18:03:24,866 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17612': np.int64(736), '18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 18:03:24,868 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:03:24,871 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:03:24,873 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:03:24,874 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:03:24,875 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17612': np.int64(736), '18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 18:03:24,875 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 18:03:24,876 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17612': np.int64(736), '18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 18:03:24,878 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:03:24,880 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:03:24,884 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:03:24,886 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:03:24,887 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17612': np.int64(736), '18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 18:03:24,887 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 18:03:24,888 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17612': np.int64(736), '18675': np.int64(767), '17904': np.int64(153), '17914': np.int64(302)}
2025-07-09 18:03:24,889 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 18:03:24,891 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 18:03:24,893 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 18:03:24,894 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 18:03:24,895 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 18:03:24,896 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17612': np.int64(689), '18675': np.int64(766), '17904': np.int64(151), '17914': np.int64(299)}
2025-07-09 18:03:24,896 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 18:03:24,896 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17612': np.int64(689), '18675': np.int64(766), '17904': np.int64(151), '17914': np.int64(299)}
2025-07-09 18:03:24,899 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 18:03:24,902 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 18:03:24,904 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 18:03:24,906 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 18:03:24,909 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 18:03:24,909 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17612': np.int64(602), '18675': np.int64(766), '17904': np.int64(151), '17914': np.int64(296)}
2025-07-09 18:03:24,910 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 18:03:24,910 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17612': np.int64(602), '18675': np.int64(766), '17904': np.int64(151), '17914': np.int64(296)}
2025-07-09 18:03:24,911 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 18:03:24,913 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 18:03:24,914 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 18:03:24,918 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 18:03:24,920 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 18:03:24,920 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17612': np.int64(535), '18675': np.int64(765), '17904': np.int64(150), '17914': np.int64(293)}
2025-07-09 18:03:24,920 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 18:03:24,921 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17612': np.int64(535), '18675': np.int64(765), '17904': np.int64(150), '17914': np.int64(293)}
2025-07-09 18:03:24,923 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 18:03:24,924 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 18:03:24,926 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:03:24,928 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 18:03:24,929 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 18:03:24,930 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17612': np.int64(301), '18675': np.int64(765), '17904': np.int64(136), '17914': np.int64(282)}
2025-07-09 18:03:24,930 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 18:03:24,931 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17612': np.int64(301), '18675': np.int64(765), '17904': np.int64(136), '17914': np.int64(282)}
2025-07-09 18:03:24,934 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 18:03:24,936 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 18:03:24,939 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:03:24,941 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 18:03:24,942 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 18:03:24,943 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17612': np.int64(218), '18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 18:03:24,943 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 18:03:24,944 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17612': np.int64(218), '18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 18:03:24,946 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:03:24,947 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:03:24,950 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:03:24,952 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:03:24,953 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17612': np.int64(218), '18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 18:03:24,953 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 18:03:24,954 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17612': np.int64(218), '18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 18:03:24,956 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:03:24,957 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:03:24,959 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:03:24,960 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:03:24,961 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17612': np.int64(218), '18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 18:03:24,961 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 18:03:24,961 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17612': np.int64(218), '18675': np.int64(765), '17904': np.int64(135), '17914': np.int64(270)}
2025-07-09 18:03:24,962 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 18:03:24,963 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 18:03:24,968 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 18:03:24,970 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 18:03:24,973 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 18:03:24,973 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17612': np.int64(54), '18675': np.int64(762), '17904': np.int64(133), '17914': np.int64(267)}
2025-07-09 18:03:24,974 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 18:03:24,974 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17612': np.int64(54), '18675': np.int64(762), '17904': np.int64(133), '17914': np.int64(267)}
2025-07-09 18:03:24,975 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 18:03:24,977 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 18:03:24,978 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 18:03:24,979 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 18:03:24,981 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 18:03:24,981 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17612': np.int64(-2), '18675': np.int64(750), '17904': np.int64(132), '17914': np.int64(256)}
2025-07-09 18:03:24,982 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 18:03:24,983 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17612': np.int64(-2), '18675': np.int64(750), '17904': np.int64(132), '17914': np.int64(256)}
2025-07-09 18:03:24,984 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 18:03:24,986 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 18:03:24,988 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:03:24,990 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 18:03:24,992 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 18:03:24,992 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17612': np.int64(517), '18675': np.int64(750), '17904': np.int64(131), '17914': np.int64(255)}
2025-07-09 18:03:24,993 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 18:03:24,993 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17612': np.int64(517), '18675': np.int64(750), '17904': np.int64(131), '17914': np.int64(255)}
2025-07-09 18:03:24,993 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 18:03:24,996 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 18:03:24,997 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:03:25,000 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 18:03:25,002 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 18:03:25,002 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17612': np.int64(470), '18675': np.int64(750), '17904': np.int64(129), '17914': np.int64(248)}
2025-07-09 18:03:25,003 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 18:03:25,003 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17612': np.int64(470), '18675': np.int64(750), '17904': np.int64(129), '17914': np.int64(248)}
2025-07-09 18:03:25,005 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 18:03:25,007 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 18:03:25,008 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 18:03:25,010 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 18:03:25,011 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 18:03:25,011 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17612': np.int64(394), '18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 18:03:25,012 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 18:03:25,012 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17612': np.int64(394), '18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 18:03:25,013 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:03:25,016 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:03:25,019 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:03:25,021 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:03:25,021 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17612': np.int64(394), '18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 18:03:25,021 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 18:03:25,022 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17612': np.int64(394), '18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 18:03:25,023 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:03:25,025 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:03:25,026 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:03:25,027 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:03:25,028 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17612': np.int64(394), '18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 18:03:25,028 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 18:03:25,028 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17612': np.int64(394), '18675': np.int64(749), '17904': np.int64(128), '17914': np.int64(243)}
2025-07-09 18:03:25,029 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 18:03:25,030 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 18:03:25,033 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:03:25,035 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 18:03:25,037 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:03:25,037 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17612': np.int64(749), '18675': np.int64(749), '17904': np.int64(122), '17914': np.int64(243)}
2025-07-09 18:03:25,038 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 18:03:25,038 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17612': np.int64(749), '18675': np.int64(749), '17904': np.int64(122), '17914': np.int64(243)}
2025-07-09 18:03:25,039 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 18:03:25,041 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 18:03:25,042 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:03:25,044 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 18:03:25,045 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 18:03:25,046 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17612': np.int64(707), '18675': np.int64(749), '17904': np.int64(121), '17914': np.int64(242)}
2025-07-09 18:03:25,046 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 18:03:25,046 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17612': np.int64(707), '18675': np.int64(749), '17904': np.int64(121), '17914': np.int64(242)}
2025-07-09 18:03:25,047 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 18:03:25,051 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 18:03:25,053 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:03:25,055 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 18:03:25,057 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 18:03:25,058 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17612': np.int64(534), '18675': np.int64(749), '17904': np.int64(120), '17914': np.int64(238)}
2025-07-09 18:03:25,058 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 18:03:25,058 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17612': np.int64(534), '18675': np.int64(749), '17904': np.int64(120), '17914': np.int64(238)}
2025-07-09 18:03:25,059 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 18:03:25,060 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 18:03:25,063 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:03:25,065 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 18:03:25,069 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 18:03:25,070 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17612': np.int64(474), '18675': np.int64(749), '17904': np.int64(118), '17914': np.int64(229)}
2025-07-09 18:03:25,070 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 18:03:25,071 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17612': np.int64(474), '18675': np.int64(749), '17904': np.int64(118), '17914': np.int64(229)}
2025-07-09 18:03:25,072 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 18:03:25,074 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 18:03:25,075 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:03:25,076 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 18:03:25,078 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 18:03:25,078 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17612': np.int64(423), '18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 18:03:25,078 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 18:03:25,079 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17612': np.int64(423), '18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 18:03:25,081 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:03:25,083 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:03:25,085 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:03:25,086 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:03:25,087 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17612': np.int64(423), '18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 18:03:25,087 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 18:03:25,088 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17612': np.int64(423), '18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 18:03:25,090 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:03:25,091 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:03:25,092 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:03:25,093 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:03:25,093 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17612': np.int64(423), '18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 18:03:25,095 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 18:03:25,095 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17612': np.int64(423), '18675': np.int64(749), '17904': np.int64(115), '17914': np.int64(223)}
2025-07-09 18:03:25,096 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 18:03:25,097 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 18:03:25,101 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:03:25,102 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 18:03:25,104 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 18:03:25,105 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17612': np.int64(339), '18675': np.int64(749), '17904': np.int64(112), '17914': np.int64(222)}
2025-07-09 18:03:25,113 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
3  2025-06-01  17914            326            326
1  2025-06-01  18675            769            769
4  2025-06-02  17612            955            884
2025-07-09 18:03:25,117 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
113  2025-06-29  18675            749            749
116  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
119  2025-06-30  17914            223            222
117  2025-06-30  18675            749            749
2025-07-09 18:03:25,118 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 18:03:25,118 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 18:03:25,119 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
0  2025-06-01  17612            955            955
2  2025-06-01  17904            178            178
3  2025-06-01  17914            326            326
1  2025-06-01  18675            769            769
4  2025-06-02  17612            955            884
2025-07-09 18:03:25,121 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
113  2025-06-29  18675            749            749
116  2025-06-30  17612            423            339
118  2025-06-30  17904            115            112
119  2025-06-30  17914            223            222
117  2025-06-30  18675            749            749
2025-07-09 18:03:25,122 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 18:03:25,125 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 18:03:25,127 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
0    2025-06-01            955
4    2025-06-02            884
8    2025-06-03            790
12   2025-06-04           1149
16   2025-06-05            853
20   2025-06-06            736
24   2025-06-07            736
28   2025-06-08            736
32   2025-06-09            689
36   2025-06-10            602
40   2025-06-11            535
44   2025-06-12            301
48   2025-06-13            218
52   2025-06-14            218
56   2025-06-15            218
60   2025-06-16             54
64   2025-06-17             -2
68   2025-06-18            517
72   2025-06-19            470
76   2025-06-20            394
80   2025-06-21            394
84   2025-06-22            394
88   2025-06-23            749
92   2025-06-24            707
96   2025-06-25            534
100  2025-06-26            474
104  2025-06-27            423
108  2025-06-28            423
112  2025-06-29            423
116  2025-06-30            339
2025-07-09 18:03:25,129 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
2    2025-06-01            178
6    2025-06-02            176
10   2025-06-03            163
14   2025-06-04            156
18   2025-06-05            155
22   2025-06-06            153
26   2025-06-07            153
30   2025-06-08            153
34   2025-06-09            151
38   2025-06-10            151
42   2025-06-11            150
46   2025-06-12            136
50   2025-06-13            135
54   2025-06-14            135
58   2025-06-15            135
62   2025-06-16            133
66   2025-06-17            132
70   2025-06-18            131
74   2025-06-19            129
78   2025-06-20            128
82   2025-06-21            128
86   2025-06-22            128
90   2025-06-23            122
94   2025-06-24            121
98   2025-06-25            120
102  2025-06-26            118
106  2025-06-27            115
110  2025-06-28            115
114  2025-06-29            115
118  2025-06-30            112
2025-07-09 18:03:25,140 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 18:03:25,147 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 18:03:25,151 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 18:03:25,153 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
0    2025-06-01           20
4    2025-06-02           19
8    2025-06-03           17
12   2025-06-04           24
16   2025-06-05           18
20   2025-06-06           16
24   2025-06-07           16
28   2025-06-08           16
32   2025-06-09           15
36   2025-06-10           13
40   2025-06-11           12
44   2025-06-12            7
48   2025-06-13            5
52   2025-06-14            5
56   2025-06-15            5
60   2025-06-16            2
64   2025-06-17            0
68   2025-06-18           11
72   2025-06-19           10
76   2025-06-20            9
80   2025-06-21            9
84   2025-06-22            9
88   2025-06-23           16
92   2025-06-24           15
96   2025-06-25           12
100  2025-06-26           10
104  2025-06-27            9
108  2025-06-28            9
112  2025-06-29            9
116  2025-06-30            8
2025-07-09 18:03:25,154 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 18:03:25,155 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 18:03:25,156 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 18:03:25,156 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 18:03:25,158 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 18:03:25,160 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 18:03:25,160 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 18:03:25,168 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 18:03:25,168 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 18:03:25,168 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:03:25,169 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:03:25,171 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:03:25,453 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:03:25,456 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:03:25,457 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:03:25,457 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 18:03:25,479 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:03:25,622 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:03:25,625 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:03:25,838 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:26,079 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:27,102 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:03:27,545 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:03:27,553 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 18:03:28,025 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:03:28,027 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 18:03:28,029 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 18:03:28,030 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 18:03:28,031 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 18:03:28,031 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 18:03:28,032 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 18:03:28,034 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 18:03:28,035 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 18:03:28,039 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 18:03:28,041 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 18:03:28,041 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 18:03:28,043 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 18:03:28,044 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 18:03:28,045 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 18:03:28,046 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 18:03:28,048 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 18:03:28,049 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:03:28,050 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:03:28,050 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 18:03:28,053 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:03:28,055 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:03:28,057 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:03:28,332 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:03:28,335 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:03:28,336 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:03:28,337 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 18:03:28,359 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:03:28,520 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:03:28,522 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:03:28,843 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:29,040 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:03:29,321 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:03:30,165 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:03:30,177 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 18:03:30,522 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:03:30,523 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 18:03:30,523 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 18:03:30,524 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 18:03:30,524 - __main__ - INFO - Script finished successfully.
2025-07-09 18:18:56,847 - root - DEBUG - Logging system initialized with level: DEBUG
2025-07-09 18:18:56,848 - root - DEBUG - Log file output to: C:\Users\NathanNeely\Projects\ORA_Automation\logs\app-log.txt
2025-07-09 18:18:57,252 - __main__ - INFO - Starting ShipStation Reporter Script (main orchestrator)...
2025-07-09 18:18:57,252 - src.services.reporting_logic.report_data_loader - INFO - Loading all configuration data...
2025-07-09 18:18:57,252 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:18:57,253 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:18:57,265 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:18:57,654 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:18:57,657 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:18:57,657 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:18:57,658 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:18:57,685 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:18:57,849 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:18:57,851 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:18:58,341 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:18:58,466 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:18:58,468 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Configuration'.
2025-07-09 18:18:58,644 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Configuration%27 HTTP/1.1" 200 None
2025-07-09 18:18:58,647 - src.services.google_sheets.api_client - INFO - Successfully fetched 43 rows from worksheet 'ORA_Configuration'.
2025-07-09 18:18:58,652 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded all configuration data.
2025-07-09 18:18:58,652 - src.services.reporting_logic.report_data_loader - INFO - Loading inventory transactions...
2025-07-09 18:18:58,653 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:18:58,653 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:18:58,656 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:18:58,896 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:18:58,899 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:18:58,901 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:18:58,902 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:18:58,926 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:18:59,074 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:18:59,075 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:18:59,289 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:18:59,408 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:18:59,410 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Inventory_Transactions'.
2025-07-09 18:18:59,561 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Inventory_Transactions%27 HTTP/1.1" 200 None
2025-07-09 18:18:59,563 - src.services.google_sheets.api_client - INFO - Successfully fetched 12 rows from worksheet 'Inventory_Transactions'.
2025-07-09 18:18:59,565 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions dtypes BEFORE date conversion:
Date               object
SKU                 int64
Quantity            int64
TransactionType    object
Notes              object
2025-07-09 18:18:59,566 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head BEFORE conversion:
0    5/16/2025
1    5/20/2025
2    5/25/2025
3     5/2/2025
4    5/12/2025
2025-07-09 18:18:59,569 - src.services.reporting_logic.report_data_loader - DEBUG - Inventory_Transactions 'Date' column head AFTER conversion and dropna:
0   2025-05-16
1   2025-05-20
2   2025-05-25
3   2025-05-02
4   2025-05-12
2025-07-09 18:18:59,570 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 12 inventory transactions.
2025-07-09 18:18:59,572 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped items data...
2025-07-09 18:18:59,572 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:18:59,573 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:18:59,578 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:18:59,869 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:18:59,870 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:18:59,872 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:18:59,872 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:18:59,897 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:19:00,048 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:19:00,050 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:19:00,250 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:19:00,361 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:19:00,363 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Items_Data'.
2025-07-09 18:19:00,535 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Items_Data%27 HTTP/1.1" 200 None
2025-07-09 18:19:00,540 - src.services.google_sheets.api_client - INFO - Successfully fetched 799 rows from worksheet 'Shipped_Items_Data'.
2025-07-09 18:19:00,544 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'Date' column head AFTER conversion and dropna:
0   2025-06-02
1   2025-06-02
2   2025-06-02
3   2025-06-02
4   2025-06-02
2025-07-09 18:19:00,546 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes BEFORE SKU/Quantity processing:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
Base SKU                     int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:19:00,551 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head BEFORE SKU/Quantity processing:
  Ship Date       SKU - Lot  Quantity Shipped  Base SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2     17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2     17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1     17612                 1 2025-06-02
2025-07-09 18:19:00,556 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU' column (if exists):
Series([], )
2025-07-09 18:19:00,557 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'SKU_Lot' column (if exists):
Series([], )
2025-07-09 18:19:00,559 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data value counts for 'Base SKU' column (if exists):
Base SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:19:00,560 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data dtypes AFTER SKU derivation:
Ship Date                   object
SKU - Lot                   object
Quantity Shipped             int64
SKU                          int64
Quantity_Shipped             int64
Date                datetime64[ns]
2025-07-09 18:19:00,562 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data head AFTER SKU derivation:
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped       Date
0  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2 2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2 2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1 2025-06-02
2025-07-09 18:19:00,564 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data 'SKU' column value counts AFTER derivation:
SKU
17612    662
17914     75
17904     51
18675     11
2025-07-09 18:19:00,565 - src.services.reporting_logic.report_data_loader - DEBUG - Shipped_Items_Data missing values in 'SKU' column AFTER derivation:
0
2025-07-09 18:19:00,565 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 799 shipped items.
2025-07-09 18:19:00,566 - src.services.reporting_logic.report_data_loader - INFO - Loading shipped orders data...
2025-07-09 18:19:00,567 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:19:00,567 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:19:00,569 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:19:00,806 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:19:00,809 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:19:00,810 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:19:00,810 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:19:00,834 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:19:00,981 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:19:00,982 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:19:01,173 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:19:01,297 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:19:01,299 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'Shipped_Orders_Data'.
2025-07-09 18:19:01,449 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Shipped_Orders_Data%27 HTTP/1.1" 200 None
2025-07-09 18:19:01,452 - src.services.google_sheets.api_client - INFO - Successfully fetched 602 rows from worksheet 'Shipped_Orders_Data'.
2025-07-09 18:19:01,455 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded 602 shipped orders.
2025-07-09 18:19:01,456 - src.services.reporting_logic.report_data_loader - INFO - Loading weekly shipped history...
2025-07-09 18:19:01,456 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:19:01,457 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:19:01,460 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:19:01,694 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:19:01,696 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:19:01,697 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:19:01,699 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:19:01,722 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:19:01,871 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:19:01,876 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:19:02,070 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:19:02,199 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:19:02,200 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'ORA_Weekly_Shipped_History'.
2025-07-09 18:19:02,349 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27ORA_Weekly_Shipped_History%27 HTTP/1.1" 200 None
2025-07-09 18:19:02,352 - src.services.google_sheets.api_client - INFO - Successfully fetched 60 rows from worksheet 'ORA_Weekly_Shipped_History'.
2025-07-09 18:19:02,358 - src.services.reporting_logic.report_data_loader - INFO - Successfully loaded and unpivoted weekly shipped history. Resulting DataFrame shape: (240, 3)
2025-07-09 18:19:02,359 - src.services.reporting_logic.report_data_loader - INFO - Loading product names map...
2025-07-09 18:19:02,359 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:19:02,360 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:19:02,364 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:19:02,607 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:19:02,608 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:19:02,609 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:19:02,609 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID: '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo'.
2025-07-09 18:19:02,632 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:19:02,788 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:19:02,789 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:19:02,984 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:19:03,090 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:19:03,091 - src.services.google_sheets.api_client - DEBUG - Reading data from worksheet: 'SKU_Lot'.
2025-07-09 18:19:03,231 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27SKU_Lot%27 HTTP/1.1" 200 None
2025-07-09 18:19:03,232 - src.services.google_sheets.api_client - INFO - Successfully fetched 7 rows from worksheet 'SKU_Lot'.
2025-07-09 18:19:03,234 - src.services.reporting_logic.report_data_loader - ERROR - Missing 'SKU' or 'Product Name'/'Product' columns in 'SKU_Lot' sheet.
2025-07-09 18:19:03,235 - __main__ - INFO - Generating Monthly Charge Report...
2025-07-09 18:19:03,235 - src.services.reporting_logic.monthly_report_generator - INFO - Generating Monthly Charge Report for 2025-6...
2025-07-09 18:19:03,239 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered head: 
  Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
0  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
1  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2  6/2/2025  17612 - 250101                 2  17612                 2  2025-06-02
3  6/2/2025  17914 - 240286                 2  17914                 2  2025-06-02
4  6/2/2025  17612 - 250101                 1  17612                 1  2025-06-02
2025-07-09 18:19:03,241 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered tail: 
     Ship Date       SKU - Lot  Quantity Shipped    SKU  Quantity_Shipped        Date
597  6/30/2025  17612 - 250172                 2  17612                 2  2025-06-30
598  6/30/2025  17612 - 250172                 6  17612                 6  2025-06-30
599  6/30/2025  17612 - 250172                16  17612                16  2025-06-30
600  6/30/2025  17612 - 250172                 1  17612                 1  2025-06-30
601  6/30/2025  17612 - 250172                40  17612                40  2025-06-30
2025-07-09 18:19:03,241 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_items_df_filtered shape: (602, 6)
2025-07-09 18:19:03,242 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered head: 
  Ship Date  OrderNumber        Date
0  6/2/2025       660875  2025-06-02
1  6/2/2025       660975  2025-06-02
2  6/2/2025       661025  2025-06-02
3  6/2/2025       660915  2025-06-02
4  6/2/2025       660885  2025-06-02
2025-07-09 18:19:03,243 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered tail: 
     Ship Date  OrderNumber        Date
597  6/30/2025       666965  2025-06-30
598  6/30/2025       666915  2025-06-30
599  6/30/2025       666895  2025-06-30
600  6/30/2025       666905  2025-06-30
601  6/30/2025       666945  2025-06-30
2025-07-09 18:19:03,244 - src.services.reporting_logic.monthly_report_generator - DEBUG - shipped_orders_df_filtered shape: (602, 3)
2025-07-09 18:19:03,246 - src.services.reporting_logic.inventory_calculations - INFO - --- Starting daily inventory calculation (BOD/EOD) ---
2025-07-09 18:19:03,248 - src.services.reporting_logic.inventory_calculations - INFO - Initial Inventory (head): [('17612', 955), ('17904', 178), ('17914', 326), ('18675', 769)]...
2025-07-09 18:19:03,248 - src.services.reporting_logic.inventory_calculations - INFO - Number of dates in report period: 30
2025-07-09 18:19:03,249 - src.services.reporting_logic.inventory_calculations - INFO - First 5 dates: [datetime.date(2025, 6, 1) datetime.date(2025, 6, 2)
 datetime.date(2025, 6, 3) datetime.date(2025, 6, 4)
 datetime.date(2025, 6, 5)]
2025-07-09 18:19:03,249 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame shape: (614, 5)
2025-07-09 18:19:03,251 - src.services.reporting_logic.inventory_calculations - INFO - Transactions DataFrame head:
         Date    SKU  Quantity TransactionType Notes
0  2025-05-16  17612       528         Receive      
1  2025-05-20  17612       576         Receive      
2  2025-05-25  17612       576         Receive      
3  2025-05-02  17612       382         Receive      
4  2025-05-12  17612         5          Repack      
2025-07-09 18:19:03,251 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial state of current_inventory before daily loop: {'17914': 326, '17904': 178, '18675': 769, '17612': 955}
2025-07-09 18:19:03,252 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-01 (Day 1 of 30) ---
2025-07-09 18:19:03,252 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-01: {'17914': 326, '17904': 178, '18675': 769, '17612': 955}
2025-07-09 18:19:03,254 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17914, BOD: 326, Received: 0, Shipped: 0, Repack: 0, EOD: 326
2025-07-09 18:19:03,255 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17904, BOD: 178, Received: 0, Shipped: 0, Repack: 0, EOD: 178
2025-07-09 18:19:03,257 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 18675, BOD: 769, Received: 0, Shipped: 0, Repack: 0, EOD: 769
2025-07-09 18:19:03,258 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-01, SKU: 17612, BOD: 955, Received: 0, Shipped: 0, Repack: 0, EOD: 955
2025-07-09 18:19:03,258 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-01): {'17914': np.int64(326), '17904': np.int64(178), '18675': np.int64(769), '17612': np.int64(955)}
2025-07-09 18:19:03,259 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-02 (Day 2 of 30) ---
2025-07-09 18:19:03,259 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-02: {'17914': np.int64(326), '17904': np.int64(178), '18675': np.int64(769), '17612': np.int64(955)}
2025-07-09 18:19:03,260 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-02: 20 transactions found.
2025-07-09 18:19:03,262 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17914, BOD: 326, Received: 0, Shipped: 3, Repack: 0, EOD: 323
2025-07-09 18:19:03,264 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17904, BOD: 178, Received: 0, Shipped: 2, Repack: 0, EOD: 176
2025-07-09 18:19:03,266 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 18675, BOD: 769, Received: 0, Shipped: 1, Repack: 0, EOD: 768
2025-07-09 18:19:03,268 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-02, SKU: 17612, BOD: 955, Received: 0, Shipped: 71, Repack: 0, EOD: 884
2025-07-09 18:19:03,269 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-02): {'17914': np.int64(323), '17904': np.int64(176), '18675': np.int64(768), '17612': np.int64(884)}
2025-07-09 18:19:03,269 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-03 (Day 3 of 30) ---
2025-07-09 18:19:03,270 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-03: {'17914': np.int64(323), '17904': np.int64(176), '18675': np.int64(768), '17612': np.int64(884)}
2025-07-09 18:19:03,271 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-03: 25 transactions found.
2025-07-09 18:19:03,272 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17914, BOD: 323, Received: 0, Shipped: 6, Repack: 0, EOD: 317
2025-07-09 18:19:03,274 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17904, BOD: 176, Received: 0, Shipped: 13, Repack: 0, EOD: 163
2025-07-09 18:19:03,276 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:19:03,278 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-03, SKU: 17612, BOD: 884, Received: 0, Shipped: 94, Repack: 0, EOD: 790
2025-07-09 18:19:03,278 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-03): {'17914': np.int64(317), '17904': np.int64(163), '18675': np.int64(768), '17612': np.int64(790)}
2025-07-09 18:19:03,279 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-04 (Day 4 of 30) ---
2025-07-09 18:19:03,280 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-04: {'17914': np.int64(317), '17904': np.int64(163), '18675': np.int64(768), '17612': np.int64(790)}
2025-07-09 18:19:03,282 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-04: 40 transactions found.
2025-07-09 18:19:03,285 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17914, BOD: 317, Received: 0, Shipped: 7, Repack: 0, EOD: 310
2025-07-09 18:19:03,287 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17904, BOD: 163, Received: 0, Shipped: 7, Repack: 0, EOD: 156
2025-07-09 18:19:03,288 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:19:03,289 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-04, SKU: 17612, BOD: 790, Received: 478, Shipped: 119, Repack: 0, EOD: 1149
2025-07-09 18:19:03,290 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-04): {'17914': np.int64(310), '17904': np.int64(156), '18675': np.int64(768), '17612': np.int64(1149)}
2025-07-09 18:19:03,290 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-05 (Day 5 of 30) ---
2025-07-09 18:19:03,290 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-05: {'17914': np.int64(310), '17904': np.int64(156), '18675': np.int64(768), '17612': np.int64(1149)}
2025-07-09 18:19:03,291 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-05: 87 transactions found.
2025-07-09 18:19:03,293 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17914, BOD: 310, Received: 0, Shipped: 7, Repack: 0, EOD: 303
2025-07-09 18:19:03,295 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17904, BOD: 156, Received: 0, Shipped: 1, Repack: 0, EOD: 155
2025-07-09 18:19:03,298 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 18675, BOD: 768, Received: 0, Shipped: 0, Repack: 0, EOD: 768
2025-07-09 18:19:03,301 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-05, SKU: 17612, BOD: 1149, Received: 0, Shipped: 296, Repack: 0, EOD: 853
2025-07-09 18:19:03,301 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-05): {'17914': np.int64(303), '17904': np.int64(155), '18675': np.int64(768), '17612': np.int64(853)}
2025-07-09 18:19:03,302 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-06 (Day 6 of 30) ---
2025-07-09 18:19:03,302 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-06: {'17914': np.int64(303), '17904': np.int64(155), '18675': np.int64(768), '17612': np.int64(853)}
2025-07-09 18:19:03,303 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-06: 21 transactions found.
2025-07-09 18:19:03,305 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17914, BOD: 303, Received: 0, Shipped: 1, Repack: 0, EOD: 302
2025-07-09 18:19:03,307 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17904, BOD: 155, Received: 0, Shipped: 2, Repack: 0, EOD: 153
2025-07-09 18:19:03,308 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 18675, BOD: 768, Received: 0, Shipped: 1, Repack: 0, EOD: 767
2025-07-09 18:19:03,310 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-06, SKU: 17612, BOD: 853, Received: 0, Shipped: 117, Repack: 0, EOD: 736
2025-07-09 18:19:03,310 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-06): {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:19:03,310 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-07 (Day 7 of 30) ---
2025-07-09 18:19:03,311 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-07: {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:19:03,314 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:19:03,316 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:19:03,317 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:19:03,319 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-07, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:19:03,319 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-07): {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:19:03,320 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-08 (Day 8 of 30) ---
2025-07-09 18:19:03,320 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-08: {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:19:03,322 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17914, BOD: 302, Received: 0, Shipped: 0, Repack: 0, EOD: 302
2025-07-09 18:19:03,324 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17904, BOD: 153, Received: 0, Shipped: 0, Repack: 0, EOD: 153
2025-07-09 18:19:03,325 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 18675, BOD: 767, Received: 0, Shipped: 0, Repack: 0, EOD: 767
2025-07-09 18:19:03,326 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-08, SKU: 17612, BOD: 736, Received: 0, Shipped: 0, Repack: 0, EOD: 736
2025-07-09 18:19:03,326 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-08): {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:19:03,327 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-09 (Day 9 of 30) ---
2025-07-09 18:19:03,327 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-09: {'17914': np.int64(302), '17904': np.int64(153), '18675': np.int64(767), '17612': np.int64(736)}
2025-07-09 18:19:03,328 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-09: 21 transactions found.
2025-07-09 18:19:03,332 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17914, BOD: 302, Received: 0, Shipped: 3, Repack: 0, EOD: 299
2025-07-09 18:19:03,334 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17904, BOD: 153, Received: 0, Shipped: 2, Repack: 0, EOD: 151
2025-07-09 18:19:03,336 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 18675, BOD: 767, Received: 0, Shipped: 1, Repack: 0, EOD: 766
2025-07-09 18:19:03,338 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-09, SKU: 17612, BOD: 736, Received: 0, Shipped: 47, Repack: 0, EOD: 689
2025-07-09 18:19:03,338 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-09): {'17914': np.int64(299), '17904': np.int64(151), '18675': np.int64(766), '17612': np.int64(689)}
2025-07-09 18:19:03,338 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-10 (Day 10 of 30) ---
2025-07-09 18:19:03,339 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-10: {'17914': np.int64(299), '17904': np.int64(151), '18675': np.int64(766), '17612': np.int64(689)}
2025-07-09 18:19:03,340 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-10: 19 transactions found.
2025-07-09 18:19:03,341 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17914, BOD: 299, Received: 0, Shipped: 3, Repack: 0, EOD: 296
2025-07-09 18:19:03,343 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17904, BOD: 151, Received: 0, Shipped: 0, Repack: 0, EOD: 151
2025-07-09 18:19:03,344 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 18675, BOD: 766, Received: 0, Shipped: 0, Repack: 0, EOD: 766
2025-07-09 18:19:03,348 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-10, SKU: 17612, BOD: 689, Received: 0, Shipped: 87, Repack: 0, EOD: 602
2025-07-09 18:19:03,348 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-10): {'17914': np.int64(296), '17904': np.int64(151), '18675': np.int64(766), '17612': np.int64(602)}
2025-07-09 18:19:03,349 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-11 (Day 11 of 30) ---
2025-07-09 18:19:03,349 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-11: {'17914': np.int64(296), '17904': np.int64(151), '18675': np.int64(766), '17612': np.int64(602)}
2025-07-09 18:19:03,351 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-11: 14 transactions found.
2025-07-09 18:19:03,353 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17914, BOD: 296, Received: 0, Shipped: 3, Repack: 0, EOD: 293
2025-07-09 18:19:03,355 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17904, BOD: 151, Received: 0, Shipped: 1, Repack: 0, EOD: 150
2025-07-09 18:19:03,357 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 18675, BOD: 766, Received: 0, Shipped: 1, Repack: 0, EOD: 765
2025-07-09 18:19:03,358 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-11, SKU: 17612, BOD: 602, Received: 0, Shipped: 67, Repack: 0, EOD: 535
2025-07-09 18:19:03,359 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-11): {'17914': np.int64(293), '17904': np.int64(150), '18675': np.int64(765), '17612': np.int64(535)}
2025-07-09 18:19:03,359 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-12 (Day 12 of 30) ---
2025-07-09 18:19:03,360 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-12: {'17914': np.int64(293), '17904': np.int64(150), '18675': np.int64(765), '17612': np.int64(535)}
2025-07-09 18:19:03,361 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-12: 53 transactions found.
2025-07-09 18:19:03,364 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17914, BOD: 293, Received: 0, Shipped: 11, Repack: 0, EOD: 282
2025-07-09 18:19:03,367 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17904, BOD: 150, Received: 0, Shipped: 14, Repack: 0, EOD: 136
2025-07-09 18:19:03,369 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:19:03,371 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-12, SKU: 17612, BOD: 535, Received: 0, Shipped: 234, Repack: 0, EOD: 301
2025-07-09 18:19:03,371 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-12): {'17914': np.int64(282), '17904': np.int64(136), '18675': np.int64(765), '17612': np.int64(301)}
2025-07-09 18:19:03,371 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-13 (Day 13 of 30) ---
2025-07-09 18:19:03,372 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-13: {'17914': np.int64(282), '17904': np.int64(136), '18675': np.int64(765), '17612': np.int64(301)}
2025-07-09 18:19:03,373 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-13: 20 transactions found.
2025-07-09 18:19:03,375 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17914, BOD: 282, Received: 0, Shipped: 12, Repack: 0, EOD: 270
2025-07-09 18:19:03,376 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17904, BOD: 136, Received: 0, Shipped: 1, Repack: 0, EOD: 135
2025-07-09 18:19:03,378 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:19:03,383 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-13, SKU: 17612, BOD: 301, Received: 0, Shipped: 83, Repack: 0, EOD: 218
2025-07-09 18:19:03,383 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-13): {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:19:03,384 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-14 (Day 14 of 30) ---
2025-07-09 18:19:03,384 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-14: {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:19:03,386 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:19:03,388 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:19:03,389 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:19:03,392 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-14, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:19:03,392 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-14): {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:19:03,392 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-15 (Day 15 of 30) ---
2025-07-09 18:19:03,392 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-15: {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:19:03,394 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17914, BOD: 270, Received: 0, Shipped: 0, Repack: 0, EOD: 270
2025-07-09 18:19:03,398 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17904, BOD: 135, Received: 0, Shipped: 0, Repack: 0, EOD: 135
2025-07-09 18:19:03,401 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 18675, BOD: 765, Received: 0, Shipped: 0, Repack: 0, EOD: 765
2025-07-09 18:19:03,403 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-15, SKU: 17612, BOD: 218, Received: 0, Shipped: 0, Repack: 0, EOD: 218
2025-07-09 18:19:03,403 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-15): {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:19:03,403 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-16 (Day 16 of 30) ---
2025-07-09 18:19:03,404 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-16: {'17914': np.int64(270), '17904': np.int64(135), '18675': np.int64(765), '17612': np.int64(218)}
2025-07-09 18:19:03,405 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-16: 69 transactions found.
2025-07-09 18:19:03,406 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17914, BOD: 270, Received: 0, Shipped: 3, Repack: 0, EOD: 267
2025-07-09 18:19:03,408 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17904, BOD: 135, Received: 0, Shipped: 2, Repack: 0, EOD: 133
2025-07-09 18:19:03,409 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 18675, BOD: 765, Received: 0, Shipped: 3, Repack: 0, EOD: 762
2025-07-09 18:19:03,411 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-16, SKU: 17612, BOD: 218, Received: 0, Shipped: 164, Repack: 0, EOD: 54
2025-07-09 18:19:03,413 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-16): {'17914': np.int64(267), '17904': np.int64(133), '18675': np.int64(762), '17612': np.int64(54)}
2025-07-09 18:19:03,413 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-17 (Day 17 of 30) ---
2025-07-09 18:19:03,414 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-17: {'17914': np.int64(267), '17904': np.int64(133), '18675': np.int64(762), '17612': np.int64(54)}
2025-07-09 18:19:03,416 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-17: 27 transactions found.
2025-07-09 18:19:03,418 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17914, BOD: 267, Received: 0, Shipped: 11, Repack: 0, EOD: 256
2025-07-09 18:19:03,420 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17904, BOD: 133, Received: 0, Shipped: 1, Repack: 0, EOD: 132
2025-07-09 18:19:03,422 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 18675, BOD: 762, Received: 0, Shipped: 12, Repack: 0, EOD: 750
2025-07-09 18:19:03,424 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-17, SKU: 17612, BOD: 54, Received: 0, Shipped: 56, Repack: 0, EOD: -2
2025-07-09 18:19:03,424 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-17): {'17914': np.int64(256), '17904': np.int64(132), '18675': np.int64(750), '17612': np.int64(-2)}
2025-07-09 18:19:03,425 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-18 (Day 18 of 30) ---
2025-07-09 18:19:03,425 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-18: {'17914': np.int64(256), '17904': np.int64(132), '18675': np.int64(750), '17612': np.int64(-2)}
2025-07-09 18:19:03,426 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-18: 17 transactions found.
2025-07-09 18:19:03,428 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17914, BOD: 256, Received: 0, Shipped: 1, Repack: 0, EOD: 255
2025-07-09 18:19:03,432 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17904, BOD: 132, Received: 0, Shipped: 1, Repack: 0, EOD: 131
2025-07-09 18:19:03,434 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:19:03,436 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-18, SKU: 17612, BOD: -2, Received: 576, Shipped: 57, Repack: 0, EOD: 517
2025-07-09 18:19:03,436 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-18): {'17914': np.int64(255), '17904': np.int64(131), '18675': np.int64(750), '17612': np.int64(517)}
2025-07-09 18:19:03,436 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-19 (Day 19 of 30) ---
2025-07-09 18:19:03,437 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-19: {'17914': np.int64(255), '17904': np.int64(131), '18675': np.int64(750), '17612': np.int64(517)}
2025-07-09 18:19:03,438 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-19: 17 transactions found.
2025-07-09 18:19:03,440 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17914, BOD: 255, Received: 0, Shipped: 7, Repack: 0, EOD: 248
2025-07-09 18:19:03,441 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17904, BOD: 131, Received: 0, Shipped: 2, Repack: 0, EOD: 129
2025-07-09 18:19:03,443 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 18675, BOD: 750, Received: 0, Shipped: 0, Repack: 0, EOD: 750
2025-07-09 18:19:03,445 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-19, SKU: 17612, BOD: 517, Received: 0, Shipped: 47, Repack: 0, EOD: 470
2025-07-09 18:19:03,446 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-19): {'17914': np.int64(248), '17904': np.int64(129), '18675': np.int64(750), '17612': np.int64(470)}
2025-07-09 18:19:03,447 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-20 (Day 20 of 30) ---
2025-07-09 18:19:03,447 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-20: {'17914': np.int64(248), '17904': np.int64(129), '18675': np.int64(750), '17612': np.int64(470)}
2025-07-09 18:19:03,449 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-20: 24 transactions found.
2025-07-09 18:19:03,452 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17914, BOD: 248, Received: 0, Shipped: 5, Repack: 0, EOD: 243
2025-07-09 18:19:03,454 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17904, BOD: 129, Received: 0, Shipped: 1, Repack: 0, EOD: 128
2025-07-09 18:19:03,455 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 18675, BOD: 750, Received: 0, Shipped: 1, Repack: 0, EOD: 749
2025-07-09 18:19:03,457 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-20, SKU: 17612, BOD: 470, Received: 0, Shipped: 76, Repack: 0, EOD: 394
2025-07-09 18:19:03,457 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-20): {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:19:03,458 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-21 (Day 21 of 30) ---
2025-07-09 18:19:03,458 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-21: {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:19:03,461 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:19:03,465 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:19:03,468 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:19:03,470 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-21, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:19:03,472 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-21): {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:19:03,472 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-22 (Day 22 of 30) ---
2025-07-09 18:19:03,472 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-22: {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:19:03,475 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:19:03,476 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17904, BOD: 128, Received: 0, Shipped: 0, Repack: 0, EOD: 128
2025-07-09 18:19:03,478 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:19:03,480 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-22, SKU: 17612, BOD: 394, Received: 0, Shipped: 0, Repack: 0, EOD: 394
2025-07-09 18:19:03,482 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-22): {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:19:03,482 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-23 (Day 23 of 30) ---
2025-07-09 18:19:03,483 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-23: {'17914': np.int64(243), '17904': np.int64(128), '18675': np.int64(749), '17612': np.int64(394)}
2025-07-09 18:19:03,484 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-23: 11 transactions found.
2025-07-09 18:19:03,487 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17914, BOD: 243, Received: 0, Shipped: 0, Repack: 0, EOD: 243
2025-07-09 18:19:03,490 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17904, BOD: 128, Received: 0, Shipped: 6, Repack: 0, EOD: 122
2025-07-09 18:19:03,492 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:19:03,496 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-23, SKU: 17612, BOD: 394, Received: 376, Shipped: 21, Repack: 0, EOD: 749
2025-07-09 18:19:03,497 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-23): {'17914': np.int64(243), '17904': np.int64(122), '18675': np.int64(749), '17612': np.int64(749)}
2025-07-09 18:19:03,497 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-24 (Day 24 of 30) ---
2025-07-09 18:19:03,498 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-24: {'17914': np.int64(243), '17904': np.int64(122), '18675': np.int64(749), '17612': np.int64(749)}
2025-07-09 18:19:03,499 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-24: 17 transactions found.
2025-07-09 18:19:03,502 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17914, BOD: 243, Received: 0, Shipped: 1, Repack: 0, EOD: 242
2025-07-09 18:19:03,503 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17904, BOD: 122, Received: 0, Shipped: 1, Repack: 0, EOD: 121
2025-07-09 18:19:03,505 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:19:03,506 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-24, SKU: 17612, BOD: 749, Received: 0, Shipped: 42, Repack: 0, EOD: 707
2025-07-09 18:19:03,507 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-24): {'17914': np.int64(242), '17904': np.int64(121), '18675': np.int64(749), '17612': np.int64(707)}
2025-07-09 18:19:03,507 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-25 (Day 25 of 30) ---
2025-07-09 18:19:03,507 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-25: {'17914': np.int64(242), '17904': np.int64(121), '18675': np.int64(749), '17612': np.int64(707)}
2025-07-09 18:19:03,508 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-25: 53 transactions found.
2025-07-09 18:19:03,510 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17914, BOD: 242, Received: 0, Shipped: 4, Repack: 0, EOD: 238
2025-07-09 18:19:03,511 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17904, BOD: 121, Received: 0, Shipped: 1, Repack: 0, EOD: 120
2025-07-09 18:19:03,515 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:19:03,517 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-25, SKU: 17612, BOD: 707, Received: 0, Shipped: 173, Repack: 0, EOD: 534
2025-07-09 18:19:03,518 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-25): {'17914': np.int64(238), '17904': np.int64(120), '18675': np.int64(749), '17612': np.int64(534)}
2025-07-09 18:19:03,518 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-26 (Day 26 of 30) ---
2025-07-09 18:19:03,519 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-26: {'17914': np.int64(238), '17904': np.int64(120), '18675': np.int64(749), '17612': np.int64(534)}
2025-07-09 18:19:03,519 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-26: 17 transactions found.
2025-07-09 18:19:03,521 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17914, BOD: 238, Received: 0, Shipped: 9, Repack: 0, EOD: 229
2025-07-09 18:19:03,523 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17904, BOD: 120, Received: 0, Shipped: 2, Repack: 0, EOD: 118
2025-07-09 18:19:03,524 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:19:03,525 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-26, SKU: 17612, BOD: 534, Received: 0, Shipped: 60, Repack: 0, EOD: 474
2025-07-09 18:19:03,526 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-26): {'17914': np.int64(229), '17904': np.int64(118), '18675': np.int64(749), '17612': np.int64(474)}
2025-07-09 18:19:03,526 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-27 (Day 27 of 30) ---
2025-07-09 18:19:03,526 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-27: {'17914': np.int64(229), '17904': np.int64(118), '18675': np.int64(749), '17612': np.int64(474)}
2025-07-09 18:19:03,527 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-27: 20 transactions found.
2025-07-09 18:19:03,530 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17914, BOD: 229, Received: 0, Shipped: 6, Repack: 0, EOD: 223
2025-07-09 18:19:03,532 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17904, BOD: 118, Received: 0, Shipped: 3, Repack: 0, EOD: 115
2025-07-09 18:19:03,534 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:19:03,536 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-27, SKU: 17612, BOD: 474, Received: 0, Shipped: 51, Repack: 0, EOD: 423
2025-07-09 18:19:03,536 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-27): {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:19:03,536 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-28 (Day 28 of 30) ---
2025-07-09 18:19:03,536 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-28: {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:19:03,538 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:19:03,540 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:19:03,541 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:19:03,542 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-28, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:19:03,543 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-28): {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:19:03,543 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-29 (Day 29 of 30) ---
2025-07-09 18:19:03,543 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-29: {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:19:03,546 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17914, BOD: 223, Received: 0, Shipped: 0, Repack: 0, EOD: 223
2025-07-09 18:19:03,548 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17904, BOD: 115, Received: 0, Shipped: 0, Repack: 0, EOD: 115
2025-07-09 18:19:03,550 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:19:03,552 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-29, SKU: 17612, BOD: 423, Received: 0, Shipped: 0, Repack: 0, EOD: 423
2025-07-09 18:19:03,553 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-29): {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:19:03,553 - src.services.reporting_logic.inventory_calculations - DEBUG - --- Processing date: 2025-06-30 (Day 30 of 30) ---
2025-07-09 18:19:03,553 - src.services.reporting_logic.inventory_calculations - DEBUG - BOD_Inventory (copy of current_inventory) for 2025-06-30: {'17914': np.int64(223), '17904': np.int64(115), '18675': np.int64(749), '17612': np.int64(423)}
2025-07-09 18:19:03,554 - src.services.reporting_logic.inventory_calculations - INFO - Processing daily transactions for 2025-06-30: 13 transactions found.
2025-07-09 18:19:03,556 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17914, BOD: 223, Received: 0, Shipped: 1, Repack: 0, EOD: 222
2025-07-09 18:19:03,557 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17904, BOD: 115, Received: 0, Shipped: 3, Repack: 0, EOD: 112
2025-07-09 18:19:03,559 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 18675, BOD: 749, Received: 0, Shipped: 0, Repack: 0, EOD: 749
2025-07-09 18:19:03,560 - src.services.reporting_logic.inventory_calculations - INFO - Date: 2025-06-30, SKU: 17612, BOD: 423, Received: 0, Shipped: 84, Repack: 0, EOD: 339
2025-07-09 18:19:03,561 - src.services.reporting_logic.inventory_calculations - DEBUG - current_inventory (after processing 2025-06-30): {'17914': np.int64(222), '17904': np.int64(112), '18675': np.int64(749), '17612': np.int64(339)}
2025-07-09 18:19:03,564 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (head):
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
2  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 18:19:03,566 - src.services.reporting_logic.inventory_calculations - INFO - Final daily_inventory_df to be returned from calculate_daily_inventory (tail):
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
118  2025-06-30  18675            749            749
2025-07-09 18:19:03,567 - src.services.reporting_logic.inventory_calculations - INFO - Daily inventory calculation complete. Shape: (120, 4)
2025-07-09 18:19:03,567 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting daily_inventory_df after calculation ---
2025-07-09 18:19:03,568 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df head:
         Date    SKU  BOD_Inventory  EOD_Inventory
3  2025-06-01  17612            955            955
1  2025-06-01  17904            178            178
0  2025-06-01  17914            326            326
2  2025-06-01  18675            769            769
7  2025-06-02  17612            955            884
2025-07-09 18:19:03,569 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df tail:
           Date    SKU  BOD_Inventory  EOD_Inventory
114  2025-06-29  18675            749            749
119  2025-06-30  17612            423            339
117  2025-06-30  17904            115            112
116  2025-06-30  17914            223            222
118  2025-06-30  18675            749            749
2025-07-09 18:19:03,570 - src.services.reporting_logic.monthly_report_generator - INFO - daily_inventory_df shape: (120, 4)
2025-07-09 18:19:03,571 - src.services.reporting_logic.monthly_report_generator - INFO - EOD_Inventory description across all SKUs:
count     120.000000
mean      423.775000
std       275.114872
min        -2.000000
25%       172.750000
50%       302.000000
75%       749.000000
max      1149.000000
2025-07-09 18:19:03,573 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17612:
           Date  EOD_Inventory
3    2025-06-01            955
7    2025-06-02            884
11   2025-06-03            790
15   2025-06-04           1149
19   2025-06-05            853
23   2025-06-06            736
27   2025-06-07            736
31   2025-06-08            736
35   2025-06-09            689
39   2025-06-10            602
43   2025-06-11            535
47   2025-06-12            301
51   2025-06-13            218
55   2025-06-14            218
59   2025-06-15            218
63   2025-06-16             54
67   2025-06-17             -2
71   2025-06-18            517
75   2025-06-19            470
79   2025-06-20            394
83   2025-06-21            394
87   2025-06-22            394
91   2025-06-23            749
95   2025-06-24            707
99   2025-06-25            534
103  2025-06-26            474
107  2025-06-27            423
111  2025-06-28            423
115  2025-06-29            423
119  2025-06-30            339
2025-07-09 18:19:03,575 - src.services.reporting_logic.monthly_report_generator - INFO - Daily EOD_Inventory for SKU 17904:
           Date  EOD_Inventory
1    2025-06-01            178
5    2025-06-02            176
9    2025-06-03            163
13   2025-06-04            156
17   2025-06-05            155
21   2025-06-06            153
25   2025-06-07            153
29   2025-06-08            153
33   2025-06-09            151
37   2025-06-10            151
41   2025-06-11            150
45   2025-06-12            136
49   2025-06-13            135
53   2025-06-14            135
57   2025-06-15            135
61   2025-06-16            133
65   2025-06-17            132
69   2025-06-18            131
73   2025-06-19            129
77   2025-06-20            128
81   2025-06-21            128
85   2025-06-22            128
89   2025-06-23            122
93   2025-06-24            121
97   2025-06-25            120
101  2025-06-26            118
105  2025-06-27            115
109  2025-06-28            115
113  2025-06-29            115
117  2025-06-30            112
2025-07-09 18:19:03,584 - src.services.reporting_logic.monthly_report_generator - INFO - Daily Unique SKUs Shipped (count > 0):
Date
2025-06-02    4
2025-06-03    3
2025-06-04    3
2025-06-05    3
2025-06-06    4
2025-06-09    4
2025-06-10    2
2025-06-11    4
2025-06-12    3
2025-06-13    3
2025-06-16    4
2025-06-17    4
2025-06-18    3
2025-06-19    3
2025-06-20    4
2025-06-23    2
2025-06-24    3
2025-06-25    3
2025-06-26    3
2025-06-27    3
2025-06-30    3
2025-07-09 18:19:03,588 - src.services.reporting_logic.monthly_report_generator - INFO - --- Inspecting PalletsUsed before summing ---
2025-07-09 18:19:03,589 - src.services.reporting_logic.monthly_report_generator - INFO - PalletsUsed description across all SKUs:
count    120.000000
mean       8.516667
std        6.190238
min        0.000000
25%        3.000000
50%        4.500000
75%       16.000000
max       24.000000
2025-07-09 18:19:03,591 - src.services.reporting_logic.monthly_report_generator - INFO - Daily PalletsUsed for SKU 17612:
           Date  PalletsUsed
3    2025-06-01           20
7    2025-06-02           19
11   2025-06-03           17
15   2025-06-04           24
19   2025-06-05           18
23   2025-06-06           16
27   2025-06-07           16
31   2025-06-08           16
35   2025-06-09           15
39   2025-06-10           13
43   2025-06-11           12
47   2025-06-12            7
51   2025-06-13            5
55   2025-06-14            5
59   2025-06-15            5
63   2025-06-16            2
67   2025-06-17            0
71   2025-06-18           11
75   2025-06-19           10
79   2025-06-20            9
83   2025-06-21            9
87   2025-06-22            9
91   2025-06-23           16
95   2025-06-24           15
99   2025-06-25           12
103  2025-06-26           10
107  2025-06-27            9
111  2025-06-28            9
115  2025-06-29            9
119  2025-06-30            8
2025-07-09 18:19:03,592 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (head):
Date
2025-06-01    45
2025-06-02    43
2025-06-03    40
2025-06-04    47
2025-06-05    41
2025-07-09 18:19:03,593 - src.services.reporting_logic.monthly_report_generator - INFO - Summed PalletsUsed per Date (tail):
Date
2025-06-26    31
2025-06-27    30
2025-06-28    30
2025-06-29    30
2025-06-30    29
2025-07-09 18:19:03,593 - src.services.reporting_logic.monthly_report_generator - INFO - Pallet counts used: {'17612': 48, '17904': 64, '17914': 80, '18675': 48}
2025-07-09 18:19:03,593 - src.services.reporting_logic.monthly_report_generator - INFO - Rates dictionary used: {'OrderCharge': 4.25, 'PackageCharge': 0.75, 'SpaceRentalRate': 0.45}
2025-07-09 18:19:03,594 - src.services.reporting_logic.monthly_report_generator - INFO - --- Final Space Rental Charge in Report DataFrame ---
2025-07-09 18:19:03,597 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (head):
Date
2025-06-01    20.25
2025-06-02    19.35
2025-06-03    18.00
2025-06-04    21.15
2025-06-05    18.45
2025-07-09 18:19:03,598 - src.services.reporting_logic.monthly_report_generator - INFO - Space Rental Charge column (tail):
Date
2025-06-26    13.95
2025-06-27    13.50
2025-06-28    13.50
2025-06-29    13.50
2025-06-30    13.05
2025-07-09 18:19:03,603 - src.services.reporting_logic.monthly_report_generator - DEBUG - Key SKUs list: ['17612', '17904', '17914', '18675', '18795']
2025-07-09 18:19:03,603 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table shape: (21, 4)
2025-07-09 18:19:03,604 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table columns: [17612, 17904, 17914, 18675]
2025-07-09 18:19:03,606 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table head:
SKU         17612  17904  17914  18675
Date                                  
2025-06-02   71.0    2.0    3.0    1.0
2025-06-03   94.0   13.0    6.0    0.0
2025-06-04  119.0    7.0    7.0    0.0
2025-06-05  296.0    1.0    7.0    0.0
2025-06-06  117.0    2.0    1.0    1.0
2025-07-09 18:19:03,609 - src.services.reporting_logic.monthly_report_generator - DEBUG - Daily Shipped Pivot table info:
None
2025-07-09 18:19:03,610 - src.services.reporting_logic.monthly_report_generator - INFO - Monthly Charge Report generated successfully.
2025-07-09 18:19:03,613 - __main__ - WARNING - Monthly totals DataFrame was empty or None. Only main monthly report data will be written.
2025-07-09 18:19:03,613 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:19:03,614 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:19:03,617 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:19:03,860 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:19:03,862 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:19:03,862 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:19:03,863 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Monthly Charge Report'.
2025-07-09 18:19:03,892 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:19:04,028 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:19:04,032 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:19:04,272 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:19:04,400 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:19:04,682 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:19:04,888 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:19:04,889 - gspread_dataframe - DEBUG - 384 cell updates to send
2025-07-09 18:19:05,409 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Monthly%20Charge%20Report%27%21A1%3AL32?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:19:05,410 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Monthly Charge Report'!A1:L32", 'updatedRows': 32, 'updatedColumns': 12, 'updatedCells': 384}
2025-07-09 18:19:05,410 - src.services.google_sheets.api_client - INFO - Successfully wrote 31 rows to worksheet 'Monthly Charge Report'.
2025-07-09 18:19:05,411 - __main__ - INFO - Monthly Charge Report written successfully.
2025-07-09 18:19:05,412 - __main__ - INFO - Generating Weekly Inventory Report...
2025-07-09 18:19:05,413 - src.services.reporting_logic.inventory_calculations - INFO - Calculating current inventory for week 2025-07-07 to 2025-07-13...
2025-07-09 18:19:05,414 - src.services.reporting_logic.inventory_calculations - DEBUG - Initial inventory for current calculation: {'17612': 1006, '17904': 108, '17914': 175, '18675': 749}
2025-07-09 18:19:05,417 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly transactions shape: (1, 5)
2025-07-09 18:19:05,418 - src.services.reporting_logic.inventory_calculations - DEBUG - Weekly shipped items shape: (62, 6)
2025-07-09 18:19:05,420 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions head:
     SKU  Quantity TransactionType
0  17612       576         Receive
1  17612         2            Ship
2  17612         6            Ship
3  17612         1            Ship
4  17612         1            Ship
2025-07-09 18:19:05,421 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions tail:
      SKU  Quantity TransactionType
58  17914         1            Ship
59  17914         1            Ship
60  17914         1            Ship
61  17914         1            Ship
62  17914         2            Ship
2025-07-09 18:19:05,422 - src.services.reporting_logic.inventory_calculations - DEBUG - All weekly transactions shape: (63, 3)
2025-07-09 18:19:05,424 - src.services.reporting_logic.inventory_calculations - INFO - Current inventory calculation complete. Shape: (4, 2)
2025-07-09 18:19:05,425 - root - INFO - Calculating 12-Month Rolling Average...
2025-07-09 18:19:05,427 - root - DEBUG - Calculating rolling average for 52 weeks prior to 2025-07-09
2025-07-09 18:19:05,428 - root - DEBUG - Found 200 shipment records in the last 52 weeks.
2025-07-09 18:19:05,429 - root - INFO - Successfully calculated 12-month rolling average.
2025-07-09 18:19:05,430 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:19:05,430 - root - DEBUG - Final rolling average DataFrame shape: (4, 2)
2025-07-09 18:19:05,431 - root - DEBUG - Final rolling average DataFrame columns: ['SKU', '12-Month Rolling Average']
2025-07-09 18:19:05,434 - src.services.google_sheets.api_client - DEBUG - Authenticating with Google Sheets API...
2025-07-09 18:19:05,434 - src.services.gcp.secret_manager - DEBUG - Attempting to access secret 'google-sheets-service-account-key' in project 'ora-automation-project'.
2025-07-09 18:19:05,437 - src.services.gcp.secret_manager - DEBUG - Using service account file for authentication.
2025-07-09 18:19:05,678 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-07-09 18:19:05,680 - urllib3.util.retry - DEBUG - Converted retries value: 3 -> Retry(total=3, connect=None, read=None, redirect=None, status=None)
2025-07-09 18:19:05,681 - src.services.google_sheets.api_client - INFO - Successfully authenticated with Google Sheets API.
2025-07-09 18:19:05,682 - src.services.google_sheets.api_client - DEBUG - Opening Google Sheet by ID '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo' to write to worksheet 'Weekly Report'.
2025-07-09 18:19:05,707 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-07-09 18:19:05,851 - urllib3.connectionpool - DEBUG - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-07-09 18:19:05,852 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): sheets.googleapis.com:443
2025-07-09 18:19:06,048 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:19:06,168 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "GET /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo?includeGridData=false HTTP/1.1" 200 None
2025-07-09 18:19:06,339 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27:clear HTTP/1.1" 200 None
2025-07-09 18:19:06,525 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "POST /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo:batchUpdate HTTP/1.1" 200 None
2025-07-09 18:19:06,526 - gspread_dataframe - DEBUG - 20 cell updates to send
2025-07-09 18:19:06,775 - urllib3.connectionpool - DEBUG - https://sheets.googleapis.com:443 "PUT /v4/spreadsheets/1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo/values/%27Weekly%20Report%27%21A1%3AD5?valueInputOption=USER_ENTERED HTTP/1.1" 200 None
2025-07-09 18:19:06,776 - gspread_dataframe - DEBUG - Cell update response: {'spreadsheetId': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'updatedRange': "'Weekly Report'!A1:D5", 'updatedRows': 5, 'updatedColumns': 4, 'updatedCells': 20}
2025-07-09 18:19:06,776 - src.services.google_sheets.api_client - INFO - Successfully wrote 4 rows to worksheet 'Weekly Report'.
2025-07-09 18:19:06,777 - __main__ - INFO - Weekly Inventory Report written successfully.
2025-07-09 18:19:06,777 - __main__ - INFO - Script finished successfully.
