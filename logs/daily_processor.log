2025-08-27 15:23:12,858 - root - INFO - Logging environment: LOCAL
2025-08-27 15:23:12,858 - root - INFO - Logging environment: LOCAL
2025-08-27 15:23:12,858 - root - INFO - Logging environment: LOCAL
2025-08-27 15:23:12,858 - root - INFO - Logging environment: LOCAL
2025-08-27 15:23:12,860 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-08-27 15:23:12,860 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-08-27 15:23:12,861 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-08-27 15:23:12,861 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-08-27 15:23:12,862 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-08-27 15:23:12,862 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-08-27 15:23:12,862 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-08-27 15:23:12,862 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-08-27 15:23:12,863 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-08-27 15:23:12,863 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-08-27 15:23:12,863 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-08-27 15:23:12,863 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-08-27 15:23:12,864 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-08-27 15:23:12,864 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-08-27 15:23:12,864 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-08-27 15:23:12,864 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-08-27 15:23:12,865 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-08-27 15:23:12,865 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-08-27 15:23:13,144 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-08-27 15:23:13,144 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-08-27 15:23:13,145 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-08-27 15:23:13,145 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-08-27 15:23:13,418 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-08-27 15:23:13,418 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-08-27 15:23:13,420 - __main__ - INFO - Using rolling 32-day date range: 2025-07-26 to 2025-08-27
2025-08-27 15:23:13,420 - __main__ - INFO - Using rolling 32-day date range: 2025-07-26 to 2025-08-27
2025-08-27 15:23:13,421 - __main__ - INFO - Environment: LOCAL
2025-08-27 15:23:13,421 - __main__ - INFO - Environment: LOCAL
2025-08-27 15:23:13,422 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-08-27 15:23:13,422 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-08-27 15:23:13,423 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-07-26 with includeShipmentItems=true and status='shipped'...
2025-08-27 15:23:13,423 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-07-26 with includeShipmentItems=true and status='shipped'...
2025-08-27 15:23:13,424 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-08-27 15:23:13,424 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-08-27 15:23:14,195 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-08-27 15:23:14,195 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-08-27 15:23:14,203 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-08-27 15:23:14,203 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-08-27 15:23:14,204 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-08-27 15:23:14,204 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-08-27 15:23:14,723 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-08-27 15:23:14,723 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-08-27 15:23:14,726 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 719
2025-08-27 15:23:14,726 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 719
2025-08-27 15:23:14,727 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 719
2025-08-27 15:23:14,727 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 719
2025-08-27 15:23:14,728 - __main__ - INFO - Processing 717 non-voided shipments.
2025-08-27 15:23:14,728 - __main__ - INFO - Processing 717 non-voided shipments.
2025-08-27 15:23:14,728 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-08-27 15:23:14,728 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-08-27 15:23:14,728 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-08-27 15:23:14,728 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-08-27 15:23:14,735 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 717 rows.
2025-08-27 15:23:14,735 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 717 rows.
2025-08-27 15:23:14,736 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-08-27 15:23:14,736 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-08-27 15:23:14,737 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-08-27 15:23:14,737 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-08-27 15:23:14,745 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 652 unique order rows.
2025-08-27 15:23:14,745 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 652 unique order rows.
2025-08-27 15:23:14,746 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 717 rows...
2025-08-27 15:23:14,746 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 717 rows...
2025-08-27 15:23:14,746 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-08-27 15:23:14,746 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-08-27 15:23:14,747 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-08-27 15:23:14,747 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-08-27 15:23:14,749 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 7, 28), datetime.date(2025, 7, 28), datetime.date(2025, 7, 28)], 'SKU - Lot': ['17612 - 250195', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [2, 15, 15], 'Base SKU': ['17612', '17612', '17612']}}
2025-08-27 15:23:14,749 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 7, 28), datetime.date(2025, 7, 28), datetime.date(2025, 7, 28)], 'SKU - Lot': ['17612 - 250195', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [2, 15, 15], 'Base SKU': ['17612', '17612', '17612']}}
2025-08-27 15:23:14,752 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-08-27 15:23:14,752 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-08-27 15:23:15,018 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-08-27 15:23:15,018 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-08-27 15:23:15,020 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-08-27 15:23:15,020 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-08-27 15:23:15,024 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:23:15,024 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:23:15,028 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 718}
2025-08-27 15:23:15,028 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 718}
2025-08-27 15:23:15,763 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2872}
2025-08-27 15:23:15,763 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2872}
2025-08-27 15:23:16,293 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-08-27 15:23:16,293 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-08-27 15:23:16,503 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-08-27 15:23:16,503 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-08-27 15:23:16,504 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 652 rows...
2025-08-27 15:23:16,504 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 652 rows...
2025-08-27 15:23:16,504 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-08-27 15:23:16,504 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-08-27 15:23:16,505 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-08-27 15:23:16,505 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-08-27 15:23:16,505 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 7, 28), datetime.date(2025, 7, 28), datetime.date(2025, 7, 28)], 'OrderNumber': ['672725', '672745', '672755']}}
2025-08-27 15:23:16,505 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 7, 28), datetime.date(2025, 7, 28), datetime.date(2025, 7, 28)], 'OrderNumber': ['672725', '672745', '672755']}}
2025-08-27 15:23:16,507 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-08-27 15:23:16,507 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-08-27 15:23:16,508 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:23:16,508 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:23:16,511 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 653}
2025-08-27 15:23:16,511 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 653}
2025-08-27 15:23:16,955 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1306}
2025-08-27 15:23:16,955 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1306}
2025-08-27 15:23:17,549 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-08-27 15:23:17,549 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-08-27 15:23:17,810 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-08-27 15:23:17,810 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-08-27 15:23:17,812 - __main__ - INFO - Fetching existing 52-week history for update...
2025-08-27 15:23:17,812 - __main__ - INFO - Fetching existing 52-week history for update...
2025-08-27 15:23:17,814 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-08-27 15:23:17,814 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-08-27 15:23:17,822 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:23:17,822 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:23:17,836 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-08-27 15:23:17,836 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-08-27 15:23:18,654 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-08-27 15:23:18,654 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-08-27 15:23:18,678 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
597  2025-08-25  ...    17612
598  2025-08-25  ...    17612
599  2025-08-25  ...    17612
600  2025-08-25  ...    17914
601  2025-08-25  ...    17612
..          ...  ...      ...
712  2025-08-27  ...    17612
713  2025-08-27  ...    17612
714  2025-08-27  ...    17612
715  2025-08-27  ...    17612
716  2025-08-27  ...    17904

[120 rows x 4 columns]
2025-08-27 15:23:18,678 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
597  2025-08-25  ...    17612
598  2025-08-25  ...    17612
599  2025-08-25  ...    17612
600  2025-08-25  ...    17914
601  2025-08-25  ...    17612
..          ...  ...      ...
712  2025-08-27  ...    17612
713  2025-08-27  ...    17612
714  2025-08-27  ...    17612
715  2025-08-27  ...    17612
716  2025-08-27  ...    17904

[120 rows x 4 columns]
2025-08-27 15:23:18,681 - __main__ - INFO - current_week_items_df shape: (120, 4)
2025-08-27 15:23:18,681 - __main__ - INFO - current_week_items_df shape: (120, 4)
2025-08-27 15:23:18,693 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
597  2025-08-25  ...    17612
598  2025-08-25  ...    17612
599  2025-08-25  ...    17612
600  2025-08-25  ...    17914
601  2025-08-25  ...    17612
602  2025-08-25  ...    17612
603  2025-08-25  ...    17612
604  2025-08-25  ...    17914
605  2025-08-25  ...    17612
606  2025-08-25  ...    17612

[10 rows x 4 columns]
2025-08-27 15:23:18,693 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
597  2025-08-25  ...    17612
598  2025-08-25  ...    17612
599  2025-08-25  ...    17612
600  2025-08-25  ...    17914
601  2025-08-25  ...    17612
602  2025-08-25  ...    17612
603  2025-08-25  ...    17612
604  2025-08-25  ...    17914
605  2025-08-25  ...    17612
606  2025-08-25  ...    17612

[10 rows x 4 columns]
2025-08-27 15:23:18,694 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-08-27 15:23:18,694 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-08-27 15:23:18,695 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-08-27 15:23:18,695 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-08-27 15:23:18,699 - __main__ - INFO - Current week starts on: 2025-08-25
2025-08-27 15:23:18,699 - __main__ - INFO - Current week starts on: 2025-08-25
2025-08-27 15:23:18,701 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 7, 28), datetime.date(2025, 7, 29), datetime.date(2025, 7, 30), datetime.date(2025, 7, 31), datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27)]
2025-08-27 15:23:18,701 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 7, 28), datetime.date(2025, 7, 29), datetime.date(2025, 7, 30), datetime.date(2025, 7, 31), datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27)]
2025-08-27 15:23:18,705 - __main__ - INFO - Min Ship Date: 2025-07-28, Max Ship Date: 2025-08-27
2025-08-27 15:23:18,705 - __main__ - INFO - Min Ship Date: 2025-07-28, Max Ship Date: 2025-08-27
2025-08-27 15:23:18,709 - __main__ - INFO - current_week_items_df shape: (120, 4)
2025-08-27 15:23:18,709 - __main__ - INFO - current_week_items_df shape: (120, 4)
2025-08-27 15:23:18,715 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
597  2025-08-25  ...    17612
598  2025-08-25  ...    17612
599  2025-08-25  ...    17612
600  2025-08-25  ...    17914
601  2025-08-25  ...    17612
602  2025-08-25  ...    17612
603  2025-08-25  ...    17612
604  2025-08-25  ...    17914
605  2025-08-25  ...    17612
606  2025-08-25  ...    17612

[10 rows x 4 columns]
2025-08-27 15:23:18,715 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
597  2025-08-25  ...    17612
598  2025-08-25  ...    17612
599  2025-08-25  ...    17612
600  2025-08-25  ...    17914
601  2025-08-25  ...    17612
602  2025-08-25  ...    17612
603  2025-08-25  ...    17612
604  2025-08-25  ...    17914
605  2025-08-25  ...    17612
606  2025-08-25  ...    17612

[10 rows x 4 columns]
2025-08-27 15:23:18,719 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-08-27 15:23:18,719 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-08-27 15:23:18,722 - __main__ - INFO - Current week starts on: 2025-08-25
2025-08-27 15:23:18,722 - __main__ - INFO - Current week starts on: 2025-08-25
2025-08-27 15:23:18,735 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-08-27 15:23:18,735 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-08-27 15:23:18,762 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-08-27 15:23:18,762 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-08-27 15:23:18,782 - __main__ - INFO - Current week found in history. Updating the last row.
2025-08-27 15:23:18,782 - __main__ - INFO - Current week found in history. Updating the last row.
2025-08-27 15:23:18,790 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-08-27 15:23:18,790 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-08-27 15:23:18,791 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-08-27 15:23:18,791 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-08-27 15:23:18,792 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-08-25, Expected: 2025-08-25.
2025-08-27 15:23:18,792 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-08-25, Expected: 2025-08-25.
2025-08-27 15:23:18,793 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-08-27 15:23:18,793 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-08-27 15:23:18,794 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-08-27 15:23:18,794 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-08-27 15:23:18,794 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-08-27 15:23:18,794 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-08-27 15:23:18,795 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-08-27 15:23:18,795 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-08-27 15:23:18,797 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 2), datetime.date(2024, 9, 9), datetime.date(2024, 9, 16)], 'Stop Date': ['2024-09-08', '2024-09-15', '2024-09-22'], '17612': ['592', '406', '442'], '17904': ['11', '0', '0'], '17914': ['27', '19', '24'], '18675': ['14', '2', '2'], '18795': ['0', '0', '0']}}
2025-08-27 15:23:18,797 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 2), datetime.date(2024, 9, 9), datetime.date(2024, 9, 16)], 'Stop Date': ['2024-09-08', '2024-09-15', '2024-09-22'], '17612': ['592', '406', '442'], '17904': ['11', '0', '0'], '17914': ['27', '19', '24'], '18675': ['14', '2', '2'], '18795': ['0', '0', '0']}}
2025-08-27 15:23:18,800 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-08-27 15:23:18,800 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-08-27 15:23:18,805 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:23:18,805 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:23:18,835 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-08-27 15:23:18,835 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-08-27 15:23:19,397 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-08-27 15:23:19,397 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-08-27 15:23:20,051 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-08-27 15:23:20,051 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-08-27 15:23:20,309 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-08-27 15:23:20,309 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-08-27 15:23:20,311 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-08-27 15:23:20,311 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-08-27 15:29:59,073 - root - INFO - Logging environment: LOCAL
2025-08-27 15:29:59,073 - root - INFO - Logging environment: LOCAL
2025-08-27 15:29:59,073 - root - INFO - Logging environment: LOCAL
2025-08-27 15:29:59,073 - root - INFO - Logging environment: LOCAL
2025-08-27 15:29:59,074 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-08-27 15:29:59,074 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-08-27 15:29:59,076 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-08-27 15:29:59,076 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-08-27 15:29:59,077 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-08-27 15:29:59,077 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-08-27 15:29:59,078 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-08-27 15:29:59,078 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-08-27 15:29:59,078 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-08-27 15:29:59,078 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-08-27 15:29:59,080 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-08-27 15:29:59,080 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-08-27 15:29:59,080 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-08-27 15:29:59,080 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-08-27 15:29:59,081 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-08-27 15:29:59,081 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-08-27 15:29:59,083 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-08-27 15:29:59,083 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-08-27 15:29:59,426 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-08-27 15:29:59,426 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-08-27 15:29:59,428 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-08-27 15:29:59,428 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-08-27 15:29:59,719 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-08-27 15:29:59,719 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-08-27 15:29:59,721 - __main__ - INFO - Using rolling 32-day date range: 2025-07-26 to 2025-08-27
2025-08-27 15:29:59,721 - __main__ - INFO - Using rolling 32-day date range: 2025-07-26 to 2025-08-27
2025-08-27 15:29:59,723 - __main__ - INFO - Environment: LOCAL
2025-08-27 15:29:59,723 - __main__ - INFO - Environment: LOCAL
2025-08-27 15:29:59,724 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-08-27 15:29:59,724 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-08-27 15:29:59,725 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-07-26 with includeShipmentItems=true and status='shipped'...
2025-08-27 15:29:59,725 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-07-26 with includeShipmentItems=true and status='shipped'...
2025-08-27 15:29:59,728 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-08-27 15:29:59,728 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-08-27 15:30:00,614 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-08-27 15:30:00,614 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-08-27 15:30:00,634 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-08-27 15:30:00,634 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-08-27 15:30:00,637 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-08-27 15:30:00,637 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-08-27 15:30:01,384 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-08-27 15:30:01,384 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-08-27 15:30:01,388 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 719
2025-08-27 15:30:01,388 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 719
2025-08-27 15:30:01,389 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 719
2025-08-27 15:30:01,389 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 719
2025-08-27 15:30:01,391 - __main__ - INFO - Processing 717 non-voided shipments.
2025-08-27 15:30:01,391 - __main__ - INFO - Processing 717 non-voided shipments.
2025-08-27 15:30:01,392 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-08-27 15:30:01,392 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-08-27 15:30:01,393 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-08-27 15:30:01,393 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-08-27 15:30:01,407 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 717 rows.
2025-08-27 15:30:01,407 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 717 rows.
2025-08-27 15:30:01,408 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-08-27 15:30:01,408 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-08-27 15:30:01,409 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-08-27 15:30:01,409 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-08-27 15:30:01,424 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 652 unique order rows.
2025-08-27 15:30:01,424 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 652 unique order rows.
2025-08-27 15:30:01,425 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 717 rows...
2025-08-27 15:30:01,425 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 717 rows...
2025-08-27 15:30:01,426 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-08-27 15:30:01,426 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-08-27 15:30:01,427 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-08-27 15:30:01,427 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-08-27 15:30:01,430 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 7, 28), datetime.date(2025, 7, 28), datetime.date(2025, 7, 28)], 'SKU - Lot': ['17612 - 250195', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [2, 15, 15], 'Base SKU': ['17612', '17612', '17612']}}
2025-08-27 15:30:01,430 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 7, 28), datetime.date(2025, 7, 28), datetime.date(2025, 7, 28)], 'SKU - Lot': ['17612 - 250195', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [2, 15, 15], 'Base SKU': ['17612', '17612', '17612']}}
2025-08-27 15:30:01,440 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-08-27 15:30:01,440 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-08-27 15:30:01,794 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-08-27 15:30:01,794 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-08-27 15:30:01,797 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-08-27 15:30:01,797 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-08-27 15:30:01,804 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:30:01,804 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:30:01,808 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 718}
2025-08-27 15:30:01,808 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 718}
2025-08-27 15:30:02,894 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2872}
2025-08-27 15:30:02,894 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2872}
2025-08-27 15:30:03,557 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-08-27 15:30:03,557 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-08-27 15:30:03,858 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-08-27 15:30:03,858 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-08-27 15:30:03,859 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 652 rows...
2025-08-27 15:30:03,859 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 652 rows...
2025-08-27 15:30:03,859 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-08-27 15:30:03,859 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-08-27 15:30:03,861 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-08-27 15:30:03,861 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-08-27 15:30:03,863 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 7, 28), datetime.date(2025, 7, 28), datetime.date(2025, 7, 28)], 'OrderNumber': ['672725', '672745', '672755']}}
2025-08-27 15:30:03,863 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 7, 28), datetime.date(2025, 7, 28), datetime.date(2025, 7, 28)], 'OrderNumber': ['672725', '672745', '672755']}}
2025-08-27 15:30:03,868 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-08-27 15:30:03,868 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-08-27 15:30:03,873 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:30:03,873 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:30:03,878 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 653}
2025-08-27 15:30:03,878 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 653}
2025-08-27 15:30:04,561 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1306}
2025-08-27 15:30:04,561 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1306}
2025-08-27 15:30:05,200 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-08-27 15:30:05,200 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-08-27 15:30:05,381 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-08-27 15:30:05,381 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-08-27 15:30:05,384 - __main__ - INFO - Fetching existing 52-week history for update...
2025-08-27 15:30:05,384 - __main__ - INFO - Fetching existing 52-week history for update...
2025-08-27 15:30:05,385 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-08-27 15:30:05,385 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-08-27 15:30:05,391 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:30:05,391 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:30:05,400 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-08-27 15:30:05,400 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-08-27 15:30:05,985 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-08-27 15:30:05,985 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-08-27 15:30:06,011 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
597  2025-08-25  ...    17612
598  2025-08-25  ...    17612
599  2025-08-25  ...    17612
600  2025-08-25  ...    17914
601  2025-08-25  ...    17612
..          ...  ...      ...
712  2025-08-27  ...    17612
713  2025-08-27  ...    17612
714  2025-08-27  ...    17612
715  2025-08-27  ...    17612
716  2025-08-27  ...    17904

[120 rows x 4 columns]
2025-08-27 15:30:06,011 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
597  2025-08-25  ...    17612
598  2025-08-25  ...    17612
599  2025-08-25  ...    17612
600  2025-08-25  ...    17914
601  2025-08-25  ...    17612
..          ...  ...      ...
712  2025-08-27  ...    17612
713  2025-08-27  ...    17612
714  2025-08-27  ...    17612
715  2025-08-27  ...    17612
716  2025-08-27  ...    17904

[120 rows x 4 columns]
2025-08-27 15:30:06,011 - __main__ - INFO - current_week_items_df shape: (120, 4)
2025-08-27 15:30:06,011 - __main__ - INFO - current_week_items_df shape: (120, 4)
2025-08-27 15:30:06,022 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
597  2025-08-25  ...    17612
598  2025-08-25  ...    17612
599  2025-08-25  ...    17612
600  2025-08-25  ...    17914
601  2025-08-25  ...    17612
602  2025-08-25  ...    17612
603  2025-08-25  ...    17612
604  2025-08-25  ...    17914
605  2025-08-25  ...    17612
606  2025-08-25  ...    17612

[10 rows x 4 columns]
2025-08-27 15:30:06,022 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
597  2025-08-25  ...    17612
598  2025-08-25  ...    17612
599  2025-08-25  ...    17612
600  2025-08-25  ...    17914
601  2025-08-25  ...    17612
602  2025-08-25  ...    17612
603  2025-08-25  ...    17612
604  2025-08-25  ...    17914
605  2025-08-25  ...    17612
606  2025-08-25  ...    17612

[10 rows x 4 columns]
2025-08-27 15:30:06,023 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-08-27 15:30:06,023 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-08-27 15:30:06,024 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-08-27 15:30:06,024 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-08-27 15:30:06,026 - __main__ - INFO - Current week starts on: 2025-08-25
2025-08-27 15:30:06,026 - __main__ - INFO - Current week starts on: 2025-08-25
2025-08-27 15:30:06,028 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 7, 28), datetime.date(2025, 7, 29), datetime.date(2025, 7, 30), datetime.date(2025, 7, 31), datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27)]
2025-08-27 15:30:06,028 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 7, 28), datetime.date(2025, 7, 29), datetime.date(2025, 7, 30), datetime.date(2025, 7, 31), datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27)]
2025-08-27 15:30:06,029 - __main__ - INFO - Min Ship Date: 2025-07-28, Max Ship Date: 2025-08-27
2025-08-27 15:30:06,029 - __main__ - INFO - Min Ship Date: 2025-07-28, Max Ship Date: 2025-08-27
2025-08-27 15:30:06,032 - __main__ - INFO - current_week_items_df shape: (120, 4)
2025-08-27 15:30:06,032 - __main__ - INFO - current_week_items_df shape: (120, 4)
2025-08-27 15:30:06,072 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
597  2025-08-25  ...    17612
598  2025-08-25  ...    17612
599  2025-08-25  ...    17612
600  2025-08-25  ...    17914
601  2025-08-25  ...    17612
602  2025-08-25  ...    17612
603  2025-08-25  ...    17612
604  2025-08-25  ...    17914
605  2025-08-25  ...    17612
606  2025-08-25  ...    17612

[10 rows x 4 columns]
2025-08-27 15:30:06,072 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
597  2025-08-25  ...    17612
598  2025-08-25  ...    17612
599  2025-08-25  ...    17612
600  2025-08-25  ...    17914
601  2025-08-25  ...    17612
602  2025-08-25  ...    17612
603  2025-08-25  ...    17612
604  2025-08-25  ...    17914
605  2025-08-25  ...    17612
606  2025-08-25  ...    17612

[10 rows x 4 columns]
2025-08-27 15:30:06,079 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-08-27 15:30:06,079 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-08-27 15:30:06,088 - __main__ - INFO - Current week starts on: 2025-08-25
2025-08-27 15:30:06,088 - __main__ - INFO - Current week starts on: 2025-08-25
2025-08-27 15:30:06,145 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-08-27 15:30:06,145 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-08-27 15:30:06,217 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-08-27 15:30:06,217 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-08-27 15:30:06,267 - __main__ - INFO - Current week found in history. Updating the last row.
2025-08-27 15:30:06,267 - __main__ - INFO - Current week found in history. Updating the last row.
2025-08-27 15:30:06,277 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-08-27 15:30:06,277 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-08-27 15:30:06,277 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-08-27 15:30:06,277 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-08-27 15:30:06,279 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-08-25, Expected: 2025-08-25.
2025-08-27 15:30:06,279 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-08-25, Expected: 2025-08-25.
2025-08-27 15:30:06,281 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-08-27 15:30:06,281 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-08-27 15:30:06,283 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-08-27 15:30:06,283 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-08-27 15:30:06,284 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-08-27 15:30:06,284 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-08-27 15:30:06,289 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-08-27 15:30:06,289 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-08-27 15:30:06,291 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 2), datetime.date(2024, 9, 9), datetime.date(2024, 9, 16)], 'Stop Date': ['2024-09-08', '2024-09-15', '2024-09-22'], '17612': ['592', '406', '442'], '17904': ['11', '0', '0'], '17914': ['27', '19', '24'], '18675': ['14', '2', '2'], '18795': ['0', '0', '0']}}
2025-08-27 15:30:06,291 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 2), datetime.date(2024, 9, 9), datetime.date(2024, 9, 16)], 'Stop Date': ['2024-09-08', '2024-09-15', '2024-09-22'], '17612': ['592', '406', '442'], '17904': ['11', '0', '0'], '17914': ['27', '19', '24'], '18675': ['14', '2', '2'], '18795': ['0', '0', '0']}}
2025-08-27 15:30:06,294 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-08-27 15:30:06,294 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-08-27 15:30:06,296 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:30:06,296 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-08-27 15:30:06,329 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-08-27 15:30:06,329 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-08-27 15:30:07,032 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-08-27 15:30:07,032 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-08-27 15:30:08,404 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-08-27 15:30:08,404 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-08-27 15:30:08,614 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-08-27 15:30:08,614 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-08-27 15:30:08,615 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-08-27 15:30:08,615 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:22:24,078 - root - INFO - Logging environment: LOCAL
2025-09-02 12:22:24,078 - root - INFO - Logging environment: LOCAL
2025-09-02 12:22:24,080 - root - INFO - Logging environment: LOCAL
2025-09-02 12:22:24,080 - root - INFO - Logging environment: LOCAL
2025-09-02 12:22:24,081 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:22:24,081 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:22:24,082 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:22:24,082 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:22:24,083 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:22:24,083 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:22:24,083 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:22:24,083 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:22:24,083 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:22:24,083 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:22:24,084 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:22:24,084 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:22:24,084 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:22:24,084 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:22:24,086 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:22:24,086 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:22:24,087 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:22:24,087 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:22:24,428 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:22:24,428 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:22:24,429 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:22:24,429 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:22:24,690 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:22:24,690 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:22:24,691 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:22:24,691 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:22:24,693 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:22:24,693 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:22:24,693 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:22:24,693 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:22:24,695 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:22:24,695 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:22:24,696 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:22:24,696 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:22:25,482 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:22:25,482 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:22:25,494 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:22:25,494 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:22:25,495 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:22:25,495 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:22:26,042 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:22:26,042 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:22:26,048 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:22:26,048 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:22:26,049 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:22:26,049 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:22:26,051 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:22:26,051 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:22:26,053 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:22:26,053 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:22:26,054 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:22:26,054 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:22:26,065 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:22:26,065 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:22:26,066 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:22:26,066 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:22:26,066 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:22:26,066 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:22:26,081 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:22:26,081 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:22:26,083 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:22:26,083 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:22:26,084 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:22:26,084 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:22:26,086 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:22:26,086 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:22:26,093 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:22:26,093 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:22:26,096 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:22:26,096 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:22:26,361 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:22:26,361 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:22:26,364 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:22:26,364 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:22:26,368 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:22:26,368 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:22:26,376 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:22:26,376 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:22:27,409 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:22:27,409 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:22:28,274 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:22:28,274 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:22:28,456 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:22:28,456 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:22:28,457 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:22:28,457 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:22:28,457 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:22:28,457 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:22:28,458 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:22:28,458 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:22:28,461 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:22:28,461 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:22:28,464 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:22:28,464 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:22:28,467 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:22:28,467 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:22:28,529 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:22:28,529 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:22:29,241 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:22:29,241 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:22:29,945 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:22:29,945 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:22:30,118 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:22:30,118 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:22:30,120 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:22:30,120 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:22:30,121 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:22:30,121 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:22:30,123 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:22:30,123 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:22:30,131 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:22:30,131 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:22:30,720 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:22:30,720 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:22:30,739 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:22:30,739 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:22:30,740 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:22:30,740 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:22:30,751 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:22:30,751 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:22:30,752 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:22:30,752 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:22:30,753 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:22:30,753 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:22:30,759 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:22:30,759 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:22:30,761 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:22:30,761 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:22:30,763 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:22:30,763 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:22:30,765 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:22:30,765 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:22:30,775 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:22:30,775 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:22:30,776 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:22:30,776 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:22:30,777 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:22:30,777 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:22:30,786 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:22:30,786 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:22:30,815 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:22:30,815 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:22:30,833 - __main__ - INFO - This is a new week. Appending new week and removing the oldest.
2025-09-02 12:22:30,833 - __main__ - INFO - This is a new week. Appending new week and removing the oldest.
2025-09-02 12:22:30,838 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:22:30,838 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:22:30,839 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:22:30,839 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:22:30,841 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:22:30,841 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:22:30,842 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:22:30,842 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:22:30,842 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:22:30,842 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:22:30,843 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:22:30,843 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:22:30,844 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:22:30,844 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:22:30,845 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:22:30,845 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:22:30,849 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:22:30,849 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:22:30,851 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:22:30,851 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:22:30,856 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:22:30,856 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:22:31,473 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:22:31,473 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:22:31,989 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:22:31,989 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:22:32,179 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:22:32,179 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:22:32,180 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:22:32,180 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:23:07,276 - root - INFO - Logging environment: LOCAL
2025-09-02 12:23:07,276 - root - INFO - Logging environment: LOCAL
2025-09-02 12:23:07,278 - root - INFO - Logging environment: LOCAL
2025-09-02 12:23:07,278 - root - INFO - Logging environment: LOCAL
2025-09-02 12:23:07,283 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:23:07,283 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:23:07,285 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:23:07,285 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:23:07,285 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:23:07,285 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:23:07,286 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:23:07,286 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:23:07,287 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:23:07,287 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:23:07,288 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:23:07,288 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:23:07,290 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:23:07,290 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:23:07,291 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:23:07,291 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:23:07,292 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:23:07,292 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:23:07,740 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:23:07,740 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:23:07,741 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:23:07,741 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:23:08,125 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:23:08,125 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:23:08,126 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:23:08,126 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:23:08,126 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:23:08,126 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:23:08,127 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:23:08,127 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:23:08,127 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:23:08,127 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:23:08,129 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:23:08,129 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:23:08,809 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:23:08,809 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:23:08,827 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:23:08,827 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:23:08,831 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:23:08,831 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:23:09,597 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:23:09,597 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:23:09,605 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:23:09,605 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:23:09,607 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:23:09,607 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:23:09,609 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:23:09,609 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:23:09,612 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:23:09,612 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:23:09,613 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:23:09,613 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:23:09,626 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:23:09,626 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:23:09,627 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:23:09,627 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:23:09,629 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:23:09,629 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:23:09,646 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:23:09,646 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:23:09,648 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:23:09,648 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:23:09,652 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:23:09,652 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:23:09,656 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:23:09,656 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:23:09,661 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:23:09,661 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:23:09,668 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:23:09,668 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:23:10,156 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:23:10,156 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:23:10,159 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:23:10,159 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:23:10,168 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:10,168 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:10,175 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:23:10,175 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:23:11,222 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:23:11,222 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:23:11,846 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:23:11,846 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:23:12,051 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:23:12,051 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:23:12,052 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:23:12,052 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:23:12,053 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:23:12,053 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:23:12,055 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:23:12,055 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:23:12,056 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:23:12,056 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:23:12,061 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:23:12,061 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:23:12,067 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:12,067 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:12,133 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:23:12,133 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:23:12,927 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:23:12,927 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:23:13,548 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:23:13,548 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:23:13,734 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:23:13,734 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:23:13,736 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:23:13,736 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:23:13,736 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:23:13,736 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:23:13,742 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:13,742 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:13,751 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:23:13,751 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:23:14,392 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:23:14,392 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:23:14,412 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:23:14,412 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:23:14,413 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:23:14,413 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:23:14,423 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:23:14,423 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:23:14,425 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:23:14,425 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:23:14,426 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:23:14,426 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:23:14,429 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:23:14,429 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:23:14,431 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:23:14,431 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:23:14,434 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:23:14,434 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:23:14,437 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:23:14,437 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:23:14,449 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:23:14,449 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:23:14,450 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:23:14,450 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:23:14,451 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:23:14,451 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:23:14,463 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:23:14,463 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:23:14,483 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:23:14,483 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:23:14,502 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:23:14,502 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:23:14,513 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:23:14,513 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:23:14,514 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:23:14,514 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:23:14,516 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:23:14,516 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:23:14,516 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:23:14,516 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:23:14,517 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:23:14,517 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:23:14,518 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:23:14,518 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:23:14,519 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:23:14,519 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:23:14,521 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:23:14,521 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:23:14,527 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:23:14,527 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:23:14,532 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:14,532 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:14,535 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:23:14,535 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:23:15,159 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:23:15,159 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:23:15,769 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:23:15,769 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:23:15,966 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:23:15,966 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:23:15,967 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:23:15,967 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:23:37,701 - root - INFO - Logging environment: LOCAL
2025-09-02 12:23:37,701 - root - INFO - Logging environment: LOCAL
2025-09-02 12:23:37,701 - root - INFO - Logging environment: LOCAL
2025-09-02 12:23:37,701 - root - INFO - Logging environment: LOCAL
2025-09-02 12:23:37,706 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:23:37,706 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:23:37,708 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:23:37,708 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:23:37,709 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:23:37,709 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:23:37,710 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:23:37,710 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:23:37,711 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:23:37,711 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:23:37,711 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:23:37,711 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:23:37,713 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:23:37,713 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:23:37,714 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:23:37,714 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:23:37,715 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:23:37,715 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:23:38,038 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:23:38,038 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:23:38,039 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:23:38,039 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:23:38,306 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:23:38,306 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:23:38,307 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:23:38,307 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:23:38,308 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:23:38,308 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:23:38,308 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:23:38,308 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:23:38,309 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:23:38,309 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:23:38,310 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:23:38,310 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:23:38,996 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:23:38,996 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:23:39,004 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:23:39,004 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:23:39,005 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:23:39,005 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:23:39,499 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:23:39,499 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:23:39,502 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:23:39,502 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:23:39,505 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:23:39,505 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:23:39,508 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:23:39,508 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:23:39,508 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:23:39,508 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:23:39,516 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:23:39,516 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:23:39,517 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:23:39,517 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:23:39,518 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:23:39,518 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:23:39,528 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:23:39,528 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:23:39,528 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:23:39,528 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:23:39,529 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:23:39,529 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:23:39,529 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:23:39,529 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:23:39,531 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:23:39,531 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:23:39,535 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:23:39,535 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:23:39,966 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:23:39,966 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:23:39,968 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:23:39,968 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:23:39,975 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:39,975 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:39,979 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:23:39,979 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:23:40,826 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:23:40,826 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:23:41,562 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:23:41,562 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:23:41,741 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:23:41,741 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:23:41,742 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:23:41,742 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:23:41,742 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:23:41,742 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:23:41,744 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:23:41,744 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:23:41,747 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:23:41,747 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:23:41,751 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:23:41,751 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:23:41,756 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:41,756 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:41,829 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:23:41,829 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:23:42,455 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:23:42,455 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:23:43,013 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:23:43,013 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:23:43,228 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:23:43,228 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:23:43,229 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:23:43,229 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:23:43,230 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:23:43,230 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:23:43,231 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:43,231 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:43,240 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:23:43,240 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:23:43,807 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:23:43,807 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:23:43,830 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:23:43,830 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:23:43,831 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:23:43,831 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:23:43,837 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:23:43,837 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:23:43,839 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:23:43,839 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:23:43,840 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:23:43,840 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:23:43,847 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:23:43,847 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:23:43,850 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:23:43,850 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:23:43,851 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:23:43,851 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:23:43,853 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:23:43,853 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:23:43,863 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:23:43,863 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:23:43,865 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:23:43,865 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:23:43,866 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:23:43,866 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:23:43,877 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:23:43,877 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:23:43,896 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:23:43,896 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:23:43,915 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:23:43,915 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:23:43,921 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:23:43,921 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:23:43,923 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:23:43,923 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:23:43,925 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:23:43,925 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:23:43,926 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:23:43,926 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:23:43,928 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:23:43,928 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:23:43,929 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:23:43,929 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:23:43,930 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:23:43,930 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:23:43,931 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:23:43,931 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:23:43,934 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:23:43,934 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:23:43,939 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:43,939 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:23:43,947 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:23:43,947 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:23:44,550 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:23:44,550 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:23:45,062 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:23:45,062 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:23:45,280 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:23:45,280 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:23:45,281 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:23:45,281 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:36:13,738 - root - INFO - Logging environment: LOCAL
2025-09-02 12:36:13,738 - root - INFO - Logging environment: LOCAL
2025-09-02 12:36:13,739 - root - INFO - Logging environment: LOCAL
2025-09-02 12:36:13,739 - root - INFO - Logging environment: LOCAL
2025-09-02 12:36:13,741 - shipstation_reporter - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:36:13,741 - shipstation_reporter - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:36:13,743 - shipstation_reporter - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:36:13,743 - shipstation_reporter - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:36:13,743 - shipstation_reporter - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:36:13,743 - shipstation_reporter - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:36:13,744 - shipstation_reporter - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:36:13,744 - shipstation_reporter - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:36:13,744 - shipstation_reporter - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:36:13,744 - shipstation_reporter - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:36:13,745 - shipstation_reporter - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:36:13,745 - shipstation_reporter - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:36:13,746 - shipstation_reporter - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:36:13,746 - shipstation_reporter - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:36:13,746 - shipstation_reporter - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:36:13,746 - shipstation_reporter - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:36:13,747 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:36:13,747 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:36:14,187 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:36:14,187 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:36:14,188 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:36:14,188 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:36:14,594 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:36:14,594 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:36:14,596 - shipstation_reporter - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:36:14,596 - shipstation_reporter - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:36:14,596 - shipstation_reporter - INFO - Environment: LOCAL
2025-09-02 12:36:14,596 - shipstation_reporter - INFO - Environment: LOCAL
2025-09-02 12:36:14,597 - shipstation_reporter - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:36:14,597 - shipstation_reporter - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:36:14,598 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:36:14,598 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:36:14,600 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:36:14,600 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:36:15,258 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:36:15,258 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:36:15,266 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:36:15,266 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:36:15,267 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:36:15,267 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:36:15,751 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:36:15,751 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:36:15,754 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:36:15,754 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:36:15,756 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:36:15,756 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:36:15,757 - shipstation_reporter - INFO - Processing 686 non-voided shipments.
2025-09-02 12:36:15,757 - shipstation_reporter - INFO - Processing 686 non-voided shipments.
2025-09-02 12:36:15,758 - shipstation_reporter - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:36:15,758 - shipstation_reporter - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:36:15,759 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:36:15,759 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:36:15,772 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:36:15,772 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:36:15,774 - shipstation_reporter - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:36:15,774 - shipstation_reporter - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:36:15,775 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:36:15,775 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:36:15,782 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:36:15,782 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:36:15,784 - shipstation_reporter - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:36:15,784 - shipstation_reporter - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:36:15,787 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:36:15,787 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:36:15,789 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:36:15,789 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:36:15,792 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:36:15,792 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:36:15,797 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:36:15,797 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:36:16,126 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:36:16,126 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:36:16,129 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:36:16,129 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:36:16,133 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:36:16,133 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:36:16,138 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:36:16,138 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:36:17,291 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:36:17,291 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:36:18,056 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:36:18,056 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:36:18,372 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:36:18,372 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:36:18,373 - shipstation_reporter - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:36:18,373 - shipstation_reporter - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:36:18,374 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:36:18,374 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:36:18,374 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:36:18,374 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:36:18,377 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:36:18,377 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:36:18,380 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:36:18,380 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:36:18,384 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:36:18,384 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:36:18,450 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:36:18,450 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:36:19,261 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:36:19,261 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:36:19,862 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:36:19,862 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:36:20,057 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:36:20,057 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:36:20,058 - shipstation_reporter - INFO - Fetching existing 52-week history for update...
2025-09-02 12:36:20,058 - shipstation_reporter - INFO - Fetching existing 52-week history for update...
2025-09-02 12:36:20,059 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:36:20,059 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:36:20,064 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:36:20,064 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:36:20,073 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:36:20,073 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:36:20,694 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:36:20,694 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:36:20,717 - shipstation_reporter - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:36:20,717 - shipstation_reporter - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:36:20,718 - shipstation_reporter - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:36:20,718 - shipstation_reporter - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:36:20,727 - shipstation_reporter - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:36:20,727 - shipstation_reporter - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:36:20,728 - shipstation_reporter - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:36:20,728 - shipstation_reporter - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:36:20,728 - shipstation_reporter - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:36:20,728 - shipstation_reporter - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:36:20,731 - shipstation_reporter - INFO - Current week starts on: 2025-09-01
2025-09-02 12:36:20,731 - shipstation_reporter - INFO - Current week starts on: 2025-09-01
2025-09-02 12:36:20,732 - shipstation_reporter - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:36:20,732 - shipstation_reporter - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:36:20,734 - shipstation_reporter - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:36:20,734 - shipstation_reporter - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:36:20,738 - shipstation_reporter - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:36:20,738 - shipstation_reporter - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:36:20,747 - shipstation_reporter - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:36:20,747 - shipstation_reporter - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:36:20,748 - shipstation_reporter - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:36:20,748 - shipstation_reporter - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:36:20,749 - shipstation_reporter - INFO - Current week starts on: 2025-09-01
2025-09-02 12:36:20,749 - shipstation_reporter - INFO - Current week starts on: 2025-09-01
2025-09-02 12:36:20,761 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:36:20,761 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:36:20,781 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:36:20,781 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:36:20,805 - shipstation_reporter - INFO - Current week found in history. Updating the last row.
2025-09-02 12:36:20,805 - shipstation_reporter - INFO - Current week found in history. Updating the last row.
2025-09-02 12:36:20,811 - shipstation_reporter - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:36:20,811 - shipstation_reporter - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:36:20,814 - shipstation_reporter - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:36:20,814 - shipstation_reporter - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:36:20,820 - shipstation_reporter - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:36:20,820 - shipstation_reporter - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:36:20,821 - shipstation_reporter - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:36:20,821 - shipstation_reporter - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:36:20,823 - shipstation_reporter - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:36:20,823 - shipstation_reporter - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:36:20,823 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:36:20,823 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:36:20,824 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:36:20,824 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:36:20,826 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:36:20,826 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:36:20,828 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:36:20,828 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:36:20,831 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:36:20,831 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:36:20,841 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:36:20,841 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:36:21,630 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:36:21,630 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:36:22,262 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:36:22,262 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:36:22,462 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:36:22,462 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:36:22,464 - shipstation_reporter - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:36:22,464 - shipstation_reporter - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:37:07,529 - root - INFO - Logging environment: LOCAL
2025-09-02 12:37:07,529 - root - INFO - Logging environment: LOCAL
2025-09-02 12:37:07,530 - root - INFO - Logging environment: LOCAL
2025-09-02 12:37:07,530 - root - INFO - Logging environment: LOCAL
2025-09-02 12:37:07,531 - shipstation_reporter - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:37:07,531 - shipstation_reporter - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:37:07,531 - shipstation_reporter - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:37:07,531 - shipstation_reporter - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:37:07,532 - shipstation_reporter - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:37:07,532 - shipstation_reporter - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:37:07,533 - shipstation_reporter - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:37:07,533 - shipstation_reporter - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:37:07,535 - shipstation_reporter - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:37:07,535 - shipstation_reporter - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:37:07,536 - shipstation_reporter - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:37:07,536 - shipstation_reporter - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:37:07,537 - shipstation_reporter - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:37:07,537 - shipstation_reporter - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:37:07,538 - shipstation_reporter - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:37:07,538 - shipstation_reporter - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:37:07,538 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:37:07,538 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:37:07,987 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:37:07,987 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:37:07,988 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:37:07,988 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:37:08,260 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:37:08,260 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:37:08,261 - shipstation_reporter - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:37:08,261 - shipstation_reporter - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:37:08,262 - shipstation_reporter - INFO - Environment: LOCAL
2025-09-02 12:37:08,262 - shipstation_reporter - INFO - Environment: LOCAL
2025-09-02 12:37:08,263 - shipstation_reporter - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:37:08,263 - shipstation_reporter - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:37:08,265 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:37:08,265 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:37:08,267 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:37:08,267 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:37:09,081 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:37:09,081 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:37:09,093 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:37:09,093 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:37:09,094 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:37:09,094 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:37:09,604 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:37:09,604 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:37:09,608 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:37:09,608 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:37:09,609 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:37:09,609 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:37:09,612 - shipstation_reporter - INFO - Processing 686 non-voided shipments.
2025-09-02 12:37:09,612 - shipstation_reporter - INFO - Processing 686 non-voided shipments.
2025-09-02 12:37:09,614 - shipstation_reporter - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:37:09,614 - shipstation_reporter - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:37:09,616 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:37:09,616 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:37:09,630 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:37:09,630 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:37:09,631 - shipstation_reporter - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:37:09,631 - shipstation_reporter - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:37:09,632 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:37:09,632 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:37:09,647 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:37:09,647 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:37:09,648 - shipstation_reporter - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:37:09,648 - shipstation_reporter - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:37:09,650 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:37:09,650 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:37:09,654 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:37:09,654 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:37:09,659 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:37:09,659 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:37:09,667 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:37:09,667 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:37:09,952 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:37:09,952 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:37:09,955 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:37:09,955 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:37:09,961 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:37:09,961 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:37:09,965 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:37:09,965 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:37:10,852 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:37:10,852 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:37:11,502 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:37:11,502 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:37:11,760 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:37:11,760 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:37:11,762 - shipstation_reporter - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:37:11,762 - shipstation_reporter - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:37:11,763 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:37:11,763 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:37:11,765 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:37:11,765 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:37:11,769 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:37:11,769 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:37:11,774 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:37:11,774 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:37:11,779 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:37:11,779 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:37:11,863 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:37:11,863 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:37:12,497 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:37:12,497 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:37:13,055 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:37:13,055 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:37:13,233 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:37:13,233 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:37:13,234 - shipstation_reporter - INFO - Fetching existing 52-week history for update...
2025-09-02 12:37:13,234 - shipstation_reporter - INFO - Fetching existing 52-week history for update...
2025-09-02 12:37:13,234 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:37:13,234 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:37:13,239 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:37:13,239 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:37:13,249 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:37:13,249 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:37:14,084 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:37:14,084 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:37:14,115 - shipstation_reporter - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:37:14,115 - shipstation_reporter - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:37:14,118 - shipstation_reporter - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:37:14,118 - shipstation_reporter - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:37:14,136 - shipstation_reporter - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:37:14,136 - shipstation_reporter - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:37:14,138 - shipstation_reporter - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:37:14,138 - shipstation_reporter - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:37:14,140 - shipstation_reporter - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:37:14,140 - shipstation_reporter - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:37:14,146 - shipstation_reporter - INFO - Current week starts on: 2025-09-01
2025-09-02 12:37:14,146 - shipstation_reporter - INFO - Current week starts on: 2025-09-01
2025-09-02 12:37:14,148 - shipstation_reporter - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:37:14,148 - shipstation_reporter - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:37:14,150 - shipstation_reporter - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:37:14,150 - shipstation_reporter - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:37:14,156 - shipstation_reporter - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:37:14,156 - shipstation_reporter - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:37:14,165 - shipstation_reporter - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:37:14,165 - shipstation_reporter - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:37:14,168 - shipstation_reporter - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:37:14,168 - shipstation_reporter - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:37:14,169 - shipstation_reporter - INFO - Current week starts on: 2025-09-01
2025-09-02 12:37:14,169 - shipstation_reporter - INFO - Current week starts on: 2025-09-01
2025-09-02 12:37:14,182 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:37:14,182 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:37:14,210 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:37:14,210 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:37:14,230 - shipstation_reporter - INFO - Current week found in history. Updating the last row.
2025-09-02 12:37:14,230 - shipstation_reporter - INFO - Current week found in history. Updating the last row.
2025-09-02 12:37:14,238 - shipstation_reporter - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:37:14,238 - shipstation_reporter - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:37:14,240 - shipstation_reporter - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:37:14,240 - shipstation_reporter - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:37:14,242 - shipstation_reporter - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:37:14,242 - shipstation_reporter - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:37:14,243 - shipstation_reporter - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:37:14,243 - shipstation_reporter - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:37:14,245 - shipstation_reporter - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:37:14,245 - shipstation_reporter - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:37:14,246 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:37:14,246 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:37:14,247 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:37:14,247 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:37:14,250 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:37:14,250 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:37:14,255 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:37:14,255 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:37:14,260 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:37:14,260 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:37:14,264 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:37:14,264 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:37:14,891 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:37:14,891 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:37:15,431 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:37:15,431 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:37:15,630 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:37:15,630 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:37:15,630 - shipstation_reporter - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:37:15,630 - shipstation_reporter - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:41:27,389 - root - INFO - Logging environment: LOCAL
2025-09-02 12:41:27,389 - root - INFO - Logging environment: LOCAL
2025-09-02 12:41:27,391 - root - INFO - Logging environment: LOCAL
2025-09-02 12:41:27,391 - root - INFO - Logging environment: LOCAL
2025-09-02 12:41:27,393 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:41:27,393 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:41:27,396 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:41:27,396 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:41:27,397 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:41:27,397 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:41:27,399 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:41:27,399 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:41:27,401 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:41:27,401 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:41:27,402 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:41:27,402 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:41:27,404 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:41:27,404 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:41:27,406 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:41:27,406 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:41:27,408 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:41:27,408 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:41:27,842 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:41:27,842 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:41:27,843 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:41:27,843 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:41:28,103 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:41:28,103 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:41:28,104 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:41:28,104 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:41:28,105 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:41:28,105 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:41:28,106 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:41:28,106 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:41:28,107 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:41:28,107 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:41:28,108 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:41:28,108 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:41:28,925 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:41:28,925 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:41:28,932 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:41:28,932 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:41:28,934 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:41:28,934 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:41:29,411 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:41:29,411 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:41:29,415 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:41:29,415 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:41:29,416 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:41:29,416 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:41:29,419 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:41:29,419 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:41:29,420 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:41:29,420 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:41:29,421 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:41:29,421 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:41:29,430 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:41:29,430 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:41:29,431 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:41:29,431 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:41:29,431 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:41:29,431 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:41:29,440 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:41:29,440 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:41:29,441 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:41:29,441 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:41:29,442 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:41:29,442 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:41:29,444 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:41:29,444 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:41:29,447 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:41:29,447 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:41:29,452 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:41:29,452 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:41:29,803 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:41:29,803 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:41:29,806 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:41:29,806 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:41:29,812 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:41:29,812 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:41:29,818 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:41:29,818 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:41:31,054 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:41:31,054 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:41:31,652 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:41:31,652 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:41:31,839 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:41:31,839 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:41:31,842 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:41:31,842 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:41:31,843 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:41:31,843 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:41:31,845 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:41:31,845 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:41:31,846 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:41:31,846 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:41:31,849 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:41:31,849 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:41:31,853 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:41:31,853 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:41:31,920 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:41:31,920 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:41:32,578 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:41:32,578 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:41:33,200 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:41:33,200 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:41:33,377 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:41:33,377 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:41:33,378 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:41:33,378 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:41:33,379 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:41:33,379 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:41:33,384 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:41:33,384 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:41:33,391 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:41:33,391 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:41:33,929 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:41:33,929 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:41:33,948 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:41:33,948 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:41:33,949 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:41:33,949 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:41:33,955 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:41:33,955 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:41:33,957 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:41:33,957 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:41:33,959 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:41:33,959 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:41:33,961 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:41:33,961 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:41:33,963 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:41:33,963 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:41:33,966 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:41:33,966 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:41:33,968 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:41:33,968 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:41:33,978 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:41:33,978 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:41:33,979 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:41:33,979 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:41:33,980 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:41:33,980 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:41:33,994 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:41:33,994 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:41:34,012 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:41:34,012 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:41:34,029 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:41:34,029 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:41:34,036 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:41:34,036 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:41:34,037 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:41:34,037 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:41:34,038 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:41:34,038 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:41:34,040 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:41:34,040 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:41:34,041 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:41:34,041 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:41:34,042 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:41:34,042 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:41:34,043 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:41:34,043 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:41:34,044 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:41:34,044 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:41:34,046 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:41:34,046 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:41:34,051 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:41:34,051 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:41:34,055 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:41:34,055 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:41:34,606 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:41:34,606 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:41:35,139 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:41:35,139 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:41:35,374 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:41:35,374 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:41:35,375 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:41:35,375 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:47:47,338 - root - INFO - Logging environment: LOCAL
2025-09-02 12:47:47,338 - root - INFO - Logging environment: LOCAL
2025-09-02 12:47:47,339 - root - INFO - Logging environment: LOCAL
2025-09-02 12:47:47,339 - root - INFO - Logging environment: LOCAL
2025-09-02 12:47:47,340 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:47:47,340 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:47:47,341 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:47:47,341 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:47:47,341 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:47:47,341 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:47:47,344 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:47:47,344 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:47:47,345 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:47:47,345 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:47:47,346 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:47:47,346 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:47:47,347 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:47:47,347 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:47:47,348 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:47:47,348 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:47:47,349 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:47:47,349 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:47:47,755 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:47:47,755 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:47:47,756 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:47:47,756 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:47:48,030 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:47:48,030 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:47:48,031 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:47:48,031 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:47:48,033 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:47:48,033 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:47:48,034 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:47:48,034 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:47:48,034 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:47:48,034 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:47:48,035 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:47:48,035 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:47:48,788 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:47:48,788 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:47:48,796 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:47:48,796 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:47:48,797 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:47:48,797 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:47:49,318 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:47:49,318 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:47:49,325 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:47:49,325 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:47:49,326 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:47:49,326 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:47:49,328 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:47:49,328 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:47:49,330 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:47:49,330 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:47:49,331 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:47:49,331 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:47:49,369 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:47:49,369 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:47:49,371 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:47:49,371 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:47:49,371 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:47:49,371 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:47:49,388 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:47:49,388 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:47:49,389 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:47:49,389 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:47:49,390 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:47:49,390 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:47:49,391 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:47:49,391 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:47:49,395 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:47:49,395 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:47:49,403 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:47:49,403 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:47:49,736 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:47:49,736 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:47:49,740 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:47:49,740 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:47:49,748 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:47:49,748 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:47:49,754 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:47:49,754 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:47:50,945 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:47:50,945 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:47:51,896 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:47:51,896 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:47:52,091 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:47:52,091 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:47:52,093 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:47:52,093 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:47:52,095 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:47:52,095 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:47:52,096 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:47:52,096 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:47:52,098 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:47:52,098 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:47:52,102 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:47:52,102 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:47:52,107 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:47:52,107 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:47:52,168 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:47:52,168 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:47:53,148 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:47:53,148 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:47:54,018 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:47:54,018 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:47:54,236 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:47:54,236 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:47:54,238 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:47:54,238 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:47:54,238 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:47:54,238 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:47:54,241 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:47:54,241 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:47:54,252 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:47:54,252 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:47:54,930 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:47:54,930 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:47:54,961 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:47:54,961 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:47:54,963 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:47:54,963 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:47:54,977 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:47:54,977 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:47:54,980 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:47:54,980 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:47:54,982 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:47:54,982 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:47:54,996 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:47:54,996 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:47:54,998 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:47:54,998 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:47:55,001 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:47:55,001 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:47:55,003 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:47:55,003 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:47:55,014 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:47:55,014 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:47:55,016 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:47:55,016 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:47:55,018 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:47:55,018 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:47:55,038 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:47:55,038 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:47:55,091 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:47:55,091 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:47:55,120 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:47:55,120 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:47:55,135 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:47:55,135 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:47:55,137 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:47:55,137 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:47:55,138 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:47:55,138 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:47:55,140 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:47:55,140 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:47:55,141 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:47:55,141 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:47:55,143 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:47:55,143 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:47:55,144 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:47:55,144 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:47:55,148 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:47:55,148 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:47:55,152 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:47:55,152 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:47:55,156 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:47:55,156 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:47:55,160 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:47:55,160 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:47:55,888 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:47:55,888 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:47:56,414 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:47:56,414 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:47:56,601 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:47:56,601 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:47:56,603 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:47:56,603 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:52:33,657 - root - INFO - Logging environment: LOCAL
2025-09-02 12:52:33,657 - root - INFO - Logging environment: LOCAL
2025-09-02 12:52:33,658 - root - INFO - Logging environment: LOCAL
2025-09-02 12:52:33,658 - root - INFO - Logging environment: LOCAL
2025-09-02 12:52:33,659 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:52:33,659 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:52:33,661 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:52:33,661 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:52:33,661 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:52:33,661 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:52:33,664 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:52:33,664 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:52:33,665 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:52:33,665 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:52:33,666 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:52:33,666 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:52:33,667 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:52:33,667 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:52:33,667 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:52:33,667 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:52:33,669 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:52:33,669 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:52:34,107 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:52:34,107 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:52:34,108 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:52:34,108 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:52:34,387 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:52:34,387 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:52:34,388 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:52:34,388 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:52:34,390 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:52:34,390 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:52:34,392 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:52:34,392 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:52:34,394 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:52:34,394 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:52:34,396 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:52:34,396 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:52:35,067 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:52:35,067 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:52:35,076 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:52:35,076 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:52:35,077 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:52:35,077 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:52:35,577 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:52:35,577 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:52:35,584 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:52:35,584 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:52:35,585 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:52:35,585 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:52:35,587 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:52:35,587 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:52:35,589 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:52:35,589 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:52:35,590 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:52:35,590 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:52:35,600 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:52:35,600 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:52:35,601 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:52:35,601 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:52:35,603 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:52:35,603 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:52:35,612 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:52:35,612 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:52:35,614 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:52:35,614 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:52:35,615 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:52:35,615 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:52:35,618 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:52:35,618 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:52:35,622 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:52:35,622 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:52:35,626 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:52:35,626 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:52:35,933 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:52:35,933 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:52:35,935 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:52:35,935 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:52:35,940 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:52:35,940 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:52:35,944 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:52:35,944 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:52:36,948 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:52:36,948 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:52:37,523 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:52:37,523 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:52:37,722 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:52:37,722 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:52:37,723 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:52:37,723 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:52:37,724 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:52:37,724 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:52:37,725 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:52:37,725 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:52:37,727 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:52:37,727 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:52:37,730 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:52:37,730 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:52:37,735 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:52:37,735 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:52:37,802 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:52:37,802 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:52:38,486 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:52:38,486 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:52:39,051 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:52:39,051 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:52:39,253 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:52:39,253 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:52:39,254 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:52:39,254 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:52:39,254 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:52:39,254 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:52:39,257 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:52:39,257 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:52:39,272 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:52:39,272 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:52:40,102 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:52:40,102 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:52:40,141 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:52:40,141 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:52:40,142 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:52:40,142 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:52:40,166 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:52:40,166 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:52:40,175 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:52:40,175 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:52:40,177 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:52:40,177 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:52:40,190 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:52:40,190 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:52:40,194 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:52:40,194 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:52:40,209 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:52:40,209 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:52:40,225 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:52:40,225 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:52:40,255 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:52:40,255 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:52:40,260 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:52:40,260 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:52:40,263 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:52:40,263 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:52:40,298 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:52:40,298 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:52:40,336 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:52:40,336 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:52:40,374 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:52:40,374 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:52:40,392 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:52:40,392 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:52:40,393 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:52:40,393 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:52:40,398 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:52:40,398 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:52:40,402 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:52:40,402 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:52:40,404 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:52:40,404 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:52:40,408 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:52:40,408 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:52:40,411 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:52:40,411 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:52:40,420 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:52:40,420 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:52:40,426 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:52:40,426 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:52:40,441 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:52:40,441 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:52:40,453 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:52:40,453 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:52:41,265 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:52:41,265 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:52:41,821 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:52:41,821 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:52:42,020 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:52:42,020 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:52:42,022 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:52:42,022 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:53:07,827 - root - INFO - Logging environment: LOCAL
2025-09-02 12:53:07,827 - root - INFO - Logging environment: LOCAL
2025-09-02 12:53:07,829 - root - INFO - Logging environment: LOCAL
2025-09-02 12:53:07,829 - root - INFO - Logging environment: LOCAL
2025-09-02 12:53:07,834 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:53:07,834 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:53:07,835 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:53:07,835 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:53:07,836 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:53:07,836 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:53:07,838 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:53:07,838 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:53:07,840 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:53:07,840 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:53:07,843 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:53:07,843 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:53:07,844 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:53:07,844 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:53:07,845 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:53:07,845 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:53:07,845 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:53:07,845 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:53:08,201 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:53:08,201 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:53:08,203 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:53:08,203 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:53:08,466 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:53:08,466 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:53:08,468 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:53:08,468 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:53:08,470 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:53:08,470 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:53:08,472 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:53:08,472 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:53:08,473 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:53:08,473 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:53:08,474 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:53:08,474 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:53:09,209 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:53:09,209 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:53:09,226 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:53:09,226 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:53:09,228 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:53:09,228 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:53:09,860 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:53:09,860 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:53:09,864 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:53:09,864 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:53:09,866 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:53:09,866 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:53:09,867 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:53:09,867 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:53:09,868 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:53:09,868 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:53:09,869 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:53:09,869 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:53:09,878 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:53:09,878 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:53:09,879 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:53:09,879 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:53:09,881 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:53:09,881 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:53:09,891 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:53:09,891 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:53:09,892 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:53:09,892 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:53:09,894 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:53:09,894 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:53:09,896 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:53:09,896 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:53:09,903 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:53:09,903 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:53:09,908 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:53:09,908 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:53:10,412 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:53:10,412 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:53:10,415 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:53:10,415 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:53:10,421 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:53:10,421 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:53:10,424 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:53:10,424 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:53:11,388 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:53:11,388 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:53:11,951 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:53:11,951 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:53:12,149 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:53:12,149 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:53:12,150 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:53:12,150 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:53:12,151 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:53:12,151 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:53:12,152 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:53:12,152 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:53:12,154 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:53:12,154 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:53:12,158 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:53:12,158 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:53:12,166 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:53:12,166 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:53:12,231 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:53:12,231 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:53:12,917 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:53:12,917 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:53:13,477 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:53:13,477 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:53:13,681 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:53:13,681 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:53:13,683 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:53:13,683 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:53:13,685 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:53:13,685 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:53:13,688 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:53:13,688 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:53:13,696 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:53:13,696 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:53:14,325 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:53:14,325 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:53:14,348 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:53:14,348 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:53:14,351 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:53:14,351 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:53:14,361 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:53:14,361 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:53:14,363 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:53:14,363 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:53:14,367 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:53:14,367 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:53:14,371 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:53:14,371 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:53:14,374 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:53:14,374 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:53:14,376 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:53:14,376 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:53:14,377 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:53:14,377 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:53:14,389 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:53:14,389 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:53:14,391 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:53:14,391 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:53:14,392 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:53:14,392 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:53:14,407 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:53:14,407 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:53:14,426 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:53:14,426 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:53:14,446 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:53:14,446 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:53:14,454 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:53:14,454 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:53:14,455 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:53:14,455 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:53:14,456 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:53:14,456 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:53:14,456 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:53:14,456 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:53:14,458 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:53:14,458 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:53:14,460 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:53:14,460 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:53:14,463 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:53:14,463 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:53:14,467 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:53:14,467 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:53:14,470 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:53:14,470 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:53:14,474 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:53:14,474 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:53:14,480 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:53:14,480 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:53:15,144 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:53:15,144 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:53:15,720 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:53:15,720 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:53:15,908 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:53:15,908 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:53:15,909 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:53:15,909 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:56:56,245 - root - INFO - Logging environment: LOCAL
2025-09-02 12:56:56,245 - root - INFO - Logging environment: LOCAL
2025-09-02 12:56:56,246 - root - INFO - Logging environment: LOCAL
2025-09-02 12:56:56,246 - root - INFO - Logging environment: LOCAL
2025-09-02 12:56:56,248 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:56:56,248 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:56:56,250 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:56:56,250 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 12:56:56,251 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:56:56,251 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 12:56:56,252 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:56:56,252 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 12:56:56,253 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:56:56,253 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 12:56:56,254 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:56:56,254 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 12:56:56,255 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:56:56,255 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 12:56:56,255 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:56:56,255 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 12:56:56,256 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:56:56,256 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 12:56:56,594 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:56:56,594 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 12:56:56,595 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:56:56,595 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 12:56:56,831 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:56:56,831 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 12:56:56,832 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:56:56,832 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 12:56:56,832 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:56:56,832 - __main__ - INFO - Environment: LOCAL
2025-09-02 12:56:56,834 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:56:56,834 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 12:56:56,836 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:56:56,836 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 12:56:56,837 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:56:56,837 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:56:57,500 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:56:57,500 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:56:57,507 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:56:57,507 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 12:56:57,508 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:56:57,508 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 12:56:58,025 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:56:58,025 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 12:56:58,028 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:56:58,028 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 12:56:58,029 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:56:58,029 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 12:56:58,030 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:56:58,030 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 12:56:58,031 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:56:58,031 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 12:56:58,032 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:56:58,032 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 12:56:58,041 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:56:58,041 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 12:56:58,043 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:56:58,043 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 12:56:58,043 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:56:58,043 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 12:56:58,054 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:56:58,054 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 12:56:58,055 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:56:58,055 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 12:56:58,056 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:56:58,056 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:56:58,057 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:56:58,057 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 12:56:58,060 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:56:58,060 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 12:56:58,066 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:56:58,066 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 12:56:58,406 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:56:58,406 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 12:56:58,409 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:56:58,409 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 12:56:58,415 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:56:58,415 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:56:58,419 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:56:58,419 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 12:56:59,469 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:56:59,469 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 12:57:00,228 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:57:00,228 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:57:00,425 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:57:00,425 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 12:57:00,426 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:57:00,426 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 12:57:00,428 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:57:00,428 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:57:00,430 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:57:00,430 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 12:57:00,431 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:57:00,431 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 12:57:00,433 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:57:00,433 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:57:00,435 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:57:00,435 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:57:00,489 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:57:00,489 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 12:57:01,074 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:57:01,074 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 12:57:01,664 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:57:01,664 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:57:01,827 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:57:01,827 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 12:57:01,828 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:57:01,828 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 12:57:01,830 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:57:01,830 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:57:01,833 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:57:01,833 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:57:01,841 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:57:01,841 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 12:57:02,280 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:57:02,280 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 12:57:02,304 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:57:02,304 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 12:57:02,305 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:57:02,305 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:57:02,312 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:57:02,312 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:57:02,315 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:57:02,315 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:57:02,318 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:57:02,318 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 12:57:02,322 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:57:02,322 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:57:02,324 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:57:02,324 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 12:57:02,325 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:57:02,325 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 12:57:02,327 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:57:02,327 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 12:57:02,337 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:57:02,337 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 12:57:02,338 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:57:02,338 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 12:57:02,339 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:57:02,339 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 12:57:02,350 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:57:02,350 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 12:57:02,370 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:57:02,370 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 12:57:02,389 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:57:02,389 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 12:57:02,397 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:57:02,397 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 12:57:02,398 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:57:02,398 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 12:57:02,400 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:57:02,400 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 12:57:02,401 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:57:02,401 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 12:57:02,401 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:57:02,401 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 12:57:02,402 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:57:02,402 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 12:57:02,403 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:57:02,403 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 12:57:02,405 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:57:02,405 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 12:57:02,407 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:57:02,407 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 12:57:02,411 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:57:02,411 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 12:57:02,415 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:57:02,415 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 12:57:02,982 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:57:02,982 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 12:57:03,515 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:57:03,515 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:57:03,720 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:57:03,720 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 12:57:03,720 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 12:57:03,720 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 13:00:48,116 - root - INFO - Logging environment: LOCAL
2025-09-02 13:00:48,116 - root - INFO - Logging environment: LOCAL
2025-09-02 13:00:48,117 - root - INFO - Logging environment: LOCAL
2025-09-02 13:00:48,117 - root - INFO - Logging environment: LOCAL
2025-09-02 13:00:48,119 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 13:00:48,119 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 13:00:48,120 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 13:00:48,120 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 13:00:48,122 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 13:00:48,122 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 13:00:48,123 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 13:00:48,123 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 13:00:48,124 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 13:00:48,124 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 13:00:48,125 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 13:00:48,125 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 13:00:48,127 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 13:00:48,127 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 13:00:48,128 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 13:00:48,128 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 13:00:48,129 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 13:00:48,129 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 13:00:48,474 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 13:00:48,474 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 13:00:48,475 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 13:00:48,475 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 13:00:48,784 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 13:00:48,784 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 13:00:48,785 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 13:00:48,785 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 13:00:48,785 - __main__ - INFO - Environment: LOCAL
2025-09-02 13:00:48,785 - __main__ - INFO - Environment: LOCAL
2025-09-02 13:00:48,787 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 13:00:48,787 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 13:00:48,788 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 13:00:48,788 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 13:00:48,788 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 13:00:48,788 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 13:00:49,474 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 13:00:49,474 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 13:00:49,484 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 13:00:49,484 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 13:00:49,485 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 13:00:49,485 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 13:00:49,981 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 13:00:49,981 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 13:00:49,986 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 13:00:49,986 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 13:00:49,988 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 13:00:49,988 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 13:00:49,990 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 13:00:49,990 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 13:00:49,991 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 13:00:49,991 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 13:00:49,991 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 13:00:49,991 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 13:00:50,001 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 13:00:50,001 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 13:00:50,002 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 13:00:50,002 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 13:00:50,003 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 13:00:50,003 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 13:00:50,010 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 13:00:50,010 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 13:00:50,011 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 13:00:50,011 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 13:00:50,013 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 13:00:50,013 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 13:00:50,015 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 13:00:50,015 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 13:00:50,019 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 13:00:50,019 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 13:00:50,025 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 13:00:50,025 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 13:00:50,311 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 13:00:50,311 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 13:00:50,313 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 13:00:50,313 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 13:00:50,317 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:00:50,317 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:00:50,320 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 13:00:50,320 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 13:00:51,409 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 13:00:51,409 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 13:00:52,022 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 13:00:52,022 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 13:00:52,221 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 13:00:52,221 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 13:00:52,222 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 13:00:52,222 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 13:00:52,223 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 13:00:52,223 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 13:00:52,224 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 13:00:52,224 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 13:00:52,225 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 13:00:52,225 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 13:00:52,228 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 13:00:52,228 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 13:00:52,233 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:00:52,233 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:00:52,288 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 13:00:52,288 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 13:00:52,892 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 13:00:52,892 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 13:00:53,390 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 13:00:53,390 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 13:00:53,557 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 13:00:53,557 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 13:00:53,558 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 13:00:53,558 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 13:00:53,558 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 13:00:53,558 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 13:00:53,563 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:00:53,563 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:00:53,568 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 13:00:53,568 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 13:00:54,084 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 13:00:54,084 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 13:00:54,103 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
666  2025-09-02  17612 - 250216                 1    17612
667  2025-09-02  17904 - 240276                 1    17904
668  2025-09-02  17612 - 250216                20    17612
669  2025-09-02  17612 - 250216                 1    17612
670  2025-09-02  17612 - 250216                 2    17612
671  2025-09-02  17612 - 250216                 6    17612
672  2025-09-02  17612 - 250216                 1    17612
673  2025-09-02  17612 - 250216                15    17612
674  2025-09-02  17612 - 250216                15    17612
675  2025-09-02  17612 - 250216                 1    17612
676  2025-09-02   18795 - 11001                 3    18795
677  2025-09-02  17612 - 250216                 3    17612
678  2025-09-02  17612 - 250216                 6    17612
679  2025-09-02  17612 - 250216                 1    17612
680  2025-09-02  17612 - 250216                 6    17612
681  2025-09-02  17612 - 250216                 3    17612
682  2025-09-02  17612 - 250216                 3    17612
683  2025-09-02  17914 - 240286                 1    17914
684  2025-09-02   18795 - 11001                 2    18795
685  2025-09-02  17612 - 250216                 1    17612
2025-09-02 13:00:54,103 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
666  2025-09-02  17612 - 250216                 1    17612
667  2025-09-02  17904 - 240276                 1    17904
668  2025-09-02  17612 - 250216                20    17612
669  2025-09-02  17612 - 250216                 1    17612
670  2025-09-02  17612 - 250216                 2    17612
671  2025-09-02  17612 - 250216                 6    17612
672  2025-09-02  17612 - 250216                 1    17612
673  2025-09-02  17612 - 250216                15    17612
674  2025-09-02  17612 - 250216                15    17612
675  2025-09-02  17612 - 250216                 1    17612
676  2025-09-02   18795 - 11001                 3    18795
677  2025-09-02  17612 - 250216                 3    17612
678  2025-09-02  17612 - 250216                 6    17612
679  2025-09-02  17612 - 250216                 1    17612
680  2025-09-02  17612 - 250216                 6    17612
681  2025-09-02  17612 - 250216                 3    17612
682  2025-09-02  17612 - 250216                 3    17612
683  2025-09-02  17914 - 240286                 1    17914
684  2025-09-02   18795 - 11001                 2    18795
685  2025-09-02  17612 - 250216                 1    17612
2025-09-02 13:00:54,104 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 13:00:54,104 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 13:00:54,109 - __main__ - INFO - current_week_items_df head:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
666  2025-09-02  17612 - 250216                 1    17612
667  2025-09-02  17904 - 240276                 1    17904
668  2025-09-02  17612 - 250216                20    17612
669  2025-09-02  17612 - 250216                 1    17612
670  2025-09-02  17612 - 250216                 2    17612
671  2025-09-02  17612 - 250216                 6    17612
672  2025-09-02  17612 - 250216                 1    17612
673  2025-09-02  17612 - 250216                15    17612
674  2025-09-02  17612 - 250216                15    17612
675  2025-09-02  17612 - 250216                 1    17612
2025-09-02 13:00:54,109 - __main__ - INFO - current_week_items_df head:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
666  2025-09-02  17612 - 250216                 1    17612
667  2025-09-02  17904 - 240276                 1    17904
668  2025-09-02  17612 - 250216                20    17612
669  2025-09-02  17612 - 250216                 1    17612
670  2025-09-02  17612 - 250216                 2    17612
671  2025-09-02  17612 - 250216                 6    17612
672  2025-09-02  17612 - 250216                 1    17612
673  2025-09-02  17612 - 250216                15    17612
674  2025-09-02  17612 - 250216                15    17612
675  2025-09-02  17612 - 250216                 1    17612
2025-09-02 13:00:54,112 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 13:00:54,112 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 13:00:54,113 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 13:00:54,113 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 13:00:54,116 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 13:00:54,116 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 13:00:54,118 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 13:00:54,118 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 13:00:54,120 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 13:00:54,120 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 13:00:54,122 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 13:00:54,122 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 13:00:54,126 - __main__ - INFO - current_week_items_df head:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
666  2025-09-02  17612 - 250216                 1    17612
667  2025-09-02  17904 - 240276                 1    17904
668  2025-09-02  17612 - 250216                20    17612
669  2025-09-02  17612 - 250216                 1    17612
670  2025-09-02  17612 - 250216                 2    17612
671  2025-09-02  17612 - 250216                 6    17612
672  2025-09-02  17612 - 250216                 1    17612
673  2025-09-02  17612 - 250216                15    17612
674  2025-09-02  17612 - 250216                15    17612
675  2025-09-02  17612 - 250216                 1    17612
2025-09-02 13:00:54,126 - __main__ - INFO - current_week_items_df head:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
666  2025-09-02  17612 - 250216                 1    17612
667  2025-09-02  17904 - 240276                 1    17904
668  2025-09-02  17612 - 250216                20    17612
669  2025-09-02  17612 - 250216                 1    17612
670  2025-09-02  17612 - 250216                 2    17612
671  2025-09-02  17612 - 250216                 6    17612
672  2025-09-02  17612 - 250216                 1    17612
673  2025-09-02  17612 - 250216                15    17612
674  2025-09-02  17612 - 250216                15    17612
675  2025-09-02  17612 - 250216                 1    17612
2025-09-02 13:00:54,127 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 13:00:54,127 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 13:00:54,127 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 13:00:54,127 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 13:00:54,140 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 13:00:54,140 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 13:00:54,160 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 13:00:54,160 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 13:00:54,178 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 13:00:54,178 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 13:00:54,186 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 13:00:54,186 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 13:00:54,188 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 13:00:54,188 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 13:00:54,191 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 13:00:54,191 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 13:00:54,192 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 13:00:54,192 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 13:00:54,193 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 13:00:54,193 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 13:00:54,194 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 13:00:54,194 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 13:00:54,195 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 13:00:54,195 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 13:00:54,197 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 13:00:54,197 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 13:00:54,201 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 13:00:54,201 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 13:00:54,207 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:00:54,207 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:00:54,211 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 13:00:54,211 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 13:00:54,786 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 13:00:54,786 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 13:00:55,323 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 13:00:55,323 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 13:00:55,501 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 13:00:55,501 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 13:00:55,503 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 13:00:55,503 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 13:13:44,929 - root - INFO - Logging environment: LOCAL
2025-09-02 13:13:44,929 - root - INFO - Logging environment: LOCAL
2025-09-02 13:13:44,930 - root - INFO - Logging environment: LOCAL
2025-09-02 13:13:44,930 - root - INFO - Logging environment: LOCAL
2025-09-02 13:13:44,933 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 13:13:44,933 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 13:13:44,934 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 13:13:44,934 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 13:13:44,934 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 13:13:44,934 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 13:13:44,936 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 13:13:44,936 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 13:13:44,938 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 13:13:44,938 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 13:13:44,939 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 13:13:44,939 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 13:13:44,942 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 13:13:44,942 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 13:13:44,958 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 13:13:44,958 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 13:13:44,965 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 13:13:44,965 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Key from Secret Manager...
2025-09-02 13:13:45,460 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 13:13:45,460 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 13:13:45,461 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 13:13:45,461 - src.services.shipstation.api_client - INFO - Attempting to retrieve ShipStation API Secret from Secret Manager...
2025-09-02 13:13:45,827 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 13:13:45,827 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 13:13:45,827 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 13:13:45,827 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 13:13:45,829 - __main__ - INFO - Environment: LOCAL
2025-09-02 13:13:45,829 - __main__ - INFO - Environment: LOCAL
2025-09-02 13:13:45,831 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 13:13:45,831 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 13:13:45,831 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 13:13:45,831 - src.services.shipstation.api_client - INFO - Starting raw shipment fetch from 2025-08-01 with includeShipmentItems=true and status='shipped'...
2025-09-02 13:13:45,832 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 13:13:45,832 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 13:13:46,586 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 13:13:46,586 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 13:13:46,597 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 13:13:46,597 - src.services.shipstation.api_client - INFO - Fetched page 1 of 2. Total shipments so far: 500
2025-09-02 13:13:46,599 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 13:13:46,599 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 13:13:47,135 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 13:13:47,135 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 13:13:47,138 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 13:13:47,138 - src.services.shipstation.api_client - INFO - Fetched page 2 of 2. Total shipments so far: 688
2025-09-02 13:13:47,139 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 13:13:47,139 - src.services.shipstation.api_client - INFO - Finished fetching ShipStation shipments. Total retrieved: 688
2025-09-02 13:13:47,140 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 13:13:47,140 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 13:13:47,141 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 13:13:47,141 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 13:13:47,144 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 13:13:47,144 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 13:13:47,157 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 13:13:47,157 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 13:13:47,158 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 13:13:47,158 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 13:13:47,160 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 13:13:47,160 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 13:13:47,173 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 13:13:47,173 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 13:13:47,175 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 13:13:47,175 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 13:13:47,177 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 13:13:47,177 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 13:13:47,179 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 13:13:47,179 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 13:13:47,183 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 13:13:47,183 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 13:13:47,189 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 13:13:47,189 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 13:13:47,588 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 13:13:47,588 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 13:13:47,590 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 13:13:47,590 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 13:13:47,596 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:13:47,596 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:13:47,602 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 13:13:47,602 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 13:13:48,803 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 13:13:48,803 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 13:13:49,718 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 13:13:49,718 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 13:13:49,980 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 13:13:49,980 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 13:13:49,981 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 13:13:49,981 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 13:13:49,981 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 13:13:49,981 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 13:13:49,983 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 13:13:49,983 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 13:13:49,985 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 13:13:49,985 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 13:13:49,988 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 13:13:49,988 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 13:13:49,991 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:13:49,991 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:13:50,053 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 13:13:50,053 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 13:13:50,774 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 13:13:50,774 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 13:13:51,496 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 13:13:51,496 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 13:13:51,784 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 13:13:51,784 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 13:13:51,785 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 13:13:51,785 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 13:13:51,787 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 13:13:51,787 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 13:13:51,793 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:13:51,793 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:13:51,812 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 13:13:51,812 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 13:13:52,513 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 13:13:52,513 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 13:13:52,539 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 13:13:52,539 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 13:13:52,541 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 13:13:52,541 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 13:13:52,552 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 13:13:52,552 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 13:13:52,554 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 13:13:52,554 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 13:13:52,558 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 13:13:52,558 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 13:13:52,564 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 13:13:52,564 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 13:13:52,565 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 13:13:52,565 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 13:13:52,569 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 13:13:52,569 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 13:13:52,572 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 13:13:52,572 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 13:13:52,584 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 13:13:52,584 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 13:13:52,586 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 13:13:52,586 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 13:13:52,587 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 13:13:52,587 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 13:13:52,606 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 13:13:52,606 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 13:13:52,647 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 13:13:52,647 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 13:13:52,671 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 13:13:52,671 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 13:13:52,684 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 13:13:52,684 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 13:13:52,685 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 13:13:52,685 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 13:13:52,687 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 13:13:52,687 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 13:13:52,688 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 13:13:52,688 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 13:13:52,689 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 13:13:52,689 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 13:13:52,690 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 13:13:52,690 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 13:13:52,693 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 13:13:52,693 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 13:13:52,696 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 13:13:52,696 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 13:13:52,702 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 13:13:52,702 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 13:13:52,707 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:13:52,707 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 13:13:52,714 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 13:13:52,714 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 13:13:53,361 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 13:13:53,361 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 13:13:53,917 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 13:13:53,917 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 13:13:54,104 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 13:13:54,104 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 13:13:54,105 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 13:13:54,105 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 14:13:47,223 - root - INFO - Logging environment: LOCAL
2025-09-02 14:13:47,223 - root - INFO - Logging environment: LOCAL
2025-09-02 14:13:47,224 - root - INFO - Logging environment: LOCAL
2025-09-02 14:13:47,224 - root - INFO - Logging environment: LOCAL
2025-09-02 14:13:47,225 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 14:13:47,225 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 14:13:47,227 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 14:13:47,227 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 14:13:47,228 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 14:13:47,228 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 14:13:47,230 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 14:13:47,230 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 14:13:47,232 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 14:13:47,232 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 14:13:47,234 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 14:13:47,234 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 14:13:47,234 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 14:13:47,234 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 14:13:47,235 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 14:13:47,235 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 14:13:47,600 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 14:13:47,600 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 14:13:47,895 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 14:13:47,895 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 14:13:47,896 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 14:13:47,896 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 14:13:47,897 - __main__ - INFO - Environment: LOCAL
2025-09-02 14:13:47,897 - __main__ - INFO - Environment: LOCAL
2025-09-02 14:13:47,897 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 14:13:47,897 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 14:13:47,898 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 14:13:47,898 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 14:13:49,156 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 14:13:49,156 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 14:13:49,173 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 14:13:49,173 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 14:13:49,720 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 14:13:49,720 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 14:13:49,724 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 14:13:49,724 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 14:13:49,725 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 14:13:49,725 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 14:13:49,725 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 14:13:49,725 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 14:13:49,734 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 14:13:49,734 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 14:13:49,735 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 14:13:49,735 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 14:13:49,736 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 14:13:49,736 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 14:13:49,749 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 14:13:49,749 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 14:13:49,750 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 14:13:49,750 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 14:13:49,751 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 14:13:49,751 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 14:13:49,753 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 14:13:49,753 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 14:13:49,756 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 14:13:49,756 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 14:13:49,763 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 14:13:49,763 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 14:13:50,154 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 14:13:50,154 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 14:13:50,156 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 14:13:50,156 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 14:13:50,163 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 14:13:50,163 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 14:13:50,169 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 14:13:50,169 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 14:13:51,529 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 14:13:51,529 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 14:13:52,183 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 14:13:52,183 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 14:13:52,430 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 14:13:52,430 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 14:13:52,431 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 14:13:52,431 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 14:13:52,433 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 14:13:52,433 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 14:13:52,434 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 14:13:52,434 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 14:13:52,435 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 14:13:52,435 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 14:13:52,437 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 14:13:52,437 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 14:13:52,440 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 14:13:52,440 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 14:13:52,501 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 14:13:52,501 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 14:13:53,208 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 14:13:53,208 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 14:13:53,826 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 14:13:53,826 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 14:13:54,017 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 14:13:54,017 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 14:13:54,018 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 14:13:54,018 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 14:13:54,019 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 14:13:54,019 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 14:13:54,023 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 14:13:54,023 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 14:13:54,035 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 14:13:54,035 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 14:13:54,804 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 14:13:54,804 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 14:13:54,836 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 14:13:54,836 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 14:13:54,838 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 14:13:54,838 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 14:13:54,852 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 14:13:54,852 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 14:13:54,855 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 14:13:54,855 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 14:13:54,857 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 14:13:54,857 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 14:13:54,863 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 14:13:54,863 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 14:13:54,866 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 14:13:54,866 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 14:13:54,868 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 14:13:54,868 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 14:13:54,872 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 14:13:54,872 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 14:13:54,885 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 14:13:54,885 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 14:13:54,887 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 14:13:54,887 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 14:13:54,890 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 14:13:54,890 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 14:13:54,909 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 14:13:54,909 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 14:13:54,983 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 14:13:54,983 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 14:13:55,003 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 14:13:55,003 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 14:13:55,013 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 14:13:55,013 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 14:13:55,015 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 14:13:55,015 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 14:13:55,018 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 14:13:55,018 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 14:13:55,021 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 14:13:55,021 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 14:13:55,034 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 14:13:55,034 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 14:13:55,043 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 14:13:55,043 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 14:13:55,051 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 14:13:55,051 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 14:13:55,057 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 14:13:55,057 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 14:13:55,072 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 14:13:55,072 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 14:13:55,115 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 14:13:55,115 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 14:13:55,124 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 14:13:55,124 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 14:13:55,886 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 14:13:55,886 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 14:13:56,501 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 14:13:56,501 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 14:13:56,730 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 14:13:56,730 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 14:13:56,731 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 14:13:56,731 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 15:57:14,944 - root - INFO - Logging environment: LOCAL
2025-09-02 15:57:14,944 - root - INFO - Logging environment: LOCAL
2025-09-02 15:57:14,945 - root - INFO - Logging environment: LOCAL
2025-09-02 15:57:14,945 - root - INFO - Logging environment: LOCAL
2025-09-02 15:57:14,946 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 15:57:14,946 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 15:57:14,947 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 15:57:14,947 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 15:57:14,948 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 15:57:14,948 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 15:57:14,948 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 15:57:14,948 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 15:57:14,949 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 15:57:14,949 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 15:57:14,950 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 15:57:14,950 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 15:57:14,951 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 15:57:14,951 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 15:57:14,952 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 15:57:14,952 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 15:57:15,355 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 15:57:15,355 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 15:57:15,684 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 15:57:15,684 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 15:57:15,685 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 15:57:15,685 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 15:57:15,686 - __main__ - INFO - Environment: LOCAL
2025-09-02 15:57:15,686 - __main__ - INFO - Environment: LOCAL
2025-09-02 15:57:15,686 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 15:57:15,686 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 15:57:15,687 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 15:57:15,687 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 15:57:16,440 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 15:57:16,440 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 15:57:16,449 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 15:57:16,449 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 15:57:16,998 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 15:57:16,998 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 15:57:17,002 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 15:57:17,002 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 15:57:17,002 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 15:57:17,002 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 15:57:17,004 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 15:57:17,004 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 15:57:17,017 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 15:57:17,017 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 15:57:17,018 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 15:57:17,018 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 15:57:17,018 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 15:57:17,018 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 15:57:17,033 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 15:57:17,033 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 15:57:17,033 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 15:57:17,033 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 15:57:17,034 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 15:57:17,034 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 15:57:17,035 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 15:57:17,035 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 15:57:17,041 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 15:57:17,041 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 15:57:17,045 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 15:57:17,045 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 15:57:17,377 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 15:57:17,377 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 15:57:17,379 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 15:57:17,379 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 15:57:17,385 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 15:57:17,385 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 15:57:17,392 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 15:57:17,392 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 15:57:18,481 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 15:57:18,481 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 15:57:19,148 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 15:57:19,148 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 15:57:19,317 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 15:57:19,317 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 15:57:19,318 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 15:57:19,318 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 15:57:19,320 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 15:57:19,320 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 15:57:19,322 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 15:57:19,322 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 15:57:19,322 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 15:57:19,322 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 15:57:19,328 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 15:57:19,328 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 15:57:19,331 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 15:57:19,331 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 15:57:19,408 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 15:57:19,408 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 15:57:20,012 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 15:57:20,012 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 15:57:20,548 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 15:57:20,548 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 15:57:20,723 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 15:57:20,723 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 15:57:20,724 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 15:57:20,724 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 15:57:20,725 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 15:57:20,725 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 15:57:20,727 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 15:57:20,727 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 15:57:20,738 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 15:57:20,738 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 15:57:21,264 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 15:57:21,264 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 15:57:21,291 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 15:57:21,291 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 15:57:21,294 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 15:57:21,294 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 15:57:21,300 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 15:57:21,300 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 15:57:21,300 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 15:57:21,300 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 15:57:21,302 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 15:57:21,302 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 15:57:21,304 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 15:57:21,304 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 15:57:21,306 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 15:57:21,306 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 15:57:21,309 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 15:57:21,309 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 15:57:21,313 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 15:57:21,313 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 15:57:21,319 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 15:57:21,319 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 15:57:21,320 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 15:57:21,320 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 15:57:21,322 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 15:57:21,322 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 15:57:21,330 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 15:57:21,330 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 15:57:21,352 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 15:57:21,352 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 15:57:21,368 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 15:57:21,368 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 15:57:21,378 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 15:57:21,378 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 15:57:21,380 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 15:57:21,380 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 15:57:21,382 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 15:57:21,382 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 15:57:21,382 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 15:57:21,382 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 15:57:21,382 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 15:57:21,382 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 15:57:21,384 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 15:57:21,384 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 15:57:21,385 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 15:57:21,385 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 15:57:21,386 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 15:57:21,386 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 15:57:21,389 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 15:57:21,389 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 15:57:21,393 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 15:57:21,393 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 15:57:21,397 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 15:57:21,397 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 15:57:21,944 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 15:57:21,944 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 15:57:22,561 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 15:57:22,561 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 15:57:22,729 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 15:57:22,729 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 15:57:22,730 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 15:57:22,730 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 16:00:59,622 - root - INFO - Logging environment: LOCAL
2025-09-02 16:00:59,622 - root - INFO - Logging environment: LOCAL
2025-09-02 16:00:59,625 - root - INFO - Logging environment: LOCAL
2025-09-02 16:00:59,625 - root - INFO - Logging environment: LOCAL
2025-09-02 16:00:59,628 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:00:59,628 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:00:59,630 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 16:00:59,630 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 16:00:59,632 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 16:00:59,632 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 16:00:59,633 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 16:00:59,633 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 16:00:59,633 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 16:00:59,633 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 16:00:59,634 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 16:00:59,634 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 16:00:59,635 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 16:00:59,635 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 16:00:59,636 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 16:00:59,636 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 16:00:59,948 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 16:00:59,948 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 16:01:00,197 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 16:01:00,197 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 16:01:00,199 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 16:01:00,199 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 16:01:00,200 - __main__ - INFO - Environment: LOCAL
2025-09-02 16:01:00,200 - __main__ - INFO - Environment: LOCAL
2025-09-02 16:01:00,201 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:01:00,201 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:01:00,202 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:01:00,202 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:01:01,140 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:01:01,140 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:01:01,153 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:01:01,153 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:01:01,718 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:01:01,718 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:01:01,724 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 16:01:01,724 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 16:01:01,726 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 16:01:01,726 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 16:01:01,726 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 16:01:01,726 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 16:01:01,738 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 16:01:01,738 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 16:01:01,748 - __main__ - INFO - [DEBUG] items_df shape: (686, 4)
2025-09-02 16:01:01,748 - __main__ - INFO - [DEBUG] items_df shape: (686, 4)
2025-09-02 16:01:01,756 - __main__ - INFO - [DEBUG] items_df head:
    Ship Date       SKU - Lot  Quantity Shipped Base SKU
0  2025-08-01  17914 - 240286                 1    17914
1  2025-08-01  17612 - 250195                 2    17612
2  2025-08-01  17612 - 250195                 6    17612
3  2025-08-01  17612 - 250195                 6    17612
4  2025-08-01  17612 - 250195                 6    17612
5  2025-08-01  17612 - 250195                 1    17612
6  2025-08-01  17612 - 250195                 6    17612
7  2025-08-01  17612 - 250195                 2    17612
8  2025-08-01  17612 - 250195                 1    17612
9  2025-08-01  17612 - 250195                 1    17612
2025-09-02 16:01:01,756 - __main__ - INFO - [DEBUG] items_df head:
    Ship Date       SKU - Lot  Quantity Shipped Base SKU
0  2025-08-01  17914 - 240286                 1    17914
1  2025-08-01  17612 - 250195                 2    17612
2  2025-08-01  17612 - 250195                 6    17612
3  2025-08-01  17612 - 250195                 6    17612
4  2025-08-01  17612 - 250195                 6    17612
5  2025-08-01  17612 - 250195                 1    17612
6  2025-08-01  17612 - 250195                 6    17612
7  2025-08-01  17612 - 250195                 2    17612
8  2025-08-01  17612 - 250195                 1    17612
9  2025-08-01  17612 - 250195                 1    17612
2025-09-02 16:01:01,757 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 16:01:01,757 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 16:01:01,758 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 16:01:01,758 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 16:01:01,767 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 16:01:01,767 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 16:01:01,778 - __main__ - INFO - [DEBUG] orders_df shape: (624, 2)
2025-09-02 16:01:01,778 - __main__ - INFO - [DEBUG] orders_df shape: (624, 2)
2025-09-02 16:01:01,786 - __main__ - INFO - [DEBUG] orders_df head:
     Ship Date OrderNumber
0   2025-08-01      673665
17  2025-08-01      673615
16  2025-08-01      673645
15  2025-08-01      673675
14  2025-08-01      673625
13  2025-08-01      673655
12  2025-08-01      673685
10  2025-08-01      673635
11  2025-08-01      673745
8   2025-08-01      673755
2025-09-02 16:01:01,786 - __main__ - INFO - [DEBUG] orders_df head:
     Ship Date OrderNumber
0   2025-08-01      673665
17  2025-08-01      673615
16  2025-08-01      673645
15  2025-08-01      673675
14  2025-08-01      673625
13  2025-08-01      673655
12  2025-08-01      673685
10  2025-08-01      673635
11  2025-08-01      673745
8   2025-08-01      673755
2025-09-02 16:01:01,788 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 16:01:01,788 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 16:01:01,789 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:01:01,789 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:01:01,792 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 16:01:01,792 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 16:01:01,796 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 16:01:01,796 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 16:01:01,804 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 16:01:01,804 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 16:01:02,294 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 16:01:02,294 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 16:01:02,296 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 16:01:02,296 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 16:01:02,300 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:01:02,300 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:01:02,305 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 16:01:02,305 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 16:01:03,296 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 16:01:03,296 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 16:01:03,881 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:01:03,881 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:01:04,106 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:01:04,106 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:01:04,109 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 16:01:04,109 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 16:01:04,110 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:01:04,110 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:01:04,113 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 16:01:04,113 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 16:01:04,114 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 16:01:04,114 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 16:01:04,117 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:01:04,117 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:01:04,122 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:01:04,122 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:01:04,126 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 16:01:04,126 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 16:01:04,738 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 16:01:04,738 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 16:01:05,256 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:01:05,256 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:01:05,429 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:01:05,429 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:01:05,430 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 16:01:05,430 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 16:01:05,431 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:01:05,431 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:01:05,434 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:01:05,434 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:01:05,446 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 16:01:05,446 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 16:01:06,012 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 16:01:06,012 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 16:01:06,028 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 16:01:06,028 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 16:01:06,029 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:01:06,029 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:01:06,037 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:01:06,037 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:01:06,038 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:01:06,038 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:01:06,039 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 16:01:06,039 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 16:01:06,041 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:01:06,041 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:01:06,043 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 16:01:06,043 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 16:01:06,044 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 16:01:06,044 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 16:01:06,045 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:01:06,045 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:01:06,054 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:01:06,054 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:01:06,056 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:01:06,056 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:01:06,057 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:01:06,057 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:01:06,064 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 16:01:06,064 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 16:01:06,081 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 16:01:06,081 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 16:01:06,102 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 16:01:06,102 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 16:01:06,114 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 16:01:06,114 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 16:01:06,116 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 16:01:06,116 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 16:01:06,118 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 16:01:06,118 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 16:01:06,119 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 16:01:06,119 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 16:01:06,120 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 16:01:06,120 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 16:01:06,123 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:01:06,123 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:01:06,126 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 16:01:06,126 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 16:01:06,128 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 16:01:06,128 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 16:01:06,130 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:01:06,130 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:01:06,135 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:01:06,135 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:01:06,166 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 16:01:06,166 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 16:01:06,798 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 16:01:06,798 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 16:01:07,314 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:01:07,314 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:01:07,501 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:01:07,501 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:01:07,502 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 16:01:07,502 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 16:04:16,637 - root - INFO - Logging environment: LOCAL
2025-09-02 16:04:16,637 - root - INFO - Logging environment: LOCAL
2025-09-02 16:04:16,638 - root - INFO - Logging environment: LOCAL
2025-09-02 16:04:16,638 - root - INFO - Logging environment: LOCAL
2025-09-02 16:04:16,642 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:04:16,642 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:04:16,644 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 16:04:16,644 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 16:04:16,646 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 16:04:16,646 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 16:04:16,647 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 16:04:16,647 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 16:04:16,647 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 16:04:16,647 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 16:04:16,648 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 16:04:16,648 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 16:04:16,648 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 16:04:16,648 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 16:04:16,649 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 16:04:16,649 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 16:04:17,034 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 16:04:17,034 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 16:04:17,330 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 16:04:17,330 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 16:04:17,330 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 16:04:17,330 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 16:04:17,332 - __main__ - INFO - Environment: LOCAL
2025-09-02 16:04:17,332 - __main__ - INFO - Environment: LOCAL
2025-09-02 16:04:17,332 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:04:17,332 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:04:17,333 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:04:17,333 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:04:18,045 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:04:18,045 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:04:18,056 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:04:18,056 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:04:18,570 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:04:18,570 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:04:18,579 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 16:04:18,579 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 16:04:18,580 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 16:04:18,580 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 16:04:18,581 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 16:04:18,581 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 16:04:18,595 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 16:04:18,595 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 16:04:18,610 - __main__ - INFO - [DEBUG] items_df shape: (686, 4)
2025-09-02 16:04:18,610 - __main__ - INFO - [DEBUG] items_df shape: (686, 4)
2025-09-02 16:04:18,616 - __main__ - INFO - [DEBUG] items_df head:
    Ship Date       SKU - Lot  Quantity Shipped Base SKU
0  2025-08-01  17914 - 240286                 1    17914
1  2025-08-01  17612 - 250195                 2    17612
2  2025-08-01  17612 - 250195                 6    17612
3  2025-08-01  17612 - 250195                 6    17612
4  2025-08-01  17612 - 250195                 6    17612
5  2025-08-01  17612 - 250195                 1    17612
6  2025-08-01  17612 - 250195                 6    17612
7  2025-08-01  17612 - 250195                 2    17612
8  2025-08-01  17612 - 250195                 1    17612
9  2025-08-01  17612 - 250195                 1    17612
2025-09-02 16:04:18,616 - __main__ - INFO - [DEBUG] items_df head:
    Ship Date       SKU - Lot  Quantity Shipped Base SKU
0  2025-08-01  17914 - 240286                 1    17914
1  2025-08-01  17612 - 250195                 2    17612
2  2025-08-01  17612 - 250195                 6    17612
3  2025-08-01  17612 - 250195                 6    17612
4  2025-08-01  17612 - 250195                 6    17612
5  2025-08-01  17612 - 250195                 1    17612
6  2025-08-01  17612 - 250195                 6    17612
7  2025-08-01  17612 - 250195                 2    17612
8  2025-08-01  17612 - 250195                 1    17612
9  2025-08-01  17612 - 250195                 1    17612
2025-09-02 16:04:18,618 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 16:04:18,618 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 16:04:18,620 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 16:04:18,620 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 16:04:18,633 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 16:04:18,633 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 16:04:18,646 - __main__ - INFO - [DEBUG] orders_df shape: (624, 2)
2025-09-02 16:04:18,646 - __main__ - INFO - [DEBUG] orders_df shape: (624, 2)
2025-09-02 16:04:18,652 - __main__ - INFO - [DEBUG] orders_df head:
     Ship Date OrderNumber
0   2025-08-01      673665
17  2025-08-01      673615
16  2025-08-01      673645
15  2025-08-01      673675
14  2025-08-01      673625
13  2025-08-01      673655
12  2025-08-01      673685
10  2025-08-01      673635
11  2025-08-01      673745
8   2025-08-01      673755
2025-09-02 16:04:18,652 - __main__ - INFO - [DEBUG] orders_df head:
     Ship Date OrderNumber
0   2025-08-01      673665
17  2025-08-01      673615
16  2025-08-01      673645
15  2025-08-01      673675
14  2025-08-01      673625
13  2025-08-01      673655
12  2025-08-01      673685
10  2025-08-01      673635
11  2025-08-01      673745
8   2025-08-01      673755
2025-09-02 16:04:18,654 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 16:04:18,654 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 16:04:18,657 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 16:04:18,657 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 16:04:18,660 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 16:04:18,660 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 16:04:18,670 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 16:04:18,670 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 16:04:19,067 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 16:04:19,067 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 16:04:19,075 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 16:04:19,075 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 16:04:19,087 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:19,087 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:19,096 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 16:04:19,096 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 16:04:21,197 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 16:04:21,197 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 16:04:21,907 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:04:21,907 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:04:22,174 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:04:22,174 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:04:22,179 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 16:04:22,179 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 16:04:22,180 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 16:04:22,180 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 16:04:22,182 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 16:04:22,182 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 16:04:22,187 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:04:22,187 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:04:22,194 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:22,194 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:22,201 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 16:04:22,201 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 16:04:22,836 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 16:04:22,836 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 16:04:23,390 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:04:23,390 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:04:23,571 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:04:23,571 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:04:23,574 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 16:04:23,574 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 16:04:23,575 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:04:23,575 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:04:23,578 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:23,578 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:23,585 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 16:04:23,585 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 16:04:24,456 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 16:04:24,456 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 16:04:24,489 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 16:04:24,489 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 16:04:24,492 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:04:24,492 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:04:24,512 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:04:24,512 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:04:24,515 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:04:24,515 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:04:24,518 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 16:04:24,518 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 16:04:24,528 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:04:24,528 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:04:24,533 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 16:04:24,533 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 16:04:24,536 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 16:04:24,536 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 16:04:24,539 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:04:24,539 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:04:24,559 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:04:24,559 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:04:24,561 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:04:24,561 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:04:24,562 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:04:24,562 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:04:24,590 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 16:04:24,590 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 16:04:24,628 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 16:04:24,628 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 16:04:24,672 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 16:04:24,672 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 16:04:24,681 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 16:04:24,681 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 16:04:24,683 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 16:04:24,683 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 16:04:24,686 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 16:04:24,686 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 16:04:24,688 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 16:04:24,688 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 16:04:24,692 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 16:04:24,692 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 16:04:24,695 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:04:24,695 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:04:24,699 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 16:04:24,699 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 16:04:24,705 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 16:04:24,705 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 16:04:24,719 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:04:24,719 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:04:24,736 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:24,736 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:24,782 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 16:04:24,782 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 16:04:25,646 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 16:04:25,646 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 16:04:26,260 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:04:26,260 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:04:26,479 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:04:26,479 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:04:26,480 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 16:04:26,480 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 16:04:42,794 - root - INFO - Logging environment: LOCAL
2025-09-02 16:04:42,794 - root - INFO - Logging environment: LOCAL
2025-09-02 16:04:42,796 - root - INFO - Logging environment: LOCAL
2025-09-02 16:04:42,796 - root - INFO - Logging environment: LOCAL
2025-09-02 16:04:42,798 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:04:42,798 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:04:42,798 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 16:04:42,798 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 16:04:42,799 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 16:04:42,799 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 16:04:42,800 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 16:04:42,800 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 16:04:42,800 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 16:04:42,800 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 16:04:42,801 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 16:04:42,801 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 16:04:42,802 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 16:04:42,802 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 16:04:42,807 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 16:04:42,807 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 16:04:43,171 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 16:04:43,171 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 16:04:43,544 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 16:04:43,544 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 16:04:43,544 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 16:04:43,544 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 16:04:43,546 - __main__ - INFO - Environment: LOCAL
2025-09-02 16:04:43,546 - __main__ - INFO - Environment: LOCAL
2025-09-02 16:04:43,547 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:04:43,547 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:04:43,549 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:04:43,549 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:04:44,218 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:04:44,218 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:04:44,229 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:04:44,229 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:04:44,746 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:04:44,746 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:04:44,753 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 16:04:44,753 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 16:04:44,754 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 16:04:44,754 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 16:04:44,756 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 16:04:44,756 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 16:04:44,764 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 16:04:44,764 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 16:04:44,776 - __main__ - INFO - [DEBUG] items_df shape: (686, 4)
2025-09-02 16:04:44,776 - __main__ - INFO - [DEBUG] items_df shape: (686, 4)
2025-09-02 16:04:44,783 - __main__ - INFO - [DEBUG] items_df head:
    Ship Date       SKU - Lot  Quantity Shipped Base SKU
0  2025-08-01  17914 - 240286                 1    17914
1  2025-08-01  17612 - 250195                 2    17612
2  2025-08-01  17612 - 250195                 6    17612
3  2025-08-01  17612 - 250195                 6    17612
4  2025-08-01  17612 - 250195                 6    17612
5  2025-08-01  17612 - 250195                 1    17612
6  2025-08-01  17612 - 250195                 6    17612
7  2025-08-01  17612 - 250195                 2    17612
8  2025-08-01  17612 - 250195                 1    17612
9  2025-08-01  17612 - 250195                 1    17612
2025-09-02 16:04:44,783 - __main__ - INFO - [DEBUG] items_df head:
    Ship Date       SKU - Lot  Quantity Shipped Base SKU
0  2025-08-01  17914 - 240286                 1    17914
1  2025-08-01  17612 - 250195                 2    17612
2  2025-08-01  17612 - 250195                 6    17612
3  2025-08-01  17612 - 250195                 6    17612
4  2025-08-01  17612 - 250195                 6    17612
5  2025-08-01  17612 - 250195                 1    17612
6  2025-08-01  17612 - 250195                 6    17612
7  2025-08-01  17612 - 250195                 2    17612
8  2025-08-01  17612 - 250195                 1    17612
9  2025-08-01  17612 - 250195                 1    17612
2025-09-02 16:04:44,784 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 16:04:44,784 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 16:04:44,785 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 16:04:44,785 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 16:04:44,795 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 16:04:44,795 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 16:04:44,800 - __main__ - INFO - [DEBUG] orders_df shape: (624, 2)
2025-09-02 16:04:44,800 - __main__ - INFO - [DEBUG] orders_df shape: (624, 2)
2025-09-02 16:04:44,805 - __main__ - INFO - [DEBUG] orders_df head:
     Ship Date OrderNumber
0   2025-08-01      673665
17  2025-08-01      673615
16  2025-08-01      673645
15  2025-08-01      673675
14  2025-08-01      673625
13  2025-08-01      673655
12  2025-08-01      673685
10  2025-08-01      673635
11  2025-08-01      673745
8   2025-08-01      673755
2025-09-02 16:04:44,805 - __main__ - INFO - [DEBUG] orders_df head:
     Ship Date OrderNumber
0   2025-08-01      673665
17  2025-08-01      673615
16  2025-08-01      673645
15  2025-08-01      673675
14  2025-08-01      673625
13  2025-08-01      673655
12  2025-08-01      673685
10  2025-08-01      673635
11  2025-08-01      673745
8   2025-08-01      673755
2025-09-02 16:04:44,806 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 16:04:44,806 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 16:04:44,808 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 16:04:44,808 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 16:04:44,810 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 16:04:44,810 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 16:04:44,816 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 16:04:44,816 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 16:04:45,089 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 16:04:45,089 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 16:04:45,092 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 16:04:45,092 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 16:04:45,097 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:45,097 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:45,100 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 16:04:45,100 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 16:04:45,971 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 16:04:45,971 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 16:04:46,712 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:04:46,712 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:04:46,952 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:04:46,952 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:04:46,953 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 16:04:46,953 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 16:04:46,955 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 16:04:46,955 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 16:04:46,958 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 16:04:46,958 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 16:04:46,962 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:04:46,962 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:04:46,966 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:46,966 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:46,971 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 16:04:46,971 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 16:04:47,556 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 16:04:47,556 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 16:04:48,118 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:04:48,118 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:04:48,370 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:04:48,370 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:04:48,373 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 16:04:48,373 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 16:04:48,376 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:04:48,376 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:04:48,385 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:48,385 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:48,415 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 16:04:48,415 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 16:04:49,327 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 16:04:49,327 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 16:04:49,384 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 16:04:49,384 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 16:04:49,391 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:04:49,391 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:04:49,416 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:04:49,416 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:04:49,417 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:04:49,417 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:04:49,418 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 16:04:49,418 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 16:04:49,428 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:04:49,428 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:04:49,431 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 16:04:49,431 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 16:04:49,433 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 16:04:49,433 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 16:04:49,436 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:04:49,436 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:04:49,449 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:04:49,449 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:04:49,452 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:04:49,452 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:04:49,454 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:04:49,454 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:04:49,479 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 16:04:49,479 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 16:04:49,516 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 16:04:49,516 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 16:04:49,561 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 16:04:49,561 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 16:04:49,577 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 16:04:49,577 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 16:04:49,578 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 16:04:49,578 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 16:04:49,581 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 16:04:49,581 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 16:04:49,583 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 16:04:49,583 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 16:04:49,585 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 16:04:49,585 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 16:04:49,589 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:04:49,589 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:04:49,592 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 16:04:49,592 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 16:04:49,594 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 16:04:49,594 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 16:04:49,600 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:04:49,600 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:04:49,612 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:49,612 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:04:49,660 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 16:04:49,660 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 16:04:50,504 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 16:04:50,504 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 16:04:51,178 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:04:51,178 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:04:51,388 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:04:51,388 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:04:51,392 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 16:04:51,392 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 16:05:05,844 - root - INFO - Logging environment: LOCAL
2025-09-02 16:05:05,844 - root - INFO - Logging environment: LOCAL
2025-09-02 16:05:05,846 - root - INFO - Logging environment: LOCAL
2025-09-02 16:05:05,846 - root - INFO - Logging environment: LOCAL
2025-09-02 16:05:05,848 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:05:05,848 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:05:05,850 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 16:05:05,850 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 16:05:05,852 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 16:05:05,852 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 16:05:05,853 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 16:05:05,853 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 16:05:05,854 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 16:05:05,854 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 16:05:05,857 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 16:05:05,857 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 16:05:05,860 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 16:05:05,860 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 16:05:05,861 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 16:05:05,861 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 16:05:06,166 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 16:05:06,166 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 16:05:06,398 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 16:05:06,398 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 16:05:06,399 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 16:05:06,399 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 16:05:06,400 - __main__ - INFO - Environment: LOCAL
2025-09-02 16:05:06,400 - __main__ - INFO - Environment: LOCAL
2025-09-02 16:05:06,401 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:05:06,401 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:05:06,402 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:05:06,402 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:05:07,080 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:05:07,080 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:05:07,094 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:05:07,094 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:05:07,627 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:05:07,627 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:05:07,633 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 16:05:07,633 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 16:05:07,634 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 16:05:07,634 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 16:05:07,635 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 16:05:07,635 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 16:05:07,644 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 16:05:07,644 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 16:05:07,645 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 16:05:07,645 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 16:05:07,646 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 16:05:07,646 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 16:05:07,658 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 16:05:07,658 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 16:05:07,659 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 16:05:07,659 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 16:05:07,660 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:05:07,660 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:05:07,660 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 16:05:07,660 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 16:05:07,665 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 16:05:07,665 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 16:05:07,670 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 16:05:07,670 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 16:05:07,907 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 16:05:07,907 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 16:05:07,911 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 16:05:07,911 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 16:05:07,919 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:05:07,919 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:05:07,927 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 16:05:07,927 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 16:05:08,659 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 16:05:08,659 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 16:05:09,284 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:05:09,284 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:05:09,487 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:05:09,487 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:05:09,488 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 16:05:09,488 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 16:05:09,490 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:05:09,490 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:05:09,492 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 16:05:09,492 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 16:05:09,495 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 16:05:09,495 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 16:05:09,500 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:05:09,500 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:05:09,512 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:05:09,512 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:05:09,588 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 16:05:09,588 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 16:05:10,487 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 16:05:10,487 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 16:05:11,063 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:05:11,063 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:05:11,286 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:05:11,286 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:05:11,287 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 16:05:11,287 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 16:05:11,288 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:05:11,288 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:05:11,296 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:05:11,296 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:05:11,318 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 16:05:11,318 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 16:05:12,434 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 16:05:12,434 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 16:05:12,477 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 16:05:12,477 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 16:05:12,478 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:05:12,478 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:05:12,490 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:05:12,490 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:05:12,497 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:05:12,497 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:05:12,499 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 16:05:12,499 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 16:05:12,505 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:05:12,505 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:05:12,508 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 16:05:12,508 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 16:05:12,510 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 16:05:12,510 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 16:05:12,515 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:05:12,515 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:05:12,535 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:05:12,535 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:05:12,537 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:05:12,537 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:05:12,542 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:05:12,542 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:05:12,568 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 16:05:12,568 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 16:05:12,598 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 16:05:12,598 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 16:05:12,628 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 16:05:12,628 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 16:05:12,645 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 16:05:12,645 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 16:05:12,646 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 16:05:12,646 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 16:05:12,649 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 16:05:12,649 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 16:05:12,650 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 16:05:12,650 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 16:05:12,651 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 16:05:12,651 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 16:05:12,654 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:05:12,654 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:05:12,659 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 16:05:12,659 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 16:05:12,662 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 16:05:12,662 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 16:05:12,666 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:05:12,666 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:05:12,677 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:05:12,677 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:05:12,687 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 16:05:12,687 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 16:05:13,604 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 16:05:13,604 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 16:05:14,448 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:05:14,448 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:05:14,655 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:05:14,655 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:05:14,657 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 16:05:14,657 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 16:06:58,517 - root - INFO - Logging environment: LOCAL
2025-09-02 16:06:58,517 - root - INFO - Logging environment: LOCAL
2025-09-02 16:06:58,518 - root - INFO - Logging environment: LOCAL
2025-09-02 16:06:58,518 - root - INFO - Logging environment: LOCAL
2025-09-02 16:06:58,523 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:06:58,523 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:06:58,524 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 16:06:58,524 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 16:06:58,526 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 16:06:58,526 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 16:06:58,527 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 16:06:58,527 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 16:06:58,528 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 16:06:58,528 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 16:06:58,529 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 16:06:58,529 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 16:06:58,530 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 16:06:58,530 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 16:06:58,532 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 16:06:58,532 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 16:06:58,841 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 16:06:58,841 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 16:06:59,136 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 16:06:59,136 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 16:06:59,139 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 16:06:59,139 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 16:06:59,142 - __main__ - INFO - Environment: LOCAL
2025-09-02 16:06:59,142 - __main__ - INFO - Environment: LOCAL
2025-09-02 16:06:59,143 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:06:59,143 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:06:59,143 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:06:59,143 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:06:59,821 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:06:59,821 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:06:59,830 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:06:59,830 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:07:00,312 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:07:00,312 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:07:00,317 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 16:07:00,317 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 16:07:00,319 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 16:07:00,319 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 16:07:00,320 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 16:07:00,320 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 16:07:00,328 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 16:07:00,328 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 16:07:00,330 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 16:07:00,330 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 16:07:00,332 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 16:07:00,332 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 16:07:00,340 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 16:07:00,340 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 16:07:00,341 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 16:07:00,341 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 16:07:00,342 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 16:07:00,342 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 16:07:00,343 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 16:07:00,343 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 16:07:00,347 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 16:07:00,347 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 16:07:00,600 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 16:07:00,600 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 16:07:00,602 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 16:07:00,602 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 16:07:00,607 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:07:00,607 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:07:00,613 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 16:07:00,613 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 16:07:01,543 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 16:07:01,543 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 16:07:02,136 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:07:02,136 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:07:02,427 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:07:02,427 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:07:02,428 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 16:07:02,428 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 16:07:02,431 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 16:07:02,431 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 16:07:02,432 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 16:07:02,432 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 16:07:02,435 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:07:02,435 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:07:02,439 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:07:02,439 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:07:02,508 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 16:07:02,508 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 16:07:03,095 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 16:07:03,095 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 16:07:03,583 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:07:03,583 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:07:03,757 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:07:03,757 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:07:03,758 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 16:07:03,758 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 16:07:03,759 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:07:03,759 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:07:03,763 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:07:03,763 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:07:03,772 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 16:07:03,772 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 16:07:04,577 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 16:07:04,577 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 16:07:04,625 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 16:07:04,625 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 16:07:04,630 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:07:04,630 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:07:04,647 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:07:04,647 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:07:04,651 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:07:04,651 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:07:04,655 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 16:07:04,655 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 16:07:04,664 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:07:04,664 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:07:04,666 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 16:07:04,666 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 16:07:04,668 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 16:07:04,668 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 16:07:04,672 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:07:04,672 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:07:04,692 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:07:04,692 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:07:04,698 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:07:04,698 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:07:04,700 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:07:04,700 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:07:04,729 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 16:07:04,729 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 16:07:04,774 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 16:07:04,774 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 16:07:04,810 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 16:07:04,810 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 16:07:04,822 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 16:07:04,822 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 16:07:04,824 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 16:07:04,824 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 16:07:04,826 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 16:07:04,826 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 16:07:04,828 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 16:07:04,828 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 16:07:04,829 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 16:07:04,829 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 16:07:04,831 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:07:04,831 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:07:04,834 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 16:07:04,834 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 16:07:04,841 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 16:07:04,841 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 16:07:04,847 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:07:04,847 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:07:04,855 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:07:04,855 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:07:04,862 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 16:07:04,862 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 16:07:05,712 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 16:07:05,712 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 16:07:06,453 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:07:06,453 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:07:06,707 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:07:06,707 - src.services.google_sheets.api_client - INFO - {'message': 'Cleared all rows after row 53 (row 54 and beyond)', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:07:06,708 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 16:07:06,708 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 16:08:18,092 - root - INFO - Logging environment: LOCAL
2025-09-02 16:08:18,092 - root - INFO - Logging environment: LOCAL
2025-09-02 16:08:18,092 - root - INFO - Logging environment: LOCAL
2025-09-02 16:08:18,092 - root - INFO - Logging environment: LOCAL
2025-09-02 16:08:18,094 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:08:18,094 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:08:18,094 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 16:08:18,094 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-02 16:08:18,096 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 16:08:18,096 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-02 16:08:18,096 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 16:08:18,096 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-02 16:08:18,098 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 16:08:18,098 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-02 16:08:18,100 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 16:08:18,100 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-02 16:08:18,102 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 16:08:18,102 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-02 16:08:18,103 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 16:08:18,103 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-02 16:08:18,414 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 16:08:18,414 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-02 16:08:18,683 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 16:08:18,683 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-02 16:08:18,684 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 16:08:18,684 - __main__ - INFO - Using rolling 32-day date range: 2025-08-01 to 2025-09-02
2025-09-02 16:08:18,686 - __main__ - INFO - Environment: LOCAL
2025-09-02 16:08:18,686 - __main__ - INFO - Environment: LOCAL
2025-09-02 16:08:18,687 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:08:18,687 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-02 16:08:18,688 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:08:18,688 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:08:19,358 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:08:19,358 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:08:19,382 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:08:19,382 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-02 16:08:19,935 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:08:19,935 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-02 16:08:19,946 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 16:08:19,946 - __main__ - INFO - Processing 686 non-voided shipments.
2025-09-02 16:08:19,947 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 16:08:19,947 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-02 16:08:19,948 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 16:08:19,948 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-02 16:08:19,969 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 16:08:19,969 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 686 rows.
2025-09-02 16:08:19,971 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 16:08:19,971 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-02 16:08:19,973 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 16:08:19,973 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-02 16:08:19,994 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 16:08:19,994 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 624 unique order rows.
2025-09-02 16:08:19,996 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 16:08:19,996 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 686 rows...
2025-09-02 16:08:19,998 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 16:08:19,998 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-02 16:08:20,003 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 16:08:20,003 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'SKU - Lot': ['17914 - 240286', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [1, 2, 6], 'Base SKU': ['17914', '17612', '17612']}}
2025-09-02 16:08:20,011 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 16:08:20,011 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-02 16:08:20,303 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 16:08:20,303 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-02 16:08:20,306 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 16:08:20,306 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-02 16:08:20,317 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:08:20,317 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:08:20,323 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 16:08:20,323 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 687}
2025-09-02 16:08:21,337 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 16:08:21,337 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2748}
2025-09-02 16:08:21,964 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:08:21,964 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-02 16:08:21,965 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 16:08:21,965 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 624 rows...
2025-09-02 16:08:21,967 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 16:08:21,967 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-02 16:08:21,969 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 16:08:21,969 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 1), datetime.date(2025, 8, 1), datetime.date(2025, 8, 1)], 'OrderNumber': ['673665', '673615', '673645']}}
2025-09-02 16:08:21,974 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:08:21,974 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:08:21,981 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:08:21,981 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:08:22,066 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 16:08:22,066 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 625}
2025-09-02 16:08:22,701 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 16:08:22,701 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1250}
2025-09-02 16:08:23,212 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:08:23,212 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-02 16:08:23,215 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 16:08:23,215 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-02 16:08:23,217 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:08:23,217 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:08:23,226 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:08:23,226 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:08:23,242 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 16:08:23,242 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-02 16:08:23,959 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 16:08:23,959 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-02 16:08:23,982 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 16:08:23,982 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612
676  2025-09-02  ...    18795
677  2025-09-02  ...    17612
678  2025-09-02  ...    17612
679  2025-09-02  ...    17612
680  2025-09-02  ...    17612
681  2025-09-02  ...    17612
682  2025-09-02  ...    17612
683  2025-09-02  ...    17914
684  2025-09-02  ...    18795
685  2025-09-02  ...    17612

[20 rows x 4 columns]
2025-09-02 16:08:23,985 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:08:23,985 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:08:23,992 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:08:23,992 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:08:23,995 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:08:23,995 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:08:23,996 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 16:08:23,996 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-02 16:08:23,998 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:08:23,998 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:08:24,002 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 16:08:24,002 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-02 16:08:24,006 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 16:08:24,006 - __main__ - INFO - Min Ship Date: 2025-08-01, Max Ship Date: 2025-09-02
2025-09-02 16:08:24,008 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:08:24,008 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-02 16:08:24,015 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:08:24,015 - __main__ - INFO - current_week_items_df head:
      Ship Date  ... Base SKU
666  2025-09-02  ...    17612
667  2025-09-02  ...    17904
668  2025-09-02  ...    17612
669  2025-09-02  ...    17612
670  2025-09-02  ...    17612
671  2025-09-02  ...    17612
672  2025-09-02  ...    17612
673  2025-09-02  ...    17612
674  2025-09-02  ...    17612
675  2025-09-02  ...    17612

[10 rows x 4 columns]
2025-09-02 16:08:24,016 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:08:24,016 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-02 16:08:24,016 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:08:24,016 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-02 16:08:24,028 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 16:08:24,028 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-02 16:08:24,051 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 16:08:24,051 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-02 16:08:24,074 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 16:08:24,074 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-02 16:08:24,081 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 16:08:24,081 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-02 16:08:24,082 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 16:08:24,082 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-02 16:08:24,084 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 16:08:24,084 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-02 16:08:24,085 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 16:08:24,085 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-02 16:08:24,086 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 16:08:24,086 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-02 16:08:24,087 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:08:24,087 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-02 16:08:24,088 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 16:08:24,088 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-02 16:08:24,090 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 16:08:24,090 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-02 16:08:24,092 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:08:24,092 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-02 16:08:24,095 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:08:24,095 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-02 16:08:24,114 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 16:08:24,114 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-02 16:08:24,690 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 16:08:24,690 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-02 16:08:25,404 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:08:25,404 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-02 16:08:25,406 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-02 16:08:25,406 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-03 10:35:31,316 - root - INFO - Logging environment: LOCAL
2025-09-03 10:35:31,316 - root - INFO - Logging environment: LOCAL
2025-09-03 10:35:31,317 - root - INFO - Logging environment: LOCAL
2025-09-03 10:35:31,317 - root - INFO - Logging environment: LOCAL
2025-09-03 10:35:31,321 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-03 10:35:31,321 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-03 10:35:31,322 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-03 10:35:31,322 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-03 10:35:31,324 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-03 10:35:31,324 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-03 10:35:31,326 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-03 10:35:31,326 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-03 10:35:31,327 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-03 10:35:31,327 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-03 10:35:31,330 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-03 10:35:31,330 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-03 10:35:31,331 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-03 10:35:31,331 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-03 10:35:31,332 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-03 10:35:31,332 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-03 10:35:31,875 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-03 10:35:31,875 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-03 10:35:32,334 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-03 10:35:32,334 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-03 10:35:32,336 - __main__ - INFO - Using rolling 32-day date range: 2025-08-02 to 2025-09-03
2025-09-03 10:35:32,336 - __main__ - INFO - Using rolling 32-day date range: 2025-08-02 to 2025-09-03
2025-09-03 10:35:32,339 - __main__ - INFO - Environment: LOCAL
2025-09-03 10:35:32,339 - __main__ - INFO - Environment: LOCAL
2025-09-03 10:35:32,342 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-03 10:35:32,342 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-03 10:35:32,348 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-03 10:35:32,348 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-03 10:35:33,206 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-03 10:35:33,206 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-03 10:35:33,221 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-03 10:35:33,221 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-03 10:35:33,743 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-03 10:35:33,743 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-03 10:35:33,750 - __main__ - INFO - Processing 668 non-voided shipments.
2025-09-03 10:35:33,750 - __main__ - INFO - Processing 668 non-voided shipments.
2025-09-03 10:35:33,750 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-03 10:35:33,750 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-03 10:35:33,752 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-03 10:35:33,752 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-03 10:35:33,791 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 668 rows.
2025-09-03 10:35:33,791 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 668 rows.
2025-09-03 10:35:33,792 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-03 10:35:33,792 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-03 10:35:33,793 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-03 10:35:33,793 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-03 10:35:33,818 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 607 unique order rows.
2025-09-03 10:35:33,818 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 607 unique order rows.
2025-09-03 10:35:33,820 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 668 rows...
2025-09-03 10:35:33,820 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 668 rows...
2025-09-03 10:35:33,823 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-03 10:35:33,823 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-03 10:35:33,828 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 4), datetime.date(2025, 8, 4), datetime.date(2025, 8, 4)], 'SKU - Lot': ['17612 - 250195', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [16, 1, 2], 'Base SKU': ['17612', '17612', '17612']}}
2025-09-03 10:35:33,828 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 4), datetime.date(2025, 8, 4), datetime.date(2025, 8, 4)], 'SKU - Lot': ['17612 - 250195', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [16, 1, 2], 'Base SKU': ['17612', '17612', '17612']}}
2025-09-03 10:35:33,836 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-03 10:35:33,836 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-03 10:35:34,215 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-03 10:35:34,215 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-03 10:35:34,218 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-03 10:35:34,218 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-03 10:35:34,235 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:35:34,235 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:35:34,284 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 669}
2025-09-03 10:35:34,284 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 669}
2025-09-03 10:35:35,733 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2676}
2025-09-03 10:35:35,733 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 2676}
2025-09-03 10:35:36,801 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-03 10:35:36,801 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-03 10:35:36,804 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 607 rows...
2025-09-03 10:35:36,804 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 607 rows...
2025-09-03 10:35:36,807 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-03 10:35:36,807 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-03 10:35:36,812 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 4), datetime.date(2025, 8, 4), datetime.date(2025, 8, 4)], 'OrderNumber': ['673805', '100439', '673815']}}
2025-09-03 10:35:36,812 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 8, 4), datetime.date(2025, 8, 4), datetime.date(2025, 8, 4)], 'OrderNumber': ['673805', '100439', '673815']}}
2025-09-03 10:35:36,823 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-03 10:35:36,823 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-03 10:35:36,839 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:35:36,839 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:35:36,970 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 608}
2025-09-03 10:35:36,970 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 608}
2025-09-03 10:35:38,278 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1216}
2025-09-03 10:35:38,278 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1216}
2025-09-03 10:35:39,233 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-03 10:35:39,233 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-03 10:35:39,235 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-03 10:35:39,235 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-03 10:35:39,237 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-03 10:35:39,237 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-03 10:35:39,245 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:35:39,245 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:35:39,260 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-03 10:35:39,260 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-03 10:35:40,334 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-03 10:35:40,334 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-03 10:35:40,493 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
648  2025-09-02  17612 - 250216                 1    17612
649  2025-09-02  17904 - 240276                 1    17904
650  2025-09-02  17612 - 250216                20    17612
651  2025-09-02  17612 - 250216                 1    17612
652  2025-09-02  17612 - 250216                 2    17612
653  2025-09-02  17612 - 250216                 6    17612
654  2025-09-02  17612 - 250216                 1    17612
655  2025-09-02  17612 - 250216                15    17612
656  2025-09-02  17612 - 250216                15    17612
657  2025-09-02  17612 - 250216                 1    17612
658  2025-09-02   18795 - 11001                 3    18795
659  2025-09-02  17612 - 250216                 3    17612
660  2025-09-02  17612 - 250216                 6    17612
661  2025-09-02  17612 - 250216                 1    17612
662  2025-09-02  17612 - 250216                 6    17612
663  2025-09-02  17612 - 250216                 3    17612
664  2025-09-02  17612 - 250216                 3    17612
665  2025-09-02  17914 - 240286                 1    17914
666  2025-09-02   18795 - 11001                 2    18795
667  2025-09-02  17612 - 250216                 1    17612
2025-09-03 10:35:40,493 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
648  2025-09-02  17612 - 250216                 1    17612
649  2025-09-02  17904 - 240276                 1    17904
650  2025-09-02  17612 - 250216                20    17612
651  2025-09-02  17612 - 250216                 1    17612
652  2025-09-02  17612 - 250216                 2    17612
653  2025-09-02  17612 - 250216                 6    17612
654  2025-09-02  17612 - 250216                 1    17612
655  2025-09-02  17612 - 250216                15    17612
656  2025-09-02  17612 - 250216                15    17612
657  2025-09-02  17612 - 250216                 1    17612
658  2025-09-02   18795 - 11001                 3    18795
659  2025-09-02  17612 - 250216                 3    17612
660  2025-09-02  17612 - 250216                 6    17612
661  2025-09-02  17612 - 250216                 1    17612
662  2025-09-02  17612 - 250216                 6    17612
663  2025-09-02  17612 - 250216                 3    17612
664  2025-09-02  17612 - 250216                 3    17612
665  2025-09-02  17914 - 240286                 1    17914
666  2025-09-02   18795 - 11001                 2    18795
667  2025-09-02  17612 - 250216                 1    17612
2025-09-03 10:35:40,502 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-03 10:35:40,502 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-03 10:35:40,537 - __main__ - INFO - current_week_items_df head:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
648  2025-09-02  17612 - 250216                 1    17612
649  2025-09-02  17904 - 240276                 1    17904
650  2025-09-02  17612 - 250216                20    17612
651  2025-09-02  17612 - 250216                 1    17612
652  2025-09-02  17612 - 250216                 2    17612
653  2025-09-02  17612 - 250216                 6    17612
654  2025-09-02  17612 - 250216                 1    17612
655  2025-09-02  17612 - 250216                15    17612
656  2025-09-02  17612 - 250216                15    17612
657  2025-09-02  17612 - 250216                 1    17612
2025-09-03 10:35:40,537 - __main__ - INFO - current_week_items_df head:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
648  2025-09-02  17612 - 250216                 1    17612
649  2025-09-02  17904 - 240276                 1    17904
650  2025-09-02  17612 - 250216                20    17612
651  2025-09-02  17612 - 250216                 1    17612
652  2025-09-02  17612 - 250216                 2    17612
653  2025-09-02  17612 - 250216                 6    17612
654  2025-09-02  17612 - 250216                 1    17612
655  2025-09-02  17612 - 250216                15    17612
656  2025-09-02  17612 - 250216                15    17612
657  2025-09-02  17612 - 250216                 1    17612
2025-09-03 10:35:40,543 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-03 10:35:40,543 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-03 10:35:40,546 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-03 10:35:40,546 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-03 10:35:40,562 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-03 10:35:40,562 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-03 10:35:40,568 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-03 10:35:40,568 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-03 10:35:40,578 - __main__ - INFO - Min Ship Date: 2025-08-04, Max Ship Date: 2025-09-02
2025-09-03 10:35:40,578 - __main__ - INFO - Min Ship Date: 2025-08-04, Max Ship Date: 2025-09-02
2025-09-03 10:35:40,595 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-03 10:35:40,595 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-03 10:35:40,633 - __main__ - INFO - current_week_items_df head:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
648  2025-09-02  17612 - 250216                 1    17612
649  2025-09-02  17904 - 240276                 1    17904
650  2025-09-02  17612 - 250216                20    17612
651  2025-09-02  17612 - 250216                 1    17612
652  2025-09-02  17612 - 250216                 2    17612
653  2025-09-02  17612 - 250216                 6    17612
654  2025-09-02  17612 - 250216                 1    17612
655  2025-09-02  17612 - 250216                15    17612
656  2025-09-02  17612 - 250216                15    17612
657  2025-09-02  17612 - 250216                 1    17612
2025-09-03 10:35:40,633 - __main__ - INFO - current_week_items_df head:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
648  2025-09-02  17612 - 250216                 1    17612
649  2025-09-02  17904 - 240276                 1    17904
650  2025-09-02  17612 - 250216                20    17612
651  2025-09-02  17612 - 250216                 1    17612
652  2025-09-02  17612 - 250216                 2    17612
653  2025-09-02  17612 - 250216                 6    17612
654  2025-09-02  17612 - 250216                 1    17612
655  2025-09-02  17612 - 250216                15    17612
656  2025-09-02  17612 - 250216                15    17612
657  2025-09-02  17612 - 250216                 1    17612
2025-09-03 10:35:40,638 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-03 10:35:40,638 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-03 10:35:40,641 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-03 10:35:40,641 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-03 10:35:40,675 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-03 10:35:40,675 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-03 10:35:40,748 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-03 10:35:40,748 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-03 10:35:40,790 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-03 10:35:40,790 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-03 10:35:40,813 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-03 10:35:40,813 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-03 10:35:40,816 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-03 10:35:40,816 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-03 10:35:40,820 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-03 10:35:40,820 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-03 10:35:40,822 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-03 10:35:40,822 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-03 10:35:40,824 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-03 10:35:40,824 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-03 10:35:40,827 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-03 10:35:40,827 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-03 10:35:40,831 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-03 10:35:40,831 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-03 10:35:40,836 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-03 10:35:40,836 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-03 10:35:40,845 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-03 10:35:40,845 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-03 10:35:40,858 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:35:40,858 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:35:40,873 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-03 10:35:40,873 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-03 10:35:42,068 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-03 10:35:42,068 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-03 10:35:42,691 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-03 10:35:42,691 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-03 10:35:42,693 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-03 10:35:42,693 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-03 10:49:43,826 - root - INFO - Logging environment: LOCAL
2025-09-03 10:49:43,826 - root - INFO - Logging environment: LOCAL
2025-09-03 10:49:43,827 - root - INFO - Logging environment: LOCAL
2025-09-03 10:49:43,827 - root - INFO - Logging environment: LOCAL
2025-09-03 10:49:43,830 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-03 10:49:43,830 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-03 10:49:43,832 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-03 10:49:43,832 - __main__ - INFO - [DEBUG] SERVICE_ACCOUNT_KEY_PATH exists: True
2025-09-03 10:49:43,833 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-03 10:49:43,833 - __main__ - INFO - [DEBUG] IS_LOCAL_ENV: True
2025-09-03 10:49:43,833 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-03 10:49:43,833 - __main__ - INFO - [DEBUG] IS_CLOUD_ENV: False
2025-09-03 10:49:43,834 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-03 10:49:43,834 - __main__ - INFO - [DEBUG] YOUR_GCP_PROJECT_ID: ora-automation-project-dev
2025-09-03 10:49:43,834 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-03 10:49:43,834 - __main__ - INFO - [DEBUG] SHIPSTATION_API_KEY_SECRET_ID: shipstation-api-key
2025-09-03 10:49:43,835 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-03 10:49:43,835 - __main__ - INFO - [DEBUG] SHIPSTATION_API_SECRET_SECRET_ID: shipstation-api-secret
2025-09-03 10:49:43,836 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-03 10:49:43,836 - __main__ - INFO - --- Starting Daily Shipment Processor ---
2025-09-03 10:49:44,321 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-03 10:49:44,321 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-key'.
2025-09-03 10:49:44,693 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-03 10:49:44,693 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'shipstation-api-secret'.
2025-09-03 10:49:44,695 - __main__ - INFO - Using rolling 32-day date range: 2025-07-25 to 2025-09-03
2025-09-03 10:49:44,695 - __main__ - INFO - Using rolling 32-day date range: 2025-07-25 to 2025-09-03
2025-09-03 10:49:44,698 - __main__ - INFO - Environment: LOCAL
2025-09-03 10:49:44,698 - __main__ - INFO - Environment: LOCAL
2025-09-03 10:49:44,700 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-03 10:49:44,700 - __main__ - INFO - Service Account Key Path: C:\Users\NathanNeely\Projects\config\ora-automation-project-dev-25acb5551197.json
2025-09-03 10:49:44,712 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-03 10:49:44,712 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-03 10:49:45,581 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-03 10:49:45,581 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-03 10:49:45,591 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-03 10:49:45,591 - utils.api_utils - INFO - Attempting GET request to: https://ssapi.shipstation.com/shipments
2025-09-03 10:49:46,164 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-03 10:49:46,164 - utils.api_utils - INFO - Successfully received response from https://ssapi.shipstation.com/shipments with status code: 200
2025-09-03 10:49:46,171 - __main__ - INFO - Processing 823 non-voided shipments.
2025-09-03 10:49:46,171 - __main__ - INFO - Processing 823 non-voided shipments.
2025-09-03 10:49:46,173 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-03 10:49:46,173 - __main__ - INFO - Processing data for Shipped_Items_Data tab...
2025-09-03 10:49:46,175 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-03 10:49:46,175 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Items_Data tab...
2025-09-03 10:49:46,211 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 823 rows.
2025-09-03 10:49:46,211 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 823 rows.
2025-09-03 10:49:46,215 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-03 10:49:46,215 - __main__ - INFO - Processing data for Shipped_Orders_Data tab...
2025-09-03 10:49:46,216 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-03 10:49:46,216 - src.services.data_processing.shipment_processor - INFO - Processing raw shipment data for Shipped_Orders_Data tab...
2025-09-03 10:49:46,229 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 752 unique order rows.
2025-09-03 10:49:46,229 - src.services.data_processing.shipment_processor - INFO - Finished processing. Resulting DataFrame has 752 unique order rows.
2025-09-03 10:49:46,232 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 823 rows...
2025-09-03 10:49:46,232 - __main__ - INFO - Overwriting 'Shipped_Items_Data' tab with 823 rows...
2025-09-03 10:49:46,235 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-03 10:49:46,235 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'SKU - Lot': 'object', 'Quantity Shipped': 'int64', 'Base SKU': 'object'}}
2025-09-03 10:49:46,240 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 7, 25), datetime.date(2025, 7, 25), datetime.date(2025, 7, 25)], 'SKU - Lot': ['17612 - 250195', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [6, 15, 1], 'Base SKU': ['17612', '17612', '17612']}}
2025-09-03 10:49:46,240 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 7, 25), datetime.date(2025, 7, 25), datetime.date(2025, 7, 25)], 'SKU - Lot': ['17612 - 250195', '17612 - 250195', '17612 - 250195'], 'Quantity Shipped': [6, 15, 1], 'Base SKU': ['17612', '17612', '17612']}}
2025-09-03 10:49:46,248 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-03 10:49:46,248 - src.services.google_sheets.api_client - DEBUG - {'message': 'Attempting to retrieve Google Sheets service account key from Secret Manager.'}
2025-09-03 10:49:46,527 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-03 10:49:46,527 - src.services.gcp.secret_manager - INFO - Successfully accessed secret 'google-sheets-service-account-key'.
2025-09-03 10:49:46,530 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-03 10:49:46,530 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheets credentials successfully retrieved and cached.'}
2025-09-03 10:49:46,537 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:49:46,537 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:49:46,590 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 824}
2025-09-03 10:49:46,590 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'rows_to_write': 824}
2025-09-03 10:49:47,834 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 3296}
2025-09-03 10:49:47,834 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data', 'updated_cells': 3296}
2025-09-03 10:49:48,789 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-03 10:49:48,789 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Items_Data'}
2025-09-03 10:49:48,792 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 752 rows...
2025-09-03 10:49:48,792 - __main__ - INFO - Overwriting 'Shipped_Orders_Data' tab with 752 rows...
2025-09-03 10:49:48,795 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-03 10:49:48,795 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Ship Date': 'object', 'OrderNumber': 'object'}}
2025-09-03 10:49:48,798 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 7, 25), datetime.date(2025, 7, 25), datetime.date(2025, 7, 25)], 'OrderNumber': ['671835', '672175', '672675']}}
2025-09-03 10:49:48,798 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Ship Date': [datetime.date(2025, 7, 25), datetime.date(2025, 7, 25), datetime.date(2025, 7, 25)], 'OrderNumber': ['671835', '672175', '672675']}}
2025-09-03 10:49:48,804 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-03 10:49:48,804 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-03 10:49:48,815 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:49:48,815 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:49:48,837 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 753}
2025-09-03 10:49:48,837 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'rows_to_write': 753}
2025-09-03 10:49:50,034 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1506}
2025-09-03 10:49:50,034 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data', 'updated_cells': 1506}
2025-09-03 10:49:51,325 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-03 10:49:51,325 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'Shipped_Orders_Data'}
2025-09-03 10:49:51,328 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-03 10:49:51,328 - __main__ - INFO - Fetching existing 52-week history for update...
2025-09-03 10:49:51,331 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-03 10:49:51,331 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-03 10:49:51,339 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:49:51,339 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:49:51,354 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-03 10:49:51,354 - src.services.google_sheets.api_client - DEBUG - {'message': 'Fetching data from Google Sheet', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'range': "'ORA_Weekly_Shipped_History'!A:ZZ"}
2025-09-03 10:49:52,381 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-03 10:49:52,381 - src.services.google_sheets.api_client - INFO - {'message': 'Successfully retrieved data from Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_count': 53}
2025-09-03 10:49:52,434 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
803  2025-09-02  17612 - 250216                 1    17612
804  2025-09-02  17904 - 240276                 1    17904
805  2025-09-02  17612 - 250216                20    17612
806  2025-09-02  17612 - 250216                 1    17612
807  2025-09-02  17612 - 250216                 2    17612
808  2025-09-02  17612 - 250216                 6    17612
809  2025-09-02  17612 - 250216                 1    17612
810  2025-09-02  17612 - 250216                15    17612
811  2025-09-02  17612 - 250216                15    17612
812  2025-09-02  17612 - 250216                 1    17612
813  2025-09-02   18795 - 11001                 3    18795
814  2025-09-02  17612 - 250216                 3    17612
815  2025-09-02  17612 - 250216                 6    17612
816  2025-09-02  17612 - 250216                 1    17612
817  2025-09-02  17612 - 250216                 6    17612
818  2025-09-02  17612 - 250216                 3    17612
819  2025-09-02  17612 - 250216                 3    17612
820  2025-09-02  17914 - 240286                 1    17914
821  2025-09-02   18795 - 11001                 2    18795
822  2025-09-02  17612 - 250216                 1    17612
2025-09-03 10:49:52,434 - __main__ - INFO - Full current_week_items_df for current week:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
803  2025-09-02  17612 - 250216                 1    17612
804  2025-09-02  17904 - 240276                 1    17904
805  2025-09-02  17612 - 250216                20    17612
806  2025-09-02  17612 - 250216                 1    17612
807  2025-09-02  17612 - 250216                 2    17612
808  2025-09-02  17612 - 250216                 6    17612
809  2025-09-02  17612 - 250216                 1    17612
810  2025-09-02  17612 - 250216                15    17612
811  2025-09-02  17612 - 250216                15    17612
812  2025-09-02  17612 - 250216                 1    17612
813  2025-09-02   18795 - 11001                 3    18795
814  2025-09-02  17612 - 250216                 3    17612
815  2025-09-02  17612 - 250216                 6    17612
816  2025-09-02  17612 - 250216                 1    17612
817  2025-09-02  17612 - 250216                 6    17612
818  2025-09-02  17612 - 250216                 3    17612
819  2025-09-02  17612 - 250216                 3    17612
820  2025-09-02  17914 - 240286                 1    17914
821  2025-09-02   18795 - 11001                 2    18795
822  2025-09-02  17612 - 250216                 1    17612
2025-09-03 10:49:52,438 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-03 10:49:52,438 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-03 10:49:52,469 - __main__ - INFO - current_week_items_df head:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
803  2025-09-02  17612 - 250216                 1    17612
804  2025-09-02  17904 - 240276                 1    17904
805  2025-09-02  17612 - 250216                20    17612
806  2025-09-02  17612 - 250216                 1    17612
807  2025-09-02  17612 - 250216                 2    17612
808  2025-09-02  17612 - 250216                 6    17612
809  2025-09-02  17612 - 250216                 1    17612
810  2025-09-02  17612 - 250216                15    17612
811  2025-09-02  17612 - 250216                15    17612
812  2025-09-02  17612 - 250216                 1    17612
2025-09-03 10:49:52,469 - __main__ - INFO - current_week_items_df head:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
803  2025-09-02  17612 - 250216                 1    17612
804  2025-09-02  17904 - 240276                 1    17904
805  2025-09-02  17612 - 250216                20    17612
806  2025-09-02  17612 - 250216                 1    17612
807  2025-09-02  17612 - 250216                 2    17612
808  2025-09-02  17612 - 250216                 6    17612
809  2025-09-02  17612 - 250216                 1    17612
810  2025-09-02  17612 - 250216                15    17612
811  2025-09-02  17612 - 250216                15    17612
812  2025-09-02  17612 - 250216                 1    17612
2025-09-03 10:49:52,480 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-03 10:49:52,480 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-03 10:49:52,484 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-03 10:49:52,484 - __main__ - INFO - Starting incremental update of the 52-week history tab...
2025-09-03 10:49:52,495 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-03 10:49:52,495 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-03 10:49:52,498 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 7, 25), datetime.date(2025, 7, 28), datetime.date(2025, 7, 29), datetime.date(2025, 7, 30), datetime.date(2025, 7, 31), datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-03 10:49:52,498 - __main__ - INFO - Unique Ship Dates in daily_items_df: [datetime.date(2025, 7, 25), datetime.date(2025, 7, 28), datetime.date(2025, 7, 29), datetime.date(2025, 7, 30), datetime.date(2025, 7, 31), datetime.date(2025, 8, 1), datetime.date(2025, 8, 4), datetime.date(2025, 8, 5), datetime.date(2025, 8, 6), datetime.date(2025, 8, 7), datetime.date(2025, 8, 8), datetime.date(2025, 8, 11), datetime.date(2025, 8, 12), datetime.date(2025, 8, 13), datetime.date(2025, 8, 14), datetime.date(2025, 8, 15), datetime.date(2025, 8, 18), datetime.date(2025, 8, 19), datetime.date(2025, 8, 20), datetime.date(2025, 8, 21), datetime.date(2025, 8, 22), datetime.date(2025, 8, 25), datetime.date(2025, 8, 26), datetime.date(2025, 8, 27), datetime.date(2025, 8, 28), datetime.date(2025, 8, 29), datetime.date(2025, 9, 2)]
2025-09-03 10:49:52,506 - __main__ - INFO - Min Ship Date: 2025-07-25, Max Ship Date: 2025-09-02
2025-09-03 10:49:52,506 - __main__ - INFO - Min Ship Date: 2025-07-25, Max Ship Date: 2025-09-02
2025-09-03 10:49:52,512 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-03 10:49:52,512 - __main__ - INFO - current_week_items_df shape: (20, 4)
2025-09-03 10:49:52,537 - __main__ - INFO - current_week_items_df head:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
803  2025-09-02  17612 - 250216                 1    17612
804  2025-09-02  17904 - 240276                 1    17904
805  2025-09-02  17612 - 250216                20    17612
806  2025-09-02  17612 - 250216                 1    17612
807  2025-09-02  17612 - 250216                 2    17612
808  2025-09-02  17612 - 250216                 6    17612
809  2025-09-02  17612 - 250216                 1    17612
810  2025-09-02  17612 - 250216                15    17612
811  2025-09-02  17612 - 250216                15    17612
812  2025-09-02  17612 - 250216                 1    17612
2025-09-03 10:49:52,537 - __main__ - INFO - current_week_items_df head:
      Ship Date       SKU - Lot  Quantity Shipped Base SKU
803  2025-09-02  17612 - 250216                 1    17612
804  2025-09-02  17904 - 240276                 1    17904
805  2025-09-02  17612 - 250216                20    17612
806  2025-09-02  17612 - 250216                 1    17612
807  2025-09-02  17612 - 250216                 2    17612
808  2025-09-02  17612 - 250216                 6    17612
809  2025-09-02  17612 - 250216                 1    17612
810  2025-09-02  17612 - 250216                15    17612
811  2025-09-02  17612 - 250216                15    17612
812  2025-09-02  17612 - 250216                 1    17612
2025-09-03 10:49:52,538 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-03 10:49:52,538 - __main__ - INFO - Unique 'Base SKU' values in current_week_items_df: ['17612', '17904', '17914', '18795']
2025-09-03 10:49:52,542 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-03 10:49:52,542 - __main__ - INFO - Current week starts on: 2025-09-01
2025-09-03 10:49:52,589 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-03 10:49:52,589 - src.services.data_processing.shipment_processor - INFO - Aggregating weekly shipment history for SKUs: ['17612', '17904', '17914', '18675', '18795']...
2025-09-03 10:49:52,653 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-03 10:49:52,653 - src.services.data_processing.shipment_processor - INFO - Aggregation complete. Final report has 1 weekly rows.
2025-09-03 10:49:52,692 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-03 10:49:52,692 - __main__ - INFO - Current week found in history. Updating the last row.
2025-09-03 10:49:52,706 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-03 10:49:52,706 - __main__ - INFO - Deduplication complete: 0 duplicate week(s) removed. 52 unique weeks remain.
2025-09-03 10:49:52,709 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-03 10:49:52,709 - __main__ - INFO - History now contains 52 weeks after enforcing 52-week rule.
2025-09-03 10:49:52,713 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-03 10:49:52,713 - __main__ - INFO - Validation: 0 duplicate week(s) found. 52 total weeks. Most recent week: 2025-09-01, Expected: 2025-09-01.
2025-09-03 10:49:52,714 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-03 10:49:52,714 - __main__ - INFO - Weekly history update successful: deduplication, 52-week enforcement, and current week validation all passed.
2025-09-03 10:49:52,715 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-03 10:49:52,715 - __main__ - INFO - Overwriting 'ORA_Weekly_Shipped_History' with updated 52-week history...
2025-09-03 10:49:52,720 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-03 10:49:52,720 - src.services.google_sheets.api_client - ERROR - {'message': 'Failed to clear rows after row 53.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'error': "cannot access local variable 'service' where it is not associated with a value"}
2025-09-03 10:49:52,723 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-03 10:49:52,723 - src.services.google_sheets.api_client - DEBUG - {'message': 'DataFrame dtypes before upload', 'dtypes': {'Start Date': 'object', 'Stop Date': 'object', '17612': 'object', '17904': 'object', '17914': 'object', '18675': 'object', '18795': 'object'}}
2025-09-03 10:49:52,727 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-03 10:49:52,727 - src.services.google_sheets.api_client - DEBUG - {'message': 'Sample data before upload', 'sample': {'Start Date': [datetime.date(2024, 9, 9), datetime.date(2024, 9, 16), datetime.date(2024, 9, 23)], 'Stop Date': ['2024-09-15', '2024-09-22', '2024-09-29'], '17612': ['406', '442', '443'], '17904': ['0', '0', '0'], '17914': ['19', '24', '30'], '18675': ['2', '2', '1'], '18795': ['0', '0', '0']}}
2025-09-03 10:49:52,733 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-03 10:49:52,733 - src.services.google_sheets.api_client - DEBUG - {'message': 'Using cached Google Sheets credentials.'}
2025-09-03 10:49:52,739 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:49:52,739 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-03 10:49:52,793 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-03 10:49:52,793 - src.services.google_sheets.api_client - DEBUG - {'message': 'Writing new data to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'rows_to_write': 53}
2025-09-03 10:49:53,598 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-03 10:49:53,598 - src.services.google_sheets.api_client - INFO - {'message': 'Data successfully written to Google Sheet.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History', 'updated_cells': 371}
2025-09-03 10:49:54,207 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-03 10:49:54,207 - src.services.google_sheets.api_client - INFO - {'message': 'Google Sheet formatting applied successfully.', 'sheet_id': '1SMewCScZp0U4QtdXMp8ZhT3oxefzKHu-Hq2BAXtCeoo', 'worksheet': 'ORA_Weekly_Shipped_History'}
2025-09-03 10:49:54,211 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
2025-09-03 10:49:54,211 - __main__ - INFO - --- Daily Shipment Processor finished successfully! ---
